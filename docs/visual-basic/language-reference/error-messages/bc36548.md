---
title: 無法將匿名類型轉換成運算式樹狀結構，因為類型的屬性會用以初始化另一個屬性
ms.date: 07/20/2015
f1_keywords:
- bc36548
- vbc36548
helpviewer_keywords:
- BC36548
ms.assetid: 27de068f-080e-4160-86bf-1ec23fd1925a
ms.openlocfilehash: 11cedfb93bcbec1f5a4f222a63b65a20b0e859f0
ms.sourcegitcommit: ff5a4eb5cffbcac9521bc44a907a118cd7e8638d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/17/2020
ms.locfileid: "92162579"
---
# <a name="bc36548-cannot-convert-anonymous-type-to-an-expression-tree-because-a-property-of-the-type-is-used-to-initialize-another-property"></a><span data-ttu-id="f27f2-102">BC36548：無法將匿名型別轉換為運算式樹狀架構，因為類型的屬性是用來初始化其他屬性</span><span class="sxs-lookup"><span data-stu-id="f27f2-102">BC36548: Cannot convert anonymous type to an expression tree because a property of the type is used to initialize another property</span></span>

<span data-ttu-id="f27f2-103">當使用匿名型別的一個屬性來初始化匿名型別的另一個屬性時，編譯器不會接受匿名型別的轉換成運算式樹狀結構。</span><span class="sxs-lookup"><span data-stu-id="f27f2-103">The compiler does not accept conversion of an anonymous type to an expression tree when one property of the anonymous type is used to initialize another property of the anonymous type.</span></span> <span data-ttu-id="f27f2-104">例如，在下列程式碼中， `Prop1` 會在初始化清單中宣告，然後用來做為的起始值 `Prop2` 。</span><span class="sxs-lookup"><span data-stu-id="f27f2-104">For example, in the following code, `Prop1` is declared in the initialization list and then used as the initial value for `Prop2`.</span></span>

<span data-ttu-id="f27f2-105">**錯誤識別碼：** BC36548</span><span class="sxs-lookup"><span data-stu-id="f27f2-105">**Error ID:** BC36548</span></span>

## <a name="example"></a><span data-ttu-id="f27f2-106">範例</span><span class="sxs-lookup"><span data-stu-id="f27f2-106">Example</span></span>

```vb
Module M2

    Sub ExpressionExample(Of T)(x As Expressions.Expression(Of Func(Of T)))
    End Sub

    Sub Main()
        ' The following line causes the error.
        ExpressionExample(Function() New With {.Prop1 = 2, .Prop2 = .Prop1})
    End Sub
End Module
```

## <a name="to-correct-this-error"></a><span data-ttu-id="f27f2-107">更正這個錯誤</span><span class="sxs-lookup"><span data-stu-id="f27f2-107">To correct this error</span></span>

<span data-ttu-id="f27f2-108">將的初始值指派給 `Prop1` 區域變數。</span><span class="sxs-lookup"><span data-stu-id="f27f2-108">Assign the initial value for `Prop1` to a local variable.</span></span> <span data-ttu-id="f27f2-109">將該變數指派給 `Prop1` 和 `Prop2` ，如下列程式碼所示：</span><span class="sxs-lookup"><span data-stu-id="f27f2-109">Assign that variable to both `Prop1` and `Prop2`, as shown in the following code:</span></span>

```vb
Sub Main()
    Dim temp = 2
    ExpressionExample(Function() New With {.Prop1 = temp, .Prop2 = temp})
End Sub
```

## <a name="see-also"></a><span data-ttu-id="f27f2-110">另請參閱</span><span class="sxs-lookup"><span data-stu-id="f27f2-110">See also</span></span>

- [<span data-ttu-id="f27f2-111">匿名類型 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="f27f2-111">Anonymous Types (Visual Basic)</span></span>](../../programming-guide/language-features/objects-and-classes/anonymous-types.md)
- [<span data-ttu-id="f27f2-112">運算式樹狀結構 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="f27f2-112">Expression Trees (Visual Basic)</span></span>](../../programming-guide/concepts/expression-trees/index.md)
- [<span data-ttu-id="f27f2-113">如何：使用運算式樹狀架構建立動態查詢 (Visual Basic) </span><span class="sxs-lookup"><span data-stu-id="f27f2-113">How to: Use Expression Trees to Build Dynamic Queries (Visual Basic)</span></span>](../../programming-guide/concepts/expression-trees/how-to-use-expression-trees-to-build-dynamic-queries.md)

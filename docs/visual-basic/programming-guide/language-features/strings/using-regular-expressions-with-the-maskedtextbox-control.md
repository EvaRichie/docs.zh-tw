---
title: 將規則運算式與 MaskedTextBox 控制項搭配使用
ms.date: 07/20/2015
helpviewer_keywords:
- strings [Visual Basic], regular expressions
- strings [Visual Basic], masked edit
ms.assetid: 2a048fb0-7053-487d-b2c5-ffa5e22ed6f9
ms.openlocfilehash: efda70be0ccdbc1f4b59d548e50f743f6c493b19
ms.sourcegitcommit: f8c270376ed905f6a8896ce0fe25b4f4b38ff498
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 06/04/2020
ms.locfileid: "84363706"
---
# <a name="using-regular-expressions-with-the-maskedtextbox-control-in-visual-basic"></a><span data-ttu-id="e0961-102">在 Visual Basic 中將規則運算式與 MaskedTextBox 控制項一起搭配使用</span><span class="sxs-lookup"><span data-stu-id="e0961-102">Using Regular Expressions with the MaskedTextBox Control in Visual Basic</span></span>
<span data-ttu-id="e0961-103">這個範例示範如何轉換簡單的正則運算式，以使用 <xref:System.Windows.Forms.MaskedTextBox> 控制項。</span><span class="sxs-lookup"><span data-stu-id="e0961-103">This example demonstrates how to convert simple regular expressions to work with the <xref:System.Windows.Forms.MaskedTextBox> control.</span></span>  
  
## <a name="description-of-the-masking-language"></a><span data-ttu-id="e0961-104">遮罩語言的描述</span><span class="sxs-lookup"><span data-stu-id="e0961-104">Description of the Masking Language</span></span>  
 <span data-ttu-id="e0961-105">標準 <xref:System.Windows.Forms.MaskedTextBox> 遮罩語言是以 Visual Basic 6.0 中的控制項所使用的語言為基礎 `Masked Edit` ，對從該平臺進行遷移的使用者應該很熟悉。</span><span class="sxs-lookup"><span data-stu-id="e0961-105">The standard <xref:System.Windows.Forms.MaskedTextBox> masking language is based on the one used by the `Masked Edit` control in Visual Basic 6.0 and should be familiar to users migrating from that platform.</span></span>  
  
 <span data-ttu-id="e0961-106"><xref:System.Windows.Forms.MaskedTextBox.Mask%2A>控制項的屬性會 <xref:System.Windows.Forms.MaskedTextBox> 指定要使用的輸入遮罩。</span><span class="sxs-lookup"><span data-stu-id="e0961-106">The <xref:System.Windows.Forms.MaskedTextBox.Mask%2A> property of the <xref:System.Windows.Forms.MaskedTextBox> control specifies what input mask to use.</span></span> <span data-ttu-id="e0961-107">遮罩必須是由下表中一或多個遮罩元素所組成的字串。</span><span class="sxs-lookup"><span data-stu-id="e0961-107">The mask must be a string composed of one or more of the masking elements from the following table.</span></span>  
  
|<span data-ttu-id="e0961-108">遮罩元素</span><span class="sxs-lookup"><span data-stu-id="e0961-108">Masking element</span></span>|<span data-ttu-id="e0961-109">Description</span><span class="sxs-lookup"><span data-stu-id="e0961-109">Description</span></span>|<span data-ttu-id="e0961-110">正則運算式元素</span><span class="sxs-lookup"><span data-stu-id="e0961-110">Regular expression element</span></span>|  
|---------------------|-----------------|--------------------------------|  
|<span data-ttu-id="e0961-111">0</span><span class="sxs-lookup"><span data-stu-id="e0961-111">0</span></span>|<span data-ttu-id="e0961-112">介於0到9之間的任何單一位數。</span><span class="sxs-lookup"><span data-stu-id="e0961-112">Any single digit between 0 and 9.</span></span> <span data-ttu-id="e0961-113">需要輸入。</span><span class="sxs-lookup"><span data-stu-id="e0961-113">Entry required.</span></span>|<span data-ttu-id="e0961-114">\d</span><span class="sxs-lookup"><span data-stu-id="e0961-114">\d</span></span>|  
|<span data-ttu-id="e0961-115">9</span><span class="sxs-lookup"><span data-stu-id="e0961-115">9</span></span>|<span data-ttu-id="e0961-116">數位或空格。</span><span class="sxs-lookup"><span data-stu-id="e0961-116">Digit or space.</span></span> <span data-ttu-id="e0961-117">選擇性專案。</span><span class="sxs-lookup"><span data-stu-id="e0961-117">Entry optional.</span></span>|<span data-ttu-id="e0961-118">[\d]？</span><span class="sxs-lookup"><span data-stu-id="e0961-118">[ \d]?</span></span>|  
|#|<span data-ttu-id="e0961-119">數位或空格。</span><span class="sxs-lookup"><span data-stu-id="e0961-119">Digit or space.</span></span> <span data-ttu-id="e0961-120">選擇性專案。</span><span class="sxs-lookup"><span data-stu-id="e0961-120">Entry optional.</span></span> <span data-ttu-id="e0961-121">如果遮罩中的這個位置保留空白，則會轉譯為空格。</span><span class="sxs-lookup"><span data-stu-id="e0961-121">If this position is left blank in the mask, it will be rendered as a space.</span></span> <span data-ttu-id="e0961-122">允許加上（+）和減號（-）符號。</span><span class="sxs-lookup"><span data-stu-id="e0961-122">Plus (+) and minus (-) signs are allowed.</span></span>|<span data-ttu-id="e0961-123">[\d +-]？</span><span class="sxs-lookup"><span data-stu-id="e0961-123">[ \d+-]?</span></span>|  
|<span data-ttu-id="e0961-124">L</span><span class="sxs-lookup"><span data-stu-id="e0961-124">L</span></span>|<span data-ttu-id="e0961-125">ASCII 字母。</span><span class="sxs-lookup"><span data-stu-id="e0961-125">ASCII letter.</span></span> <span data-ttu-id="e0961-126">需要輸入。</span><span class="sxs-lookup"><span data-stu-id="e0961-126">Entry required.</span></span>|<span data-ttu-id="e0961-127">[a-zA-Z]</span><span class="sxs-lookup"><span data-stu-id="e0961-127">[a-zA-Z]</span></span>|  
|<span data-ttu-id="e0961-128">?</span><span class="sxs-lookup"><span data-stu-id="e0961-128">?</span></span>|<span data-ttu-id="e0961-129">ASCII 字母。</span><span class="sxs-lookup"><span data-stu-id="e0961-129">ASCII letter.</span></span> <span data-ttu-id="e0961-130">選擇性專案。</span><span class="sxs-lookup"><span data-stu-id="e0961-130">Entry optional.</span></span>|<span data-ttu-id="e0961-131">[a-zA-Z]？</span><span class="sxs-lookup"><span data-stu-id="e0961-131">[a-zA-Z]?</span></span>|  
|&|<span data-ttu-id="e0961-132">字元。</span><span class="sxs-lookup"><span data-stu-id="e0961-132">Character.</span></span> <span data-ttu-id="e0961-133">需要輸入。</span><span class="sxs-lookup"><span data-stu-id="e0961-133">Entry required.</span></span>|<span data-ttu-id="e0961-134">[\p{Ll}\p{Lu}\p{Lt}\p{Lm}\p{Lo}]</span><span class="sxs-lookup"><span data-stu-id="e0961-134">[\p{Ll}\p{Lu}\p{Lt}\p{Lm}\p{Lo}]</span></span>|  
|<span data-ttu-id="e0961-135">C</span><span class="sxs-lookup"><span data-stu-id="e0961-135">C</span></span>|<span data-ttu-id="e0961-136">字元。</span><span class="sxs-lookup"><span data-stu-id="e0961-136">Character.</span></span> <span data-ttu-id="e0961-137">選擇性專案。</span><span class="sxs-lookup"><span data-stu-id="e0961-137">Entry optional.</span></span>|<span data-ttu-id="e0961-138">[\p{Ll}\p{Lu}\p{Lt}\p{Lm}\p{Lo}]?</span><span class="sxs-lookup"><span data-stu-id="e0961-138">[\p{Ll}\p{Lu}\p{Lt}\p{Lm}\p{Lo}]?</span></span>|  
|<span data-ttu-id="e0961-139">A</span><span class="sxs-lookup"><span data-stu-id="e0961-139">A</span></span>|<span data-ttu-id="e0961-140">拉丁字母.</span><span class="sxs-lookup"><span data-stu-id="e0961-140">Alphanumeric.</span></span> <span data-ttu-id="e0961-141">選擇性專案。</span><span class="sxs-lookup"><span data-stu-id="e0961-141">Entry optional.</span></span>|<span data-ttu-id="e0961-142">\W</span><span class="sxs-lookup"><span data-stu-id="e0961-142">\W</span></span>|  
|<span data-ttu-id="e0961-143">.</span><span class="sxs-lookup"><span data-stu-id="e0961-143">.</span></span>|<span data-ttu-id="e0961-144">符合文化特性的十進位預留位置。</span><span class="sxs-lookup"><span data-stu-id="e0961-144">Culture-appropriate decimal placeholder.</span></span>|<span data-ttu-id="e0961-145">無法使用。</span><span class="sxs-lookup"><span data-stu-id="e0961-145">Not available.</span></span>|  
|<span data-ttu-id="e0961-146">,</span><span class="sxs-lookup"><span data-stu-id="e0961-146">,</span></span>|<span data-ttu-id="e0961-147">符合文化特性的千位預留位置。</span><span class="sxs-lookup"><span data-stu-id="e0961-147">Culture-appropriate thousands placeholder.</span></span>|<span data-ttu-id="e0961-148">無法使用。</span><span class="sxs-lookup"><span data-stu-id="e0961-148">Not available.</span></span>|  
|<span data-ttu-id="e0961-149">:</span><span class="sxs-lookup"><span data-stu-id="e0961-149">:</span></span>|<span data-ttu-id="e0961-150">符合文化特性的時間分隔符號。</span><span class="sxs-lookup"><span data-stu-id="e0961-150">Culture-appropriate time separator.</span></span>|<span data-ttu-id="e0961-151">無法使用。</span><span class="sxs-lookup"><span data-stu-id="e0961-151">Not available.</span></span>|  
|/|<span data-ttu-id="e0961-152">符合文化特性的日期分隔符號。</span><span class="sxs-lookup"><span data-stu-id="e0961-152">Culture-appropriate date separator.</span></span>|<span data-ttu-id="e0961-153">無法使用。</span><span class="sxs-lookup"><span data-stu-id="e0961-153">Not available.</span></span>|  
|$|<span data-ttu-id="e0961-154">符合文化特性的貨幣符號。</span><span class="sxs-lookup"><span data-stu-id="e0961-154">Culture-appropriate currency symbol.</span></span>|<span data-ttu-id="e0961-155">無法使用。</span><span class="sxs-lookup"><span data-stu-id="e0961-155">Not available.</span></span>|  
|\<|<span data-ttu-id="e0961-156">將後面的所有字元轉換成小寫。</span><span class="sxs-lookup"><span data-stu-id="e0961-156">Converts all characters that follow to lowercase.</span></span>|<span data-ttu-id="e0961-157">無法使用。</span><span class="sxs-lookup"><span data-stu-id="e0961-157">Not available.</span></span>|  
|>|<span data-ttu-id="e0961-158">將後面的所有字元轉換成大寫。</span><span class="sxs-lookup"><span data-stu-id="e0961-158">Converts all characters that follow to uppercase.</span></span>|<span data-ttu-id="e0961-159">無法使用。</span><span class="sxs-lookup"><span data-stu-id="e0961-159">Not available.</span></span>|  
|<span data-ttu-id="e0961-160">&#124;</span><span class="sxs-lookup"><span data-stu-id="e0961-160">&#124;</span></span>|<span data-ttu-id="e0961-161">復原上一個上移或下移。</span><span class="sxs-lookup"><span data-stu-id="e0961-161">Undoes a previous shift up or shift down.</span></span>|<span data-ttu-id="e0961-162">無法使用。</span><span class="sxs-lookup"><span data-stu-id="e0961-162">Not available.</span></span>|  
|<span data-ttu-id="e0961-163">&#92;</span><span class="sxs-lookup"><span data-stu-id="e0961-163">&#92;</span></span>|<span data-ttu-id="e0961-164">將遮罩字元轉義，將它轉換成常值。</span><span class="sxs-lookup"><span data-stu-id="e0961-164">Escapes a mask character, turning it into a literal.</span></span> <span data-ttu-id="e0961-165">" \\ \\ " 是反斜線的逸出序列。</span><span class="sxs-lookup"><span data-stu-id="e0961-165">"\\\\" is the escape sequence for a backslash.</span></span>|<span data-ttu-id="e0961-166">&#92;</span><span class="sxs-lookup"><span data-stu-id="e0961-166">&#92;</span></span>|  
|<span data-ttu-id="e0961-167">所有其他字元。</span><span class="sxs-lookup"><span data-stu-id="e0961-167">All other characters.</span></span>|<span data-ttu-id="e0961-168">常值。</span><span class="sxs-lookup"><span data-stu-id="e0961-168">Literals.</span></span> <span data-ttu-id="e0961-169">所有非遮罩專案會在中以本身的形式出現 <xref:System.Windows.Forms.MaskedTextBox> 。</span><span class="sxs-lookup"><span data-stu-id="e0961-169">All non-mask elements will appear as themselves within <xref:System.Windows.Forms.MaskedTextBox>.</span></span>|<span data-ttu-id="e0961-170">所有其他字元。</span><span class="sxs-lookup"><span data-stu-id="e0961-170">All other characters.</span></span>|  
  
 <span data-ttu-id="e0961-171">Decimal （.）、萬分之一（，）、time （:)、date （/）和 currency （$）符號會預設為顯示應用程式文化特性所定義的符號。</span><span class="sxs-lookup"><span data-stu-id="e0961-171">The decimal (.), thousandths (,), time (:), date (/), and currency ($) symbols default to displaying those symbols as defined by the application's culture.</span></span> <span data-ttu-id="e0961-172">您可以使用屬性，強制其顯示另一個文化特性的符號 <xref:System.Windows.Forms.MaskedTextBox.FormatProvider%2A> 。</span><span class="sxs-lookup"><span data-stu-id="e0961-172">You can force them to display symbols for another culture by using the <xref:System.Windows.Forms.MaskedTextBox.FormatProvider%2A> property.</span></span>  
  
## <a name="regular-expressions-and-masks"></a><span data-ttu-id="e0961-173">正則運算式和遮罩</span><span class="sxs-lookup"><span data-stu-id="e0961-173">Regular Expressions and Masks</span></span>  
 <span data-ttu-id="e0961-174">雖然您可以使用正則運算式和遮罩來驗證使用者輸入，但它們並不完全相同。</span><span class="sxs-lookup"><span data-stu-id="e0961-174">Although you can use regular expressions and masks to validate user input, they are not completely equivalent.</span></span> <span data-ttu-id="e0961-175">正則運算式可以表達比遮罩更複雜的模式，但是遮罩可以更簡潔地表達相同的資訊，並採用與文化特性相關的格式。</span><span class="sxs-lookup"><span data-stu-id="e0961-175">Regular expressions can express more complex patterns than masks, but masks can express the same information more succinctly and in a culturally relevant format.</span></span>  
  
 <span data-ttu-id="e0961-176">下表比較四個正則運算式和各自的相等遮罩。</span><span class="sxs-lookup"><span data-stu-id="e0961-176">The following table compares four regular expressions and the equivalent mask for each.</span></span>  
  
|<span data-ttu-id="e0961-177">規則運算式</span><span class="sxs-lookup"><span data-stu-id="e0961-177">Regular Expression</span></span>|<span data-ttu-id="e0961-178">Mask</span><span class="sxs-lookup"><span data-stu-id="e0961-178">Mask</span></span>|<span data-ttu-id="e0961-179">注意</span><span class="sxs-lookup"><span data-stu-id="e0961-179">Notes</span></span>|  
|------------------------|----------|-----------|  
|`\d{2}/\d{2}/\d{4}`|`00/00/0000`|<span data-ttu-id="e0961-180">`/`遮罩中的字元是邏輯日期分隔符號，而且會向使用者顯示為應用程式目前文化特性適當的日期分隔符號。</span><span class="sxs-lookup"><span data-stu-id="e0961-180">The `/` character in the mask is a logical date separator, and it will appear to the user as the date separator appropriate to the application's current culture.</span></span>|  
|`\d{2}-[A-Z][a-z]{2}-\d{4}`|`00->L<LL-0000`|<span data-ttu-id="e0961-181">美國格式的日期（日、月縮寫和年），其中三個字母的月份縮寫會以初始大寫字母和後面接著兩個小寫字母來顯示。</span><span class="sxs-lookup"><span data-stu-id="e0961-181">A date (day, month abbreviation, and year) in United States format in which the three-letter month abbreviation is displayed with an initial uppercase letter followed by two lowercase letters.</span></span>|  
|`(\(\d{3}\)-)?\d{3}-d{4}`|`(999)-000-0000`|<span data-ttu-id="e0961-182">美國電話號碼，區功能變數代碼為選用。</span><span class="sxs-lookup"><span data-stu-id="e0961-182">United States phone number, area code optional.</span></span> <span data-ttu-id="e0961-183">如果使用者不想要輸入選擇性字元，可以輸入空格或將滑鼠指標直接放在第一個0所代表的遮罩位置。</span><span class="sxs-lookup"><span data-stu-id="e0961-183">If the user does not wish to enter the optional characters, they can either enter spaces or place the mouse pointer directly at the position in the mask represented by the first 0.</span></span>|  
|`$\d{6}.00`|`$999,999.00`|<span data-ttu-id="e0961-184">貨幣值，範圍介於0到999999之間。</span><span class="sxs-lookup"><span data-stu-id="e0961-184">A currency value in the range of 0 to 999999.</span></span> <span data-ttu-id="e0961-185">在執行時間會將貨幣、千位和十進位字元取代為其文化特性特定的對等專案。</span><span class="sxs-lookup"><span data-stu-id="e0961-185">The currency, thousandth, and decimal characters will be replaced at run time with their culture-specific equivalents.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="e0961-186">另請參閱</span><span class="sxs-lookup"><span data-stu-id="e0961-186">See also</span></span>

- <xref:System.Windows.Forms.MaskedTextBox.Mask%2A>
- <xref:System.Windows.Forms.MaskedTextBox>
- [<span data-ttu-id="e0961-187">在 Visual Basic 中驗證字串</span><span class="sxs-lookup"><span data-stu-id="e0961-187">Validating Strings in Visual Basic</span></span>](validating-strings.md)
- [<span data-ttu-id="e0961-188">MaskedTextBox 控制項</span><span class="sxs-lookup"><span data-stu-id="e0961-188">MaskedTextBox Control</span></span>](../../../../framework/winforms/controls/maskedtextbox-control-windows-forms.md)

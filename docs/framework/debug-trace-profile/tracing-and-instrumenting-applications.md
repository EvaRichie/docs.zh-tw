---
title: 追蹤和稽核應用程式
description: 在 .NET 中追蹤和檢測應用程式。 追蹤可讓您在應用程式執行時進行監視。 檢測可讓您測量效能層級。
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- tracing [.NET Framework]
- debugging [.NET Framework], instrumentation
- performance monitoring, instrumentation
- instrumentation, about instrumentation
- tracing [.NET Framework], about tracing
- performance monitoring, tracing code
- Trace class, instrumentation for .NET applications
ms.assetid: 773b6fc4-9013-4322-b728-5dec7a72e743
ms.openlocfilehash: d5484129ac17ee20aafe305bea5599f85903dfa2
ms.sourcegitcommit: c23d9666ec75b91741da43ee3d91c317d68c7327
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 07/01/2020
ms.locfileid: "85803543"
---
# <a name="tracing-and-instrumenting-applications"></a><span data-ttu-id="40ebb-105">追蹤和稽核應用程式</span><span class="sxs-lookup"><span data-stu-id="40ebb-105">Tracing and Instrumenting Applications</span></span>
<span data-ttu-id="40ebb-106">追蹤是一種方式，可讓您在應用程式執行時加以監視。</span><span class="sxs-lookup"><span data-stu-id="40ebb-106">Tracing is a way for you to monitor the execution of your application while it is running.</span></span> <span data-ttu-id="40ebb-107">您可以在開發 .NET Framework 應用程式時，加入追蹤和偵錯檢測，當您在開發應用程式時，以及將其部署之後，都可以使用該檢測。</span><span class="sxs-lookup"><span data-stu-id="40ebb-107">You can add tracing and debugging instrumentation to your .NET Framework application when you develop it, and you can use that instrumentation both while you are developing the application and after you have deployed it.</span></span> <span data-ttu-id="40ebb-108">您可以使用 <xref:System.Diagnostics.Trace?displayProperty=nameWithType>、<xref:System.Diagnostics.Debug?displayProperty=nameWithType> 和 <xref:System.Diagnostics.TraceSource?displayProperty=nameWithType> 類別，將錯誤和應用程式執行的相關資訊，記錄在記錄檔、文字檔案或其他裝置中，以供稍後進行分析。</span><span class="sxs-lookup"><span data-stu-id="40ebb-108">You can use the <xref:System.Diagnostics.Trace?displayProperty=nameWithType>, <xref:System.Diagnostics.Debug?displayProperty=nameWithType>, and <xref:System.Diagnostics.TraceSource?displayProperty=nameWithType> classes to record information about errors and application execution in logs, text files, or other devices for later analysis.</span></span>  
  
 <span data-ttu-id="40ebb-109">「檢測」\*\* 一詞是指監視或測量產品效能層級，以及診斷錯誤的能力。</span><span class="sxs-lookup"><span data-stu-id="40ebb-109">The term *instrumentation* refers to an ability to monitor or measure the level of a product's performance and to diagnose errors.</span></span> <span data-ttu-id="40ebb-110">在程式設計中，這表示應用程式納入下列項目的能力：</span><span class="sxs-lookup"><span data-stu-id="40ebb-110">In programming, this means the ability of an application to incorporate:</span></span>  
  
- <span data-ttu-id="40ebb-111">**程式碼追蹤** - 接收在執行階段有關應用程式執行的參考訊息。</span><span class="sxs-lookup"><span data-stu-id="40ebb-111">**Code tracing** - Receiving informative messages about the execution of an application at run time.</span></span>  
  
- <span data-ttu-id="40ebb-112">**偵錯** - 追蹤並修正開發中之應用程式的程式設計錯誤。</span><span class="sxs-lookup"><span data-stu-id="40ebb-112">**Debugging** - Tracking down and fixing programming errors in an application under development.</span></span> <span data-ttu-id="40ebb-113">如需詳細資訊，請參閱[偵錯](/visualstudio/debugger/debugger-feature-tour)。</span><span class="sxs-lookup"><span data-stu-id="40ebb-113">For more information, see [Debugging](/visualstudio/debugger/debugger-feature-tour).</span></span>  
  
- <span data-ttu-id="40ebb-114">**效能計數器** - 可讓您追蹤應用程式效能的元件。</span><span class="sxs-lookup"><span data-stu-id="40ebb-114">**Performance counters** - Components that allow you to track the performance of your application.</span></span> <span data-ttu-id="40ebb-115">如需詳細資訊，請參閱[效能計數器](performance-counters.md)。</span><span class="sxs-lookup"><span data-stu-id="40ebb-115">For more information, see [Performance Counters](performance-counters.md).</span></span>  
  
- <span data-ttu-id="40ebb-116">**事件記錄檔** - 這些元件可讓您接收和追蹤應用程式執行時的主要事件。</span><span class="sxs-lookup"><span data-stu-id="40ebb-116">**Event logs** - Components that allow you receive and track major events in the execution of your application.</span></span> <span data-ttu-id="40ebb-117">如需詳細資訊，請參閱 <xref:System.Diagnostics.EventLog> 類別。</span><span class="sxs-lookup"><span data-stu-id="40ebb-117">For more information, see the <xref:System.Diagnostics.EventLog> class.</span></span>  
  
 <span data-ttu-id="40ebb-118">在程式碼的策略性位置上放置追蹤陳述式來檢測應用程式，特別適用於分散式應用程式。</span><span class="sxs-lookup"><span data-stu-id="40ebb-118">Instrumenting your application by placing trace statements at strategic locations in your code is especially useful for distributed applications.</span></span> <span data-ttu-id="40ebb-119">使用追蹤陳述式可讓您檢測應用程式，不僅可以在發生錯誤時顯示資訊，還可以監視應用程式執行的效能。</span><span class="sxs-lookup"><span data-stu-id="40ebb-119">By using trace statements you can instrument an application not only to display information when things go wrong, but also to monitor how well the application is performing.</span></span>  
  
 <span data-ttu-id="40ebb-120"><xref:System.Diagnostics.TraceSource> 類別提供增強的追蹤功能，並可用來取代較舊之 <xref:System.Diagnostics.Trace> 和 <xref:System.Diagnostics.Debug> 追蹤類別的靜態方法。</span><span class="sxs-lookup"><span data-stu-id="40ebb-120">The <xref:System.Diagnostics.TraceSource> class provides enhanced tracing features and can be used in place of the static methods of the older <xref:System.Diagnostics.Trace> and <xref:System.Diagnostics.Debug> tracing classes.</span></span> <span data-ttu-id="40ebb-121">熟悉的 <xref:System.Diagnostics.Trace> 和 <xref:System.Diagnostics.Debug> 類別仍廣為使用，但是建議將 <xref:System.Diagnostics.TraceSource> 類別用於新的追蹤命令，例如 <xref:System.Diagnostics.TraceSource.TraceEvent%2A> 和 <xref:System.Diagnostics.TraceSource.TraceData%2A>。</span><span class="sxs-lookup"><span data-stu-id="40ebb-121">The familiar <xref:System.Diagnostics.Trace> and <xref:System.Diagnostics.Debug> classes are still widely used, but the <xref:System.Diagnostics.TraceSource> class is recommended for new tracing commands, such as <xref:System.Diagnostics.TraceSource.TraceEvent%2A> and <xref:System.Diagnostics.TraceSource.TraceData%2A>.</span></span>  
  
 <span data-ttu-id="40ebb-122"><xref:System.Diagnostics.Trace> 和 <xref:System.Diagnostics.Debug> 類別相同，只是根據預設，<xref:System.Diagnostics.Trace> 類別的程序和函式會編譯成發行組建，但 <xref:System.Diagnostics.Debug> 類別的程序和函式並不會編譯成發行組建。</span><span class="sxs-lookup"><span data-stu-id="40ebb-122">The <xref:System.Diagnostics.Trace> and <xref:System.Diagnostics.Debug> classes are identical, except that procedures and functions of the <xref:System.Diagnostics.Trace> class are compiled by default into release builds, but those of the <xref:System.Diagnostics.Debug> class are not.</span></span>  
  
 <span data-ttu-id="40ebb-123"><xref:System.Diagnostics.Trace> 和 <xref:System.Diagnostics.Debug> 類別提供方法來監視及檢查開發期間或部署後的應用程式效能。</span><span class="sxs-lookup"><span data-stu-id="40ebb-123">The <xref:System.Diagnostics.Trace> and <xref:System.Diagnostics.Debug> classes provide the means to monitor and examine application performance either during development or after deployment.</span></span> <span data-ttu-id="40ebb-124">例如，您可使用 <xref:System.Diagnostics.Trace> 類別來追蹤出現於部署應用程式中的特定動作類型 (例如，建立新的資料庫連接)，並藉此監視應用程式的效率。</span><span class="sxs-lookup"><span data-stu-id="40ebb-124">For example, you can use the <xref:System.Diagnostics.Trace> class to track particular types of actions in a deployed application as they occur (for example, creation of new database connections), and can therefore monitor the application's efficiency.</span></span>  
  
## <a name="code-tracing-and-debugging"></a><span data-ttu-id="40ebb-125">程式碼追蹤和偵錯</span><span class="sxs-lookup"><span data-stu-id="40ebb-125">Code Tracing and Debugging</span></span>  
 <span data-ttu-id="40ebb-126">在開發期間，您可以使用 <xref:System.Diagnostics.Debug> 類別的輸出方法，在 Visual Studio 整合式開發環境 (IDE) 的 [輸出] 視窗中顯示訊息。</span><span class="sxs-lookup"><span data-stu-id="40ebb-126">During development, you can use the output methods of the <xref:System.Diagnostics.Debug> class to display messages in the Output window of the Visual Studio integrated development environment (IDE).</span></span> <span data-ttu-id="40ebb-127">例如：</span><span class="sxs-lookup"><span data-stu-id="40ebb-127">For example:</span></span>  
  
```vb  
Trace.WriteLine("Hello World!")  
Debug.WriteLine("Hello World!")  
```  
  
```csharp  
System.Diagnostics.Trace.WriteLine("Hello World!");  
System.Diagnostics.Debug.WriteLine("Hello World!");  
```  
  
 <span data-ttu-id="40ebb-128">這些範例中的每一個都會顯示「Hello World！」</span><span class="sxs-lookup"><span data-stu-id="40ebb-128">Each of these examples will display "Hello World!"</span></span> <span data-ttu-id="40ebb-129">當應用程式在偵錯工具中執行時，在 [輸出] 視窗中。</span><span class="sxs-lookup"><span data-stu-id="40ebb-129">in the Output window when the application is run in the debugger.</span></span>  
  
 <span data-ttu-id="40ebb-130">這可讓您偵錯應用程式，並依據其於測試環境中的的行為，將其效能最佳化。</span><span class="sxs-lookup"><span data-stu-id="40ebb-130">This enables you to debug your applications and optimize their performance based on their behavior in your test environment.</span></span> <span data-ttu-id="40ebb-131">您可在已啟動 <xref:System.Diagnostics.Debug> 條件屬性的偵錯組建中進行應用程式偵錯，以接收所有的偵錯輸出。</span><span class="sxs-lookup"><span data-stu-id="40ebb-131">You can debug your application in your debug build with the <xref:System.Diagnostics.Debug> conditional attribute turned on so that you receive all debugging output.</span></span> <span data-ttu-id="40ebb-132">當您準備發行應用程式時，可以在不啟動 <xref:System.Diagnostics.Debug> 條件屬性的情況下編譯發行組建，如此編譯器就不會將偵錯程式碼納入最終可執行檔中。</span><span class="sxs-lookup"><span data-stu-id="40ebb-132">When your application is ready for release, you can compile your release build without turning on the <xref:System.Diagnostics.Debug> conditional attribute, so that the compiler will not include your debugging code in the final executable.</span></span> <span data-ttu-id="40ebb-133">如需詳細資訊，請參閱[如何：使用追蹤和偵錯進行條件式編譯](how-to-compile-conditionally-with-trace-and-debug.md)。</span><span class="sxs-lookup"><span data-stu-id="40ebb-133">For more information, see [How to: Compile Conditionally with Trace and Debug](how-to-compile-conditionally-with-trace-and-debug.md).</span></span> <span data-ttu-id="40ebb-134">如需您的應用程式適用之不同組建組態的詳細資訊，請參閱[編譯和建置](/visualstudio/ide/compiling-and-building-in-visual-studio)。</span><span class="sxs-lookup"><span data-stu-id="40ebb-134">For more information on different build configurations for your application, see [Compiling and Building](/visualstudio/ide/compiling-and-building-in-visual-studio).</span></span>  
  
 <span data-ttu-id="40ebb-135">您還可以使用 <xref:System.Diagnostics.Trace> 類別的方法，追蹤已安裝應用程式中程式碼執行的情形。</span><span class="sxs-lookup"><span data-stu-id="40ebb-135">You can also trace code execution in an installed application, using methods of the <xref:System.Diagnostics.Trace> class.</span></span> <span data-ttu-id="40ebb-136">藉由在程式碼中放置 [Trace 參數](trace-switches.md) ，您可以控制是否發生追蹤以及廣泛程度。</span><span class="sxs-lookup"><span data-stu-id="40ebb-136">By placing [Trace Switches](trace-switches.md) in your code, you can control whether tracing occurs and how extensive it is.</span></span> <span data-ttu-id="40ebb-137">這可讓您監視您的應用程式在生產環境中的狀態。</span><span class="sxs-lookup"><span data-stu-id="40ebb-137">This lets you monitor the status of your application in a production environment.</span></span> <span data-ttu-id="40ebb-138">對於在多部電腦上執行多個元件的商務應用程式來說，這特別重要。</span><span class="sxs-lookup"><span data-stu-id="40ebb-138">This is especially important in a business application that uses multiple components running on multiple computers.</span></span> <span data-ttu-id="40ebb-139">您可以透過組態檔來控制部署之後如何使用參數。</span><span class="sxs-lookup"><span data-stu-id="40ebb-139">You can control how the switches are used after deployment through the configuration file.</span></span> <span data-ttu-id="40ebb-140">如需詳細資訊，請參閱[如何：建立、初始化和設定追蹤參數](how-to-create-initialize-and-configure-trace-switches.md)。</span><span class="sxs-lookup"><span data-stu-id="40ebb-140">For more information, see [How to: Create, Initialize and Configure Trace Switches](how-to-create-initialize-and-configure-trace-switches.md).</span></span>  
  
 <span data-ttu-id="40ebb-141">在開發要使用追蹤的應用程式時，您通常會將追蹤和偵錯訊息都包含在應用程式程式碼中。</span><span class="sxs-lookup"><span data-stu-id="40ebb-141">When you are developing an application for which you intend to use tracing, you usually include both tracing and debugging messages in the application code.</span></span> <span data-ttu-id="40ebb-142">當您準備好要部署應用程式時，可以編譯發行組建，而不需開啟**偵錯**條件屬性。</span><span class="sxs-lookup"><span data-stu-id="40ebb-142">When you are ready to deploy the application, you can compile your release build without turning on the **Debug** conditional attribute.</span></span> <span data-ttu-id="40ebb-143">不過，您可以開啟**追蹤**條件屬性，讓編譯器在可執行檔中包含您的追蹤程式碼。</span><span class="sxs-lookup"><span data-stu-id="40ebb-143">However, you can turn on the **Trace** conditional attribute so that the compiler includes your trace code in the executable.</span></span> <span data-ttu-id="40ebb-144">如需詳細資訊，請參閱[如何：使用追蹤和偵錯進行條件式編譯](how-to-compile-conditionally-with-trace-and-debug.md)。</span><span class="sxs-lookup"><span data-stu-id="40ebb-144">For more information, see [How to: Compile Conditionally with Trace and Debug](how-to-compile-conditionally-with-trace-and-debug.md).</span></span>  
  
### <a name="phases-of-code-tracing"></a><span data-ttu-id="40ebb-145">程式碼追蹤的階段</span><span class="sxs-lookup"><span data-stu-id="40ebb-145">Phases of Code Tracing</span></span>  
 <span data-ttu-id="40ebb-146">程式碼追蹤分為三個階段：</span><span class="sxs-lookup"><span data-stu-id="40ebb-146">There are three phases of code tracing:</span></span>  
  
1. <span data-ttu-id="40ebb-147">**檢測** — 您將追蹤程式碼新增到您的應用程式。</span><span class="sxs-lookup"><span data-stu-id="40ebb-147">**Instrumentation** — you add trace code to your application.</span></span>  
  
2. <span data-ttu-id="40ebb-148">**追蹤** — 追蹤程式碼將資訊寫入指定的目標。</span><span class="sxs-lookup"><span data-stu-id="40ebb-148">**Tracing** — the tracing code writes information to the specified target.</span></span>  
  
3. <span data-ttu-id="40ebb-149">**分析** — 您評估追蹤資訊，以識別並了解應用程式中的問題。</span><span class="sxs-lookup"><span data-stu-id="40ebb-149">**Analysis** — you evaluate the tracing information to identify and understand problems in the application.</span></span>  
  
 <span data-ttu-id="40ebb-150">根據預設，在開發期間，所有偵錯和追蹤輸出方法都會將資訊寫入 Visual Studio 中的 [輸出] 視窗。</span><span class="sxs-lookup"><span data-stu-id="40ebb-150">During development, all debug and trace output methods write information to the Output window in Visual Studio by default.</span></span> <span data-ttu-id="40ebb-151">在已部署的應用程式中，這些方法會將追蹤資訊寫入您指定的目標。</span><span class="sxs-lookup"><span data-stu-id="40ebb-151">In a deployed application, the methods write tracing information to the targets you specify.</span></span> <span data-ttu-id="40ebb-152">若要了解如何指定追蹤或偵錯的輸出目標，請參閱[追蹤接聽項](trace-listeners.md)。</span><span class="sxs-lookup"><span data-stu-id="40ebb-152">For more information on specifying an output target for tracing or debugging, see [Trace Listeners](trace-listeners.md).</span></span>  
  
 <span data-ttu-id="40ebb-153">以下是在已部署的應用程式中，使用追蹤來分析及更正潛在問題時，常用的主要步驟整體概觀。</span><span class="sxs-lookup"><span data-stu-id="40ebb-153">The following is an overall view of the major steps typically involved in using tracing to analyze and correct potential problems in deployed applications.</span></span> <span data-ttu-id="40ebb-154">如需有關如何執行這些步驟的詳細資訊，請參閱適當的連結。</span><span class="sxs-lookup"><span data-stu-id="40ebb-154">For more information on how to perform these steps, see the appropriate link.</span></span>  
  
##### <a name="to-use-tracing-in-an-application"></a><span data-ttu-id="40ebb-155">若要在應用程式中使用追蹤</span><span class="sxs-lookup"><span data-stu-id="40ebb-155">To use tracing in an application</span></span>  
  
1. <span data-ttu-id="40ebb-156">請考慮您在部署應用程式之後，會想要在現場接收哪些追蹤輸出。</span><span class="sxs-lookup"><span data-stu-id="40ebb-156">Consider which tracing output you will want to receive onsite after you have deployed the application.</span></span>  
  
2. <span data-ttu-id="40ebb-157">建立一組參數。</span><span class="sxs-lookup"><span data-stu-id="40ebb-157">Create a set of switches.</span></span> <span data-ttu-id="40ebb-158">如需詳細資訊，請參閱 [做法：設定追蹤參數](how-to-create-initialize-and-configure-trace-switches.md)。</span><span class="sxs-lookup"><span data-stu-id="40ebb-158">For more information, see [How to: Configure Trace Switches](how-to-create-initialize-and-configure-trace-switches.md).</span></span>  
  
3. <span data-ttu-id="40ebb-159">將追蹤陳述式加入應用程式程式碼</span><span class="sxs-lookup"><span data-stu-id="40ebb-159">Add the trace statements to the application code.</span></span>  
  
4. <span data-ttu-id="40ebb-160">決定您想要讓追蹤輸出出現在哪裡，並加入適當的接聽程式。</span><span class="sxs-lookup"><span data-stu-id="40ebb-160">Determine where you want the tracing output to appear and add the appropriate listeners.</span></span> <span data-ttu-id="40ebb-161">如需詳細資訊，請參閱[建立和初始化追蹤接聽項](how-to-create-and-initialize-trace-listeners.md)。</span><span class="sxs-lookup"><span data-stu-id="40ebb-161">For more information, see [Creating and Initializing Trace Listeners](how-to-create-and-initialize-trace-listeners.md).</span></span>  
  
5. <span data-ttu-id="40ebb-162">測試和偵錯您的應用程式，以及其包含的追蹤程式碼。</span><span class="sxs-lookup"><span data-stu-id="40ebb-162">Test and debug your application and the tracing code it contains.</span></span>  
  
6. <span data-ttu-id="40ebb-163">使用下列其中一個程序，將應用程式編譯為可執行的程式碼：</span><span class="sxs-lookup"><span data-stu-id="40ebb-163">Compile the application into executable code using one of the following procedures:</span></span>  
  
    - <span data-ttu-id="40ebb-164">使用 [建置]\*\*\*\* 功能表，以及方案總管\*\*\*\* 中 [屬性頁]\*\*\*\* 對話方塊的 [偵錯]\*\*\*\* 頁面。</span><span class="sxs-lookup"><span data-stu-id="40ebb-164">Use the **Build** menu along with the **Debug** page of the **Property Pages** dialog box in **Solution Explorer**.</span></span> <span data-ttu-id="40ebb-165">在 Visual Studio 中進行編譯時，請使用此選項。</span><span class="sxs-lookup"><span data-stu-id="40ebb-165">Use this when compiling in Visual Studio.</span></span>  
  
         <span data-ttu-id="40ebb-166">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="40ebb-166">\- or -</span></span>  
  
    - <span data-ttu-id="40ebb-167">使用**追蹤**和**偵錯**編譯器指示詞來進行命令列方法的編譯。</span><span class="sxs-lookup"><span data-stu-id="40ebb-167">Use the **Trace** and **Debug** compiler directives for the command-line method of compiling.</span></span> <span data-ttu-id="40ebb-168">如需詳細資訊，請參閱[使用追蹤和偵錯進行條件式編譯](how-to-compile-conditionally-with-trace-and-debug.md)。</span><span class="sxs-lookup"><span data-stu-id="40ebb-168">For more information, see [Compiling Conditionally with Trace and Debug](how-to-compile-conditionally-with-trace-and-debug.md).</span></span> <span data-ttu-id="40ebb-169">從命令列編譯時，請使用此選項。</span><span class="sxs-lookup"><span data-stu-id="40ebb-169">Use this when compiling from the command line.</span></span>  
  
7. <span data-ttu-id="40ebb-170">如果在執行階段期間發生問題，請開啟適當的追蹤參數。</span><span class="sxs-lookup"><span data-stu-id="40ebb-170">If a problem occurs during run time, turn on the appropriate trace switch.</span></span> <span data-ttu-id="40ebb-171">如需詳細資訊，請參閱[設定追蹤參數](how-to-create-initialize-and-configure-trace-switches.md)。</span><span class="sxs-lookup"><span data-stu-id="40ebb-171">For more information, see [Configuring Trace Switches](how-to-create-initialize-and-configure-trace-switches.md).</span></span>  
  
     <span data-ttu-id="40ebb-172">追蹤程式碼會將追蹤訊息寫入指定的目標，例如畫面、文字檔或事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="40ebb-172">The tracing code writes tracing messages to a specified target, for example, a screen, a text file, or an event log.</span></span> <span data-ttu-id="40ebb-173">您包含在集合中的接聽程式類型會 <xref:System.Diagnostics.Trace.Listeners%2A?displayProperty=nameWithType> 決定目標。</span><span class="sxs-lookup"><span data-stu-id="40ebb-173">The type of listener you included in the <xref:System.Diagnostics.Trace.Listeners%2A?displayProperty=nameWithType> collection determines the target.</span></span>  
  
8. <span data-ttu-id="40ebb-174">分析追蹤訊息，以識別並了解應用程式中的問題。</span><span class="sxs-lookup"><span data-stu-id="40ebb-174">Analyze the tracing messages to identify and understand the problem in the application.</span></span>  
  
## <a name="trace-instrumentation-and-distributed-applications"></a><span data-ttu-id="40ebb-175">追蹤檢測和分散式應用程式</span><span class="sxs-lookup"><span data-stu-id="40ebb-175">Trace Instrumentation and Distributed Applications</span></span>  
 <span data-ttu-id="40ebb-176">當您建立分散式應用程式時，可能會發現很難以將要使用應用程式的方式來測試應用程式。</span><span class="sxs-lookup"><span data-stu-id="40ebb-176">When you create a distributed application, you might find it difficult to test the application in the manner in which it will be used.</span></span> <span data-ttu-id="40ebb-177">很少有開發小組能夠測試所有可能的作業系統或 Web 瀏覽器的組合 (包括所有當地語系化的語言選項)，或是模擬將會同時存取應用程式的大量使用者。</span><span class="sxs-lookup"><span data-stu-id="40ebb-177">Few development teams have the capability to test all possible combinations of operating systems or Web browsers (including all the localized language options), or to simulate the high number of users that will access the application at the same time.</span></span> <span data-ttu-id="40ebb-178">在這些情況下，您無法測試分散式應用程式將如何回應龐大的數量、不同的設定，以及獨特的終端使用者行為。</span><span class="sxs-lookup"><span data-stu-id="40ebb-178">Under these circumstances, you cannot test how a distributed application will respond to high volumes, different setups, and unique end-user behaviors.</span></span> <span data-ttu-id="40ebb-179">此外，分散式應用程式的許多部分都沒有使用者介面可讓您直接互動或檢視的那些部分的活動。</span><span class="sxs-lookup"><span data-stu-id="40ebb-179">Also, many parts of a distributed application have no user interface with which you can interact directly or view the activity of those parts.</span></span>  
  
 <span data-ttu-id="40ebb-180">不過，為了彌補這一點，您可以「檢測」\*\* 應用程式，也就是將追蹤陳述式放在程式碼的策略性位置上，讓分散式應用程式向系統管理員描述所感興趣的特定事件，尤其是出差錯的事情。</span><span class="sxs-lookup"><span data-stu-id="40ebb-180">However, you can compensate for this by enabling distributed applications to describe certain events of interest to system administrators, especially things that go wrong, by *instrumenting* the application — that is, by placing trace statements at strategic locations in your code.</span></span> <span data-ttu-id="40ebb-181">然後如果在執行階段時發生非預期的事件 (例如，回應時間極慢)，您就可以判斷可能的原因。</span><span class="sxs-lookup"><span data-stu-id="40ebb-181">Then if something unexpected occurs at run time (for example, excessively slow response time), you can determine the likely cause.</span></span>  
  
 <span data-ttu-id="40ebb-182">利用追蹤陳述式，您可以避免掉一些困難的工作，例如，檢查原始來源程式碼、加以修改、重新編譯，以及嘗試在偵錯環境內產生執行階段錯誤。</span><span class="sxs-lookup"><span data-stu-id="40ebb-182">With trace statements you can avoid the difficult task of examining the original source code, modifying it, recompiling, and attempting to produce the run-time error within the debugging environment.</span></span> <span data-ttu-id="40ebb-183">請記住，檢測應用程式不但可以顯示錯誤，還能監視效能。</span><span class="sxs-lookup"><span data-stu-id="40ebb-183">Remember that you can instrument an application not only to display errors, but also to monitor performance.</span></span>  
  
## <a name="strategic-placement-of-trace-statements"></a><span data-ttu-id="40ebb-184">追蹤陳述式的策略位置</span><span class="sxs-lookup"><span data-stu-id="40ebb-184">Strategic Placement of Trace Statements</span></span>  
 <span data-ttu-id="40ebb-185">在放置追蹤陳述式，以在執行階段使用時，您必須特別小心。</span><span class="sxs-lookup"><span data-stu-id="40ebb-185">You must exercise special care when placing your trace statements for use during run time.</span></span> <span data-ttu-id="40ebb-186">您必須考量，在所部署的應用程式中，可能會需要哪些追蹤資訊，以充分涵蓋所有可能的追蹤案例。</span><span class="sxs-lookup"><span data-stu-id="40ebb-186">You must consider what tracing information is likely to be needed in a deployed application, so that all likely tracing scenarios are adequately covered.</span></span> <span data-ttu-id="40ebb-187">使用追蹤的應用程式差異甚大，但是並沒有追蹤策略位置的一般方針。</span><span class="sxs-lookup"><span data-stu-id="40ebb-187">Because applications that use tracing vary widely, however, there are no general guidelines for strategic placement of tracing.</span></span> <span data-ttu-id="40ebb-188">如需有關放置追蹤陳述式的詳細資訊，請參閱[如何：將追蹤陳述式新增到應用程式程式碼](how-to-add-trace-statements-to-application-code.md)。</span><span class="sxs-lookup"><span data-stu-id="40ebb-188">For more information on placing trace statements, see [How to: Add Trace Statements to Application Code](how-to-add-trace-statements-to-application-code.md).</span></span>  
  
## <a name="output-from-tracing"></a><span data-ttu-id="40ebb-189">追蹤的輸出</span><span class="sxs-lookup"><span data-stu-id="40ebb-189">Output from Tracing</span></span>  
 <span data-ttu-id="40ebb-190">追蹤輸出是由稱為「接聽項」\*\* 的物件來收集。</span><span class="sxs-lookup"><span data-stu-id="40ebb-190">Trace output is collected by objects called *listeners*.</span></span> <span data-ttu-id="40ebb-191">接聽程式是會接收追蹤輸出，並將其寫入輸出裝置 (通常是視窗、記錄檔或文字檔) 的物件。</span><span class="sxs-lookup"><span data-stu-id="40ebb-191">A listener is an object that receives trace output and writes it to an output device (usually a window, log, or text file).</span></span> <span data-ttu-id="40ebb-192">建立追蹤接聽程式時，通常會將它加入至 <xref:System.Diagnostics.Trace.Listeners%2A?displayProperty=nameWithType> 集合，讓接聽程式能夠接收所有的追蹤輸出。</span><span class="sxs-lookup"><span data-stu-id="40ebb-192">When a trace listener is created, it is typically added to the <xref:System.Diagnostics.Trace.Listeners%2A?displayProperty=nameWithType> collection, allowing the listener to receive all trace output.</span></span>  
  
 <span data-ttu-id="40ebb-193">追蹤資訊一定至少會寫入至預設的 <xref:System.Diagnostics.Trace> 輸出目標，也就是 <xref:System.Diagnostics.DefaultTraceListener>。</span><span class="sxs-lookup"><span data-stu-id="40ebb-193">Tracing information is always written at least to the default <xref:System.Diagnostics.Trace> output target, the <xref:System.Diagnostics.DefaultTraceListener>.</span></span> <span data-ttu-id="40ebb-194">如果您因為某種原因而已經刪除了 <xref:System.Diagnostics.DefaultTraceListener>，而且未將任何其他接聽程式加入至 <xref:System.Diagnostics.Trace.Listeners%2A> 集合，您將不會接收到任何追蹤訊息。</span><span class="sxs-lookup"><span data-stu-id="40ebb-194">If for some reason you have deleted the <xref:System.Diagnostics.DefaultTraceListener> without adding any other listeners to the <xref:System.Diagnostics.Trace.Listeners%2A> collection, you will not receive any tracing messages.</span></span> <span data-ttu-id="40ebb-195">如需詳細資訊，請參閱[追蹤接聽項](trace-listeners.md)。</span><span class="sxs-lookup"><span data-stu-id="40ebb-195">For more information, see [Trace Listeners](trace-listeners.md).</span></span>  
  
 <span data-ttu-id="40ebb-196">下表列出寫入追蹤資訊的六個 <xref:System.Diagnostics.Debug> 成員和 <xref:System.Diagnostics.Trace>方法。</span><span class="sxs-lookup"><span data-stu-id="40ebb-196">The six <xref:System.Diagnostics.Debug> members and <xref:System.Diagnostics.Trace> methods that write tracing information are listed in the following table.</span></span>  
  
|<span data-ttu-id="40ebb-197">方法</span><span class="sxs-lookup"><span data-stu-id="40ebb-197">Method</span></span>|<span data-ttu-id="40ebb-198">輸出</span><span class="sxs-lookup"><span data-stu-id="40ebb-198">Output</span></span>|  
|------------|------------|  
|`Assert`|<span data-ttu-id="40ebb-199">指定的文字；或者如果未指定，則為呼叫堆疊。</span><span class="sxs-lookup"><span data-stu-id="40ebb-199">The specified text; or, if none is specified, the Call Stack.</span></span> <span data-ttu-id="40ebb-200">只有在語句中指定為引數的條件為 false 時，才會寫入輸出 `Assert` 。 **false**</span><span class="sxs-lookup"><span data-stu-id="40ebb-200">The output is written only if the condition specified as an argument in the `Assert` statement is **false**.</span></span>|  
|`Fail`|<span data-ttu-id="40ebb-201">指定的文字；或者如果未指定，則為呼叫堆疊。</span><span class="sxs-lookup"><span data-stu-id="40ebb-201">The specified text; or, if none is specified, the Call Stack.</span></span>|  
|`Write`|<span data-ttu-id="40ebb-202">指定的文字。</span><span class="sxs-lookup"><span data-stu-id="40ebb-202">The specified text.</span></span>|  
|`WriteIf`|<span data-ttu-id="40ebb-203">指定的文字（如果滿足語句中指定為引數的條件） `WriteIf` 。</span><span class="sxs-lookup"><span data-stu-id="40ebb-203">The specified text, if the condition specified as an argument in the `WriteIf` statement is satisfied.</span></span>|  
|`WriteLine`|<span data-ttu-id="40ebb-204">指定的文字和歸位字元。</span><span class="sxs-lookup"><span data-stu-id="40ebb-204">The specified text and a carriage return.</span></span>|  
|`WriteLineIf`|<span data-ttu-id="40ebb-205">如果滿足指定為語句中之引數的條件，則指定的文字和換行字元 `WriteLineIf` 。</span><span class="sxs-lookup"><span data-stu-id="40ebb-205">The specified text and a carriage return, if the condition specified as an argument in the `WriteLineIf` statement is satisfied.</span></span>|  
  
 <span data-ttu-id="40ebb-206"><xref:System.Diagnostics.Trace.Listeners%2A> 集合中的所有接聽程式都會接收上表中所述的訊息，但是採取的動作會因接收訊息的接聽程式種類而異。</span><span class="sxs-lookup"><span data-stu-id="40ebb-206">All listeners in the <xref:System.Diagnostics.Trace.Listeners%2A> collection receive the messages described in the above table, but the actions taken may vary depending on what kind of listener receives the message.</span></span> <span data-ttu-id="40ebb-207">例如， <xref:System.Diagnostics.DefaultTraceListener> 當收到或失敗通知時，會顯示判斷 `Fail` 提示對話方塊 `Assert` ，但只會將 <xref:System.Diagnostics.TextWriterTraceListener> 輸出寫入其資料流程。</span><span class="sxs-lookup"><span data-stu-id="40ebb-207">For example, the <xref:System.Diagnostics.DefaultTraceListener> displays an assertion dialog box when it receives a `Fail` or failed `Assert` notification, but a <xref:System.Diagnostics.TextWriterTraceListener> simply writes the output to its stream.</span></span>  
  
 <span data-ttu-id="40ebb-208">您可以實作自己的接聽程式來產生自訂結果。</span><span class="sxs-lookup"><span data-stu-id="40ebb-208">You can produce custom results by implementing your own listener.</span></span> <span data-ttu-id="40ebb-209">比方說，自訂追蹤接聽程式可能會將訊息顯示在訊息方塊，或連接至資料庫，以將訊息加入資料表。</span><span class="sxs-lookup"><span data-stu-id="40ebb-209">A custom trace listener might, for example, display the messages to a message box, or connect to a database to add messages to a table.</span></span> <span data-ttu-id="40ebb-210">所有自訂接聽程式應該都會支援上述六種方法。</span><span class="sxs-lookup"><span data-stu-id="40ebb-210">All custom listeners should support the six methods mentioned above.</span></span> <span data-ttu-id="40ebb-211">如需有關如何建立開發人員定義之接聽程式的詳細資訊，請參閱 .NET Framework 參考中的 <xref:System.Diagnostics.TraceListener>。</span><span class="sxs-lookup"><span data-stu-id="40ebb-211">For more information on creating developer-defined listeners, see <xref:System.Diagnostics.TraceListener> in the .NET Framework reference.</span></span>  
  
 <span data-ttu-id="40ebb-212">`Write`和 `WriteLine` 方法一律會寫入您指定的文字。</span><span class="sxs-lookup"><span data-stu-id="40ebb-212">The `Write` and `WriteLine` methods always write the text that you specify.</span></span> <span data-ttu-id="40ebb-213">`Assert`、 `WriteIf` 和 `WriteLineIf` 需要布林值引數，以控制是否要寫入指定的文字; 只有當運算式為**true** （適用于 `WriteIf` 和 `WriteLineIf` ），或**false** （適用于）時，才會寫入指定的文字 `Assert` 。</span><span class="sxs-lookup"><span data-stu-id="40ebb-213">`Assert`, `WriteIf`, and `WriteLineIf` require a Boolean argument that controls whether or not they write the specified text; they write the specified text only if the expression is **true** (for `WriteIf` and `WriteLineIf`), or **false** (for `Assert`).</span></span> <span data-ttu-id="40ebb-214">`Fail`方法一律會寫入指定的文字。</span><span class="sxs-lookup"><span data-stu-id="40ebb-214">The `Fail` method always writes the specified text.</span></span> <span data-ttu-id="40ebb-215">如需詳細資訊，請參閱[如何：將追蹤陳述式新增到應用程式程式碼](how-to-add-trace-statements-to-application-code.md)和 .NET Framework 參考。</span><span class="sxs-lookup"><span data-stu-id="40ebb-215">For more information, see [How to: Add Trace Statements to Application Code](how-to-add-trace-statements-to-application-code.md) and the .NET Framework reference.</span></span>  
  
## <a name="security-concerns"></a><span data-ttu-id="40ebb-216">安全性考量</span><span class="sxs-lookup"><span data-stu-id="40ebb-216">Security Concerns</span></span>  
 <span data-ttu-id="40ebb-217">如果您在部署 ASP.NET 應用程式之前，沒有先停用追蹤和偵錯，您的應用程式可能會顯示其本身會遭惡意程式利用的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="40ebb-217">If you do not disable tracing and debugging before deploying an ASP.NET application, your application may reveal information about itself that could be exploited by a malicious program.</span></span> <span data-ttu-id="40ebb-218">如需詳細資訊，請參閱[如何：使用追蹤和偵錯進行條件式編譯](how-to-compile-conditionally-with-trace-and-debug.md)、[編譯和建置](/visualstudio/ide/compiling-and-building-in-visual-studio)，以及[如何：建立、初始化和設定追蹤參數](how-to-create-initialize-and-configure-trace-switches.md)。</span><span class="sxs-lookup"><span data-stu-id="40ebb-218">For more information, see [How to: Compile Conditionally with Trace and Debug](how-to-compile-conditionally-with-trace-and-debug.md), [Compiling and Building](/visualstudio/ide/compiling-and-building-in-visual-studio), and [How to: Create, Initialize and Configure Trace Switches](how-to-create-initialize-and-configure-trace-switches.md).</span></span> <span data-ttu-id="40ebb-219">偵錯也可以透過 Internet Information Services (IIS) 來設定。</span><span class="sxs-lookup"><span data-stu-id="40ebb-219">Debugging is also configurable through Internet Information Services (IIS).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="40ebb-220">另請參閱</span><span class="sxs-lookup"><span data-stu-id="40ebb-220">See also</span></span>

- <xref:System.Diagnostics.Trace>
- <xref:System.Diagnostics.TraceSource>
- [<span data-ttu-id="40ebb-221">程式碼合約</span><span class="sxs-lookup"><span data-stu-id="40ebb-221">Code Contracts</span></span>](code-contracts.md)
- [<span data-ttu-id="40ebb-222">C#、F# 和 Visual Basic 專案類型</span><span class="sxs-lookup"><span data-stu-id="40ebb-222">C#, F#, and Visual Basic Project Types</span></span>](/visualstudio/debugger/debugging-preparation-csharp-f-hash-and-visual-basic-project-types)
- [<span data-ttu-id="40ebb-223">如何：將追蹤陳述式加入至應用程式程式碼</span><span class="sxs-lookup"><span data-stu-id="40ebb-223">How to: Add Trace Statements to Application Code</span></span>](how-to-add-trace-statements-to-application-code.md)
- [<span data-ttu-id="40ebb-224">如何：使用追蹤和偵錯進行條件式編譯</span><span class="sxs-lookup"><span data-stu-id="40ebb-224">How to: Compile Conditionally with Trace and Debug</span></span>](how-to-compile-conditionally-with-trace-and-debug.md)
- [<span data-ttu-id="40ebb-225">如何：建立、初始化和設定追蹤參數</span><span class="sxs-lookup"><span data-stu-id="40ebb-225">How to: Create, Initialize and Configure Trace Switches</span></span>](how-to-create-initialize-and-configure-trace-switches.md)
- [<span data-ttu-id="40ebb-226">如何：建立和初始化追蹤來源</span><span class="sxs-lookup"><span data-stu-id="40ebb-226">How to: Create and Initialize Trace Sources</span></span>](how-to-create-and-initialize-trace-sources.md)
- [<span data-ttu-id="40ebb-227">如何：使用 TraceSource 和含有追蹤接聽項的篩選條件</span><span class="sxs-lookup"><span data-stu-id="40ebb-227">How to: Use TraceSource and Filters with Trace Listeners</span></span>](how-to-use-tracesource-and-filters-with-trace-listeners.md)
- [<span data-ttu-id="40ebb-228">追蹤接聽程式</span><span class="sxs-lookup"><span data-stu-id="40ebb-228">Trace Listeners</span></span>](trace-listeners.md)
- [<span data-ttu-id="40ebb-229">追蹤參數</span><span class="sxs-lookup"><span data-stu-id="40ebb-229">Trace Switches</span></span>](trace-switches.md)

---
title: 使用組態檔設定應用程式
ms.date: 03/30/2017
f1_keywords:
- AutoGeneratedOrientationPage
helpviewer_keywords:
- security configuration files
- end tags
- configuration files [.NET Framework], application
- machine configuration files
- .NET Framework application configuration, configuration files
- applications [.NET Framework], configuration files
- application configuration files, security
- application configuration files, format
- configuration files [.NET Framework]
- hosts, application
- application configuration files, machine
- ASP.NET, configuring
- configuration files [.NET Framework], security
- application configuration files, about
- application configuration files
- <runtime> element
- start tags
- configuration files [.NET Framework], machine
- configuration files [.NET Framework], format
ms.assetid: 86bd26d3-737e-4484-9782-19b17f34cd1f
ms.openlocfilehash: b2da9600e6947a1efcb13fc8b1127665cea63071
ms.sourcegitcommit: b16c00371ea06398859ecd157defc81301c9070f
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 06/06/2020
ms.locfileid: "70972194"
---
# <a name="configuring-apps-by-using-configuration-files"></a><span data-ttu-id="80fdf-102">使用組態檔設定應用程式</span><span class="sxs-lookup"><span data-stu-id="80fdf-102">Configuring Apps by using Configuration Files</span></span>
<span data-ttu-id="80fdf-103">.NET Framework 透過組態檔賦予開發人員和系統管理員對於應用程式執行方式的控制和彈性。</span><span class="sxs-lookup"><span data-stu-id="80fdf-103">The .NET Framework, through configuration files, gives developers and administrators control and flexibility over the way applications run.</span></span> <span data-ttu-id="80fdf-104">組態檔是可以按需要變更的 XML 檔。</span><span class="sxs-lookup"><span data-stu-id="80fdf-104">Configuration files are XML files that can be changed as needed.</span></span> <span data-ttu-id="80fdf-105">系統管員能夠控制應用程式可以存取哪些受保護的資源、應用程式將使用之組件的版本為何，以及遠端應用程式和物件要位於何處。</span><span class="sxs-lookup"><span data-stu-id="80fdf-105">An administrator can control which protected resources an application can access, which versions of assemblies an application will use, and where remote applications and objects are located.</span></span> <span data-ttu-id="80fdf-106">開發人員則可以將設定值置於組態檔，排除每當設定值變更時重新編譯應用程式的需要。</span><span class="sxs-lookup"><span data-stu-id="80fdf-106">Developers can put settings in configuration files, eliminating the need to recompile an application every time a setting changes.</span></span> <span data-ttu-id="80fdf-107">本章節說明可以設定些什麼以及設定應用程式會很有用處的原因。</span><span class="sxs-lookup"><span data-stu-id="80fdf-107">This section describes what can be configured and why configuring an application might be useful.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="80fdf-108">Managed 程式碼可以使用 <xref:System.Configuration> 命名空間中的類別，以讀取 (而非寫入) 組態檔設定。</span><span class="sxs-lookup"><span data-stu-id="80fdf-108">Managed code can use the classes in the <xref:System.Configuration> namespace to read settings from the configuration files, but not to write settings to those files.</span></span>  
  
 <span data-ttu-id="80fdf-109">本主題描述組態檔的語法，並提供有關組態檔的三種類型資訊：電腦、應用程式和安全性。</span><span class="sxs-lookup"><span data-stu-id="80fdf-109">This topic describes the syntax of configuration files and provides information about the three types of configuration files: machine, application, and security.</span></span>  
  
## <a name="configuration-file-format"></a><span data-ttu-id="80fdf-110">組態檔格式</span><span class="sxs-lookup"><span data-stu-id="80fdf-110">Configuration File Format</span></span>  
 <span data-ttu-id="80fdf-111">組態檔包含一些項目，為設定組態資訊的邏輯資料結構。</span><span class="sxs-lookup"><span data-stu-id="80fdf-111">Configuration files contain elements, which are logical data structures that set configuration information.</span></span> <span data-ttu-id="80fdf-112">在組態檔內，您要使用標記 (Tag) 來標記項目的開頭和結尾。</span><span class="sxs-lookup"><span data-stu-id="80fdf-112">Within a configuration file, you use tags to mark the beginning and end of an element.</span></span> <span data-ttu-id="80fdf-113">例如，元素是 `<runtime>` 由 `<runtime>` *子項目*所組成 `</runtime>` 。</span><span class="sxs-lookup"><span data-stu-id="80fdf-113">For example, the `<runtime>` element consists of `<runtime>`*child elements*`</runtime>`.</span></span> <span data-ttu-id="80fdf-114">空白項目會寫成 `<runtime/>` 或 `<runtime></runtime>`。</span><span class="sxs-lookup"><span data-stu-id="80fdf-114">An empty element would be written as `<runtime/>` or `<runtime></runtime>`.</span></span>  
  
 <span data-ttu-id="80fdf-115">就如同所有的 XML 檔，組態檔中的語法要區分大小寫。</span><span class="sxs-lookup"><span data-stu-id="80fdf-115">As with all XML files, the syntax in configuration files is case-sensitive.</span></span>  
  
 <span data-ttu-id="80fdf-116">您要使用預先定義的屬性 (項目之開始標記內的名稱/值組) 來指定組態設定。</span><span class="sxs-lookup"><span data-stu-id="80fdf-116">You specify configuration settings using predefined attributes, which are name/value pairs inside an element's start tag.</span></span> <span data-ttu-id="80fdf-117">下列範例會為 `<codeBase>` 項目指定兩個屬性 (`version` 與 `href`)，以指定執行階段可以找到組件的位置 (如需詳細資料，請參閱[指定組件的位置](specify-assembly-location.md))。</span><span class="sxs-lookup"><span data-stu-id="80fdf-117">The following example specifies two attributes (`version` and `href`) for the `<codeBase>` element, which specifies where the runtime can locate an assembly (for more information, see [Specifying an Assembly's Location](specify-assembly-location.md)).</span></span>  
  
```xml  
<codeBase version="2.0.0.0"  
          href="http://www.litwareinc.com/myAssembly.dll"/>  
```  
  
## <a name="machine-configuration-files"></a><span data-ttu-id="80fdf-118">電腦組態檔</span><span class="sxs-lookup"><span data-stu-id="80fdf-118">Machine Configuration Files</span></span>  
 <span data-ttu-id="80fdf-119">電腦組態檔 Machine.config 包含套用於整個電腦的設定值。</span><span class="sxs-lookup"><span data-stu-id="80fdf-119">The machine configuration file, Machine.config, contains settings that apply to an entire computer.</span></span> <span data-ttu-id="80fdf-120">這個檔案位於 %*runtime install path*%\Config 目錄中。</span><span class="sxs-lookup"><span data-stu-id="80fdf-120">This file is located in the %*runtime install path*%\Config directory.</span></span> <span data-ttu-id="80fdf-121">Machine.config 包含全電腦的組件繫結、內建[遠端通道](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/dkfd3wha(v=vs.100))和 ASP.NET 的組態設定。</span><span class="sxs-lookup"><span data-stu-id="80fdf-121">Machine.config contains configuration settings for machine-wide assembly binding, built-in [remoting channels](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/dkfd3wha(v=vs.100)), and ASP.NET.</span></span>  
  
 <span data-ttu-id="80fdf-122">設定系統會先在電腦設定檔中尋找專案， [ **\<appSettings>** 以及開發](./file-schema/appsettings/index.md)人員可能定義的其他設定區段。</span><span class="sxs-lookup"><span data-stu-id="80fdf-122">The configuration system first looks in the machine configuration file for the [**\<appSettings>** element](./file-schema/appsettings/index.md) and other configuration sections that a developer might define.</span></span> <span data-ttu-id="80fdf-123">接著會查看應用程式組態檔。</span><span class="sxs-lookup"><span data-stu-id="80fdf-123">It then looks in the application configuration file.</span></span> <span data-ttu-id="80fdf-124">若要讓電腦組態檔易於管理，最好將這些設定值放在應用程式組態檔中。</span><span class="sxs-lookup"><span data-stu-id="80fdf-124">To keep the machine configuration file manageable, it is best to put these settings in the application configuration file.</span></span> <span data-ttu-id="80fdf-125">然而，將設定值置於電腦組態檔可讓您的系統更容易維護。</span><span class="sxs-lookup"><span data-stu-id="80fdf-125">However, putting the settings in the machine configuration file can make your system more maintainable.</span></span> <span data-ttu-id="80fdf-126">例如，如果您有用戶端和伺服器應用程式都使用到的協力廠商元件，將那元件的設定值放在一個地方會比較容易。</span><span class="sxs-lookup"><span data-stu-id="80fdf-126">For example, if you have a third-party component that both your client and server application uses, it is easier to put the settings for that component in one place.</span></span> <span data-ttu-id="80fdf-127">在這個情況中，電腦組態檔是設定值的適當位置，所以您在兩個不同檔案中沒有相同的設定值。</span><span class="sxs-lookup"><span data-stu-id="80fdf-127">In this case, the machine configuration file is the appropriate place for the settings, so you don't have the same settings in two different files.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="80fdf-128">使用 XCOPY 部署應用程式將不會複製電腦組態檔中的設定值。</span><span class="sxs-lookup"><span data-stu-id="80fdf-128">Deploying an application using XCOPY will not copy the settings in the machine configuration file.</span></span>  
  
 <span data-ttu-id="80fdf-129">如需 Common Language Runtime 如何使用電腦組態檔執行組件繫結的詳細資訊，請參閱[執行階段如何找出組件](../deployment/how-the-runtime-locates-assemblies.md)。</span><span class="sxs-lookup"><span data-stu-id="80fdf-129">For more information about how the common language runtime uses the machine configuration file for assembly binding, see [How the Runtime Locates Assemblies](../deployment/how-the-runtime-locates-assemblies.md).</span></span>  
  
## <a name="application-configuration-files"></a><span data-ttu-id="80fdf-130">應用程式組態檔</span><span class="sxs-lookup"><span data-stu-id="80fdf-130">Application Configuration Files</span></span>  
 <span data-ttu-id="80fdf-131">應用程式組態檔包含應用程式特有的設定值。</span><span class="sxs-lookup"><span data-stu-id="80fdf-131">An application configuration file contains settings that are specific to an app.</span></span> <span data-ttu-id="80fdf-132">這個檔案包含通用語言執行平台讀取的組態設定 (例如組件繫結原則、遠端處理物件等) 以及應用程式可以讀取的設定值。</span><span class="sxs-lookup"><span data-stu-id="80fdf-132">This file includes configuration settings that the common language runtime reads (such as assembly binding policy, remoting objects, and so on), and settings that the app can read.</span></span>  
  
 <span data-ttu-id="80fdf-133">應用程式組態檔的名稱和位置取決於應用程式的主應用程式 (Host)，可以是下列其中一個：</span><span class="sxs-lookup"><span data-stu-id="80fdf-133">The name and location of the application configuration file depend on the app's host, which can be one of the following:</span></span>  
  
- <span data-ttu-id="80fdf-134">可執行檔裝載的應用程式。</span><span class="sxs-lookup"><span data-stu-id="80fdf-134">Executable–hosted app.</span></span>  
  
     <span data-ttu-id="80fdf-135">這些應用程式有兩個組態檔：一個是來源組態檔，開發人員會在開發期間修改這個組態檔，另一個是隨應用程式散發的輸出檔。</span><span class="sxs-lookup"><span data-stu-id="80fdf-135">These apps have two configuration files:  a source configuration file, which is modified by the developer during development, and an output file that is distributed with the app.</span></span>  
  
     <span data-ttu-id="80fdf-136">當您使用 Visual Studio 進行開發時，將應用程式的來源組態檔放置在專案目錄中，並將其 [複製到輸出目錄]\*\*\*\* 屬性設定為 [永遠複製]\*\*\*\* 或 [有更新時才複製]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="80fdf-136">When you develop in Visual Studio, place the source configuration file for your app in the project directory and set its **Copy To Output Directory** property to **Copy always** or **Copy if newer**.</span></span> <span data-ttu-id="80fdf-137">組態檔的名稱為具有 .config 副檔名的應用程式名稱。</span><span class="sxs-lookup"><span data-stu-id="80fdf-137">The name of the configuration file is the name of the app with a .config extension.</span></span> <span data-ttu-id="80fdf-138">例如，稱為 myApp.exe 的應用程式應擁有稱為 myApp.exe.config 的來源組態檔。</span><span class="sxs-lookup"><span data-stu-id="80fdf-138">For example, an app called myApp.exe should have a source configuration file called myApp.exe.config.</span></span>  
  
     <span data-ttu-id="80fdf-139">Visual Studio 會自動將來源組態檔複製到編譯的組件所在的目錄中，以建立輸出組態檔，該組態檔會隨應用程式一起部署。</span><span class="sxs-lookup"><span data-stu-id="80fdf-139">Visual Studio automatically copies the source configuration file to the directory where the compiled assembly is placed to create the output configuration file, which is deployed with the app.</span></span> <span data-ttu-id="80fdf-140">在某些情況下，Visual Studio 可能會修改輸出組態檔；如需詳細資訊，請參閱[重新導向組件版本](redirect-assembly-versions.md)文件的[將應用程式層級的組件版本重新導向](redirect-assembly-versions.md#BKMK_Redirectingassemblyversionsattheapplevel)一節。</span><span class="sxs-lookup"><span data-stu-id="80fdf-140">In some cases, Visual Studio may modify the output configuration file; for more information, see the [Redirecting assembly versions at the app level](redirect-assembly-versions.md#BKMK_Redirectingassemblyversionsattheapplevel) section of the [Redirecting Assembly Versions](redirect-assembly-versions.md) article.</span></span>  
  
- <span data-ttu-id="80fdf-141">ASP.NET 裝載的應用程式。</span><span class="sxs-lookup"><span data-stu-id="80fdf-141">ASP.NET-hosted app.</span></span>  
  
     <span data-ttu-id="80fdf-142">如需 ASP.NET 設定檔的詳細資訊，請參閱[ASP.NET Configuration Settings](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/b5ysx397(v=vs.100))。</span><span class="sxs-lookup"><span data-stu-id="80fdf-142">For more information about ASP.NET configuration files, see [ASP.NET Configuration Settings](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/b5ysx397(v=vs.100)).</span></span>
  
- <span data-ttu-id="80fdf-143">Internet Explorer 裝載的應用程式。</span><span class="sxs-lookup"><span data-stu-id="80fdf-143">Internet Explorer-hosted app.</span></span>  
  
     <span data-ttu-id="80fdf-144">如果裝載於 Internet Explorer 的應用程式具有組態檔，這個檔案的位置會以下列語法在 `<link>` 標籤中指定：</span><span class="sxs-lookup"><span data-stu-id="80fdf-144">If an app hosted in Internet Explorer has a configuration file, the location of this file is specified in a `<link>` tag with the following syntax:</span></span>  
  
     \<link rel="*ConfigurationFileName*" href="*location*">  
  
     <span data-ttu-id="80fdf-145">這個標記中，`location` 為組態檔的 URL。</span><span class="sxs-lookup"><span data-stu-id="80fdf-145">In this tag, `location` is a URL to the configuration file.</span></span> <span data-ttu-id="80fdf-146">這會設定應用程式基底。</span><span class="sxs-lookup"><span data-stu-id="80fdf-146">This sets the app base.</span></span> <span data-ttu-id="80fdf-147">組態檔必須位在與應用程式相同的網站上。</span><span class="sxs-lookup"><span data-stu-id="80fdf-147">The configuration file must be located on the same website as the app.</span></span>  
  
## <a name="security-configuration-files"></a><span data-ttu-id="80fdf-148">安全組態檔</span><span class="sxs-lookup"><span data-stu-id="80fdf-148">Security Configuration Files</span></span>  
 <span data-ttu-id="80fdf-149">安全組態檔包含程式碼群組階層架構和與原則層級相關聯的使用權限集合的資訊。</span><span class="sxs-lookup"><span data-stu-id="80fdf-149">Security configuration files contain information about the code group hierarchy and permission sets associated with a policy level.</span></span> <span data-ttu-id="80fdf-150">強烈建議您使用[程式碼存取安全性原則工具 (Caspol.exe)](../tools/caspol-exe-code-access-security-policy-tool.md) 修改安全性原則，確保原則變更不會造成安全性組態檔損毀。</span><span class="sxs-lookup"><span data-stu-id="80fdf-150">We strongly recommend that you use the [Code Access Security Policy tool (Caspol.exe)](../tools/caspol-exe-code-access-security-policy-tool.md) to modify security policy to ensure that policy changes do not corrupt the security configuration files.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="80fdf-151">從 .NET Framework 4 開始，只有在安全性原則已變更時，才會顯示安全性設定檔。</span><span class="sxs-lookup"><span data-stu-id="80fdf-151">Starting with the .NET Framework 4, the security configuration files are present only if security policy has been changed.</span></span>  
  
 <span data-ttu-id="80fdf-152">安全性組態檔位於下列位置：</span><span class="sxs-lookup"><span data-stu-id="80fdf-152">The security configuration files are in the following locations:</span></span>  
  
- <span data-ttu-id="80fdf-153">企業原則組態檔：%*runtime-install-path*%\Config\Enterprisesec.config</span><span class="sxs-lookup"><span data-stu-id="80fdf-153">Enterprise policy configuration file: %*runtime-install-path*%\Config\Enterprisesec.config</span></span>  
  
- <span data-ttu-id="80fdf-154">電腦原則組態檔：%*runtime-install-path*%\Config\Security.config</span><span class="sxs-lookup"><span data-stu-id="80fdf-154">Machine policy configuration file: %*runtime-install-path*%\Config\Security.config</span></span>  
  
- <span data-ttu-id="80fdf-155">使用者原則組態檔：%USERPROFILE%\Application data\Microsoft\CLR security config\v*xx.xx*\Security.config</span><span class="sxs-lookup"><span data-stu-id="80fdf-155">User policy configuration file: %USERPROFILE%\Application data\Microsoft\CLR security config\v*xx.xx*\Security.config</span></span>  
  
## <a name="in-this-section"></a><span data-ttu-id="80fdf-156">本節內容</span><span class="sxs-lookup"><span data-stu-id="80fdf-156">In This Section</span></span>  
 [<span data-ttu-id="80fdf-157">作法：使用 DEVPATH 找出組件</span><span class="sxs-lookup"><span data-stu-id="80fdf-157">How to: Locate Assemblies by Using DEVPATH</span></span>](how-to-locate-assemblies-by-using-devpath.md)  
 <span data-ttu-id="80fdf-158">說明如何在搜尋組件時指示執行階段使用 DEVPATH 環境變數。</span><span class="sxs-lookup"><span data-stu-id="80fdf-158">Describes how to direct the runtime to use the DEVPATH environment variable when searching for assemblies.</span></span>  
  
 [<span data-ttu-id="80fdf-159">重新導向組件版本</span><span class="sxs-lookup"><span data-stu-id="80fdf-159">Redirecting Assembly Versions</span></span>](redirect-assembly-versions.md)  
 <span data-ttu-id="80fdf-160">說明如何指定組件的位置和應使用組件的哪個版本。</span><span class="sxs-lookup"><span data-stu-id="80fdf-160">Describes how to specify the location of an assembly and which version of an assembly to use.</span></span>  
  
 [<span data-ttu-id="80fdf-161">指定組件的位置</span><span class="sxs-lookup"><span data-stu-id="80fdf-161">Specifying an Assembly's Location</span></span>](specify-assembly-location.md)  
 <span data-ttu-id="80fdf-162">說明如何指定執行階段應該在什麼地方搜尋組件。</span><span class="sxs-lookup"><span data-stu-id="80fdf-162">Describes how to specify where the runtime should search for an assembly.</span></span>  
  
 [<span data-ttu-id="80fdf-163">設定密碼編譯類別</span><span class="sxs-lookup"><span data-stu-id="80fdf-163">Configuring Cryptography Classes</span></span>](configure-cryptography-classes.md)  
 <span data-ttu-id="80fdf-164">說明如何將演算法名稱對應到加密類別，物件識別項對應到加密演算法。</span><span class="sxs-lookup"><span data-stu-id="80fdf-164">Describes how to map an algorithm name to a cryptography class and an object identifier to a cryptography algorithm.</span></span>  
  
 [<span data-ttu-id="80fdf-165">作法：建立發行者原則</span><span class="sxs-lookup"><span data-stu-id="80fdf-165">How to: Create a Publisher Policy</span></span>](how-to-create-a-publisher-policy.md)  
 <span data-ttu-id="80fdf-166">說明您何時應該以何種方式新增發行者原則檔，以指定組件重新導向和程式碼基底設定。</span><span class="sxs-lookup"><span data-stu-id="80fdf-166">Describes when and how you should add a publisher policy file to specify assembly redirection and code base settings.</span></span>  
  
 [<span data-ttu-id="80fdf-167">設定檔架構</span><span class="sxs-lookup"><span data-stu-id="80fdf-167">Configuration File Schema</span></span>](./file-schema/index.md)  
 <span data-ttu-id="80fdf-168">說明啟動、執行階段、網路和其他類型組態設定的結構描述階層架構。</span><span class="sxs-lookup"><span data-stu-id="80fdf-168">Describes the schema hierarchy for startup, runtime, network, and other types of configuration settings.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="80fdf-169">另請參閱</span><span class="sxs-lookup"><span data-stu-id="80fdf-169">See also</span></span>

- [<span data-ttu-id="80fdf-170">設定檔架構</span><span class="sxs-lookup"><span data-stu-id="80fdf-170">Configuration File Schema</span></span>](./file-schema/index.md)
- [<span data-ttu-id="80fdf-171">指定組件的位置</span><span class="sxs-lookup"><span data-stu-id="80fdf-171">Specifying an Assembly's Location</span></span>](specify-assembly-location.md)
- [<span data-ttu-id="80fdf-172">重新導向組件版本</span><span class="sxs-lookup"><span data-stu-id="80fdf-172">Redirecting Assembly Versions</span></span>](redirect-assembly-versions.md)
- <span data-ttu-id="80fdf-173">[管理 ASP.NET 網站](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2008/6hy1xzbw(v=vs.90))</span><span class="sxs-lookup"><span data-stu-id="80fdf-173">[ASP.NET Web Site Administration](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2008/6hy1xzbw(v=vs.90))</span></span>
- <span data-ttu-id="80fdf-174">[安全性原則管理](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/c1k0eed6(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="80fdf-174">[Security Policy Management](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/c1k0eed6(v=vs.100))</span></span>
- [<span data-ttu-id="80fdf-175">Caspol.exe （代碼啟用安全性原則工具）</span><span class="sxs-lookup"><span data-stu-id="80fdf-175">Caspol.exe (Code Access Security Policy Tool)</span></span>](../tools/caspol-exe-code-access-security-policy-tool.md)
- [<span data-ttu-id="80fdf-176">.NET 中的組件</span><span class="sxs-lookup"><span data-stu-id="80fdf-176">Assemblies in .NET</span></span>](../../standard/assembly/index.md)

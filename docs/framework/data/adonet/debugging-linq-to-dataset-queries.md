---
title: 偵錯 LINQ to DataSet 查詢
ms.date: 03/30/2017
ms.assetid: f4c54015-8ce2-4c5c-8d18-7038144cc66d
ms.openlocfilehash: 5f6e711d13a71f73a75e774c9251c5c29216b860
ms.sourcegitcommit: 27a15a55019f6b5f2733961738babe94aec0def3
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/15/2020
ms.locfileid: "90554344"
---
# <a name="debugging-linq-to-dataset-queries"></a><span data-ttu-id="a86dd-102">偵錯 LINQ to DataSet 查詢</span><span class="sxs-lookup"><span data-stu-id="a86dd-102">Debugging LINQ to DataSet Queries</span></span>

<span data-ttu-id="a86dd-103">Visual Studio 支援 LINQ to DataSet 程式碼的偵錯工具。</span><span class="sxs-lookup"><span data-stu-id="a86dd-103">Visual Studio supports the debugging of LINQ to DataSet code.</span></span> <span data-ttu-id="a86dd-104">不過，LINQ to DataSet 程式碼和非 LINQ to DataSet managed 程式碼的偵錯工具之間有一些差異。</span><span class="sxs-lookup"><span data-stu-id="a86dd-104">However, there are some differences between debugging LINQ to DataSet code and non-LINQ to DataSet managed code.</span></span> <span data-ttu-id="a86dd-105">大部分的偵錯工具都可搭配 LINQ to DataSet 的語句使用，包括逐步執行、設定中斷點，以及顯示在偵錯工具視窗中的結果。</span><span class="sxs-lookup"><span data-stu-id="a86dd-105">Most debugging features work with LINQ to DataSet statements, including stepping, setting breakpoints, and viewing results that are shown in debugger windows.</span></span> <span data-ttu-id="a86dd-106">但是，中的延遲查詢執行有一些副作用，您應該考慮在 LINQ to DataSet 程式碼進行偵錯工具時，使用 [編輯後繼續] 有一些限制。</span><span class="sxs-lookup"><span data-stu-id="a86dd-106">However, deferred query execution in has some side effects that you should consider while debugging LINQ to DataSet code and there are some limitations to using Edit and Continue.</span></span> <span data-ttu-id="a86dd-107">本主題將討論與非 LINQ to DataSet managed 程式碼相較之下，LINQ to DataSet 特有的偵錯工具層面。</span><span class="sxs-lookup"><span data-stu-id="a86dd-107">This topic discusses aspects of debugging that are unique to LINQ to DataSet compared to non-LINQ to DataSet managed code.</span></span>  
  
## <a name="viewing-results"></a><span data-ttu-id="a86dd-108">檢視結果</span><span class="sxs-lookup"><span data-stu-id="a86dd-108">Viewing Results</span></span>  
 <span data-ttu-id="a86dd-109">您可以使用 [資料提示]、[監看式視窗] 和 [快速監看式] 對話方塊來查看 LINQ to DataSet 語句的結果。</span><span class="sxs-lookup"><span data-stu-id="a86dd-109">You can view the result of a LINQ to DataSet statement by using DataTips, the Watch window, and the QuickWatch dialog box.</span></span> <span data-ttu-id="a86dd-110">藉由使用來源視窗，您可以在來源視窗中暫停查詢的指標，而且 DataTip 將會出現。</span><span class="sxs-lookup"><span data-stu-id="a86dd-110">By using a source window, you can pause the pointer on a query in the source window and a DataTip will appear.</span></span> <span data-ttu-id="a86dd-111">您可以複製 LINQ to DataSet 變數，並將它貼到監看式視窗或 [快速監看式] 對話方塊中。</span><span class="sxs-lookup"><span data-stu-id="a86dd-111">You can copy a LINQ to DataSet variable and paste it into the Watch window or the QuickWatch dialog box.</span></span> <span data-ttu-id="a86dd-112">在 LINQ to DataSet 中，在建立或宣告查詢時，不會評估該查詢，但只有在執行查詢時才會進行評估。</span><span class="sxs-lookup"><span data-stu-id="a86dd-112">In LINQ to DataSet, a query is not evaluated when it is created or declared, but only when the query is executed.</span></span> <span data-ttu-id="a86dd-113">這稱為「 *延後執行*」。</span><span class="sxs-lookup"><span data-stu-id="a86dd-113">This is called *deferred execution*.</span></span> <span data-ttu-id="a86dd-114">因此，查詢變數在接受評估前沒有值。</span><span class="sxs-lookup"><span data-stu-id="a86dd-114">Therefore, the query variable does not have a value until it is evaluated.</span></span> <span data-ttu-id="a86dd-115">如需詳細資訊，請參閱 [LINQ to DataSet 中的查詢](queries-in-linq-to-dataset.md)。</span><span class="sxs-lookup"><span data-stu-id="a86dd-115">For more information, see [Queries in LINQ to DataSet](queries-in-linq-to-dataset.md).</span></span>  
  
 <span data-ttu-id="a86dd-116">偵錯工具必須評估查詢，才能顯示查詢結果。</span><span class="sxs-lookup"><span data-stu-id="a86dd-116">The debugger must evaluate a query to display the query results.</span></span> <span data-ttu-id="a86dd-117">當您在偵錯工具中查看 LINQ to DataSet 查詢結果時，就會發生這種隱含的評估，且您應該考慮一些效果。</span><span class="sxs-lookup"><span data-stu-id="a86dd-117">This implicit evaluation occurs when you view a LINQ to DataSet query result in the debugger, and it has some effects you should consider.</span></span> <span data-ttu-id="a86dd-118">每個查詢評估會耗費些許時間。</span><span class="sxs-lookup"><span data-stu-id="a86dd-118">Each evaluation of the query takes time.</span></span> <span data-ttu-id="a86dd-119">展開結果節點也會耗用時間。</span><span class="sxs-lookup"><span data-stu-id="a86dd-119">Expanding the results node takes time.</span></span> <span data-ttu-id="a86dd-120">對於某些查詢而言，重複的評估可能會造成明顯的效能影響。</span><span class="sxs-lookup"><span data-stu-id="a86dd-120">For some queries, repeated evaluation might cause a noticeable performance penalty.</span></span> <span data-ttu-id="a86dd-121">評估查詢也可能造成變更資料值與程式狀態的副作用。</span><span class="sxs-lookup"><span data-stu-id="a86dd-121">Evaluating a query can also cause side effects, which are changes to the value of data or the state of your program.</span></span> <span data-ttu-id="a86dd-122">並不是所有的查詢都有副作用。</span><span class="sxs-lookup"><span data-stu-id="a86dd-122">Not all queries have side effects.</span></span> <span data-ttu-id="a86dd-123">若要判斷查詢是否可以安全地接受評估而沒有副作用，您必須了解實作查詢的程式碼。</span><span class="sxs-lookup"><span data-stu-id="a86dd-123">To determine whether a query can be safely evaluated without side effects, you must understand the code that implements the query.</span></span> <span data-ttu-id="a86dd-124">如需詳細資訊，請參閱 [副作用和運算式](/previous-versions/visualstudio/visual-studio-2013/a7a250bs(v=vs.120))。</span><span class="sxs-lookup"><span data-stu-id="a86dd-124">For more information, see [Side Effects and Expressions](/previous-versions/visualstudio/visual-studio-2013/a7a250bs(v=vs.120)).</span></span>  
  
## <a name="edit-and-continue"></a><span data-ttu-id="a86dd-125">編輯後繼續</span><span class="sxs-lookup"><span data-stu-id="a86dd-125">Edit and Continue</span></span>  
 <span data-ttu-id="a86dd-126">[編輯後繼續] 不支援 LINQ to DataSet 查詢的變更。</span><span class="sxs-lookup"><span data-stu-id="a86dd-126">Edit and Continue does not support changes to LINQ to DataSet queries.</span></span> <span data-ttu-id="a86dd-127">如果您在偵錯工具期間加入、移除或變更 LINQ to DataSet 語句，會出現一個對話方塊，告訴您 [編輯後繼續] 不支援變更。</span><span class="sxs-lookup"><span data-stu-id="a86dd-127">If you add, remove, or change a LINQ to DataSet statement during a debugging session, a dialog box appears that tells you the change is not supported by Edit and Continue.</span></span> <span data-ttu-id="a86dd-128">此時，您可以復原變更，或者是停止偵錯工作階段並使用編輯過的程式碼重新啟動新的工作階段。</span><span class="sxs-lookup"><span data-stu-id="a86dd-128">At that point, you can either undo the changes or stop the debugging session and restart a new session with the edited code.</span></span>  
  
 <span data-ttu-id="a86dd-129">此外，[編輯後繼續] 不支援變更 LINQ to DataSet 語句中所使用之變數的類型或值。</span><span class="sxs-lookup"><span data-stu-id="a86dd-129">In addition, Edit and Continue does not support changing the type or the value of a variable that is used in a LINQ to DataSet statement.</span></span> <span data-ttu-id="a86dd-130">同樣地，您可以復原變更，或者是停止並重新啟動偵錯工作階段。</span><span class="sxs-lookup"><span data-stu-id="a86dd-130">Again, you can either undo the changes or stop and restart the debugging session.</span></span>  
  
 <span data-ttu-id="a86dd-131">在 Visual Studio 中的 Visual c # 中，您無法在包含 LINQ to DataSet 查詢之方法中的任何程式碼上使用 [編輯後繼續]。</span><span class="sxs-lookup"><span data-stu-id="a86dd-131">In Visual C# in Visual Studio, you cannot use Edit and Continue on any code in a method that contains a LINQ to DataSet query.</span></span>  
  
 <span data-ttu-id="a86dd-132">在 Visual Studio 的 Visual Basic 中，您可以在非 LINQ to DataSet 的程式碼上使用 [編輯後繼續]，即使是在包含 LINQ to DataSet 查詢的方法中也一樣。</span><span class="sxs-lookup"><span data-stu-id="a86dd-132">In Visual Basic in Visual Studio, you can use Edit and Continue on non-LINQ to DataSet code, even in a method that contains a LINQ to DataSet query.</span></span> <span data-ttu-id="a86dd-133">您可以在 LINQ to DataSet 語句之前新增或移除程式碼，即使這些變更會影響 LINQ to DataSet 查詢的行號。</span><span class="sxs-lookup"><span data-stu-id="a86dd-133">You can add or remove code before the LINQ to DataSet statement, even if the changes affect line number of the LINQ to DataSet query.</span></span> <span data-ttu-id="a86dd-134">您 Visual Basic 非 LINQ to DataSet 程式碼的偵錯工具體驗，與引進 LINQ to DataSet 之前保持不變。</span><span class="sxs-lookup"><span data-stu-id="a86dd-134">Your Visual Basic debugging experience for non-LINQ to DataSet code remains the same as it was before LINQ to DataSet was introduced.</span></span> <span data-ttu-id="a86dd-135">不過，您無法變更、新增或移除 LINQ to DataSet 查詢，除非您停止調試以套用變更。</span><span class="sxs-lookup"><span data-stu-id="a86dd-135">You cannot change, add, or remove a LINQ to DataSet query, however, unless you stop debugging to apply the changes.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="a86dd-136">另請參閱</span><span class="sxs-lookup"><span data-stu-id="a86dd-136">See also</span></span>

- [<span data-ttu-id="a86dd-137">偵錯 Managed 程式碼</span><span class="sxs-lookup"><span data-stu-id="a86dd-137">Debugging Managed Code</span></span>](/visualstudio/debugger/debugging-managed-code)
- [<span data-ttu-id="a86dd-138">程式設計指南</span><span class="sxs-lookup"><span data-stu-id="a86dd-138">Programming Guide</span></span>](programming-guide-linq-to-dataset.md)

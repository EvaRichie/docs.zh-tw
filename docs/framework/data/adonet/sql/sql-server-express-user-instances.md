---
title: SQL Server Express 使用者執行個體
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: 00c12376-cb26-4317-86ad-e6e9c089be57
ms.openlocfilehash: 71f42cb2707c27be6c1a761d09d3a2dae1791680
ms.sourcegitcommit: 27a15a55019f6b5f2733961738babe94aec0def3
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/15/2020
ms.locfileid: "90552670"
---
# <a name="sql-server-express-user-instances"></a><span data-ttu-id="47647-102">SQL Server Express 使用者執行個體</span><span class="sxs-lookup"><span data-stu-id="47647-102">SQL Server Express User Instances</span></span>
<span data-ttu-id="47647-103">Microsoft SQL Server Express Edition (SQL Server Express) 支援使用者執行個體功能，只有在使用 .NET Framework Data Provider for SQL Server (`SqlClient`) 時才提供此功能。</span><span class="sxs-lookup"><span data-stu-id="47647-103">Microsoft SQL Server Express Edition (SQL Server Express) supports the user instance feature, which is only available when using the .NET Framework Data Provider for SQL Server (`SqlClient`).</span></span> <span data-ttu-id="47647-104">使用者執行個體是 SQL Server Express 資料庫引擎的個別執行個體，這是由 SQL Server Express 的父執行個體所產生的。</span><span class="sxs-lookup"><span data-stu-id="47647-104">A user instance is a separate instance of the SQL Server Express Database Engine that is generated by a parent instance.</span></span> <span data-ttu-id="47647-105">使用者執行個體可讓不是本機電腦上系統管理員的使用者附加及連線到 SQL Server Express 資料庫。</span><span class="sxs-lookup"><span data-stu-id="47647-105">User instances allow users who are not administrators on their local computers to attach and connect to SQL Server Express databases.</span></span> <span data-ttu-id="47647-106">每個執行個體都會在個別使用者的資訊安全內容下，以每個使用者一個執行個體為基礎的方式執行。</span><span class="sxs-lookup"><span data-stu-id="47647-106">Each instance runs under the security context of the individual user, on a one-instance-per-user basis.</span></span>  
  
## <a name="user-instance-capabilities"></a><span data-ttu-id="47647-107">使用者執行個體功能</span><span class="sxs-lookup"><span data-stu-id="47647-107">User Instance Capabilities</span></span>  
 <span data-ttu-id="47647-108">使用者實例適用于在最低許可權使用者帳戶下執行 Windows 的使用者 (LUA) 。</span><span class="sxs-lookup"><span data-stu-id="47647-108">User instances are useful for users who are running Windows under a least-privilege user account (LUA).</span></span> <span data-ttu-id="47647-109">每位使用者都 SQL Server 系統管理員 (在 `sysadmin` 其電腦上執行的實例) 許可權，而且不需要以 Windows 系統管理員身分執行。</span><span class="sxs-lookup"><span data-stu-id="47647-109">Each user has SQL Server system administrator (`sysadmin`) privileges over the instance running on their computer without needing to run as a Windows administrator as well.</span></span> <span data-ttu-id="47647-110">在具備有限權限的使用者執行個體上執行的軟體，無法進行全系統變更，因為 SQL Server Express 的執行個體是在使用者的非系統管理員 Windows 帳戶下執行，而非以服務方式執行。</span><span class="sxs-lookup"><span data-stu-id="47647-110">Software executing on a user instance with limited permissions cannot make system-wide changes because the instance of SQL Server Express is running under the non-administrator Windows account of the user, not as a service.</span></span> <span data-ttu-id="47647-111">每個使用者執行個體都會與父執行個體，以及相同電腦上執行的所有其他使用者執行個體隔離。</span><span class="sxs-lookup"><span data-stu-id="47647-111">Each user instance is isolated from its parent instance and from any other user instances running on the same computer.</span></span> <span data-ttu-id="47647-112">在使用者執行個體上執行的資料庫只會以單一使用者模式開啟，而且無法讓多個使用者連線到在使用者執行個體上執行的資料庫。</span><span class="sxs-lookup"><span data-stu-id="47647-112">Databases running on a user instance are opened in single-user mode only, and it is not possible for multiple users to connect to databases running on a user instance.</span></span> <span data-ttu-id="47647-113">複寫與分散式查詢也會針對使用者執行個體停用。</span><span class="sxs-lookup"><span data-stu-id="47647-113">Replication and distributed queries are also disabled for user instances.</span></span>
  
> [!NOTE]
> <span data-ttu-id="47647-114">使用者如果已經是其自有電腦上的系統管理員，或屬於涉及多個資料庫使用者的情況，則不需要使用者執行個體。</span><span class="sxs-lookup"><span data-stu-id="47647-114">User instances are not needed for users who are already administrators on their own computers, or for scenarios involving multiple database users.</span></span>  
  
## <a name="enabling-user-instances"></a><span data-ttu-id="47647-115">啟用使用者執行個體</span><span class="sxs-lookup"><span data-stu-id="47647-115">Enabling User Instances</span></span>  
 <span data-ttu-id="47647-116">若要產生使用者執行個體，SQL Server Express 的父執行個體必須在執行中。</span><span class="sxs-lookup"><span data-stu-id="47647-116">To generate user instances, a parent instance of SQL Server Express must be running.</span></span> <span data-ttu-id="47647-117">根據預設，在安裝 SQL Server Express 時會啟用使用者執行個體，也可以由系統管理員在父執行個體上執行 **sp_configure** 系統預存程序，而加以明確地啟用或停用。</span><span class="sxs-lookup"><span data-stu-id="47647-117">User instances are enabled by default when SQL Server Express is installed, and they can be explicitly enabled or disabled by a system administrator executing the **sp_configure** system stored procedure on the parent instance.</span></span>  
  
```sql  
-- Enable user instances.  
sp_configure 'user instances enabled','1'
  
-- Disable user instances.  
sp_configure 'user instances enabled','0'  
```  
  
 <span data-ttu-id="47647-118">使用者執行個體的網路通訊協定必須是本機具名管道。</span><span class="sxs-lookup"><span data-stu-id="47647-118">The network protocol for user instances must be local Named Pipes.</span></span> <span data-ttu-id="47647-119">使用者執行個體無法在 SQL Server 的遠端執行個體上啟動，也不允許 SQL Server 登入。</span><span class="sxs-lookup"><span data-stu-id="47647-119">A user instance cannot be started on a remote instance of SQL Server, and SQL Server logins are not allowed.</span></span>  
  
## <a name="connecting-to-a-user-instance"></a><span data-ttu-id="47647-120">連接至使用者執行個體</span><span class="sxs-lookup"><span data-stu-id="47647-120">Connecting to a User Instance</span></span>  
 <span data-ttu-id="47647-121">`User Instance` 和 `AttachDBFilename`<xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A> 關鍵字可以讓 <xref:System.Data.SqlClient.SqlConnection> 連線至使用者執行個體。</span><span class="sxs-lookup"><span data-stu-id="47647-121">The `User Instance` and `AttachDBFilename`<xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A> keywords allow a <xref:System.Data.SqlClient.SqlConnection> to connect to a user instance.</span></span> <span data-ttu-id="47647-122"><xref:System.Data.SqlClient.SqlConnectionStringBuilder>`UserInstance` 與 `AttachDBFilename` 屬性也支援使用者執行個體。</span><span class="sxs-lookup"><span data-stu-id="47647-122">User instances are also supported by the <xref:System.Data.SqlClient.SqlConnectionStringBuilder>`UserInstance` and `AttachDBFilename` properties.</span></span>  
  
 <span data-ttu-id="47647-123">請注意下列與範例連接字串有關的資訊，如下所示：</span><span class="sxs-lookup"><span data-stu-id="47647-123">Note the following about the sample connection string shown below:</span></span>  
  
- <span data-ttu-id="47647-124">`Data Source` 關鍵字會參考正在產生使用者執行個體之 SQL Server Express 的父執行個體。</span><span class="sxs-lookup"><span data-stu-id="47647-124">The `Data Source` keyword refers to the parent instance of SQL Server Express that is generating the user instance.</span></span> <span data-ttu-id="47647-125">預設的執行個體為 .\sqlexpress。</span><span class="sxs-lookup"><span data-stu-id="47647-125">The default instance is .\sqlexpress.</span></span>  
  
- <span data-ttu-id="47647-126">`Integrated Security` 設定為 `true`。</span><span class="sxs-lookup"><span data-stu-id="47647-126">`Integrated Security` is set to `true`.</span></span> <span data-ttu-id="47647-127">若要連線到使用者執行個體，需要 Windows 驗證；不支援 SQL Server 登入。</span><span class="sxs-lookup"><span data-stu-id="47647-127">To connect to a user instance, Windows Authentication is required; SQL Server logins are not supported.</span></span>  
  
- <span data-ttu-id="47647-128">`User Instance` 設定為 `true`，這會叫用使用者執行個體。</span><span class="sxs-lookup"><span data-stu-id="47647-128">The `User Instance` is set to `true`, which invokes a user instance.</span></span> <span data-ttu-id="47647-129">(預設為 `false`。)</span><span class="sxs-lookup"><span data-stu-id="47647-129">(The default is `false`.)</span></span>  
  
- <span data-ttu-id="47647-130">`AttachDbFileName` 連接字串關鍵字是用來附加主資料庫檔案 (.mdf)，這必須包含完整路徑名稱。</span><span class="sxs-lookup"><span data-stu-id="47647-130">The `AttachDbFileName` connection string keyword is used to attach the primary database file (.mdf), which must include the full path name.</span></span> <span data-ttu-id="47647-131">`AttachDbFileName` 也對應到 <xref:System.Data.SqlClient.SqlConnection> 連接字串內的「擴充屬性」與「初始檔案名稱」機碼相對應。</span><span class="sxs-lookup"><span data-stu-id="47647-131">`AttachDbFileName` also corresponds to the "extended properties" and "initial file name" keys within a <xref:System.Data.SqlClient.SqlConnection> connection string.</span></span>  
  
- <span data-ttu-id="47647-132">管線符號中括住的 `|DataDirectory|` 替代字串會參考開啟連線之應用程式的資料目錄，並提供指出 .mdf 與 .ldf 資料庫與記錄檔位置的相對路徑。</span><span class="sxs-lookup"><span data-stu-id="47647-132">The `|DataDirectory|` substitution string enclosed in the pipe symbols refers to the data directory of the application opening the connection and provides a relative path indicating the location of the .mdf and .ldf database and log files.</span></span> <span data-ttu-id="47647-133">如果您想要在其他位置尋找這些檔案，必須提供檔案的完整路徑。</span><span class="sxs-lookup"><span data-stu-id="47647-133">If you want to locate these files elsewhere, you must provide the full path to the files.</span></span>  
  
```text
Data Source=.\\SQLExpress;Integrated Security=true;  
User Instance=true;AttachDBFilename=|DataDirectory|\InstanceDB.mdf;  
Initial Catalog=InstanceDB;  
```  
  
> [!NOTE]
> <span data-ttu-id="47647-134">您也可以使用 <xref:System.Data.SqlClient.SqlConnectionStringBuilder><xref:System.Data.SqlClient.SqlConnectionStringBuilder.UserInstance%2A> 與 <xref:System.Data.SqlClient.SqlConnectionStringBuilder.AttachDBFilename%2A> 屬性，在執行階段建立連接字串。</span><span class="sxs-lookup"><span data-stu-id="47647-134">You can also use the <xref:System.Data.SqlClient.SqlConnectionStringBuilder><xref:System.Data.SqlClient.SqlConnectionStringBuilder.UserInstance%2A> and <xref:System.Data.SqlClient.SqlConnectionStringBuilder.AttachDBFilename%2A> properties to build a connection string at run time.</span></span>  
  
### <a name="using-the-124datadirectory124-substitution-string"></a><span data-ttu-id="47647-135">使用 &#124;DataDirectory&#124; 替代字串</span><span class="sxs-lookup"><span data-stu-id="47647-135">Using the &#124;DataDirectory&#124; Substitution String</span></span>  
 <span data-ttu-id="47647-136">`AttachDbFileName` 在 ADO.NET 2.0 中已藉由引進 `|DataDirectory|` (放在垂直線符號內) 替代字串而擴充。</span><span class="sxs-lookup"><span data-stu-id="47647-136">`AttachDbFileName` was extended in ADO.NET 2.0 with the introduction of the `|DataDirectory|` (enclosed in pipe symbols) substitution string.</span></span> <span data-ttu-id="47647-137">`DataDirectory` 可與 `AttachDbFileName` 搭配使用以表示資料檔案的相對路徑，開發人員因此能根據資料來源的相對路徑建立連接字串，而不需指定完整路徑。</span><span class="sxs-lookup"><span data-stu-id="47647-137">`DataDirectory` is used in conjunction with `AttachDbFileName` to indicate a relative path to a data file, allowing developers to create connection strings that are based on a relative path to the data source instead of being required to specify a full path.</span></span>  
  
 <span data-ttu-id="47647-138">`DataDirectory` 所指向的實體位置取決於應用程式的類型。</span><span class="sxs-lookup"><span data-stu-id="47647-138">The physical location that `DataDirectory` points to depends on the type of application.</span></span> <span data-ttu-id="47647-139">在此範例中，要附加的 Northwind.mdf 檔案位於應用程式的 \app_data 資料夾中。</span><span class="sxs-lookup"><span data-stu-id="47647-139">In this example, the Northwind.mdf file to be attached is located in the application's \app_data folder.</span></span>  
  
```text
Data Source=.\\SQLExpress;Integrated Security=true;  
User Instance=true;  
AttachDBFilename=|DataDirectory|\app_data\Northwind.mdf;  
Initial Catalog=Northwind;  
```  
  
 <span data-ttu-id="47647-140">使用 `DataDirectory` 時，在目錄結構中產生的檔案路徑不能高於替代字串所指向的目錄。</span><span class="sxs-lookup"><span data-stu-id="47647-140">When `DataDirectory` is used, the resulting file path cannot be higher in the directory structure than the directory pointed to by the substitution string.</span></span> <span data-ttu-id="47647-141">例如，如果完全展開的 `DataDirectory` 是 C:\AppDirectory\ app_data，上面顯示的範例連接字串可以運作，因為該字串位於 c:\AppDirectory 之下。</span><span class="sxs-lookup"><span data-stu-id="47647-141">For example, if the fully expanded `DataDirectory` is C:\AppDirectory\app_data, then the sample connection string shown above works because it is below c:\AppDirectory.</span></span> <span data-ttu-id="47647-142">不過，嘗試將 `DataDirectory` 指定為 `|DataDirectory|\..\data`將會導致錯誤，原因為 \data 不是 \AppDirectory 的子目錄。</span><span class="sxs-lookup"><span data-stu-id="47647-142">However, attempting to specify `DataDirectory` as `|DataDirectory|\..\data` will result in an error because \data is not a subdirectory of \AppDirectory.</span></span>  
  
 <span data-ttu-id="47647-143">如果連接字串具有格式不正確的替代字串，將會擲回 <xref:System.ArgumentException>。</span><span class="sxs-lookup"><span data-stu-id="47647-143">If the connection string has an improperly formatted substitution string, an <xref:System.ArgumentException> will be thrown.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="47647-144"><xref:System.Data.SqlClient> 會將替代字串解析為本機電腦檔案系統的完整路徑。</span><span class="sxs-lookup"><span data-stu-id="47647-144"><xref:System.Data.SqlClient> resolves the substitution strings into full paths against the local computer file system.</span></span> <span data-ttu-id="47647-145">因此，不支援遠端伺服器、HTTP 與 UNC 路徑名稱。</span><span class="sxs-lookup"><span data-stu-id="47647-145">Therefore, remote server, HTTP, and UNC path names are not supported.</span></span> <span data-ttu-id="47647-146">如果伺服器不在本機電腦上，當連線開啟時，就會擲回例外狀況。</span><span class="sxs-lookup"><span data-stu-id="47647-146">An exception is thrown when the connection is opened if the server is not located on the local computer.</span></span>  
  
 <span data-ttu-id="47647-147">當 <xref:System.Data.SqlClient.SqlConnection> 開啟時，系統會將該連線從預設 SQL Server Express 執行個體重新導向至以呼叫者的帳戶執行的執行個體所起始的執行階段。</span><span class="sxs-lookup"><span data-stu-id="47647-147">When the <xref:System.Data.SqlClient.SqlConnection> is opened, it is redirected from the default SQL Server Express instance to a run-time initiated instance running under the caller's account.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="47647-148">可能需要增加 <xref:System.Data.SqlClient.SqlConnection.ConnectionTimeout%2A> 值，因為使用者執行個體可能需要比一般執行個體更長的時間來載入。</span><span class="sxs-lookup"><span data-stu-id="47647-148">It may be necessary to increase the <xref:System.Data.SqlClient.SqlConnection.ConnectionTimeout%2A> value since user instances may take longer to load than regular instances.</span></span>  
  
 <span data-ttu-id="47647-149">下列程式碼片段會開啟新的 `SqlConnection`、在主控台視窗中顯示連接字串，然後在結束 `using` 程式碼區塊時關閉連線。</span><span class="sxs-lookup"><span data-stu-id="47647-149">The following code fragment opens a new `SqlConnection`, displays the connection string in the console window, and then closes the connection when exiting the `using` code block.</span></span>  
  
```vb  
Private Sub OpenSqlConnection()  
    ' Retrieve the connection string.  
    Dim connectionString As String = GetConnectionString()  
  
    Using connection As New SqlConnection(connectionString)  
        connection.Open()  
        Console.WriteLine("ConnectionString: {0}", _  
           connection.ConnectionString)  
    End Using  
End Sub  
```  
  
```csharp  
private static void OpenSqlConnection()  
{  
    // Retrieve the connection string.  
    string connectionString = GetConnectionString();  
  
    using (SqlConnection connection =
        new SqlConnection(connectionString))  
    {  
        connection.Open();  
        Console.WriteLine("ConnectionString: {0}",
             connection.ConnectionString);  
    }  
}  
```  
  
> [!NOTE]
> <span data-ttu-id="47647-150">在 SQL Server 內部執行的通用語言執行平台 (CLR) 程式碼不支援使用者執行個體。</span><span class="sxs-lookup"><span data-stu-id="47647-150">User instances are not supported in common language runtime (CLR) code that is running inside of SQL Server.</span></span> <span data-ttu-id="47647-151">如果在連接字串中有 <xref:System.InvalidOperationException> 的 `Open` 上呼叫 <xref:System.Data.SqlClient.SqlConnection>，會擲回 `User Instance=true`。</span><span class="sxs-lookup"><span data-stu-id="47647-151">An <xref:System.InvalidOperationException> is thrown if `Open` is called on a <xref:System.Data.SqlClient.SqlConnection> that has `User Instance=true` in the connection string.</span></span>  
  
## <a name="lifetime-of-a-user-instance-connection"></a><span data-ttu-id="47647-152">使用者執行個體連接的存留期</span><span class="sxs-lookup"><span data-stu-id="47647-152">Lifetime of a User Instance Connection</span></span>  
 <span data-ttu-id="47647-153">不同於以服務方式執行的 SQL Server 版本，SQL Server Express 執行個體不需要手動啟動及停止。</span><span class="sxs-lookup"><span data-stu-id="47647-153">Unlike versions of SQL Server that run as a service, SQL Server Express instances do not need to be manually started and stopped.</span></span> <span data-ttu-id="47647-154">每次使用者登入並連線到使用者執行個體時，如果使用者執行個體尚未執行，就會啟動該執行個體。</span><span class="sxs-lookup"><span data-stu-id="47647-154">Each time a user logs in and connects to a user instance, the user instance is started if it is not already running.</span></span> <span data-ttu-id="47647-155">使用者執行個體資料庫已設定 `AutoClose` 選項，因此資料庫會在一段時間沒有活動之後自動關閉。</span><span class="sxs-lookup"><span data-stu-id="47647-155">User instance databases have the `AutoClose` option set so that the database is automatically shut down after a period of inactivity.</span></span> <span data-ttu-id="47647-156">在執行個體的最後一個連線關閉之後，已啟動的 sqlservr.exe 程序會繼續執行一段有限的逾時期間，因此，如果在逾時到期之前開啟另一個連線，就不需要重新啟動該處理序。</span><span class="sxs-lookup"><span data-stu-id="47647-156">The sqlservr.exe process that is started is kept running for a limited time-out period after the last connection to the instance is closed, so it does not need to be restarted if another connection is opened before the time-out has expired.</span></span> <span data-ttu-id="47647-157">如果在該逾時期間到期之前未開啟任何新的連線，使用者執行個體會自動關閉。</span><span class="sxs-lookup"><span data-stu-id="47647-157">The user instance automatically shuts down if no new connection opens before that time-out period has expired.</span></span> <span data-ttu-id="47647-158">父執行個體的系統管理員可以使用 **sp_configure** 來變更 **user instance timeout** 選項，藉此設定使用者執行個體的逾時期限持續期間。</span><span class="sxs-lookup"><span data-stu-id="47647-158">A system administrator on the parent instance can set the duration of the time-out period for a user instance by using **sp_configure** to change the **user instance timeout** option.</span></span> <span data-ttu-id="47647-159">預設值是 60 分鐘。</span><span class="sxs-lookup"><span data-stu-id="47647-159">The default is 60 minutes.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="47647-160">如果在連接字串中使用 `Min Pool Size`，且其值大於零，連接共用器一律會維護幾個已開啟的連線，而且使用者執行個體不會自動關閉。</span><span class="sxs-lookup"><span data-stu-id="47647-160">If `Min Pool Size` is used in the connection string with a value greater than zero, the connection pooler will always maintain a few opened connections, and the user instance will not automatically shut down.</span></span>  
  
## <a name="how-user-instances-work"></a><span data-ttu-id="47647-161">使用者執行個體的運作方式</span><span class="sxs-lookup"><span data-stu-id="47647-161">How User Instances Work</span></span>  
 <span data-ttu-id="47647-162">初次針對每個使用者產生使用者執行個體時，會將 **master** 和 **msdb** 系統資料庫從 Template Data 資料夾複製到使用者的本機應用程式資料存放庫目錄下方專供使用者執行個體使用的路徑。</span><span class="sxs-lookup"><span data-stu-id="47647-162">The first time a user instance is generated for each user, the **master** and **msdb** system databases are copied from the Template Data folder to a path under the user's local application data repository directory for exclusive use by the user instance.</span></span> <span data-ttu-id="47647-163">此路徑通常是 `C:\Documents and Settings\<UserName>\Local Settings\Application Data\Microsoft\Microsoft SQL Server Data\SQLEXPRESS`。</span><span class="sxs-lookup"><span data-stu-id="47647-163">This path is typically `C:\Documents and Settings\<UserName>\Local Settings\Application Data\Microsoft\Microsoft SQL Server Data\SQLEXPRESS`.</span></span> <span data-ttu-id="47647-164">當使用者執行個體啟動時，**tempdb**、記錄檔，以及追蹤檔案也會寫入至這個目錄。</span><span class="sxs-lookup"><span data-stu-id="47647-164">When a user instance starts up, the **tempdb**, log, and trace files are also written to this directory.</span></span> <span data-ttu-id="47647-165">為執行個體產生的名稱保證對每個使用者來說都是唯一的。</span><span class="sxs-lookup"><span data-stu-id="47647-165">A name is generated for the instance, which is guaranteed to be unique for each user.</span></span>  
  
 <span data-ttu-id="47647-166">根據預設，Windows Builtin\Users 群組的所有成員都會被授與在本機執行個體上連線的權限，以及在 SQL Server 二進位檔案上讀取及執行權限。</span><span class="sxs-lookup"><span data-stu-id="47647-166">By default all members of the Windows Builtin\Users group are granted permissions to connect on the local instance as well as read and execute permissions on the SQL Server binaries.</span></span> <span data-ttu-id="47647-167">只要呼叫裝載使用者執行個體之使用者的認證通過驗證，該使用者就會成為該執行個體上的 `sysadmin`。</span><span class="sxs-lookup"><span data-stu-id="47647-167">Once the credentials of the calling user hosting the user instance have been verified, that user becomes the `sysadmin` on that instance.</span></span> <span data-ttu-id="47647-168">只有共用記憶體會針對使用者執行個體啟用，這表示只有本機電腦上的作業可以執行。</span><span class="sxs-lookup"><span data-stu-id="47647-168">Only shared memory is enabled for user instances, which means that only operations on the local machine are possible.</span></span>  
  
 <span data-ttu-id="47647-169">使用者必須獲授與連接字串中所指定之 .mdf 與 .ldf 檔案的讀取及寫入權限。</span><span class="sxs-lookup"><span data-stu-id="47647-169">Users must be granted both read and write permissions on the .mdf and .ldf files specified in the connection string.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="47647-170">.mdf 與 .ldf 檔案分別代表資料庫與記錄檔。</span><span class="sxs-lookup"><span data-stu-id="47647-170">The .mdf and .ldf files represent the database and log files, respectively.</span></span> <span data-ttu-id="47647-171">這兩個檔案是相符的集合，因此在備份及還原作業執行期間必須謹慎小心。</span><span class="sxs-lookup"><span data-stu-id="47647-171">These two files are a matched set, so care must be taken during backup and restore operations.</span></span> <span data-ttu-id="47647-172">資料庫檔案包含記錄檔確切版本的相關資訊，因此如果資料庫與錯誤的記錄檔結合，該資料庫將無法開啟。</span><span class="sxs-lookup"><span data-stu-id="47647-172">The database file contains information about the exact version of the log file, and the database will not open if it is coupled with the wrong log file.</span></span>  
  
 <span data-ttu-id="47647-173">為避免資料損毀，使用者執行個體中的資料庫會以獨佔存取權方式開啟。</span><span class="sxs-lookup"><span data-stu-id="47647-173">To avoid data corruption, a database in the user instance is opened with exclusive access.</span></span> <span data-ttu-id="47647-174">如果兩個不同的使用者執行個體共用相同電腦上的相同資料庫，第一個執行個體上的使用者必須先關閉資料庫，然後才能在第二個執行個體中開啟。</span><span class="sxs-lookup"><span data-stu-id="47647-174">If two different user instances share the same database on the same computer, the user on the first instance must close the database before it can be opened in a second instance.</span></span>  
  
## <a name="user-instance-scenarios"></a><span data-ttu-id="47647-175">使用者執行個體案例</span><span class="sxs-lookup"><span data-stu-id="47647-175">User Instance Scenarios</span></span>  
 <span data-ttu-id="47647-176">使用者執行個體會向資料庫應用程式開發人員提供 SQL Server 資料存放區，且該存放區不會要求開發人員必須有其開發電腦上的系統管理帳戶。</span><span class="sxs-lookup"><span data-stu-id="47647-176">User instances provide developers of database applications with a SQL Server data store that does not depend on developers having administrative accounts on their development computers.</span></span> <span data-ttu-id="47647-177">使用者執行個體是以 Access/Jet 模型為基礎，其中資料庫應用程式只會連線到檔案，而使用者會自動擁有所有資料庫物件的完整權限，而不需要系統管理員介入以授與權限。</span><span class="sxs-lookup"><span data-stu-id="47647-177">User instances are based on the Access/Jet model, where the database application simply connects to a file, and the user automatically has full permissions on all of the database objects without needing the intervention of a system administrator to grant permissions.</span></span> <span data-ttu-id="47647-178">在使用者以最低權限使用者帳戶 (LUA) 執行、沒有伺服器或本機電腦的系統管理權限，而且還需要建立資料庫物件與應用程式的情況下，才適用這個情況。</span><span class="sxs-lookup"><span data-stu-id="47647-178">It is intended to work in situations where the user is running under a least-privilege user account (LUA) and does not have administrative privileges on the server or local machine, yet needs to create database objects and applications.</span></span> <span data-ttu-id="47647-179">使用者執行個體可讓使用者在執行階段建立執行個體，並在使用者自己的資訊安全內容下執行，而不是在具備更特殊權限之系統服務的資訊安全內容中執行。</span><span class="sxs-lookup"><span data-stu-id="47647-179">User instances allow users to create instances at run time that run under the user's own security context, and not in the security context of a more privileged system service.</span></span>  
  
> [!IMPORTANT]
> <span data-ttu-id="47647-180">使用者執行個體應只在所有使用該執行個體的應用程式都完全受信任的情況下才使用。</span><span class="sxs-lookup"><span data-stu-id="47647-180">User instances should only be used in scenarios where all the applications using it are fully trusted.</span></span>  
  
 <span data-ttu-id="47647-181">使用者執行個體案例包括：</span><span class="sxs-lookup"><span data-stu-id="47647-181">User instance scenarios include:</span></span>  
  
- <span data-ttu-id="47647-182">任何不需要共用資料的單一使用者應用程式。</span><span class="sxs-lookup"><span data-stu-id="47647-182">Any single-user application where sharing data is not required.</span></span>  
  
- <span data-ttu-id="47647-183">ClickOnce 部署。</span><span class="sxs-lookup"><span data-stu-id="47647-183">ClickOnce deployment.</span></span> <span data-ttu-id="47647-184">如果目的電腦上已安裝 .NET Framework 2.0 (或更新版本的) 和 SQL Server Express，則非系統管理員的使用者可以安裝並使用以 ClickOnce 動作的結果下載的安裝套件。</span><span class="sxs-lookup"><span data-stu-id="47647-184">If .NET Framework 2.0 (or later) and SQL Server Express are already installed on the target computer, the installation package downloaded as a result of a ClickOnce action can be installed and used by non-administrator users.</span></span> <span data-ttu-id="47647-185">請注意，若 SQL Server Express 是安裝程式的一部分，則系統管理員必須加以安裝。</span><span class="sxs-lookup"><span data-stu-id="47647-185">Note that an administrator must install SQL Server Express if that is part of the setup.</span></span> <span data-ttu-id="47647-186">如需詳細資訊，請參閱 [Windows Forms 的 ClickOnce 部署](/dotnet/desktop/winforms/clickonce-deployment-for-windows-forms)。</span><span class="sxs-lookup"><span data-stu-id="47647-186">For more information, see [ClickOnce Deployment for Windows Forms](/dotnet/desktop/winforms/clickonce-deployment-for-windows-forms).</span></span>
  
- <span data-ttu-id="47647-187">使用 Windows 驗證的專用 ASP.NET 裝載。</span><span class="sxs-lookup"><span data-stu-id="47647-187">Dedicated ASP.NET hosting using Windows Authentication.</span></span> <span data-ttu-id="47647-188">單一 SQL Server Express 執行個體可以裝載在內部網路上。</span><span class="sxs-lookup"><span data-stu-id="47647-188">A single SQL Server Express instance can be hosted on an intranet.</span></span> <span data-ttu-id="47647-189">應用程式會使用 ASPNET Windows 帳戶來連線，而不是使用模擬。</span><span class="sxs-lookup"><span data-stu-id="47647-189">The application connects using the ASPNET Windows account, not by using impersonation.</span></span> <span data-ttu-id="47647-190">使用者執行個體不應用於協力廠商或共用裝載案例，其中所有應用程式都會共用相同的使用者執行個體，而且不會再互相保持隔離。</span><span class="sxs-lookup"><span data-stu-id="47647-190">User instances should not be used for third-party or shared hosting scenarios where all applications would share the same user instance and would no longer remain isolated from each other.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="47647-191">另請參閱</span><span class="sxs-lookup"><span data-stu-id="47647-191">See also</span></span>

- <span data-ttu-id="47647-192">[SQL Server and ADO.NET](index.md) (SQL Server 和 ADO.NET)</span><span class="sxs-lookup"><span data-stu-id="47647-192">[SQL Server and ADO.NET](index.md)</span></span>
- [<span data-ttu-id="47647-193">連接字串</span><span class="sxs-lookup"><span data-stu-id="47647-193">Connection Strings</span></span>](../connection-strings.md)
- [<span data-ttu-id="47647-194">連接到資料來源</span><span class="sxs-lookup"><span data-stu-id="47647-194">Connecting to a Data Source</span></span>](../connecting-to-a-data-source.md)
- <span data-ttu-id="47647-195">[ADO.NET 概觀](../ado-net-overview.md) \(部分機器翻譯\)</span><span class="sxs-lookup"><span data-stu-id="47647-195">[ADO.NET Overview](../ado-net-overview.md)</span></span>

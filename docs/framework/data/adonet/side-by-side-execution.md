---
title: 並存執行
ms.date: 03/30/2017
ms.assetid: 9f9ba96d-9f89-4f65-bb2f-6860879f4393
ms.openlocfilehash: 609fc7b7cefd92e38ecfff54e5ac1651e855e4b7
ms.sourcegitcommit: 5b475c1855b32cf78d2d1bbb4295e4c236f39464
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/24/2020
ms.locfileid: "91188934"
---
# <a name="side-by-side-execution-in-adonet"></a><span data-ttu-id="8f6f6-102">ADO.NET 中的並存執行</span><span class="sxs-lookup"><span data-stu-id="8f6f6-102">Side-by-Side Execution in ADO.NET</span></span>

<span data-ttu-id="8f6f6-103">.NET Framework 中並存執行的能力，是能夠在已安裝多個版本 .NET Framework 的電腦上執行應用程式，以獨佔方式使用已編譯應用程式的版本。</span><span class="sxs-lookup"><span data-stu-id="8f6f6-103">Side-by-side execution in the .NET Framework is the ability to execute an application on a computer that has multiple versions of the .NET Framework installed, exclusively using the version for which the application was compiled.</span></span> <span data-ttu-id="8f6f6-104">如需有關設定並存執行的詳細資訊，請參閱 [並存執行](../../deployment/side-by-side-execution.md)。</span><span class="sxs-lookup"><span data-stu-id="8f6f6-104">For detailed information about configuring side-by-side execution, see [Side-by-Side Execution](../../deployment/side-by-side-execution.md).</span></span>  
  
 <span data-ttu-id="8f6f6-105">使用一個 .NET Framework 版本編譯的應用程式可以在不同版本的 .NET Framework 上執行。</span><span class="sxs-lookup"><span data-stu-id="8f6f6-105">An application compiled by using one version of the .NET Framework can run on a different version of the .NET Framework.</span></span> <span data-ttu-id="8f6f6-106">不過，我們建議您針對每個已安裝的 .NET Framework 版本，編譯應用程式的版本，並個別加以執行。</span><span class="sxs-lookup"><span data-stu-id="8f6f6-106">However, we recommend that you compile a version of the application for each installed version of the .NET Framework, and run them separately.</span></span> <span data-ttu-id="8f6f6-107">在這兩種情況下，您應該留意 ADO.NET 之間的變更，這些版本可能會影響應用程式的向前相容性或回溯相容性。</span><span class="sxs-lookup"><span data-stu-id="8f6f6-107">In either scenario, you should be aware of changes in ADO.NET between releases that can affect the forward compatibility or backward compatibility of your application.</span></span>  
  
## <a name="forward-compatibility-and-backward-compatibility"></a><span data-ttu-id="8f6f6-108">向前相容性和回溯相容性</span><span class="sxs-lookup"><span data-stu-id="8f6f6-108">Forward Compatibility and Backward Compatibility</span></span>  

 <span data-ttu-id="8f6f6-109">向前相容性表示可以使用舊版的 .NET Framework 來編譯應用程式，但仍可在較新版本的 .NET Framework 上順利執行。</span><span class="sxs-lookup"><span data-stu-id="8f6f6-109">Forward compatibility means that an application can be compiled with an earlier version of the .NET Framework, but will still run successfully on a later version of the .NET Framework.</span></span> <span data-ttu-id="8f6f6-110">針對 .NET Framework 版本1.1 撰寫的 ADO.NET 程式碼會向前相容于較新的版本。</span><span class="sxs-lookup"><span data-stu-id="8f6f6-110">ADO.NET code written for the .NET Framework version 1.1 is forward compatible with later versions.</span></span>  
  
 <span data-ttu-id="8f6f6-111">回溯相容性表示會針對較新版本的 .NET Framework 編譯應用程式，但會繼續在舊版 .NET Framework 上執行，而不會遺失任何功能。</span><span class="sxs-lookup"><span data-stu-id="8f6f6-111">Backward compatibility means that an application is compiled for a newer version of the .NET Framework, but continues to run on earlier versions of the .NET Framework without any loss of functionality.</span></span> <span data-ttu-id="8f6f6-112">當然，這並不是 .NET Framework 新版本所引進之功能的情況。</span><span class="sxs-lookup"><span data-stu-id="8f6f6-112">Of course, this will not be the case for features introduced in a new version of the .NET Framework.</span></span>  
  
## <a name="the-net-framework-data-provider-for-odbc"></a><span data-ttu-id="8f6f6-113">ODBC 的 .NET Framework 資料提供者</span><span class="sxs-lookup"><span data-stu-id="8f6f6-113">The .NET Framework Data Provider for ODBC</span></span>  

 <span data-ttu-id="8f6f6-114">從1.1 版開始，ODBC () 的 .NET Framework Data Provider <xref:System.Data.Odbc> 會納入為 .NET Framework 的一部分。</span><span class="sxs-lookup"><span data-stu-id="8f6f6-114">Starting with version 1.1, the .NET Framework Data Provider for ODBC (<xref:System.Data.Odbc>) is included as a part of the .NET Framework.</span></span>
  
 <span data-ttu-id="8f6f6-115">如果您針對使用 ODBC 資料提供者連接到資料來源的 .NET Framework 版本1.0 開發應用程式，而且想要在 .NET Framework 1.1 版或更新版本上執行該應用程式，則必須將 ODBC 資料提供者的命名空間更新為 **system.object**。</span><span class="sxs-lookup"><span data-stu-id="8f6f6-115">If you have an application developed for the .NET Framework version 1.0 that uses the ODBC data provider to connect to your data source, and you want to run that application on the .NET Framework version 1.1 or a later version, you must update the namespace for the ODBC data provider to **System.Data.Odbc**.</span></span> <span data-ttu-id="8f6f6-116">然後，您必須針對較新版本的 .NET Framework 重新編譯它。</span><span class="sxs-lookup"><span data-stu-id="8f6f6-116">You then must recompile it for the newer version of the .NET Framework.</span></span>  
  
 <span data-ttu-id="8f6f6-117">如果您針對使用 ODBC 資料提供者連接到資料來源的 .NET Framework 2.0 版或更新版本所開發的應用程式，而且您想要在 .NET Framework 1.0 版上執行該應用程式，則必須下載 ODBC 資料提供者，並將它安裝在 .NET Framework 1.0 版系統上。</span><span class="sxs-lookup"><span data-stu-id="8f6f6-117">If you have an application developed for the .NET Framework version 2.0 or later that uses the ODBC data provider to connect to your data source, and you want to run that application on the .NET Framework version 1.0, you must download the ODBC data provider and install it on the .NET Framework version 1.0 system.</span></span> <span data-ttu-id="8f6f6-118">接著，您必須將 ODBC 資料提供者的命名空間變更為 **node.js，然後**針對 .NET Framework 版本1.0 重新編譯應用程式。</span><span class="sxs-lookup"><span data-stu-id="8f6f6-118">You then must change the namespace for the ODBC data provider to **Microsoft.Data.Odbc**, and recompile the application for the .NET Framework version 1.0.</span></span>  
  
## <a name="the-net-framework-data-provider-for-oracle"></a><span data-ttu-id="8f6f6-119">Oracle 的 .NET Framework 資料提供者</span><span class="sxs-lookup"><span data-stu-id="8f6f6-119">The .NET Framework Data Provider for Oracle</span></span>  

 <span data-ttu-id="8f6f6-120">從1.1 版開始，Oracle () 的 .NET Framework Data Provider <xref:System.Data.OracleClient> 會納入為 .NET Framework 的一部分。</span><span class="sxs-lookup"><span data-stu-id="8f6f6-120">Starting with version 1.1, the .NET Framework Data Provider for Oracle (<xref:System.Data.OracleClient>) is included as a part of the .NET Framework.</span></span>
  
 <span data-ttu-id="8f6f6-121">如果您已針對 .NET Framework 2.0 版或更新版本所開發的應用程式使用資料提供者連接到您的資料來源，而您想要在 .NET Framework 1.0 版上執行該應用程式，則必須下載資料提供者，並將它安裝在 .NET Framework 1.0 版系統上。</span><span class="sxs-lookup"><span data-stu-id="8f6f6-121">If you have an application developed for the .NET Framework version 2.0 or later that uses the data provider to connect to your data source, and you want to run that application on the .NET Framework version 1.0, you must download the data provider and install it on the .NET Framework version 1.0 system.</span></span>  
  
## <a name="code-access-security"></a><span data-ttu-id="8f6f6-122">程式碼存取安全性</span><span class="sxs-lookup"><span data-stu-id="8f6f6-122">Code Access Security</span></span>  

 <span data-ttu-id="8f6f6-123">.NET Framework 1.0 版 (中的 .NET Framework 資料提供者 <xref:System.Data.SqlClient> ， <xref:System.Data.OleDb>) 必須以 FullTrust 許可權執行。</span><span class="sxs-lookup"><span data-stu-id="8f6f6-123">The .NET Framework data providers in the .NET Framework version 1.0 (<xref:System.Data.SqlClient>, <xref:System.Data.OleDb>) are required to run with FullTrust permission.</span></span> <span data-ttu-id="8f6f6-124">嘗試在許可權低於 FullTrust 的區域中，使用 .NET Framework 1.0 版的 .NET Framework k 資料提供者，會導致 <xref:System.Security.SecurityException> 。</span><span class="sxs-lookup"><span data-stu-id="8f6f6-124">Any attempt to use the .NET Framework k data providers from the .NET Framework version 1.0 in a zone with less than FullTrust permission causes a <xref:System.Security.SecurityException>.</span></span>  
  
 <span data-ttu-id="8f6f6-125">不過，從 .NET Framework 版本2.0 開始，所有 .NET Framework 資料提供者都可以在部分信任的區域中使用。</span><span class="sxs-lookup"><span data-stu-id="8f6f6-125">However, starting with the .NET Framework version 2.0, all of the .NET Framework data providers can be used in partially trusted zones.</span></span> <span data-ttu-id="8f6f6-126">此外，已將新的安全性功能新增至 .NET Framework 1.1 版的 .NET Framework 資料提供者。</span><span class="sxs-lookup"><span data-stu-id="8f6f6-126">In addition, a new security feature was added to the .NET Framework data providers in the .NET Framework version 1.1.</span></span> <span data-ttu-id="8f6f6-127">這個功能可讓您限制能在特定安全性區域中使用的連接字串。</span><span class="sxs-lookup"><span data-stu-id="8f6f6-127">This feature enables you to restrict what connection strings can be used in a particular security zone.</span></span> <span data-ttu-id="8f6f6-128">您也可以在特定安全性地區內停用空白密碼。</span><span class="sxs-lookup"><span data-stu-id="8f6f6-128">You can also disable the use of blank passwords for a particular security zone.</span></span> <span data-ttu-id="8f6f6-129">如需詳細資訊，請參閱 [Code Access Security and ADO.NET](code-access-security.md)。</span><span class="sxs-lookup"><span data-stu-id="8f6f6-129">For more information, see [Code Access Security and ADO.NET](code-access-security.md).</span></span>  
  
 <span data-ttu-id="8f6f6-130">因為 .NET Framework 的每個安裝都有個別的 Security.config 檔案，所以沒有安全性設定的相容性問題。</span><span class="sxs-lookup"><span data-stu-id="8f6f6-130">Because each installation of the .NET Framework has a separate Security.config file, there are no compatibility issues with security settings.</span></span> <span data-ttu-id="8f6f6-131">但是，如果您的應用程式相依于 .NET Framework 1.1 版和更新版本中所包含之 ADO.NET 的額外安全性功能，您將無法將其散發至1.0 版系統。</span><span class="sxs-lookup"><span data-stu-id="8f6f6-131">However, if your application depends on the additional security capabilities of ADO.NET included in the .NET Framework version 1.1 and later, you will not be able to distribute it to a version 1.0 system.</span></span>  
  
## <a name="sqlcommand-execution"></a><span data-ttu-id="8f6f6-132">SqlCommand 之執行</span><span class="sxs-lookup"><span data-stu-id="8f6f6-132">SqlCommand Execution</span></span>  

 <span data-ttu-id="8f6f6-133">從 .NET Framework 版本1.1 開始，在 <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> 資料來源執行命令的方式已變更。</span><span class="sxs-lookup"><span data-stu-id="8f6f6-133">Starting with the .NET Framework version 1.1, the way that <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> executes commands at the data source was changed.</span></span>  
  
 <span data-ttu-id="8f6f6-134">在 .NET Framework 1.0 版中，會 <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> 在 **sp_executesql** 預存程式的內容中執行所有命令。</span><span class="sxs-lookup"><span data-stu-id="8f6f6-134">In the .NET Framework version 1.0, <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> executed all commands in the context of the **sp_executesql** stored procedure.</span></span> <span data-ttu-id="8f6f6-135">結果，凡是會影響連接狀態的命令 (例如，SET NOCOUNT ON) 只適用於目前命令的執行。</span><span class="sxs-lookup"><span data-stu-id="8f6f6-135">As a result, commands that affect the state of the connection (for example, SET NOCOUNT ON), only apply to the execution of the current command.</span></span> <span data-ttu-id="8f6f6-136">若連接已開啟，連接狀態就不會因為任何後續命令的執行而被修改。</span><span class="sxs-lookup"><span data-stu-id="8f6f6-136">The state of the connection is not modified for any subsequent commands executed while the connection is open.</span></span>  
  
 <span data-ttu-id="8f6f6-137">在 .NET Framework 1.1 版和更新版本中， <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> 只有當命令包含可提供效能優勢的參數時，才會在 **sp_executesql** 預存程式的內容中執行命令。</span><span class="sxs-lookup"><span data-stu-id="8f6f6-137">In the .NET Framework version 1.1 and later, <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> only executes a command in the context of the **sp_executesql** stored procedure if the command contains parameters, which provides a performance benefit.</span></span> <span data-ttu-id="8f6f6-138">這樣的結果是，若連接已開啟，凡是會影響連接狀態的命令 (它包含於非參數化命令中) 都會修改已執行之所有後續命令的連接狀態。</span><span class="sxs-lookup"><span data-stu-id="8f6f6-138">As a result, if a command affecting the state of the connection is included in a non-parameterized command, it modifies the state of the connection for all subsequent commands executed while the connection is open.</span></span>  
  
 <span data-ttu-id="8f6f6-139">請考慮使用下列在 <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> 呼叫中執行的命令批次。</span><span class="sxs-lookup"><span data-stu-id="8f6f6-139">Consider the following batch of commands executed in a call to <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A>.</span></span>  
  
```sql
SET NOCOUNT ON;  
SELECT * FROM dbo.Customers;  
```  
  
 <span data-ttu-id="8f6f6-140">在 .NET Framework 1.1 版和更新版本中，當連接開啟時，NOCOUNT 會針對執行的任何後續命令保持開啟狀態。</span><span class="sxs-lookup"><span data-stu-id="8f6f6-140">In the .NET Framework version 1.1 and later, NOCOUNT will remain ON for any subsequent commands executed while the connection is open.</span></span> <span data-ttu-id="8f6f6-141">在 .NET Framework 1.0 版中，NOCOUNT 僅適用于目前的命令執行。</span><span class="sxs-lookup"><span data-stu-id="8f6f6-141">In the .NET Framework version 1.0, NOCOUNT is only ON for the current command execution.</span></span>  
  
 <span data-ttu-id="8f6f6-142">如果您相依于任一 .NET Framework 版本的行為，這項變更可能會影響應用程式的向前和回溯相容性 <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> 。</span><span class="sxs-lookup"><span data-stu-id="8f6f6-142">This change can affect both the forward and backward compatibility of your application if you depend on the behavior of <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> for either version of the .NET Framework.</span></span>  
  
 <span data-ttu-id="8f6f6-143">針對在 .NET Framework 舊版和更新版本上執行的應用程式，您可以撰寫程式碼，以確定無論您正在執行的版本為何，行為都相同。</span><span class="sxs-lookup"><span data-stu-id="8f6f6-143">For applications that run on both earlier and later versions of the .NET Framework, you can write your code to make sure that the behavior is the same regardless of the version you are running on.</span></span> <span data-ttu-id="8f6f6-144">如果您想要確保某個命令會針對所有後續命令修改連接的狀態，我們建議您使用 <xref:System.Data.SqlClient.SqlCommand.ExecuteNonQuery%2A> 來執行命令。</span><span class="sxs-lookup"><span data-stu-id="8f6f6-144">If you want to make sure that a command modifies the state of the connection for all subsequent commands, we recommend that you execute your command using <xref:System.Data.SqlClient.SqlCommand.ExecuteNonQuery%2A>.</span></span> <span data-ttu-id="8f6f6-145">如果您想要確保命令不會針對所有後續命令修改連接，則我們建議您在命令中加入要重設連接狀態的命令。</span><span class="sxs-lookup"><span data-stu-id="8f6f6-145">If you want to make sure that a command does not modify the connection for all subsequent commands, we recommend that you include the commands to reset the state of the connection in your command.</span></span> <span data-ttu-id="8f6f6-146">例如：</span><span class="sxs-lookup"><span data-stu-id="8f6f6-146">For example:</span></span>  
  
```sql
SET NOCOUNT ON;  
SELECT * FROM dbo.Customers;  
SET NOCOUNT OFF;  
```  
  
## <a name="see-also"></a><span data-ttu-id="8f6f6-147">另請參閱</span><span class="sxs-lookup"><span data-stu-id="8f6f6-147">See also</span></span>

- <span data-ttu-id="8f6f6-148">[ADO.NET 概觀](ado-net-overview.md) \(部分機器翻譯\)</span><span class="sxs-lookup"><span data-stu-id="8f6f6-148">[ADO.NET Overview](ado-net-overview.md)</span></span>
- [<span data-ttu-id="8f6f6-149">在 ADO.NET 中傳送和修改資料</span><span class="sxs-lookup"><span data-stu-id="8f6f6-149">Retrieving and Modifying Data in ADO.NET</span></span>](retrieving-and-modifying-data.md)

---
title: 將資料繫結至控制項 (WCF 資料服務)
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- client applications, WCF Data Services
- WCF Data Services, client library
- data binding, WCF Data Services
ms.assetid: b32e1d49-c214-4cb1-867e-88fbb3d08c8d
ms.openlocfilehash: 178d77c225144497982487afa00f4493e17d1744
ms.sourcegitcommit: 636af37170ae75a11c4f7d1ecd770820e7dfe7bd
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/07/2020
ms.locfileid: "91805209"
---
# <a name="binding-data-to-controls-wcf-data-services"></a><span data-ttu-id="76e0d-102">將資料繫結至控制項 (WCF 資料服務)</span><span class="sxs-lookup"><span data-stu-id="76e0d-102">Binding Data to Controls (WCF Data Services)</span></span>

<span data-ttu-id="76e0d-103">使用 WCF Data Services，您可以將控制項（例如和控制項）系結 `ComboBox` `ListView` 至類別的實例 <xref:System.Data.Services.Client.DataServiceCollection%601> 。</span><span class="sxs-lookup"><span data-stu-id="76e0d-103">With WCF Data Services, you can bind controls such as the `ComboBox` and `ListView` controls to an instance of the <xref:System.Data.Services.Client.DataServiceCollection%601> class.</span></span> <span data-ttu-id="76e0d-104">繼承自類別的這個集合 <xref:System.Collections.ObjectModel.ObservableCollection%601> 包含開放式資料通訊協定 (OData) 摘要中的資料。</span><span class="sxs-lookup"><span data-stu-id="76e0d-104">This collection, which inherits from the <xref:System.Collections.ObjectModel.ObservableCollection%601> class, contains the data from an Open Data Protocol (OData) feed.</span></span> <span data-ttu-id="76e0d-105">此類別表示動態資料集合會在加入或移除項目時提供通知。</span><span class="sxs-lookup"><span data-stu-id="76e0d-105">This class represents a dynamic data collection that provides notifications when items get added or removed.</span></span> <span data-ttu-id="76e0d-106">當您使用的實例進行資料系結時 <xref:System.Data.Services.Client.DataServiceCollection%601> ，WCF Data Services 的用戶端程式庫會處理這些事件，以確保所追蹤的物件會與系結 <xref:System.Data.Services.Client.DataServiceContext> UI 專案中的資料保持同步。</span><span class="sxs-lookup"><span data-stu-id="76e0d-106">When you use an instance of <xref:System.Data.Services.Client.DataServiceCollection%601> for data binding, the WCF Data Services client libraries handle these events to ensure that objects tracked by the <xref:System.Data.Services.Client.DataServiceContext> remain synchronized with the data in the bound UI element.</span></span>  
  
 <span data-ttu-id="76e0d-107">在集合中加入或移除物件時，<xref:System.Data.Services.Client.DataServiceCollection%601> 類別會 (間接) 實作 <xref:System.Collections.Specialized.INotifyCollectionChanged> 介面以警示內容。</span><span class="sxs-lookup"><span data-stu-id="76e0d-107">The <xref:System.Data.Services.Client.DataServiceCollection%601> class (indirectly) implements the <xref:System.Collections.Specialized.INotifyCollectionChanged> interface to alert the context when objects are added to or removed from the collection.</span></span> <span data-ttu-id="76e0d-108">與 <xref:System.Data.Services.Client.DataServiceCollection%601> 搭配使用的資料服務類型物件也必須實作 <xref:System.ComponentModel.INotifyPropertyChanged> 介面，以便在繫結集合中的物件屬性發生變更時警示 <xref:System.Data.Services.Client.DataServiceCollection%601>。</span><span class="sxs-lookup"><span data-stu-id="76e0d-108">Data service type objects used with a <xref:System.Data.Services.Client.DataServiceCollection%601> must also implement the <xref:System.ComponentModel.INotifyPropertyChanged> interface to alert the <xref:System.Data.Services.Client.DataServiceCollection%601> when properties of objects in the binding collection have changed.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="76e0d-109">當您使用 [ **加入服務參考** ] 對話方塊或 [ [DataSvcUtil.exe](wcf-data-service-client-utility-datasvcutil-exe.md) ] 工具搭配 `/dataservicecollection` 選項來產生用戶端資料服務類別時，產生的資料類別會執行 <xref:System.ComponentModel.INotifyPropertyChanged> 介面。</span><span class="sxs-lookup"><span data-stu-id="76e0d-109">When you use the **Add Service Reference** dialog or the [DataSvcUtil.exe](wcf-data-service-client-utility-datasvcutil-exe.md) tool with the `/dataservicecollection` option to generate the client data service classes, the generated data classes implement the <xref:System.ComponentModel.INotifyPropertyChanged> interface.</span></span> <span data-ttu-id="76e0d-110">如需詳細資訊，請參閱 [如何：手動產生用戶端資料服務類別](how-to-manually-generate-client-data-service-classes-wcf-data-services.md)。</span><span class="sxs-lookup"><span data-stu-id="76e0d-110">For more information, see [How to: Manually Generate Client Data Service Classes](how-to-manually-generate-client-data-service-classes-wcf-data-services.md).</span></span>  
  
## <a name="creating-the-binding-collection"></a><span data-ttu-id="76e0d-111">建立繫結集合</span><span class="sxs-lookup"><span data-stu-id="76e0d-111">Creating the Binding Collection</span></span>  

 <span data-ttu-id="76e0d-112">以提供的 <xref:System.Data.Services.Client.DataServiceCollection%601> 執行個體及選擇性的 <xref:System.Data.Services.Client.DataServiceContext> 或 LINQ 查詢 (執行此查詢時會傳回 <xref:System.Data.Services.Client.DataServiceQuery%601> 執行個體) 呼叫其中一個類別建構函式方法，建立一個新的 <xref:System.Collections.Generic.IEnumerable%601> 類別執行個體。</span><span class="sxs-lookup"><span data-stu-id="76e0d-112">Create a new instance of the <xref:System.Data.Services.Client.DataServiceCollection%601> class by calling one of the class constructor methods with a supplied <xref:System.Data.Services.Client.DataServiceContext> instance and optionally a <xref:System.Data.Services.Client.DataServiceQuery%601> or LINQ query that, when it is executed, returns an <xref:System.Collections.Generic.IEnumerable%601> instance.</span></span> <span data-ttu-id="76e0d-113">這 <xref:System.Collections.Generic.IEnumerable%601> 會提供系結集合的物件來源，這些物件是從 OData 摘要具體化而來。</span><span class="sxs-lookup"><span data-stu-id="76e0d-113">This <xref:System.Collections.Generic.IEnumerable%601> provides the source of objects for the binding collection, which are materialized from an OData feed.</span></span> <span data-ttu-id="76e0d-114">如需詳細資訊，請參閱 [物件具體化](object-materialization-wcf-data-services.md)。</span><span class="sxs-lookup"><span data-stu-id="76e0d-114">For more information, see [Object Materialization](object-materialization-wcf-data-services.md).</span></span> <span data-ttu-id="76e0d-115">根據預設，<xref:System.Data.Services.Client.DataServiceContext>會自動追蹤對插入於集合中的繫結物件和項目所進行的變更。</span><span class="sxs-lookup"><span data-stu-id="76e0d-115">By default, changes made to bound objects and items inserted into the collection are automatically tracked by the <xref:System.Data.Services.Client.DataServiceContext>.</span></span> <span data-ttu-id="76e0d-116">如果您需要手動追蹤這些變更，請呼叫其中一個採用參數的方法， `trackingMode` 並指定的值 <xref:System.Data.Services.Client.TrackingMode.None> 。</span><span class="sxs-lookup"><span data-stu-id="76e0d-116">If you need to manually track these changes, call one of the constructor methods that takes a `trackingMode` parameter and specify a value of <xref:System.Data.Services.Client.TrackingMode.None>.</span></span>  
  
 <span data-ttu-id="76e0d-117">下列範例示範如何根據所提供的 <xref:System.Data.Services.Client.DataServiceCollection%601> 以及傳回所有客戶與相關訂單的 <xref:System.Data.Services.Client.DataServiceContext> 建立 <xref:System.Data.Services.Client.DataServiceQuery%601> 執行個體。</span><span class="sxs-lookup"><span data-stu-id="76e0d-117">The following example shows how to create an instance of <xref:System.Data.Services.Client.DataServiceCollection%601> based on a supplied <xref:System.Data.Services.Client.DataServiceContext> and a <xref:System.Data.Services.Client.DataServiceQuery%601> that returns all customers with related orders:</span></span>  
  
 [!code-csharp[Astoria Northwind Client#CustomersOrders2Binding](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria_northwind_client/cs/customerorders2.cs#customersorders2binding)]
 [!code-vb[Astoria Northwind Client#CustomersOrders2Binding](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_northwind_client/vb/customerorders2.vb#customersorders2binding)]  
  
## <a name="binding-data-to-windows-presentation-foundation-elements"></a><span data-ttu-id="76e0d-118">繫結資料至 Windows Presentation Foundation 項目</span><span class="sxs-lookup"><span data-stu-id="76e0d-118">Binding Data to Windows Presentation Foundation Elements</span></span>  

 <span data-ttu-id="76e0d-119">由於 <xref:System.Data.Services.Client.DataServiceCollection%601> 類別繼承自 <xref:System.Collections.ObjectModel.ObservableCollection%601> 類別，因此您可以在 Windows Presentation Foundation (WPF) 應用程式中將物件繫結至項目或控制項，就像使用 <xref:System.Collections.ObjectModel.ObservableCollection%601> 類別進行繫結一樣。</span><span class="sxs-lookup"><span data-stu-id="76e0d-119">Because the <xref:System.Data.Services.Client.DataServiceCollection%601> class inherits from the <xref:System.Collections.ObjectModel.ObservableCollection%601> class, you can bind objects to an element, or control, in a Windows Presentation Foundation (WPF) application as you would when using the <xref:System.Collections.ObjectModel.ObservableCollection%601> class for binding.</span></span> <span data-ttu-id="76e0d-120">如需詳細資訊，請參閱 [ (Windows Presentation Foundation) 的資料 ](/dotnet/desktop/wpf/data/data-binding-overview)系結。</span><span class="sxs-lookup"><span data-stu-id="76e0d-120">For more information, see [Data Binding (Windows Presentation Foundation)](/dotnet/desktop/wpf/data/data-binding-overview).</span></span> <span data-ttu-id="76e0d-121">繫結資料服務資料至 WPF 控制項的其中一個方法是將項目的 `DataContext` 屬性設定為包含查詢結果之 <xref:System.Data.Services.Client.DataServiceCollection%601> 類別的執行個體。</span><span class="sxs-lookup"><span data-stu-id="76e0d-121">One way to bind data service data to WPF controls is to set the `DataContext` property of the element to the instance of the <xref:System.Data.Services.Client.DataServiceCollection%601> class that contains the query result.</span></span> <span data-ttu-id="76e0d-122">在這種情況下，您可以使用 <xref:System.Windows.Controls.ItemsControl.ItemsSource%2A> 屬性來設定控制項的物件來源。</span><span class="sxs-lookup"><span data-stu-id="76e0d-122">In this case, you use the <xref:System.Windows.Controls.ItemsControl.ItemsSource%2A> property to set the object source for the control.</span></span> <span data-ttu-id="76e0d-123">使用 <xref:System.Windows.Controls.ItemsControl.DisplayMemberPath%2A> 屬性來指定要顯示繫結物件的哪一個屬性。</span><span class="sxs-lookup"><span data-stu-id="76e0d-123">Use the <xref:System.Windows.Controls.ItemsControl.DisplayMemberPath%2A> property to specify which property of the bound object to display.</span></span> <span data-ttu-id="76e0d-124">如果您要將項目繫結程序至導覽屬性所傳回的相關物件，請在為 <xref:System.Windows.Controls.ItemsControl.ItemsSource%2A> 屬性定義的繫結程序中加入路徑。</span><span class="sxs-lookup"><span data-stu-id="76e0d-124">If you are binding an element to a related object that is returned by a navigation property, include the path in the binding defined for the <xref:System.Windows.Controls.ItemsControl.ItemsSource%2A> property.</span></span> <span data-ttu-id="76e0d-125">這個路徑是相對於父控制項 <xref:System.Windows.FrameworkElement.DataContext%2A> 屬性所設定根物件的位置。</span><span class="sxs-lookup"><span data-stu-id="76e0d-125">This path is relative to the root object set by the <xref:System.Windows.FrameworkElement.DataContext%2A> property of the parent control.</span></span> <span data-ttu-id="76e0d-126">下列範例會設定 <xref:System.Windows.FrameworkElement.DataContext%2A> 項目的 <xref:System.Windows.Controls.StackPanel> 屬性，將父控制項繫結至客戶物件的 <xref:System.Data.Services.Client.DataServiceCollection%601>：</span><span class="sxs-lookup"><span data-stu-id="76e0d-126">The following example sets the <xref:System.Windows.FrameworkElement.DataContext%2A> property of a <xref:System.Windows.Controls.StackPanel> element to bind the parent control to an <xref:System.Data.Services.Client.DataServiceCollection%601> of customer objects:</span></span>  
  
 [!code-csharp[Astoria Northwind Client#MasterDetailBinding](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria_northwind_client/cs/customerorderscustom.xaml.cs#masterdetailbinding)]
 [!code-csharp[Astoria Northwind Client#MasterDetailBinding](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria_northwind_client/cs/customerorderswpf.xaml.cs#masterdetailbinding)]
 [!code-vb[Astoria Northwind Client#MasterDetailBinding](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_northwind_client/vb/customerorderscustom.xaml.vb#masterdetailbinding)]
 [!code-vb[Astoria Northwind Client#MasterDetailBinding](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_northwind_client/vb/customerorderswpf.xaml.vb#masterdetailbinding)]
 [!code-vb[Astoria Northwind Client#MasterDetailBinding](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_northwind_client/vb/customerorderscustom2.xaml.vb#masterdetailbinding)]  
  
 <span data-ttu-id="76e0d-127">下列範例顯示子控制項 <xref:System.Windows.Controls.DataGrid> 和 <xref:System.Windows.Controls.ComboBox> 的 XAML 繫結定義：</span><span class="sxs-lookup"><span data-stu-id="76e0d-127">The following example shows the XAML binding definition of the child <xref:System.Windows.Controls.DataGrid> and <xref:System.Windows.Controls.ComboBox> controls:</span></span>  
  
 [!code-xaml[Astoria Northwind Client#MasterDetailXaml](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_northwind_client/vb/customerorderswpf.xaml#masterdetailxaml)]  
  
 <span data-ttu-id="76e0d-128">如需詳細資訊，請參閱 [如何：將資料系結至 Windows Presentation Foundation 元素](bind-data-to-wpf-elements-wcf-data-services.md)。</span><span class="sxs-lookup"><span data-stu-id="76e0d-128">For more information, see [How to: Bind Data to Windows Presentation Foundation Elements](bind-data-to-wpf-elements-wcf-data-services.md).</span></span>  
  
 <span data-ttu-id="76e0d-129">實體加入一對多或多對多關聯性時，關聯性的導覽屬性會傳回相關物件集合。</span><span class="sxs-lookup"><span data-stu-id="76e0d-129">When an entity participates in a one-to-many or many-to-many relationship, the navigation property for the relationship returns a collection of related objects.</span></span> <span data-ttu-id="76e0d-130">當您使用 [ **加入服務參考** ] 對話方塊或 DataSvcUtil.exe 工具來產生用戶端資料服務類別時，導覽屬性會傳回的實例 <xref:System.Data.Services.Client.DataServiceCollection%601> 。</span><span class="sxs-lookup"><span data-stu-id="76e0d-130">When you use the **Add Service Reference** dialog box or the DataSvcUtil.exe tool to generate the client data service classes, the navigation property returns an instance of <xref:System.Data.Services.Client.DataServiceCollection%601>.</span></span> <span data-ttu-id="76e0d-131">這樣可讓您將相關物件繫結至控制項，同時支援一般的 WPF 繫結案例，例如相關實體的主版詳細資料繫結模式。</span><span class="sxs-lookup"><span data-stu-id="76e0d-131">This enables you to bind related objects to a control, and support common WPF binding scenarios, such as the master-detail binding pattern for related entities.</span></span> <span data-ttu-id="76e0d-132">在前述的 XAML 範例中，XAML 程式碼會將主版 <xref:System.Data.Services.Client.DataServiceCollection%601> 繫結至根資料項目。</span><span class="sxs-lookup"><span data-stu-id="76e0d-132">In the previous XAML example, the XAML code binds the master <xref:System.Data.Services.Client.DataServiceCollection%601> to the root data element.</span></span> <span data-ttu-id="76e0d-133">接著會將訂單 <xref:System.Windows.Controls.DataGrid> 繫結至從所選 Customers 物件傳回的 Orders <xref:System.Data.Services.Client.DataServiceCollection%601>，然後再繫結至 <xref:System.Windows.Window> 的根項目。</span><span class="sxs-lookup"><span data-stu-id="76e0d-133">The order <xref:System.Windows.Controls.DataGrid> is then bound to the Orders <xref:System.Data.Services.Client.DataServiceCollection%601> returned from the selected Customers object, which is in turn bound to the root data element of the <xref:System.Windows.Window>.</span></span>  
  
## <a name="binding-data-to-windows-forms-controls"></a><span data-ttu-id="76e0d-134">將資料繫結至 Windows Form 控制項</span><span class="sxs-lookup"><span data-stu-id="76e0d-134">Binding Data to Windows Forms Controls</span></span>  

 <span data-ttu-id="76e0d-135">若要將物件繫結至 Windows Form 控制項，請將控制項的 `DataSource` 屬性設定為包含查詢結果之 <xref:System.Data.Services.Client.DataServiceCollection%601> 類別的執行個體。</span><span class="sxs-lookup"><span data-stu-id="76e0d-135">To bind objects to a Windows Form control, set the `DataSource` property of the control to the instance of the <xref:System.Data.Services.Client.DataServiceCollection%601> class that contains the query result.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="76e0d-136">只有接聽變更事件的控制項才支援資料繫結，透過的方式是實作 <xref:System.Collections.Specialized.INotifyCollectionChanged> 和 <xref:System.ComponentModel.INotifyPropertyChanged> 介面。</span><span class="sxs-lookup"><span data-stu-id="76e0d-136">Data binding is only supported for controls that listen for change events by implementing the <xref:System.Collections.Specialized.INotifyCollectionChanged> and <xref:System.ComponentModel.INotifyPropertyChanged> interfaces.</span></span> <span data-ttu-id="76e0d-137">當控制項不支援這種變更通知時，對基礎 <xref:System.Data.Services.Client.DataServiceCollection%601> 所做的變更不會反映在繫結控制項中。</span><span class="sxs-lookup"><span data-stu-id="76e0d-137">When a control does not support this kind of change notification, changes that are made to the underlying <xref:System.Data.Services.Client.DataServiceCollection%601> are not reflected in the bound control.</span></span>  
  
 <span data-ttu-id="76e0d-138">下列範例會將 <xref:System.Data.Services.Client.DataServiceCollection%601> 繫結到 <xref:System.Windows.Forms.ComboBox> 控制項：</span><span class="sxs-lookup"><span data-stu-id="76e0d-138">The following example binds an <xref:System.Data.Services.Client.DataServiceCollection%601> to a <xref:System.Windows.Forms.ComboBox> control:</span></span>  
  
 [!code-csharp[Astoria Northwind Client#CustomersOrdersDataBindingSpecific](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria_northwind_client/cs/customerorders.cs#customersordersdatabindingspecific)]
 [!code-vb[Astoria Northwind Client#CustomersOrdersDataBindingSpecific](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_northwind_client/vb/customerorders.vb#customersordersdatabindingspecific)]  
  
 <span data-ttu-id="76e0d-139">當您使用 **加入服務參考** 對話方塊來產生用戶端資料服務類別時，也會根據產生的來建立專案資料來源 <xref:System.Data.Services.Client.DataServiceContext> 。</span><span class="sxs-lookup"><span data-stu-id="76e0d-139">When you use the **Add Service Reference** dialog to generate the client data service classes, a project data source is also created that is based on the generated <xref:System.Data.Services.Client.DataServiceContext>.</span></span> <span data-ttu-id="76e0d-140">透過此資料來源，您只要從 [ **資料來源** ] 視窗將專案拖曳至設計工具，即可建立 UI 元素或控制項，以顯示資料服務中的資料。</span><span class="sxs-lookup"><span data-stu-id="76e0d-140">With this data source, you can create UI elements or controls that display data from the data service simply by dragging items from the **Data Sources** window onto the designer.</span></span> <span data-ttu-id="76e0d-141">這些項目會成為繫結至資料來源之應用程式 UI 中的項目。</span><span class="sxs-lookup"><span data-stu-id="76e0d-141">These items become elements in the application UI that are bound to the data source.</span></span> <span data-ttu-id="76e0d-142">如需詳細資訊，請參閱 how [to：使用專案資料來源](how-to-bind-data-using-a-project-data-source-wcf-data-services.md)系結資料。</span><span class="sxs-lookup"><span data-stu-id="76e0d-142">For more information, see [How to: Bind Data Using a Project Data Source](how-to-bind-data-using-a-project-data-source-wcf-data-services.md).</span></span>  
  
## <a name="binding-paged-data"></a><span data-ttu-id="76e0d-143">繫結分頁資料</span><span class="sxs-lookup"><span data-stu-id="76e0d-143">Binding Paged Data</span></span>  

 <span data-ttu-id="76e0d-144">您可以設定資料服務來限制單一回應訊息中傳回的查詢資料量。</span><span class="sxs-lookup"><span data-stu-id="76e0d-144">A data service can be configured to limit the amount of queried data that is returned in a single response message.</span></span> <span data-ttu-id="76e0d-145">如需詳細資訊，請參閱設定 [資料服務](configuring-the-data-service-wcf-data-services.md)。</span><span class="sxs-lookup"><span data-stu-id="76e0d-145">For more information, see [Configuring the Data Service](configuring-the-data-service-wcf-data-services.md).</span></span> <span data-ttu-id="76e0d-146">當資料服務分頁回應資料時，每個回應都會包含一個連結以傳回下一頁結果。</span><span class="sxs-lookup"><span data-stu-id="76e0d-146">When the data service is paging response data, each response contains a link that is used to return the next page of results.</span></span> <span data-ttu-id="76e0d-147">如需詳細資訊，請參閱 [載入延遲的內容](loading-deferred-content-wcf-data-services.md)。</span><span class="sxs-lookup"><span data-stu-id="76e0d-147">For more information, see [Loading Deferred Content](loading-deferred-content-wcf-data-services.md).</span></span> <span data-ttu-id="76e0d-148">在這個情況下，您必須傳遞從 <xref:System.Data.Services.Client.DataServiceCollection%601.Load%2A> 屬性取得的 URI，在  <xref:System.Data.Services.Client.DataServiceCollection%601> 呼叫 <xref:System.Data.Services.Client.DataServiceQueryContinuation.NextLinkUri%2A> 方法，以明確地載入頁面，如下列範例所示：</span><span class="sxs-lookup"><span data-stu-id="76e0d-148">In this case, you must explicitly load pages by calling the <xref:System.Data.Services.Client.DataServiceCollection%601.Load%2A> method on the <xref:System.Data.Services.Client.DataServiceCollection%601> by passing the URI obtained from the <xref:System.Data.Services.Client.DataServiceQueryContinuation.NextLinkUri%2A> property, as in the following example:</span></span>  
  
 [!code-csharp[Astoria Northwind Client#BindPagedDataSpecific](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria_northwind_client/cs/customerorderswpf3.xaml.cs#bindpageddataspecific)]
 [!code-vb[Astoria Northwind Client#BindPagedDataSpecific](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_northwind_client/vb/customerorderswpf3.xaml.vb#bindpageddataspecific)]  
  
 <span data-ttu-id="76e0d-149">相關物件會以類似的方式載入。</span><span class="sxs-lookup"><span data-stu-id="76e0d-149">Related objects are loaded in a similar manner.</span></span> <span data-ttu-id="76e0d-150">如需詳細資訊，請參閱 [如何：將資料系結至 Windows Presentation Foundation 元素](bind-data-to-wpf-elements-wcf-data-services.md)。</span><span class="sxs-lookup"><span data-stu-id="76e0d-150">For more information, see [How to: Bind Data to Windows Presentation Foundation Elements](bind-data-to-wpf-elements-wcf-data-services.md).</span></span>  
  
## <a name="customizing-data-binding-behaviors"></a><span data-ttu-id="76e0d-151">自訂資料繫結行為</span><span class="sxs-lookup"><span data-stu-id="76e0d-151">Customizing Data Binding Behaviors</span></span>  

 <span data-ttu-id="76e0d-152"><xref:System.Data.Services.Client.DataServiceCollection%601> 類別可讓您攔截變更集合時所引發的事件，例如加入或移除物件，以及變更集合中物件的屬性時所引發的事件。</span><span class="sxs-lookup"><span data-stu-id="76e0d-152">The <xref:System.Data.Services.Client.DataServiceCollection%601> class enables you to intercept the events raised when changes are made to the collection, such as an object being added or removed, and when changes are made to the properties of object in a collection.</span></span> <span data-ttu-id="76e0d-153">您可以修改資料繫結事件以覆寫預設的行為，包括下列條件約束：</span><span class="sxs-lookup"><span data-stu-id="76e0d-153">You can modify the data binding events to override the default behavior, which includes the following constraints:</span></span>  
  
- <span data-ttu-id="76e0d-154">委派內未執行驗證。</span><span class="sxs-lookup"><span data-stu-id="76e0d-154">No validation is performed within the delegates.</span></span>  
  
- <span data-ttu-id="76e0d-155">加入實體時會自動加入相關的實體。</span><span class="sxs-lookup"><span data-stu-id="76e0d-155">Adding an entity automatically adds related entities.</span></span>  
  
- <span data-ttu-id="76e0d-156">刪除實體時不會刪除相關的實體。</span><span class="sxs-lookup"><span data-stu-id="76e0d-156">Deleting an entity does not delete the related entities.</span></span>  
  
 <span data-ttu-id="76e0d-157">當您建立新的 <xref:System.Data.Services.Client.DataServiceCollection%601> 執行個體時，您可以選擇指定下列參數，這些參數會定義處理變更繫結物件時引發之事件的方法委派。</span><span class="sxs-lookup"><span data-stu-id="76e0d-157">When you create a new instance of <xref:System.Data.Services.Client.DataServiceCollection%601>, you have the option to specify the following parameters that define delegates to methods that handle the events raised when bound objects are changed:</span></span>  
  
- <span data-ttu-id="76e0d-158">`entityChanged`：繫結物件變更時會呼叫此方法。</span><span class="sxs-lookup"><span data-stu-id="76e0d-158">`entityChanged` - a method that is called when the property of a bound object is changed.</span></span> <span data-ttu-id="76e0d-159">此 <xref:System.Func%602> 委派接受 <xref:System.Data.Services.Client.EntityChangedParams> 物件並傳回布林值，指出是否仍應發生預設行為 (呼叫 <xref:System.Data.Services.Client.DataServiceContext.UpdateObject%2A> 的 <xref:System.Data.Services.Client.DataServiceContext>)。</span><span class="sxs-lookup"><span data-stu-id="76e0d-159">This <xref:System.Func%602> delegate accepts an <xref:System.Data.Services.Client.EntityChangedParams> object and returns a Boolean value that indicates whether the default behavior, to call <xref:System.Data.Services.Client.DataServiceContext.UpdateObject%2A> on the <xref:System.Data.Services.Client.DataServiceContext>, should still occur.</span></span>  
  
- <span data-ttu-id="76e0d-160">`entityCollectionChanged`：在繫結集合中加入或移除物件時會呼叫此方法。</span><span class="sxs-lookup"><span data-stu-id="76e0d-160">`entityCollectionChanged` - a method that is called when an object is added or removed from the binding collection.</span></span> <span data-ttu-id="76e0d-161">此 <xref:System.Func%602> 委派接受 <xref:System.Data.Services.Client.EntityCollectionChangedParams> 物件並傳回布林值，指出是否仍應發生預設行為 (呼叫 <xref:System.Data.Services.Client.DataServiceContext.AddObject%2A> 動作的 <xref:System.Collections.Specialized.NotifyCollectionChangedAction.Add>，或在 <xref:System.Data.Services.Client.DataServiceContext.DeleteObject%2A> 呼叫 <xref:System.Collections.Specialized.NotifyCollectionChangedAction.Remove> 動作的 <xref:System.Data.Services.Client.DataServiceContext>)。</span><span class="sxs-lookup"><span data-stu-id="76e0d-161">This <xref:System.Func%602> delegate accepts an <xref:System.Data.Services.Client.EntityCollectionChangedParams> object and returns a Boolean value that indicates whether the default behavior, to call <xref:System.Data.Services.Client.DataServiceContext.AddObject%2A> for an <xref:System.Collections.Specialized.NotifyCollectionChangedAction.Add> action or <xref:System.Data.Services.Client.DataServiceContext.DeleteObject%2A> for a <xref:System.Collections.Specialized.NotifyCollectionChangedAction.Remove> action on the <xref:System.Data.Services.Client.DataServiceContext>, should still occur.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="76e0d-162">WCF Data Services 不會驗證您在這些委派中執行的自訂行為。</span><span class="sxs-lookup"><span data-stu-id="76e0d-162">WCF Data Services performs no validation of the custom behaviors that you implement in these delegates.</span></span>  
  
 <span data-ttu-id="76e0d-163">下列範例會自訂 <xref:System.Collections.Specialized.NotifyCollectionChangedAction.Remove> 動作以呼叫 <xref:System.Data.Services.Client.DataServiceContext.DeleteLink%2A> 和 <xref:System.Data.Services.Client.DataServiceContext.DeleteObject%2A> 方法來移除屬於已刪除之 `Orders_Details` 實體的 `Orders` 方法。</span><span class="sxs-lookup"><span data-stu-id="76e0d-163">In the following example, the <xref:System.Collections.Specialized.NotifyCollectionChangedAction.Remove> action is customized to call the <xref:System.Data.Services.Client.DataServiceContext.DeleteLink%2A> and <xref:System.Data.Services.Client.DataServiceContext.DeleteObject%2A> method to remove `Orders_Details` entities that belong to a deleted `Orders` entity.</span></span> <span data-ttu-id="76e0d-164">由於刪除父實體時不會自動刪除相依實體，因此會執行這個自訂行為。</span><span class="sxs-lookup"><span data-stu-id="76e0d-164">This custom action is performed because dependent entities are not automatically deleted when the parent entity is deleted.</span></span>  
  
 [!code-csharp[Astoria Northwind Client#CustomersOrdersDeleteRelated](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria_northwind_client/cs/customerorderscustom.xaml.cs#customersordersdeleterelated)]
 [!code-vb[Astoria Northwind Client#CustomersOrdersDeleteRelated](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_northwind_client/vb/customerorderscustom.xaml.vb#customersordersdeleterelated)]
 [!code-vb[Astoria Northwind Client#CustomersOrdersDeleteRelated](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_northwind_client/vb/customerorderscustom2.xaml.vb#customersordersdeleterelated)]  
  
 <span data-ttu-id="76e0d-165">如需詳細資訊，請參閱 [如何：自訂資料](how-to-customize-data-binding-behaviors-wcf-data-services.md)系結行為。</span><span class="sxs-lookup"><span data-stu-id="76e0d-165">For more information, see [How to: Customize Data Binding Behaviors](how-to-customize-data-binding-behaviors-wcf-data-services.md).</span></span>  
  
 <span data-ttu-id="76e0d-166">使用 <xref:System.Data.Services.Client.DataServiceCollection%601> 方法移除 <xref:System.Collections.ObjectModel.Collection%601.Remove%2A> 中的物件時，預設行為是在 <xref:System.Data.Services.Client.DataServiceContext> 中將該物件也標記為已刪除。</span><span class="sxs-lookup"><span data-stu-id="76e0d-166">The default behavior when an object is removed from a <xref:System.Data.Services.Client.DataServiceCollection%601> by using the <xref:System.Collections.ObjectModel.Collection%601.Remove%2A> method is that the object is also marked as deleted in the <xref:System.Data.Services.Client.DataServiceContext>.</span></span> <span data-ttu-id="76e0d-167">若要變更此行為，您可以將委派指定為發生 `entityCollectionChanged` 事件時呼叫之 <xref:System.Collections.Specialized.INotifyCollectionChanged.CollectionChanged> 參數中的方法。</span><span class="sxs-lookup"><span data-stu-id="76e0d-167">To change this behavior, you can specify a delegate to a method in the `entityCollectionChanged` parameter that is called when the <xref:System.Collections.Specialized.INotifyCollectionChanged.CollectionChanged> event occurs.</span></span>  
  
## <a name="data-binding-with-custom-client-data-classes"></a><span data-ttu-id="76e0d-168">使用自訂用戶端資料類別資料繫結</span><span class="sxs-lookup"><span data-stu-id="76e0d-168">Data Binding with Custom Client Data Classes</span></span>  

 <span data-ttu-id="76e0d-169">若要將物件載入至 <xref:System.Data.Services.Client.DataServiceCollection%601>，物件本身必須實作 <xref:System.ComponentModel.INotifyPropertyChanged> 介面。</span><span class="sxs-lookup"><span data-stu-id="76e0d-169">To be able to load objects into a <xref:System.Data.Services.Client.DataServiceCollection%601>, the objects themselves must implement the <xref:System.ComponentModel.INotifyPropertyChanged> interface.</span></span> <span data-ttu-id="76e0d-170">資料服務當您使用 [ **加入服務參考** ] 對話方塊或 [DataSvcUtil.exe](wcf-data-service-client-utility-datasvcutil-exe.md) 工具來執行此介面時所產生的用戶端類別。</span><span class="sxs-lookup"><span data-stu-id="76e0d-170">Data service client classes that are generated when you use the **Add Service Reference** dialog box or the [DataSvcUtil.exe](wcf-data-service-client-utility-datasvcutil-exe.md) tool implement this interface.</span></span> <span data-ttu-id="76e0d-171">如果您自行提供用戶端資料類別，則必須使用另一種集合類型進行資料繫結。</span><span class="sxs-lookup"><span data-stu-id="76e0d-171">If you provide your own client data classes, you must use another type of collection for data binding.</span></span> <span data-ttu-id="76e0d-172">物件變更時，您必須在資料繫結控制項中處理事件，以呼叫 <xref:System.Data.Services.Client.DataServiceContext> 類別的下列方法：</span><span class="sxs-lookup"><span data-stu-id="76e0d-172">When objects change, you must handle events in the data bound controls to call the following methods of the <xref:System.Data.Services.Client.DataServiceContext> class:</span></span>  
  
- <span data-ttu-id="76e0d-173"><xref:System.Data.Services.Client.DataServiceContext.AddObject%2A>：將新的物件加入至集合中時。</span><span class="sxs-lookup"><span data-stu-id="76e0d-173"><xref:System.Data.Services.Client.DataServiceContext.AddObject%2A> - when a new object is added to the collection.</span></span>  
  
- <span data-ttu-id="76e0d-174"><xref:System.Data.Services.Client.DataServiceContext.DeleteObject%2A>：自集合移除物件時。</span><span class="sxs-lookup"><span data-stu-id="76e0d-174"><xref:System.Data.Services.Client.DataServiceContext.DeleteObject%2A> - when an object is removed from the collection.</span></span>  
  
- <span data-ttu-id="76e0d-175"><xref:System.Data.Services.Client.DataServiceContext.UpdateObject%2A>：集合中的物件屬性變更時。</span><span class="sxs-lookup"><span data-stu-id="76e0d-175"><xref:System.Data.Services.Client.DataServiceContext.UpdateObject%2A> - when a property is changed on an object in the collection.</span></span>  
  
- <span data-ttu-id="76e0d-176"><xref:System.Data.Services.Client.DataServiceContext.AddLink%2A>：將物件加入至相關物件集合中時。</span><span class="sxs-lookup"><span data-stu-id="76e0d-176"><xref:System.Data.Services.Client.DataServiceContext.AddLink%2A> - when an object is added to a collection of related object.</span></span>  
  
- <span data-ttu-id="76e0d-177"><xref:System.Data.Services.Client.DataServiceContext.SetLink%2A>：將物件加入至相關物件集合中時。</span><span class="sxs-lookup"><span data-stu-id="76e0d-177"><xref:System.Data.Services.Client.DataServiceContext.SetLink%2A> - when an object is added to a collection of related objects.</span></span>  
  
 <span data-ttu-id="76e0d-178">如需詳細資訊，請參閱 [更新資料服務](updating-the-data-service-wcf-data-services.md)。</span><span class="sxs-lookup"><span data-stu-id="76e0d-178">For more information, see [Updating the Data Service](updating-the-data-service-wcf-data-services.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="76e0d-179">請參閱</span><span class="sxs-lookup"><span data-stu-id="76e0d-179">See also</span></span>

- [<span data-ttu-id="76e0d-180">作法：手動產生用戶端資料服務類別</span><span class="sxs-lookup"><span data-stu-id="76e0d-180">How to: Manually Generate Client Data Service Classes</span></span>](how-to-manually-generate-client-data-service-classes-wcf-data-services.md)
- [<span data-ttu-id="76e0d-181">作法：新增資料服務參考</span><span class="sxs-lookup"><span data-stu-id="76e0d-181">How to: Add a Data Service Reference</span></span>](how-to-add-a-data-service-reference-wcf-data-services.md)

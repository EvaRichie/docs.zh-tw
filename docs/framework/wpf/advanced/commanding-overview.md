---
title: 命令概觀
description: 瞭解命令，這是 Windows Presentation Foundation 中的輸入機制，可提供比裝置輸入更多的語義層級的輸入處理。
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- interfaces [WPF], ICommandSource
- command library [WPF]
- commands [WPF], definition of
- CommandBindings [WPF]
- ICommandSource interfaces [WPF]
- commanding [WPF]
- CommandManager [WPF]
ms.assetid: bc208dfe-367d-426a-99de-52b7e7511e81
ms.openlocfilehash: 4f7d12fbf0de9b1546f15061ab7eb1318378bbbb
ms.sourcegitcommit: 87cfeb69226fef01acb17c56c86f978f4f4a13db
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 07/24/2020
ms.locfileid: "87168118"
---
# <a name="commanding-overview"></a><span data-ttu-id="c5f3e-103">命令概觀</span><span class="sxs-lookup"><span data-stu-id="c5f3e-103">Commanding Overview</span></span>
<a name="introduction"></a> <span data-ttu-id="c5f3e-104">命令是處理比裝置輸入更接近語意層級的 [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] 中的輸入機制。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-104">Commanding is an input mechanism in [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] which provides input handling at a more semantic level than device input.</span></span> <span data-ttu-id="c5f3e-105">命令範例包含許多應用程式中都有的 [複製]\*\*\*\*、[剪下]\*\*\*\* 和 [貼上]\*\*\*\* 作業。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-105">Examples of commands are the **Copy**, **Cut**, and **Paste** operations found on many applications.</span></span>  
  
 <span data-ttu-id="c5f3e-106">本概觀會定義 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 中有哪些命令、哪些類別屬於命令模型，以及如何在應用程式中使用及建立命令。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-106">This overview defines what commands are in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], which classes are part of the commanding model, and how to use and create commands in your applications.</span></span>  
  
 <span data-ttu-id="c5f3e-107">本主題包含下列幾節：</span><span class="sxs-lookup"><span data-stu-id="c5f3e-107">This topic contains the following sections:</span></span>  
  
- [<span data-ttu-id="c5f3e-108">命令是什麼？</span><span class="sxs-lookup"><span data-stu-id="c5f3e-108">What Are Commands?</span></span>](#commands_at_10000_feet)  
  
- [<span data-ttu-id="c5f3e-109">WPF 中的簡單命令範例</span><span class="sxs-lookup"><span data-stu-id="c5f3e-109">Simple Command Example in WPF</span></span>](#simple_command)  
  
- [<span data-ttu-id="c5f3e-110">WPF 命令的四個主要概念</span><span class="sxs-lookup"><span data-stu-id="c5f3e-110">Four Main Concepts in WPF Commanding</span></span>](#Four_main_Concepts)  
  
- [<span data-ttu-id="c5f3e-111">命令程式庫</span><span class="sxs-lookup"><span data-stu-id="c5f3e-111">Command Library</span></span>](#Command_Library)  
  
- [<span data-ttu-id="c5f3e-112">建立自訂命令</span><span class="sxs-lookup"><span data-stu-id="c5f3e-112">Creating Custom Commands</span></span>](#creating_commands)  
  
<a name="commands_at_10000_feet"></a>
## <a name="what-are-commands"></a><span data-ttu-id="c5f3e-113">命令是什麼？</span><span class="sxs-lookup"><span data-stu-id="c5f3e-113">What Are Commands?</span></span>  
 <span data-ttu-id="c5f3e-114">命令有多種用途。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-114">Commands have several purposes.</span></span> <span data-ttu-id="c5f3e-115">第一個用途是要分隔語意和從執行命令的邏輯叫用命令的物件。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-115">The first purpose is to separate the semantics and the object that invokes a command from the logic that executes the command.</span></span> <span data-ttu-id="c5f3e-116">這可讓多個不同的來源叫用相同的命令邏輯，並可針對不同的目標自訂命令邏輯。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-116">This allows for multiple and disparate sources to invoke the same command logic, and it allows the command logic to be customized for different targets.</span></span> <span data-ttu-id="c5f3e-117">例如，許多應用程式中都有的 [複製]\*\*\*\*、[剪下]\*\*\*\* 和 [貼上]\*\*\*\* 等編輯作業；如果使用命令實作，即可使用不同的使用者動作叫用。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-117">For example, the editing operations **Copy**, **Cut**, and **Paste**, which are found in many applications, can be invoked by using different user actions if they are implemented by using commands.</span></span> <span data-ttu-id="c5f3e-118">應用程式可能會讓使用者按一下按鈕、選擇功能表中的項目，或使用 CTRL+X 等按鍵組合，剪下選取的物件或文字。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-118">An application might allow a user to cut selected objects or text by either clicking a button, choosing an item in a menu, or using a key combination, such as CTRL+X.</span></span> <span data-ttu-id="c5f3e-119">您可以使用命令將每一種使用者動作類型繫結至相同的邏輯。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-119">By using commands, you can bind each type of user action to the same logic.</span></span>  
  
 <span data-ttu-id="c5f3e-120">命令的另一項用途是指出是否有動作可用。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-120">Another purpose of commands is to indicate whether an action is available.</span></span> <span data-ttu-id="c5f3e-121">若要繼續剪下物件或文字的範例，只有選取項目時動作才有意義。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-121">To continue the example of cutting an object or text, the action only makes sense when something is selected.</span></span> <span data-ttu-id="c5f3e-122">如果使用者嘗試剪下物件或文字，但未選取任何項目，不會有任何事發生。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-122">If a user tries to cut an object or text without having anything selected, nothing would happen.</span></span> <span data-ttu-id="c5f3e-123">為向使用者指出這個狀況，許多應用程式會停用按鈕和功能表項目，讓使用者知道是否能執行某動作。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-123">To indicate this to the user, many applications disable buttons and menu items so that the user knows whether it is possible to perform an action.</span></span> <span data-ttu-id="c5f3e-124">命令可以透過實作 <xref:System.Windows.Input.ICommand.CanExecute%2A> 方法來指出一個動作是否可能執行。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-124">A command can indicate whether an action is possible by implementing the <xref:System.Windows.Input.ICommand.CanExecute%2A> method.</span></span> <span data-ttu-id="c5f3e-125">按鈕可以訂閱 <xref:System.Windows.Input.ICommand.CanExecuteChanged> 事件，如果 <xref:System.Windows.Input.ICommand.CanExecute%2A> 傳回 `false` 則會停用，如果 <xref:System.Windows.Input.ICommand.CanExecute%2A> 傳回 `true` 則會啟用。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-125">A button can subscribe to the <xref:System.Windows.Input.ICommand.CanExecuteChanged> event and be disabled if <xref:System.Windows.Input.ICommand.CanExecute%2A> returns `false` or be enabled if <xref:System.Windows.Input.ICommand.CanExecute%2A> returns `true`.</span></span>  
  
 <span data-ttu-id="c5f3e-126">命令語意在不同的應用程式和類別中可以一致，但動作邏輯專屬於於其上執行動作的特定物件。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-126">The semantics of a command can be consistent across applications and classes, but the logic of the action is specific to the particular object acted upon.</span></span> <span data-ttu-id="c5f3e-127">按鍵組合 CTRL+X 在文字類別、映像類別及網頁瀏覽器中叫用 [剪下]\*\*\*\* 命令，但執行 [剪下]\*\*\*\* 作業的實際邏輯是由執行剪下動作的應用程式所定義。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-127">The key combination CTRL+X invokes the **Cut** command in text classes, image classes, and Web browsers, but the actual logic for performing the **Cut** operation is defined by the application that performs the cut.</span></span> <span data-ttu-id="c5f3e-128"><xref:System.Windows.Input.RoutedCommand> 可讓用戶端實作邏輯。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-128">A <xref:System.Windows.Input.RoutedCommand> enables clients to implement the logic.</span></span> <span data-ttu-id="c5f3e-129">文字物件可能會將選取的文字剪入剪貼簿，而映像物件可能會剪下選取的映像。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-129">A text object may cut the selected text into the clipboard, while an image object may cut the selected image.</span></span> <span data-ttu-id="c5f3e-130">當應用程式處理 <xref:System.Windows.Input.CommandManager.Executed> 事件時，可以存取命令目標，並根據目標類型採取適當的動作。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-130">When an application handles the <xref:System.Windows.Input.CommandManager.Executed> event, it has access to the target of the command and can take appropriate action depending on the target's type.</span></span>  
  
<a name="simple_command"></a>
## <a name="simple-command-example-in-wpf"></a><span data-ttu-id="c5f3e-131">WPF 中的簡單命令範例</span><span class="sxs-lookup"><span data-stu-id="c5f3e-131">Simple Command Example in WPF</span></span>  
 <span data-ttu-id="c5f3e-132">在 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 中使用命令最簡單的方式，是從命令程式庫類別之一使用預先定義的 <xref:System.Windows.Input.RoutedCommand>、使用有可處理命令之原生支援的控制項，以及使用有可叫用命令之原生支援的控制項。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-132">The simplest way to use a command in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] is to use a predefined <xref:System.Windows.Input.RoutedCommand> from one of the command library classes; use a control that has native support for handling the command; and use a control that has native support for invoking a command.</span></span>  <span data-ttu-id="c5f3e-133"><xref:System.Windows.Input.ApplicationCommands.Paste%2A> 命令是在 <xref:System.Windows.Input.ApplicationCommands> 類別中的其中一個預先定義命令。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-133">The <xref:System.Windows.Input.ApplicationCommands.Paste%2A> command is one of the predefined commands in the <xref:System.Windows.Input.ApplicationCommands> class.</span></span>  <span data-ttu-id="c5f3e-134"><xref:System.Windows.Controls.TextBox> 控制項具有內建邏輯來處理 <xref:System.Windows.Input.ApplicationCommands.Paste%2A> 命令。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-134">The <xref:System.Windows.Controls.TextBox> control has built in logic for handling the <xref:System.Windows.Input.ApplicationCommands.Paste%2A> command.</span></span>  <span data-ttu-id="c5f3e-135"><xref:System.Windows.Controls.MenuItem> 類別具有叫用命令的原生支援。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-135">And the <xref:System.Windows.Controls.MenuItem> class has native support for invoking commands.</span></span>  
  
 <span data-ttu-id="c5f3e-136">下列範例示範如何設定 <xref:System.Windows.Controls.MenuItem>，以便其在按一下時叫用 <xref:System.Windows.Controls.TextBox> 上的 <xref:System.Windows.Input.ApplicationCommands.Paste%2A> 命令，假設 <xref:System.Windows.Controls.TextBox> 具有鍵盤焦點。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-136">The following example shows how to set up a <xref:System.Windows.Controls.MenuItem> so that when it is clicked it will invoke the <xref:System.Windows.Input.ApplicationCommands.Paste%2A> command on a <xref:System.Windows.Controls.TextBox>, assuming the <xref:System.Windows.Controls.TextBox> has keyboard focus.</span></span>  
  
 [!code-xaml[CommandingOverviewSnippets#CommandingOverviewSimpleCommand](~/samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml#commandingoverviewsimplecommand)]  
  
 [!code-csharp[CommandingOverviewSnippets#CommandingOverviewCommandTargetCodeBehind](~/samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml.cs#commandingoverviewcommandtargetcodebehind)]
 [!code-vb[CommandingOverviewSnippets#CommandingOverviewCommandTargetCodeBehind](~/samples/snippets/visualbasic/VS_Snippets_Wpf/CommandingOverviewSnippets/visualbasic/window1.xaml.vb#commandingoverviewcommandtargetcodebehind)]  
  
<a name="Four_main_Concepts"></a>
## <a name="four-main-concepts-in-wpf-commanding"></a><span data-ttu-id="c5f3e-137">WPF 命令的四個主要概念</span><span class="sxs-lookup"><span data-stu-id="c5f3e-137">Four Main Concepts in WPF Commanding</span></span>  
 <span data-ttu-id="c5f3e-138">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 中的路由命令模型可以分成四個主要概念︰命令、命令來源、命令目標和命令繫結︰</span><span class="sxs-lookup"><span data-stu-id="c5f3e-138">The routed command model in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] can be broken up into four main concepts: the command, the command source, the command target, and the command binding:</span></span>  
  
- <span data-ttu-id="c5f3e-139">「命令」\*\* 是要執行的動作。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-139">The *command* is the action to be executed.</span></span>  
  
- <span data-ttu-id="c5f3e-140">「命令來源」\*\* 是叫用命令的物件。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-140">The *command source* is the object which invokes the command.</span></span>  
  
- <span data-ttu-id="c5f3e-141">「命令目標」\*\* 是在其上執行命令的物件。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-141">The *command target* is the object that the command is being executed on.</span></span>  
  
- <span data-ttu-id="c5f3e-142">「命令繫結」\*\* 是對應命令邏輯和命令的物件。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-142">The *command binding* is the object which maps the command logic to the command.</span></span>  
  
 <span data-ttu-id="c5f3e-143">在上述範例中，<xref:System.Windows.Input.ApplicationCommands.Paste%2A> 命令是命令，<xref:System.Windows.Controls.MenuItem> 是命令來源，<xref:System.Windows.Controls.TextBox> 是命令目標，而命令繫結由 <xref:System.Windows.Controls.TextBox> 控制項提供。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-143">In the previous example, the <xref:System.Windows.Input.ApplicationCommands.Paste%2A> command is the command, the <xref:System.Windows.Controls.MenuItem> is the command source, the <xref:System.Windows.Controls.TextBox> is the command target, and the command binding is supplied by the <xref:System.Windows.Controls.TextBox> control.</span></span>  <span data-ttu-id="c5f3e-144">值得注意的是，<xref:System.Windows.Input.CommandBinding> 不一定都是由命令目標類別控制項所提供。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-144">It is worth noting that it is not always the case that the <xref:System.Windows.Input.CommandBinding> is supplied by the control that is the command target class.</span></span>  <span data-ttu-id="c5f3e-145">通常，<xref:System.Windows.Input.CommandBinding> 必須由應用程式開發人員建立，或 <xref:System.Windows.Input.CommandBinding> 可能會附加至命令目標的上階。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-145">Quite often the <xref:System.Windows.Input.CommandBinding> must be created by the application developer, or the <xref:System.Windows.Input.CommandBinding> might be attached to an ancestor of the command target.</span></span>  
  
<a name="Commands"></a>
### <a name="commands"></a><span data-ttu-id="c5f3e-146">命令</span><span class="sxs-lookup"><span data-stu-id="c5f3e-146">Commands</span></span>  
 <span data-ttu-id="c5f3e-147">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 中的命令是藉由實作 <xref:System.Windows.Input.ICommand> 介面來建立。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-147">Commands in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] are created by implementing the <xref:System.Windows.Input.ICommand> interface.</span></span>  <span data-ttu-id="c5f3e-148"><xref:System.Windows.Input.ICommand> 公開兩個方法：<xref:System.Windows.Input.ICommand.Execute%2A> 和 <xref:System.Windows.Input.ICommand.CanExecute%2A>，以及一個事件 <xref:System.Windows.Input.ICommand.CanExecuteChanged>。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-148"><xref:System.Windows.Input.ICommand> exposes two methods, <xref:System.Windows.Input.ICommand.Execute%2A>, and <xref:System.Windows.Input.ICommand.CanExecute%2A>, and an event, <xref:System.Windows.Input.ICommand.CanExecuteChanged>.</span></span> <span data-ttu-id="c5f3e-149"><xref:System.Windows.Input.ICommand.Execute%2A> 執行與命令建立關聯的動作。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-149"><xref:System.Windows.Input.ICommand.Execute%2A> performs the actions that are associated with the command.</span></span> <span data-ttu-id="c5f3e-150"><xref:System.Windows.Input.ICommand.CanExecute%2A> 判斷命令是否可以在目前命令目標上執行。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-150"><xref:System.Windows.Input.ICommand.CanExecute%2A> determines whether the command can execute on the current command target.</span></span> <span data-ttu-id="c5f3e-151">如果集中命令作業的命令管理員偵測到命令來源的變更可能會使命令繫結已引發但尚未執行的命令失效，則會引發 <xref:System.Windows.Input.ICommand.CanExecuteChanged>。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-151"><xref:System.Windows.Input.ICommand.CanExecuteChanged> is raised if the command manager that centralizes the commanding operations detects a change in the command source that might invalidate a command that has been raised but not yet executed by the command binding.</span></span>  <span data-ttu-id="c5f3e-152">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 的實作 <xref:System.Windows.Input.ICommand> 是 <xref:System.Windows.Input.RoutedCommand> 類別和此概觀焦點所在。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-152">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] implementation of <xref:System.Windows.Input.ICommand> is the <xref:System.Windows.Input.RoutedCommand> class and is the focus of this overview.</span></span>  
  
 <span data-ttu-id="c5f3e-153">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 中的輸入主要來源是滑鼠、鍵盤、筆跡和路由的命令。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-153">The main sources of input in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] are the mouse, the keyboard, ink, and routed commands.</span></span>  <span data-ttu-id="c5f3e-154">更多裝置導向的輸入使用 <xref:System.Windows.RoutedEvent> 通知應用程式頁面中的物件有輸入事件發生。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-154">The more device-oriented inputs use a <xref:System.Windows.RoutedEvent> to notify objects in an application page that an input event has occurred.</span></span>  <span data-ttu-id="c5f3e-155"><xref:System.Windows.Input.RoutedCommand> 並無不同。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-155">A <xref:System.Windows.Input.RoutedCommand> is no different.</span></span>  <span data-ttu-id="c5f3e-156"><xref:System.Windows.Input.RoutedCommand> 的 <xref:System.Windows.Input.RoutedCommand.Execute%2A> 和 <xref:System.Windows.Input.RoutedCommand.CanExecute%2A> 方法不包含該命令的應用程式邏輯，而是引發路由事件，該事件會在項目樹狀結構中浮動，直到遇到具有 <xref:System.Windows.Input.CommandBinding> 的物件。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-156">The <xref:System.Windows.Input.RoutedCommand.Execute%2A> and <xref:System.Windows.Input.RoutedCommand.CanExecute%2A> methods of a <xref:System.Windows.Input.RoutedCommand> do not contain the application logic for the command, but rather they raise routed events that tunnel and bubble through the element tree until they encounter an object with a <xref:System.Windows.Input.CommandBinding>.</span></span>  <span data-ttu-id="c5f3e-157"><xref:System.Windows.Input.CommandBinding> 包含這些事件的處理常式，並且是執行命令的處理常式。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-157">The <xref:System.Windows.Input.CommandBinding> contains the handlers for these events and it is the handlers that perform the command.</span></span>  <span data-ttu-id="c5f3e-158">如需事件在 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 中路由的詳細資訊，請參閱[路由事件概觀](routed-events-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-158">For more information on event routing in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], see [Routed Events Overview](routed-events-overview.md).</span></span>  
  
 <span data-ttu-id="c5f3e-159"><xref:System.Windows.Input.RoutedCommand> 上之 <xref:System.Windows.Input.RoutedCommand.Execute%2A> 方法會引發命令目標上的 <xref:System.Windows.Input.CommandManager.PreviewExecuted> 和 <xref:System.Windows.Input.CommandManager.Executed> 事件。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-159">The <xref:System.Windows.Input.RoutedCommand.Execute%2A> method on a <xref:System.Windows.Input.RoutedCommand> raises the <xref:System.Windows.Input.CommandManager.PreviewExecuted> and the <xref:System.Windows.Input.CommandManager.Executed> events on the command target.</span></span>  <span data-ttu-id="c5f3e-160"><xref:System.Windows.Input.RoutedCommand> 上之 <xref:System.Windows.Input.RoutedCommand.CanExecute%2A> 方法會引發命令目標上的 <xref:System.Windows.Input.CommandManager.CanExecute> 和 <xref:System.Windows.Input.CommandManager.PreviewCanExecute> 事件。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-160">The <xref:System.Windows.Input.RoutedCommand.CanExecute%2A> method on a <xref:System.Windows.Input.RoutedCommand> raises the <xref:System.Windows.Input.CommandManager.CanExecute> and <xref:System.Windows.Input.CommandManager.PreviewCanExecute> events on the command target.</span></span>  <span data-ttu-id="c5f3e-161">這些事件會在項目樹狀結構中浮動，直到遇到有該特定命令之 <xref:System.Windows.Input.CommandBinding> 的物件。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-161">These events tunnel and bubble through the element tree until they encounter an object which has a <xref:System.Windows.Input.CommandBinding> for that particular command.</span></span>  
  
 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="c5f3e-162">提供分散到數個類別中的一組常見路由命令：<xref:System.Windows.Input.MediaCommands>、<xref:System.Windows.Input.ApplicationCommands>、<xref:System.Windows.Input.NavigationCommands>、<xref:System.Windows.Input.ComponentCommands> 和 <xref:System.Windows.Documents.EditingCommands>。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-162">supplies a set of common routed commands spread across several classes: <xref:System.Windows.Input.MediaCommands>, <xref:System.Windows.Input.ApplicationCommands>, <xref:System.Windows.Input.NavigationCommands>, <xref:System.Windows.Input.ComponentCommands>, and <xref:System.Windows.Documents.EditingCommands>.</span></span>  <span data-ttu-id="c5f3e-163">這些類別只包含 <xref:System.Windows.Input.RoutedCommand> 物件，不包含命令的實作邏輯。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-163">These classes consist only of the <xref:System.Windows.Input.RoutedCommand> objects and not the implementation logic of the command.</span></span>  <span data-ttu-id="c5f3e-164">實作邏輯是於其上執行命令之物件的責任。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-164">The implementation logic is the responsibility of the object on which the command is being executed on.</span></span>  
  
<a name="Command_Sources"></a>
### <a name="command-sources"></a><span data-ttu-id="c5f3e-165">命令來源</span><span class="sxs-lookup"><span data-stu-id="c5f3e-165">Command Sources</span></span>  
 <span data-ttu-id="c5f3e-166">命令來源是叫用命令的物件。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-166">A command source is the object which invokes the command.</span></span>  <span data-ttu-id="c5f3e-167">命令來源的範例包括 <xref:System.Windows.Controls.MenuItem>、<xref:System.Windows.Controls.Button> 和 <xref:System.Windows.Input.KeyGesture>。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-167">Examples of command sources are <xref:System.Windows.Controls.MenuItem>, <xref:System.Windows.Controls.Button>, and <xref:System.Windows.Input.KeyGesture>.</span></span>  
  
 <span data-ttu-id="c5f3e-168">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 中的命令來源通常會實作 <xref:System.Windows.Input.ICommandSource> 介面。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-168">Command sources in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] generally implement the <xref:System.Windows.Input.ICommandSource> interface.</span></span>  
  
 <span data-ttu-id="c5f3e-169"><xref:System.Windows.Input.ICommandSource> 會公開三個屬性：<xref:System.Windows.Input.ICommandSource.Command%2A>、<xref:System.Windows.Input.ICommandSource.CommandTarget%2A> 和 <xref:System.Windows.Input.ICommandSource.CommandParameter%2A>：</span><span class="sxs-lookup"><span data-stu-id="c5f3e-169"><xref:System.Windows.Input.ICommandSource> exposes three properties: <xref:System.Windows.Input.ICommandSource.Command%2A>, <xref:System.Windows.Input.ICommandSource.CommandTarget%2A>, and <xref:System.Windows.Input.ICommandSource.CommandParameter%2A>:</span></span>  
  
- <span data-ttu-id="c5f3e-170"><xref:System.Windows.Input.ICommandSource.Command%2A> 是當叫用命令來源時，會執行的命令。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-170"><xref:System.Windows.Input.ICommandSource.Command%2A> is the command to execute when the command source is invoked.</span></span>  
  
- <span data-ttu-id="c5f3e-171"><xref:System.Windows.Input.ICommandSource.CommandTarget%2A> 是用來執行命令的物件。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-171"><xref:System.Windows.Input.ICommandSource.CommandTarget%2A> is the object on which to execute the command.</span></span>  <span data-ttu-id="c5f3e-172">值得注意的是，在 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 中，<xref:System.Windows.Input.ICommandSource> 上的 <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> 屬性僅適用於當 <xref:System.Windows.Input.ICommand> 為 <xref:System.Windows.Input.RoutedCommand> 時。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-172">It is worth noting that in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] the <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> property on <xref:System.Windows.Input.ICommandSource> is only applicable when the <xref:System.Windows.Input.ICommand> is a <xref:System.Windows.Input.RoutedCommand>.</span></span>  <span data-ttu-id="c5f3e-173">如果 <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> 是設定於 <xref:System.Windows.Input.ICommandSource> 上，並且對應的命令不是 <xref:System.Windows.Input.RoutedCommand>，則會忽略命令目標。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-173">If the <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> is set on an <xref:System.Windows.Input.ICommandSource> and the corresponding command is not a <xref:System.Windows.Input.RoutedCommand>, the command target is ignored.</span></span> <span data-ttu-id="c5f3e-174">如果未設定 <xref:System.Windows.Input.ICommandSource.CommandTarget%2A>，則具有鍵盤焦點的項目就是命令目標。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-174">If the <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> is not set, the element with keyboard focus will be the command target.</span></span>  
  
- <span data-ttu-id="c5f3e-175"><xref:System.Windows.Input.ICommandSource.CommandParameter%2A> 是使用者定義資料類型，用來將資訊傳遞至實作命令的處理常式。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-175"><xref:System.Windows.Input.ICommandSource.CommandParameter%2A> is a user-defined data type used to pass information to the handlers implementing the command.</span></span>  
  
 <span data-ttu-id="c5f3e-176">實作 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 的 <xref:System.Windows.Input.ICommandSource> 類別是 <xref:System.Windows.Controls.Primitives.ButtonBase>、<xref:System.Windows.Controls.MenuItem>、<xref:System.Windows.Documents.Hyperlink> 和 <xref:System.Windows.Input.InputBinding>。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-176">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] classes that implement <xref:System.Windows.Input.ICommandSource> are <xref:System.Windows.Controls.Primitives.ButtonBase>, <xref:System.Windows.Controls.MenuItem>, <xref:System.Windows.Documents.Hyperlink>, and <xref:System.Windows.Input.InputBinding>.</span></span>  <span data-ttu-id="c5f3e-177">按一下 <xref:System.Windows.Controls.Primitives.ButtonBase>、<xref:System.Windows.Controls.MenuItem> 和 <xref:System.Windows.Documents.Hyperlink> 時會叫用一個命令，並且在與其建立關聯的 <xref:System.Windows.Input.InputGesture> 執行時，<xref:System.Windows.Input.InputBinding> 會叫用一個命令。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-177"><xref:System.Windows.Controls.Primitives.ButtonBase>, <xref:System.Windows.Controls.MenuItem>, and <xref:System.Windows.Documents.Hyperlink> invoke a command when they are clicked, and an <xref:System.Windows.Input.InputBinding> invokes a command when the <xref:System.Windows.Input.InputGesture> associated with it is performed.</span></span>  
  
 <span data-ttu-id="c5f3e-178">下列範例示範如何將 <xref:System.Windows.Controls.ContextMenu> 中的 <xref:System.Windows.Controls.MenuItem> 用作 <xref:System.Windows.Input.ApplicationCommands.Properties%2A> 命令的命令來源。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-178">The following example shows how to use a <xref:System.Windows.Controls.MenuItem> in a <xref:System.Windows.Controls.ContextMenu> as a command source for the <xref:System.Windows.Input.ApplicationCommands.Properties%2A> command.</span></span>  
  
 [!code-xaml[CommandingOverviewSnippets#CommandingOverviewCmdSourceXAML](~/samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml#commandingoverviewcmdsourcexaml)]  
  
 [!code-csharp[CommandingOverviewSnippets#CommandingOverviewCmdSource](~/samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml.cs#commandingoverviewcmdsource)]
 [!code-vb[CommandingOverviewSnippets#CommandingOverviewCmdSource](~/samples/snippets/visualbasic/VS_Snippets_Wpf/CommandingOverviewSnippets/visualbasic/window1.xaml.vb#commandingoverviewcmdsource)]  
  
 <span data-ttu-id="c5f3e-179">一般而言，命令來源會接聽 <xref:System.Windows.Input.RoutedCommand.CanExecuteChanged> 事件。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-179">Typically, a command source will listen to the <xref:System.Windows.Input.RoutedCommand.CanExecuteChanged> event.</span></span>  <span data-ttu-id="c5f3e-180">此事件會通知命令來源，命令在目前的命令目標上執行的能力可能已變更。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-180">This event informs the command source that the ability of the command to execute on the current command target may have changed.</span></span>  <span data-ttu-id="c5f3e-181">命令來源可以使用 <xref:System.Windows.Input.RoutedCommand.CanExecute%2A> 方法來查詢 <xref:System.Windows.Input.RoutedCommand> 的目前狀態。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-181">The command source can query the current status of the <xref:System.Windows.Input.RoutedCommand> by using the <xref:System.Windows.Input.RoutedCommand.CanExecute%2A> method.</span></span>  <span data-ttu-id="c5f3e-182">如果命令無法執行，則命令來源可以自行停用。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-182">The command source can then disable itself if the command cannot execute.</span></span>  <span data-ttu-id="c5f3e-183">此情況範例就是 <xref:System.Windows.Controls.MenuItem> 在命令無法執行時把自己變成灰色。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-183">An example of this is a <xref:System.Windows.Controls.MenuItem> graying itself out when a command cannot execute.</span></span>  
  
 <span data-ttu-id="c5f3e-184"><xref:System.Windows.Input.InputGesture> 可用作命令來源。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-184">An <xref:System.Windows.Input.InputGesture> can be used as a command source.</span></span>  <span data-ttu-id="c5f3e-185">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 中兩種類型的輸入筆勢為 <xref:System.Windows.Input.KeyGesture> 和 <xref:System.Windows.Input.MouseGesture>。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-185">Two types of input gestures in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] are the <xref:System.Windows.Input.KeyGesture> and <xref:System.Windows.Input.MouseGesture>.</span></span>  <span data-ttu-id="c5f3e-186">您可以將 <xref:System.Windows.Input.KeyGesture> 視為鍵盤快速鍵，例如 CTRL+C。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-186">You can think of a <xref:System.Windows.Input.KeyGesture> as a keyboard shortcut, such as CTRL+C.</span></span>  <span data-ttu-id="c5f3e-187"><xref:System.Windows.Input.KeyGesture> 由 <xref:System.Windows.Input.Key> 和一組 <xref:System.Windows.Input.ModifierKeys> 組成。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-187">A <xref:System.Windows.Input.KeyGesture> is comprised of a <xref:System.Windows.Input.Key> and a set of <xref:System.Windows.Input.ModifierKeys>.</span></span>  <span data-ttu-id="c5f3e-188"><xref:System.Windows.Input.MouseGesture> 由 <xref:System.Windows.Input.MouseAction> 和選擇性的一組 <xref:System.Windows.Input.ModifierKeys> 組成。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-188">A <xref:System.Windows.Input.MouseGesture> is comprised of a <xref:System.Windows.Input.MouseAction> and an optional set of <xref:System.Windows.Input.ModifierKeys>.</span></span>  
  
 <span data-ttu-id="c5f3e-189">為了讓 <xref:System.Windows.Input.InputGesture> 表現如同命令來源，必須將其與命令建立關聯。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-189">In order for an <xref:System.Windows.Input.InputGesture> to act as a command source, it must be associated with a command.</span></span> <span data-ttu-id="c5f3e-190">有幾種方法可達成這個目標。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-190">There are a few ways to accomplish this.</span></span>  <span data-ttu-id="c5f3e-191">其中一種方式是使用 <xref:System.Windows.Input.InputBinding>。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-191">One way is to use an <xref:System.Windows.Input.InputBinding>.</span></span>  
  
 <span data-ttu-id="c5f3e-192">下列範例會示範如何在 <xref:System.Windows.Input.KeyGesture> 和 <xref:System.Windows.Input.RoutedCommand> 之間建立 <xref:System.Windows.Input.KeyBinding>。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-192">The following example shows how to create a <xref:System.Windows.Input.KeyBinding> between a <xref:System.Windows.Input.KeyGesture> and a <xref:System.Windows.Input.RoutedCommand>.</span></span>  
  
 [!code-xaml[CommandingOverviewSnippets#CommandingOverviewXAMLKeyBinding](~/samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml#commandingoverviewxamlkeybinding)]  
  
 [!code-csharp[CommandingOverviewSnippets#CommandingOverviewKeyBinding](~/samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml.cs#commandingoverviewkeybinding)]
 [!code-vb[CommandingOverviewSnippets#CommandingOverviewKeyBinding](~/samples/snippets/visualbasic/VS_Snippets_Wpf/CommandingOverviewSnippets/visualbasic/window1.xaml.vb#commandingoverviewkeybinding)]  
  
 <span data-ttu-id="c5f3e-193">將 <xref:System.Windows.Input.InputGesture> 與 <xref:System.Windows.Input.RoutedCommand> 建立關聯的另一種方法是將 <xref:System.Windows.Input.InputGesture> 新增至 <xref:System.Windows.Input.RoutedCommand> 上的 <xref:System.Windows.Input.InputGestureCollection>。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-193">Another way to associate an <xref:System.Windows.Input.InputGesture> to a <xref:System.Windows.Input.RoutedCommand> is to add the <xref:System.Windows.Input.InputGesture> to the <xref:System.Windows.Input.InputGestureCollection> on the <xref:System.Windows.Input.RoutedCommand>.</span></span>  
  
 <span data-ttu-id="c5f3e-194">下列範例示範如何將 <xref:System.Windows.Input.KeyGesture> 新增至 <xref:System.Windows.Input.RoutedCommand> 的 <xref:System.Windows.Input.InputGestureCollection>。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-194">The following example shows how to add a <xref:System.Windows.Input.KeyGesture> to the <xref:System.Windows.Input.InputGestureCollection> of a <xref:System.Windows.Input.RoutedCommand>.</span></span>  
  
 [!code-csharp[CommandingOverviewSnippets#CommandingOverviewKeyGestureOnCmd](~/samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml.cs#commandingoverviewkeygestureoncmd)]
 [!code-vb[CommandingOverviewSnippets#CommandingOverviewKeyGestureOnCmd](~/samples/snippets/visualbasic/VS_Snippets_Wpf/CommandingOverviewSnippets/visualbasic/window1.xaml.vb#commandingoverviewkeygestureoncmd)]  
  
<a name="Command_Binding"></a>
### <a name="commandbinding"></a><span data-ttu-id="c5f3e-195">CommandBinding</span><span class="sxs-lookup"><span data-stu-id="c5f3e-195">CommandBinding</span></span>  
 <span data-ttu-id="c5f3e-196"><xref:System.Windows.Input.CommandBinding> 會將命令與實作此命令的事件處理常式建立關聯。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-196">A <xref:System.Windows.Input.CommandBinding> associates a command with the event handlers that implement the command.</span></span>  
  
 <span data-ttu-id="c5f3e-197"><xref:System.Windows.Input.CommandBinding> 類別包含 <xref:System.Windows.Input.CommandBinding.Command%2A> 屬性，以及 <xref:System.Windows.Input.CommandBinding.PreviewExecuted>、<xref:System.Windows.Input.CommandBinding.Executed>、<xref:System.Windows.Input.CommandBinding.PreviewCanExecute> 和 <xref:System.Windows.Input.CommandBinding.CanExecute> 事件。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-197">The <xref:System.Windows.Input.CommandBinding> class contains a <xref:System.Windows.Input.CommandBinding.Command%2A> property, and <xref:System.Windows.Input.CommandBinding.PreviewExecuted>, <xref:System.Windows.Input.CommandBinding.Executed>, <xref:System.Windows.Input.CommandBinding.PreviewCanExecute>, and <xref:System.Windows.Input.CommandBinding.CanExecute> events.</span></span>  
  
 <span data-ttu-id="c5f3e-198"><xref:System.Windows.Input.CommandBinding.Command%2A> 是與 <xref:System.Windows.Input.CommandBinding> 建立關聯的命令。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-198"><xref:System.Windows.Input.CommandBinding.Command%2A> is the command that the <xref:System.Windows.Input.CommandBinding> is being associated with.</span></span>  <span data-ttu-id="c5f3e-199">附加到 <xref:System.Windows.Input.CommandBinding.PreviewExecuted> 和 <xref:System.Windows.Input.CommandBinding.Executed> 事件的事件處理常式會實作命令邏輯。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-199">The event handlers which are attached to the <xref:System.Windows.Input.CommandBinding.PreviewExecuted> and <xref:System.Windows.Input.CommandBinding.Executed> events implement the command logic.</span></span>  <span data-ttu-id="c5f3e-200">附加到 <xref:System.Windows.Input.CommandBinding.PreviewCanExecute> 和 <xref:System.Windows.Input.CommandBinding.CanExecute> 事件的事件處理常式會判斷命令是否可以在目前命令目標上執行。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-200">The event handlers attached to the <xref:System.Windows.Input.CommandBinding.PreviewCanExecute> and <xref:System.Windows.Input.CommandBinding.CanExecute> events determine if the command can execute on the current command target.</span></span>  
  
 <span data-ttu-id="c5f3e-201">下列範例將示範如何在應用程式的根目錄 <xref:System.Windows.Window> 上建立 <xref:System.Windows.Input.CommandBinding>。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-201">The following example shows how to create a <xref:System.Windows.Input.CommandBinding> on the root <xref:System.Windows.Window> of an application.</span></span>  <span data-ttu-id="c5f3e-202"><xref:System.Windows.Input.CommandBinding> 會將 <xref:System.Windows.Input.ApplicationCommands.Open%2A> 命令與 <xref:System.Windows.Input.CommandManager.Executed> 和 <xref:System.Windows.Input.CommandBinding.CanExecute> 處理常式建立關聯。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-202">The <xref:System.Windows.Input.CommandBinding> associates the <xref:System.Windows.Input.ApplicationCommands.Open%2A> command with <xref:System.Windows.Input.CommandManager.Executed> and <xref:System.Windows.Input.CommandBinding.CanExecute> handlers.</span></span>  
  
 [!code-xaml[commandwithhandler#CommandHandlerCommandBinding](~/samples/snippets/csharp/VS_Snippets_Wpf/commandWithHandler/CSharp/Window1.xaml#commandhandlercommandbinding)]  
  
 [!code-csharp[CommandHandlerProcedural#CommandHandlerBindingInit](~/samples/snippets/csharp/VS_Snippets_Wpf/CommandHandlerProcedural/CSharp/Window1.xaml.cs#commandhandlerbindinginit)]
 [!code-vb[CommandHandlerProcedural#CommandHandlerBindingInit](~/samples/snippets/visualbasic/VS_Snippets_Wpf/CommandHandlerProcedural/visualbasic/window1.xaml.vb#commandhandlerbindinginit)]  
  
 <span data-ttu-id="c5f3e-203">接下來，會建立 <xref:System.Windows.Input.ExecutedRoutedEventHandler> 和 <xref:System.Windows.Input.CanExecuteRoutedEventHandler>。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-203">Next, the <xref:System.Windows.Input.ExecutedRoutedEventHandler> and a <xref:System.Windows.Input.CanExecuteRoutedEventHandler> are created.</span></span>  <span data-ttu-id="c5f3e-204"><xref:System.Windows.Input.ExecutedRoutedEventHandler> 會開啟 <xref:System.Windows.MessageBox>，會顯示一個字串，指出該命令已執行。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-204">The <xref:System.Windows.Input.ExecutedRoutedEventHandler> opens a <xref:System.Windows.MessageBox> that displays a string saying the command has been executed.</span></span>  <span data-ttu-id="c5f3e-205"><xref:System.Windows.Input.CanExecuteRoutedEventHandler> 會將 <xref:System.Windows.Input.CanExecuteRoutedEventArgs.CanExecute%2A> 屬性設定為 `true`。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-205">The <xref:System.Windows.Input.CanExecuteRoutedEventHandler> sets the <xref:System.Windows.Input.CanExecuteRoutedEventArgs.CanExecute%2A> property to `true`.</span></span>  
  
 [!code-csharp[commandwithhandler#CommandHandlerExecutedHandler](~/samples/snippets/csharp/VS_Snippets_Wpf/commandWithHandler/CSharp/Window1.xaml.cs#commandhandlerexecutedhandler)]
 [!code-vb[commandwithhandler#CommandHandlerExecutedHandler](~/samples/snippets/visualbasic/VS_Snippets_Wpf/commandWithHandler/VisualBasic/Window1.xaml.vb#commandhandlerexecutedhandler)]  
  
 [!code-csharp[commandwithhandler#CommandHandlerCanExecuteHandler](~/samples/snippets/csharp/VS_Snippets_Wpf/commandWithHandler/CSharp/Window1.xaml.cs#commandhandlercanexecutehandler)]
 [!code-vb[commandwithhandler#CommandHandlerCanExecuteHandler](~/samples/snippets/visualbasic/VS_Snippets_Wpf/commandWithHandler/VisualBasic/Window1.xaml.vb#commandhandlercanexecutehandler)]  
  
 <span data-ttu-id="c5f3e-206"><xref:System.Windows.Input.CommandBinding> 會附加至特定的物件，例如應用程式或控制項的根目錄 <xref:System.Windows.Window>。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-206">A <xref:System.Windows.Input.CommandBinding> is attached to a specific object, such as the root <xref:System.Windows.Window> of the application or a control.</span></span>  <span data-ttu-id="c5f3e-207"><xref:System.Windows.Input.CommandBinding> 所附加至的物件會定義繫結範圍。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-207">The object that the <xref:System.Windows.Input.CommandBinding> is attached to defines the scope of the binding.</span></span>  <span data-ttu-id="c5f3e-208">例如，附加至命令目標上階的 <xref:System.Windows.Input.CommandBinding> 可以透過 <xref:System.Windows.Input.CommandBinding.Executed> 事件到達，但無法到達附加至命令目標子系的 <xref:System.Windows.Input.CommandBinding>。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-208">For example, a <xref:System.Windows.Input.CommandBinding> attached to an ancestor of the command target can be reached by the <xref:System.Windows.Input.CommandBinding.Executed> event, but a <xref:System.Windows.Input.CommandBinding> attached to a descendant of the command target cannot be reached.</span></span>  <span data-ttu-id="c5f3e-209">這是 <xref:System.Windows.RoutedEvent> 在引發事件之物件中浮動的直接結果。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-209">This is a direct consequence of the way a <xref:System.Windows.RoutedEvent> tunnels and bubbles from the object that raises the event.</span></span>  
  
 <span data-ttu-id="c5f3e-210">在某些情況下，<xref:System.Windows.Input.CommandBinding> 會附加至命令目標本身，例如 <xref:System.Windows.Controls.TextBox> 類別與 <xref:System.Windows.Input.ApplicationCommands.Cut%2A>、<xref:System.Windows.Input.ApplicationCommands.Copy%2A> 和 <xref:System.Windows.Input.ApplicationCommands.Paste%2A> 命令。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-210">In some situations the <xref:System.Windows.Input.CommandBinding> is attached to the command target itself, such as with the <xref:System.Windows.Controls.TextBox> class and the <xref:System.Windows.Input.ApplicationCommands.Cut%2A>, <xref:System.Windows.Input.ApplicationCommands.Copy%2A>, and <xref:System.Windows.Input.ApplicationCommands.Paste%2A> commands.</span></span> <span data-ttu-id="c5f3e-211">但通常將 <xref:System.Windows.Input.CommandBinding> 附加至命令目標的上階會更方便，例如主要的 <xref:System.Windows.Window> 或應用程式物件，特別是當相同的 <xref:System.Windows.Input.CommandBinding> 可用於多個命令目標時。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-211">Quite often though, it is more convenient to attach the <xref:System.Windows.Input.CommandBinding> to an ancestor of the command target, such as the main <xref:System.Windows.Window> or the Application object, especially if the same <xref:System.Windows.Input.CommandBinding> can be used for multiple command targets.</span></span>  <span data-ttu-id="c5f3e-212">這些都是當您要建立命令基礎結構時會想要考慮的設計決策。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-212">These are design decisions you will want to consider when you are creating your commanding infrastructure.</span></span>  
  
<a name="Commane_Target"></a>
### <a name="command-target"></a><span data-ttu-id="c5f3e-213">命令目標</span><span class="sxs-lookup"><span data-stu-id="c5f3e-213">Command Target</span></span>  
 <span data-ttu-id="c5f3e-214">命令目標是於其上執行命令的項目。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-214">The command target is the element on which the command is executed.</span></span>  <span data-ttu-id="c5f3e-215">關於 <xref:System.Windows.Input.RoutedCommand>，命令目標是 <xref:System.Windows.Input.CommandManager.Executed> 和 <xref:System.Windows.Input.CommandManager.CanExecute> 之路由啟動的項目。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-215">With regards to a <xref:System.Windows.Input.RoutedCommand>, the command target is the element at which routing of the <xref:System.Windows.Input.CommandManager.Executed> and <xref:System.Windows.Input.CommandManager.CanExecute> starts.</span></span>  <span data-ttu-id="c5f3e-216">如前所述，在 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 中，<xref:System.Windows.Input.ICommandSource> 上的 <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> 屬性僅適用於當 <xref:System.Windows.Input.ICommand> 為 <xref:System.Windows.Input.RoutedCommand> 時。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-216">As noted previously, in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] the <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> property on <xref:System.Windows.Input.ICommandSource> is only applicable when the <xref:System.Windows.Input.ICommand> is a <xref:System.Windows.Input.RoutedCommand>.</span></span>  <span data-ttu-id="c5f3e-217">如果 <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> 是設定於 <xref:System.Windows.Input.ICommandSource> 上，並且對應的命令不是 <xref:System.Windows.Input.RoutedCommand>，則會忽略命令目標。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-217">If the <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> is set on an <xref:System.Windows.Input.ICommandSource> and the corresponding command is not a <xref:System.Windows.Input.RoutedCommand>, the command target is ignored.</span></span>  
  
 <span data-ttu-id="c5f3e-218">命令來源可以明確設定命令目標。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-218">The command source can explicitly set the command target.</span></span>  <span data-ttu-id="c5f3e-219">如未定義命令目標，則具有鍵盤焦點的項目會作為命令目標。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-219">If the command target is not defined, the element with keyboard focus will be used as the command target.</span></span>  <span data-ttu-id="c5f3e-220">將具有鍵盤焦點的項目作為命令目標的優點之一是，它讓應用程式開發人員使用相同的命令來源對多個目標叫用命令，但不必追蹤命令目標。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-220">One of the benefits of using the element with keyboard focus as the command target is that it allows the application developer to use the same command source to invoke a command on multiple targets without having to keep track of the command target.</span></span>  <span data-ttu-id="c5f3e-221">例如，如果 <xref:System.Windows.Controls.MenuItem> 在具有 <xref:System.Windows.Controls.TextBox> 控制項和 <xref:System.Windows.Controls.PasswordBox> 控制項的應用程式中叫用**貼上**命令，則目標可以是 <xref:System.Windows.Controls.TextBox> 或 <xref:System.Windows.Controls.PasswordBox>，取決於哪個控制項具有鍵盤焦點。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-221">For example, if a <xref:System.Windows.Controls.MenuItem> invokes the **Paste** command in an application that has a <xref:System.Windows.Controls.TextBox> control and a <xref:System.Windows.Controls.PasswordBox> control, the target can be either the <xref:System.Windows.Controls.TextBox> or <xref:System.Windows.Controls.PasswordBox> depending on which control has keyboard focus.</span></span>  
  
 <span data-ttu-id="c5f3e-222">下例示範如何在標記和程式碼後置中明確設定命令目標。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-222">The following example shows how to explicitly set the command target in markup and in code behind.</span></span>  
  
 [!code-xaml[CommandingOverviewSnippets#CommandingOverviewXAMLCommandTarget](~/samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml#commandingoverviewxamlcommandtarget)]  
  
 [!code-csharp[CommandingOverviewSnippets#CommandingOverviewCommandTargetCodeBehind](~/samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml.cs#commandingoverviewcommandtargetcodebehind)]
 [!code-vb[CommandingOverviewSnippets#CommandingOverviewCommandTargetCodeBehind](~/samples/snippets/visualbasic/VS_Snippets_Wpf/CommandingOverviewSnippets/visualbasic/window1.xaml.vb#commandingoverviewcommandtargetcodebehind)]  
  
<a name="Command_Manager"></a>
### <a name="the-commandmanager"></a><span data-ttu-id="c5f3e-223">The CommandManager</span><span class="sxs-lookup"><span data-stu-id="c5f3e-223">The CommandManager</span></span>  
 <span data-ttu-id="c5f3e-224"><xref:System.Windows.Input.CommandManager> 提供許多與命令相關的功能。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-224">The <xref:System.Windows.Input.CommandManager> serves a number of command related functions.</span></span>  <span data-ttu-id="c5f3e-225">會提供一組靜態方法，用於向特定項目新增和移除 <xref:System.Windows.Input.CommandManager.PreviewExecuted>、<xref:System.Windows.Input.CommandManager.Executed>、<xref:System.Windows.Input.CommandManager.PreviewCanExecute> 和 <xref:System.Windows.Input.CommandManager.CanExecute> 事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-225">It provides a set of static methods for adding and removing <xref:System.Windows.Input.CommandManager.PreviewExecuted>, <xref:System.Windows.Input.CommandManager.Executed>, <xref:System.Windows.Input.CommandManager.PreviewCanExecute>, and <xref:System.Windows.Input.CommandManager.CanExecute> event handlers to and from a specific element.</span></span>  <span data-ttu-id="c5f3e-226">會提供將 <xref:System.Windows.Input.CommandBinding> 和 <xref:System.Windows.Input.InputBinding> 物件註冊到特定類別的方法。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-226">It provides a means to register <xref:System.Windows.Input.CommandBinding> and <xref:System.Windows.Input.InputBinding> objects onto a specific class.</span></span>  <span data-ttu-id="c5f3e-227"><xref:System.Windows.Input.CommandManager> 也會透過 <xref:System.Windows.Input.CommandManager.RequerySuggested> 事件提供一種方法，用於在引發 <xref:System.Windows.Input.ICommand.CanExecuteChanged> 事件時通知命令。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-227">The <xref:System.Windows.Input.CommandManager> also provides a means, through the <xref:System.Windows.Input.CommandManager.RequerySuggested> event, to notify a command when it should raise the <xref:System.Windows.Input.ICommand.CanExecuteChanged> event.</span></span>  
  
 <span data-ttu-id="c5f3e-228"><xref:System.Windows.Input.CommandManager.InvalidateRequerySuggested%2A> 方法會強制 <xref:System.Windows.Input.CommandManager> 引發 <xref:System.Windows.Input.CommandManager.RequerySuggested> 事件。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-228">The <xref:System.Windows.Input.CommandManager.InvalidateRequerySuggested%2A> method forces the <xref:System.Windows.Input.CommandManager> to raise the <xref:System.Windows.Input.CommandManager.RequerySuggested> event.</span></span>  <span data-ttu-id="c5f3e-229">出現應該停用/啟用命令的條件，卻非 <xref:System.Windows.Input.CommandManager> 所知的條件時，這很有用。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-229">This is useful for conditions that should disable/enable a command but are not conditions that the <xref:System.Windows.Input.CommandManager> is aware of.</span></span>  
  
<a name="Command_Library"></a>
## <a name="command-library"></a><span data-ttu-id="c5f3e-230">命令程式庫</span><span class="sxs-lookup"><span data-stu-id="c5f3e-230">Command Library</span></span>  
 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="c5f3e-231">提供一組預先定義的命令。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-231">provides a set of predefined commands.</span></span>  <span data-ttu-id="c5f3e-232">命令程式庫包含下列類別：<xref:System.Windows.Input.ApplicationCommands>、<xref:System.Windows.Input.NavigationCommands>、<xref:System.Windows.Input.MediaCommands>、<xref:System.Windows.Documents.EditingCommands> 和 <xref:System.Windows.Input.ComponentCommands>。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-232">The command library consists of the following classes: <xref:System.Windows.Input.ApplicationCommands>, <xref:System.Windows.Input.NavigationCommands>, <xref:System.Windows.Input.MediaCommands>, <xref:System.Windows.Documents.EditingCommands>, and the <xref:System.Windows.Input.ComponentCommands>.</span></span>  <span data-ttu-id="c5f3e-233">這些類別提供的命令，例如 <xref:System.Windows.Input.ApplicationCommands.Cut%2A>、<xref:System.Windows.Input.NavigationCommands.BrowseBack%2A> 以及 <xref:System.Windows.Input.NavigationCommands.BrowseForward%2A>、<xref:System.Windows.Input.MediaCommands.Play%2A>、<xref:System.Windows.Input.MediaCommands.Stop%2A> 和 <xref:System.Windows.Input.MediaCommands.Pause%2A>。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-233">These classes provide commands such as <xref:System.Windows.Input.ApplicationCommands.Cut%2A>, <xref:System.Windows.Input.NavigationCommands.BrowseBack%2A> and <xref:System.Windows.Input.NavigationCommands.BrowseForward%2A>, <xref:System.Windows.Input.MediaCommands.Play%2A>, <xref:System.Windows.Input.MediaCommands.Stop%2A>, and <xref:System.Windows.Input.MediaCommands.Pause%2A>.</span></span>  
  
 <span data-ttu-id="c5f3e-234">這些命令許多都包含一組預設的輸入繫結。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-234">Many of these commands include a set of default input bindings.</span></span>  <span data-ttu-id="c5f3e-235">例如，如果您指定應用程式處理複製命令，則會自動取得鍵盤系結 "CTRL + C"，您也會取得其他輸入裝置的系結，例如 Tablet PC 畫筆手勢和語音資訊。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-235">For example, if you specify that your application handles the copy command, you automatically get the keyboard binding "CTRL+C" You also get bindings for other input devices, such as Tablet PC pen gestures and speech information.</span></span>  
  
 <span data-ttu-id="c5f3e-236">當您參考使用 [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] 的各種命令程式庫中的命令時，通常會省略公開靜態命令屬性的文件庫類別的類別名稱。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-236">When you reference commands in the various command libraries using [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], you can usually omit the class name of the library class that exposes the static command property.</span></span> <span data-ttu-id="c5f3e-237">命令名稱通常像字串一樣明確，且擁有提供命令邏輯群組的類型，但不一定用於去除混淆。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-237">Generally, the command names are unambiguous as strings, and the owning types exist to provide a logical grouping of commands but are not necessary for disambiguation.</span></span> <span data-ttu-id="c5f3e-238">例如，您可以指定 `Command="Cut"` 而不是更詳細的 `Command="ApplicationCommands.Cut"`。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-238">For instance, you can specify `Command="Cut"` rather than the more verbose `Command="ApplicationCommands.Cut"`.</span></span> <span data-ttu-id="c5f3e-239">這是在命令的處理器內建的便利機制 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] （更精確地說，它是 <xref:System.Windows.Input.ICommand> [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] 處理器在載入時參考的類型轉換子行為）。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-239">This is a convenience mechanism that is built in to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] processor for commands (more precisely, it is a type converter behavior of <xref:System.Windows.Input.ICommand>, which the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] processor references at load time).</span></span>  
  
<a name="creating_commands"></a>
## <a name="creating-custom-commands"></a><span data-ttu-id="c5f3e-240">建立自訂命令</span><span class="sxs-lookup"><span data-stu-id="c5f3e-240">Creating Custom Commands</span></span>  
 <span data-ttu-id="c5f3e-241">如果命令程式庫類別中的命令不符合您的需求，您可以建立自己的命令。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-241">If the commands in the command library classes do not meet your needs, then you can create your own commands.</span></span>  <span data-ttu-id="c5f3e-242">有兩種方式可以建立自訂的命令。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-242">There are two ways to create a custom command.</span></span>  <span data-ttu-id="c5f3e-243">第一種是從頭開始實作 <xref:System.Windows.Input.ICommand> 介面。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-243">The first is to start from the ground up and implement the <xref:System.Windows.Input.ICommand> interface.</span></span>  <span data-ttu-id="c5f3e-244">另一種為更常見的方式，即建立 <xref:System.Windows.Input.RoutedCommand> 或 <xref:System.Windows.Input.RoutedUICommand>。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-244">The other way, and the more common approach, is to create a <xref:System.Windows.Input.RoutedCommand> or a <xref:System.Windows.Input.RoutedUICommand>.</span></span>  
  
 <span data-ttu-id="c5f3e-245">如需建立自訂 <xref:System.Windows.Input.RoutedCommand> 的範例，請參閱[建立自訂的 RoutedCommand 範例](https://github.com/Microsoft/WPF-Samples/tree/master/Input%20and%20Commands/CustomRoutedCommand)。</span><span class="sxs-lookup"><span data-stu-id="c5f3e-245">For an example of creating a custom <xref:System.Windows.Input.RoutedCommand>, see [Create a Custom RoutedCommand Sample](https://github.com/Microsoft/WPF-Samples/tree/master/Input%20and%20Commands/CustomRoutedCommand).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="c5f3e-246">另請參閱</span><span class="sxs-lookup"><span data-stu-id="c5f3e-246">See also</span></span>

- <xref:System.Windows.Input.RoutedCommand>
- <xref:System.Windows.Input.CommandBinding>
- <xref:System.Windows.Input.InputBinding>
- <xref:System.Windows.Input.CommandManager>
- [<span data-ttu-id="c5f3e-247">輸入概觀</span><span class="sxs-lookup"><span data-stu-id="c5f3e-247">Input Overview</span></span>](input-overview.md)
- [<span data-ttu-id="c5f3e-248">路由事件概觀</span><span class="sxs-lookup"><span data-stu-id="c5f3e-248">Routed Events Overview</span></span>](routed-events-overview.md)
- [<span data-ttu-id="c5f3e-249">實作 ICommandSource</span><span class="sxs-lookup"><span data-stu-id="c5f3e-249">Implement ICommandSource</span></span>](how-to-implement-icommandsource.md)
- <span data-ttu-id="c5f3e-250">[如何：將命令新增至 MenuItem](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms741839(v=vs.90))</span><span class="sxs-lookup"><span data-stu-id="c5f3e-250">[How to: Add a Command to a MenuItem](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms741839(v=vs.90))</span></span>
- [<span data-ttu-id="c5f3e-251">建立自訂的 RoutedCommand 範例</span><span class="sxs-lookup"><span data-stu-id="c5f3e-251">Create a Custom RoutedCommand Sample</span></span>](https://github.com/Microsoft/WPF-Samples/tree/master/Input%20and%20Commands/CustomRoutedCommand)

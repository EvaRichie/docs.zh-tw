---
title: 匯出和匯入中繼資料
ms.date: 03/30/2017
helpviewer_keywords:
- metadata [WCF], exporting and importing
ms.assetid: 614a75bb-e0b0-4c95-b6d8-02cb5e5ddb38
ms.openlocfilehash: 44a684ca7904cc059277d94f26b5c077794d75b9
ms.sourcegitcommit: bc293b14af795e0e999e3304dd40c0222cf2ffe4
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 11/26/2020
ms.locfileid: "96276642"
---
# <a name="exporting-and-importing-metadata"></a><span data-ttu-id="d593b-102">匯出和匯入中繼資料</span><span class="sxs-lookup"><span data-stu-id="d593b-102">Exporting and Importing Metadata</span></span>

<span data-ttu-id="d593b-103">在 Windows Communication Foundation (WCF) 中，匯出中繼資料是描述服務端點並將其投射至平行、標準化標記法的程式，用戶端可以使用此標記法來瞭解如何使用此服務。</span><span class="sxs-lookup"><span data-stu-id="d593b-103">In Windows Communication Foundation (WCF), exporting metadata is the process of describing service endpoints and projecting them into a parallel, standardized representation that clients can use to understand how to use the service.</span></span> <span data-ttu-id="d593b-104">匯入服務中繼資料是從服務中繼資料產生 <xref:System.ServiceModel.Description.ServiceEndpoint> 執行個體或組件的程序。</span><span class="sxs-lookup"><span data-stu-id="d593b-104">Importing service metadata is the process of generating <xref:System.ServiceModel.Description.ServiceEndpoint> instances or parts from service metadata.</span></span>  
  
## <a name="exporting-metadata"></a><span data-ttu-id="d593b-105">匯出中繼資料</span><span class="sxs-lookup"><span data-stu-id="d593b-105">Exporting Metadata</span></span>  

 <span data-ttu-id="d593b-106">若要從 <xref:System.ServiceModel.Description.ServiceEndpoint?displayProperty=nameWithType> 執行個體匯出中繼資料，請使用 <xref:System.ServiceModel.Description.MetadataExporter> 抽象類別的實作。</span><span class="sxs-lookup"><span data-stu-id="d593b-106">To export metadata from <xref:System.ServiceModel.Description.ServiceEndpoint?displayProperty=nameWithType> instances, use an implementation of the <xref:System.ServiceModel.Description.MetadataExporter> abstract class.</span></span> <span data-ttu-id="d593b-107">此 <xref:System.ServiceModel.Description.WsdlExporter> 類型是 WCF 所包含之 <xref:System.ServiceModel.Description.MetadataExporter> 抽象類別的實作為。</span><span class="sxs-lookup"><span data-stu-id="d593b-107">The <xref:System.ServiceModel.Description.WsdlExporter> type is the implementation of the <xref:System.ServiceModel.Description.MetadataExporter> abstract class included with WCF.</span></span>  
  
 <span data-ttu-id="d593b-108"><xref:System.ServiceModel.Description.WsdlExporter?displayProperty=nameWithType> 型別會使用在 <xref:System.ServiceModel.Description.MetadataSet> 執行個體中封裝的附加原則運算式來產生 Web 服務描述語言 (WSDL) 中繼資料。</span><span class="sxs-lookup"><span data-stu-id="d593b-108">The <xref:System.ServiceModel.Description.WsdlExporter?displayProperty=nameWithType> type generates Web Services Description Language (WSDL) metadata with attached policy expressions encapsulated in a <xref:System.ServiceModel.Description.MetadataSet> instance.</span></span> <span data-ttu-id="d593b-109">您可以使用 <xref:System.ServiceModel.Description.WsdlExporter?displayProperty=nameWithType> 執行個體來反覆匯出 <xref:System.ServiceModel.Description.ContractDescription> 物件和 <xref:System.ServiceModel.Description.ServiceEndpoint> 物件的中繼資料。</span><span class="sxs-lookup"><span data-stu-id="d593b-109">You can use a <xref:System.ServiceModel.Description.WsdlExporter?displayProperty=nameWithType> instance to iteratively export metadata for <xref:System.ServiceModel.Description.ContractDescription> objects and <xref:System.ServiceModel.Description.ServiceEndpoint> objects.</span></span> <span data-ttu-id="d593b-110">您也可以匯出 <xref:System.ServiceModel.Description.ServiceEndpoint> 物件的集合，並將之與特定服務名稱進行關聯。</span><span class="sxs-lookup"><span data-stu-id="d593b-110">You can also export a collection of <xref:System.ServiceModel.Description.ServiceEndpoint> objects and associate them with a specific service name.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="d593b-111">您只能使用 `WsdlExporter` 從包含 Common Language Runtime (CLR) 型別資訊的 `ContractDescription` 執行個體中匯出中繼資料，例如透過 `ContractDescription` 方法建立的 `ContractDescription.GetContract` 執行個體，或是建立為 `ServiceDescription` 執行個體的 `ServiceHost` 一部分。</span><span class="sxs-lookup"><span data-stu-id="d593b-111">You can only use the `WsdlExporter` to export metadata from `ContractDescription` instances that contain common language runtime (CLR) type information, such as a `ContractDescription` instance created using the `ContractDescription.GetContract` method or created as part of the `ServiceDescription` for a `ServiceHost` instance.</span></span> <span data-ttu-id="d593b-112">對於從服務中繼資料匯入或是未使用型別資訊建構的 `WsdlExporter` 執行個體，則無法使用 `ContractDescription` 從這類執行個體匯出中繼資料。</span><span class="sxs-lookup"><span data-stu-id="d593b-112">You cannot use the `WsdlExporter` to export metadata from `ContractDescription` instances imported from service metadata or constructed without type information.</span></span>  
  
## <a name="importing-metadata"></a><span data-ttu-id="d593b-113">匯入中繼資料</span><span class="sxs-lookup"><span data-stu-id="d593b-113">Importing Metadata</span></span>  
  
### <a name="importing-wsdl-documents"></a><span data-ttu-id="d593b-114">匯入 WSDL 文件</span><span class="sxs-lookup"><span data-stu-id="d593b-114">Importing WSDL Documents</span></span>  

 <span data-ttu-id="d593b-115">若要在 WCF 中匯入服務中繼資料，請使用抽象類別的實作為 <xref:System.ServiceModel.Description.MetadataImporter> 。</span><span class="sxs-lookup"><span data-stu-id="d593b-115">To import service metadata in WCF, use an implementation of the <xref:System.ServiceModel.Description.MetadataImporter> abstract class.</span></span> <span data-ttu-id="d593b-116">此 <xref:System.ServiceModel.Description.WsdlImporter?displayProperty=nameWithType> 類型是 WCF 所包含之 <xref:System.ServiceModel.Description.MetadataImporter> 抽象類別的實作為。</span><span class="sxs-lookup"><span data-stu-id="d593b-116">The <xref:System.ServiceModel.Description.WsdlImporter?displayProperty=nameWithType> type is the implementation of the <xref:System.ServiceModel.Description.MetadataImporter> abstract class included with WCF.</span></span> <span data-ttu-id="d593b-117"><xref:System.ServiceModel.Description.WsdlImporter> 型別會匯入 WSDL 中繼資料，其中包含與 <xref:System.ServiceModel.Description.MetadataSet> 物件組合在一起的附加原則。</span><span class="sxs-lookup"><span data-stu-id="d593b-117">The <xref:System.ServiceModel.Description.WsdlImporter> type imports WSDL metadata with attached policies bundled in a <xref:System.ServiceModel.Description.MetadataSet> object.</span></span>  
  
 <span data-ttu-id="d593b-118"><xref:System.ServiceModel.Description.WsdlImporter> 型別可讓您控制匯入中繼資料的方式。</span><span class="sxs-lookup"><span data-stu-id="d593b-118">The <xref:System.ServiceModel.Description.WsdlImporter> type gives you control over how to import the metadata.</span></span> <span data-ttu-id="d593b-119">您可以匯入所有端點、所有繫結或是所有合約。</span><span class="sxs-lookup"><span data-stu-id="d593b-119">You can import all of the endpoints, all of the bindings, or all of the contracts.</span></span> <span data-ttu-id="d593b-120">您可以匯入與特定 WSDL 服務、繫結或連接埠類型相關聯的所有端點。</span><span class="sxs-lookup"><span data-stu-id="d593b-120">You can import all of the endpoints associated with a specific WSDL service, binding, or port type.</span></span> <span data-ttu-id="d593b-121">您也可以匯入特定 WSDL 連接埠的端點、特定 WSDL 繫結的繫結，或是特定 WSDL 連接埠類型的合約。</span><span class="sxs-lookup"><span data-stu-id="d593b-121">You can also import the endpoint for a specific WSDL port, the binding for a specific WSDL binding or the contract for a specific WSDL port type.</span></span>  
  
 <span data-ttu-id="d593b-122">同時，<xref:System.ServiceModel.Description.WsdlImporter> 會公開 <xref:System.ServiceModel.Description.MetadataImporter.KnownContracts%2A> 屬性，讓您指定不需要匯入的合約集。</span><span class="sxs-lookup"><span data-stu-id="d593b-122">The <xref:System.ServiceModel.Description.WsdlImporter> also exposes a <xref:System.ServiceModel.Description.MetadataImporter.KnownContracts%2A> property that allows you to specify a set of contracts that do not need to be imported.</span></span> <span data-ttu-id="d593b-123"><xref:System.ServiceModel.Description.WsdlImporter> 會使用 <xref:System.ServiceModel.Description.MetadataImporter.KnownContracts%2A> 屬性中的合約，而不是匯入合約 (內含來自中繼資料的相同限定名稱)。</span><span class="sxs-lookup"><span data-stu-id="d593b-123">The <xref:System.ServiceModel.Description.WsdlImporter> uses the contracts in the <xref:System.ServiceModel.Description.MetadataImporter.KnownContracts%2A> property instead of importing a contract with the same qualified name from the metadata.</span></span>  
  
### <a name="importing-policies"></a><span data-ttu-id="d593b-124">匯入原則</span><span class="sxs-lookup"><span data-stu-id="d593b-124">Importing Policies</span></span>  

 <span data-ttu-id="d593b-125"><xref:System.ServiceModel.Description.WsdlImporter> 型別會收集附加至訊息、作業與端點原則主體的原則運算式，然後使用 <xref:System.ServiceModel.Description.IPolicyImportExtension> 集合中的 <xref:System.ServiceModel.Description.MetadataImporter.PolicyImportExtensions%2A> 實作來匯入原則運算式。</span><span class="sxs-lookup"><span data-stu-id="d593b-125">The <xref:System.ServiceModel.Description.WsdlImporter> type collects the policy expressions attached to the message, operation, and endpoint policy subjects and then uses the <xref:System.ServiceModel.Description.IPolicyImportExtension> implementations in the <xref:System.ServiceModel.Description.MetadataImporter.PolicyImportExtensions%2A> collection to import the policy expressions.</span></span>  
  
 <span data-ttu-id="d593b-126">原則匯入邏輯會自動處理位於相同 WSDL 文件中的原則運算式之原則參考，並使用 `wsu:Id` 或 `xml:id` 屬性加以識別。</span><span class="sxs-lookup"><span data-stu-id="d593b-126">The policy import logic automatically handles policy references to policy expressions in the same WSDL document and is identified with a `wsu:Id` or `xml:id` attribute.</span></span> <span data-ttu-id="d593b-127">原則匯入邏輯會將原則運算式的規模限制在 4096 個節點來保護應用程式免於受到循環原則參考，當中的節點為下列其中一個項目：`wsp:Policy`、`wsp:All`、`wsp:ExactlyOne` 和 `wsp:policyReference`。</span><span class="sxs-lookup"><span data-stu-id="d593b-127">The policy import logic protects applications against circular policy references by limiting the size of a policy expression to 4096 nodes, where a node is a one of the following elements: `wsp:Policy`, `wsp:All`, `wsp:ExactlyOne`, `wsp:policyReference`.</span></span>  
  
 <span data-ttu-id="d593b-128">原則匯入邏輯同時會自動正規化原則運算式。</span><span class="sxs-lookup"><span data-stu-id="d593b-128">The policy import logic also automatically normalizes policy expressions.</span></span> <span data-ttu-id="d593b-129">巢狀原則運算式和 `wsp:Optional` 屬性不會正規化。</span><span class="sxs-lookup"><span data-stu-id="d593b-129">Nested policy expressions and the `wsp:Optional` attribute are not normalized.</span></span> <span data-ttu-id="d593b-130">所能完成的正規化處理數量將限制在 4096 個步驟，其中每個步驟都會產生原則判斷提示，或是 `wsp:ExactlyOne` 項目的子項目。</span><span class="sxs-lookup"><span data-stu-id="d593b-130">The amount of normalization processing done is limited to 4096 steps, where each step yields a policy assertion, or a child element of a `wsp:ExactlyOne` element.</span></span>  
  
 <span data-ttu-id="d593b-131"><xref:System.ServiceModel.Description.WsdlImporter> 型別最多會嘗試 32 種附加至不同 WSDL 原則主體的各種原則替代方案組合。</span><span class="sxs-lookup"><span data-stu-id="d593b-131">The <xref:System.ServiceModel.Description.WsdlImporter> type tries up to 32 combinations of policy alternatives attached to the different WSDL policy subjects.</span></span> <span data-ttu-id="d593b-132">如果沒有組合可以正常匯入，就會使用第一個組合來建構部分自訂繫結。</span><span class="sxs-lookup"><span data-stu-id="d593b-132">If no combination imports cleanly, the first combination is used to construct a partial custom binding.</span></span>  
  
## <a name="error-handling"></a><span data-ttu-id="d593b-133">錯誤處理</span><span class="sxs-lookup"><span data-stu-id="d593b-133">Error Handling</span></span>  

 <span data-ttu-id="d593b-134"><xref:System.ServiceModel.Description.MetadataExporter> 和 <xref:System.ServiceModel.Description.MetadataImporter> 型別都會公開 `Errors` 屬性，此屬性會分別包含匯出或匯入處理期間所遭遇的錯誤與警告訊息集合，以便在實作工具時使用。</span><span class="sxs-lookup"><span data-stu-id="d593b-134">Both the <xref:System.ServiceModel.Description.MetadataExporter> and the <xref:System.ServiceModel.Description.MetadataImporter> types expose an `Errors` property that can contain a collection of error and warning messages encountered during the export and import processes, respectively, that can be used when implementing tools.</span></span>  
  
 <span data-ttu-id="d593b-135"><xref:System.ServiceModel.Description.WsdlImporter> 型別一般會針對匯入處理期間所攔截的例外狀況擲回例外狀況，並將對應的錯誤新增至其 `Errors` 屬性中。</span><span class="sxs-lookup"><span data-stu-id="d593b-135">The <xref:System.ServiceModel.Description.WsdlImporter> type generally throws an exception for an exception caught during the import process and adds a corresponding error to its `Errors` property.</span></span> <span data-ttu-id="d593b-136">但是，<xref:System.ServiceModel.Description.WsdlImporter.ImportAllContracts%2A>、<xref:System.ServiceModel.Description.WsdlImporter.ImportAllBindings%2A>、<xref:System.ServiceModel.Description.WsdlImporter.ImportAllEndpoints%2A> 和 <xref:System.ServiceModel.Description.WsdlImporter.ImportEndpoints%2A> 方法並不會擲回這些例外狀況，因此您必須檢查 `Errors` 屬性，判斷在呼叫這些方法時是否發生任何問題。</span><span class="sxs-lookup"><span data-stu-id="d593b-136">The <xref:System.ServiceModel.Description.WsdlImporter.ImportAllContracts%2A>, <xref:System.ServiceModel.Description.WsdlImporter.ImportAllBindings%2A>, <xref:System.ServiceModel.Description.WsdlImporter.ImportAllEndpoints%2A>, and <xref:System.ServiceModel.Description.WsdlImporter.ImportEndpoints%2A> methods, however, do not throw these exceptions, so you must check the `Errors` property to determine if any issues occurred when calling these methods.</span></span>  
  
 <span data-ttu-id="d593b-137"><xref:System.ServiceModel.Description.WsdlExporter> 型別會在匯出處理期間重新擲回所有攔截到的例外狀況。</span><span class="sxs-lookup"><span data-stu-id="d593b-137">The <xref:System.ServiceModel.Description.WsdlExporter> type rethrows any exceptions caught during the export process.</span></span> <span data-ttu-id="d593b-138">這些例外狀況不會在 `Errors` 屬性中當成錯誤來擷取。</span><span class="sxs-lookup"><span data-stu-id="d593b-138">These exceptions are not captured as errors in the `Errors` property.</span></span> <span data-ttu-id="d593b-139">一旦 <xref:System.ServiceModel.Description.WsdlExporter> 擲回例外狀況，就會呈現錯誤狀態而無法重複使用。</span><span class="sxs-lookup"><span data-stu-id="d593b-139">Once the <xref:System.ServiceModel.Description.WsdlExporter> throws an exception, it is in a faulted state and cannot be reused.</span></span> <span data-ttu-id="d593b-140">當因為使用萬用字元動作而無法匯出作業，以及當碰到重複的繫結名稱時，<xref:System.ServiceModel.Description.WsdlExporter> 就會將警告新增至自身的 `Errors` 屬性中。</span><span class="sxs-lookup"><span data-stu-id="d593b-140">The <xref:System.ServiceModel.Description.WsdlExporter> does add warnings to its `Errors` property when an operation cannot be exported because it uses wildcard actions and when duplicate binding names are encountered.</span></span>  
  
## <a name="in-this-section"></a><span data-ttu-id="d593b-141">本節內容</span><span class="sxs-lookup"><span data-stu-id="d593b-141">In This Section</span></span>  

 [<span data-ttu-id="d593b-142">作法：將中繼資料匯入服務端點</span><span class="sxs-lookup"><span data-stu-id="d593b-142">How to: Import Metadata into Service Endpoints</span></span>](how-to-import-metadata-into-service-endpoints.md)  
 <span data-ttu-id="d593b-143">說明如何將下載的中繼資料匯入描述物件中。</span><span class="sxs-lookup"><span data-stu-id="d593b-143">Describes how to import downloaded metadata into description objects.</span></span>  
  
 [<span data-ttu-id="d593b-144">作法：從服務端點匯出中繼資料</span><span class="sxs-lookup"><span data-stu-id="d593b-144">How to: Export Metadata from Service Endpoints</span></span>](how-to-export-metadata-from-service-endpoints.md)  
 <span data-ttu-id="d593b-145">說明如何將描述物件匯出至中繼資料。</span><span class="sxs-lookup"><span data-stu-id="d593b-145">Describes how to export description objects into metadata.</span></span>  
  
 [<span data-ttu-id="d593b-146">ServiceDescription 與 WSDL 參考</span><span class="sxs-lookup"><span data-stu-id="d593b-146">ServiceDescription and WSDL Reference</span></span>](servicedescription-and-wsdl-reference.md)  
 <span data-ttu-id="d593b-147">說明描述物件與 WSDL 之間的對應。</span><span class="sxs-lookup"><span data-stu-id="d593b-147">Describes the mapping between the description objects and WSDL.</span></span>  
  
 [<span data-ttu-id="d593b-148">作法：使用 Svcutil.exe 來匯出已編譯服務程式碼的中繼資料</span><span class="sxs-lookup"><span data-stu-id="d593b-148">How to: Use Svcutil.exe to Export Metadata from Compiled Service Code</span></span>](how-to-use-svcutil-exe-to-export-metadata-from-compiled-service-code.md)  
 <span data-ttu-id="d593b-149">說明使用 Svcutil.exe 來匯出編譯組件中有關服務、合約與資料型別的中繼資料。</span><span class="sxs-lookup"><span data-stu-id="d593b-149">Describes the use of Svcutil.exe to export metadata for services, contracts, and data types in compiled assemblies.</span></span>  
  
 [<span data-ttu-id="d593b-150">資料合約結構描述參考</span><span class="sxs-lookup"><span data-stu-id="d593b-150">Data Contract Schema Reference</span></span>](data-contract-schema-reference.md)  
 <span data-ttu-id="d593b-151">說明 <xref:System.Runtime.Serialization.DataContractSerializer> 用來描述 XML 序列化之 Common Language Runtime (CLR) 型別的 XML 結構描述 (XSD) 子集。</span><span class="sxs-lookup"><span data-stu-id="d593b-151">Describes the subset of the XML Schema (XSD) used by <xref:System.Runtime.Serialization.DataContractSerializer> to describe common language run-time (CLR) types for XML serialization.</span></span>  
  
## <a name="reference"></a><span data-ttu-id="d593b-152">參考</span><span class="sxs-lookup"><span data-stu-id="d593b-152">Reference</span></span>  

 <xref:System.ServiceModel.Description.WsdlExporter>  
  
 <xref:System.ServiceModel.Description.WsdlImporter>  
  
## <a name="see-also"></a><span data-ttu-id="d593b-153">另請參閱</span><span class="sxs-lookup"><span data-stu-id="d593b-153">See also</span></span>

- [<span data-ttu-id="d593b-154">匯出 WCF 擴充的自訂中繼資料</span><span class="sxs-lookup"><span data-stu-id="d593b-154">Exporting Custom Metadata for a WCF Extension</span></span>](../extending/exporting-custom-metadata-for-a-wcf-extension.md)
- [<span data-ttu-id="d593b-155">匯入 WCF 擴充的自訂中繼資料</span><span class="sxs-lookup"><span data-stu-id="d593b-155">Importing Custom Metadata for a WCF Extension</span></span>](../extending/importing-custom-metadata-for-a-wcf-extension.md)

---
title: 從服務中繼資料產生 WCF 用戶端
ms.date: 03/30/2017
ms.assetid: 27f8f545-cc44-412a-b104-617e0781b803
ms.openlocfilehash: ebf124b75e7c2b0feabfffb8c7e790b44749edb5
ms.sourcegitcommit: cdb295dd1db589ce5169ac9ff096f01fd0c2da9d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 06/09/2020
ms.locfileid: "84597367"
---
# <a name="generating-a-wcf-client-from-service-metadata"></a><span data-ttu-id="91b6b-102">從服務中繼資料產生 WCF 用戶端</span><span class="sxs-lookup"><span data-stu-id="91b6b-102">Generating a WCF Client from Service Metadata</span></span>
<span data-ttu-id="91b6b-103">本主題說明如何使用 Svcutil.exe 中不同的參數，從中繼資料文件中產生用戶端。</span><span class="sxs-lookup"><span data-stu-id="91b6b-103">This topic describes how to use the various switches in Svcutil.exe to generate clients from metadata documents.</span></span>  
  
 <span data-ttu-id="91b6b-104">中繼資料文件可以位於永久性儲存裝置上或在線上擷取。</span><span class="sxs-lookup"><span data-stu-id="91b6b-104">Metadata documents can be on a durable storage or be retrieved online.</span></span> <span data-ttu-id="91b6b-105">線上擷取會遵循 WS-MetadataExchange 通訊協定或 Microsoft Discovery (DISCO) 通訊協定。</span><span class="sxs-lookup"><span data-stu-id="91b6b-105">Online retrieval follows either the WS-MetadataExchange protocol or the Microsoft Discovery (DISCO) protocol.</span></span> <span data-ttu-id="91b6b-106">Svcutil.exe 會同時發出以下中繼資料要求，以擷取中繼資料：</span><span class="sxs-lookup"><span data-stu-id="91b6b-106">Svcutil.exe issues the following metadata requests simultaneously to retrieve metadata:</span></span>  
  
- <span data-ttu-id="91b6b-107">對所提供位址的 WS-MetadataExchange (MEX) 要求。</span><span class="sxs-lookup"><span data-stu-id="91b6b-107">WS-MetadataExchange (MEX) request to the supplied address.</span></span>  
  
- <span data-ttu-id="91b6b-108">對附加 `/mex` 之所提供位址的 MEX 要求。</span><span class="sxs-lookup"><span data-stu-id="91b6b-108">MEX request to the supplied address with `/mex` appended.</span></span>  
  
- <span data-ttu-id="91b6b-109">DISCO 要求（使用 <xref:System.Web.Services.Discovery.DiscoveryClientProtocol> 從 ASP.NET Web 服務）到提供的位址。</span><span class="sxs-lookup"><span data-stu-id="91b6b-109">DISCO request (using the <xref:System.Web.Services.Discovery.DiscoveryClientProtocol> from ASP.NET Web services) to the supplied address.</span></span>  
  
 <span data-ttu-id="91b6b-110">Svcutil.exe 會根據 Web 服務描述語言 (WSDL) 或從服務收到的原則檔產生用戶端。</span><span class="sxs-lookup"><span data-stu-id="91b6b-110">Svcutil.exe generates the client based on the Web Services Description Language (WSDL) or policy file received from the service.</span></span> <span data-ttu-id="91b6b-111">使用者主體名稱（UPN）是藉由串連使用者名稱與 " \@ "，然後新增完整功能變數名稱（FQDN）所產生。</span><span class="sxs-lookup"><span data-stu-id="91b6b-111">The user principal name (UPN) is generated by concatenating the user name with "\@" and then adding a fully-qualified domain name (FQDN).</span></span> <span data-ttu-id="91b6b-112">不過，針對在 Active Directory 上註冊的使用者，此格式無效，且此工具產生的 UPN 會造成 Kerberos 驗證失敗，並出現下列錯誤訊息：登入**嘗試失敗。**</span><span class="sxs-lookup"><span data-stu-id="91b6b-112">However, for users who registered on Active Directory, this format is not valid and the UPN that the tool generates causes a failure in the Kerberos authentication with the following error message: **The logon attempt failed.**</span></span> <span data-ttu-id="91b6b-113">若要解決這個問題，請手動修復由此工具產生的用戶端檔案。</span><span class="sxs-lookup"><span data-stu-id="91b6b-113">To resolve this problem, manually fix the client file that the tool generated.</span></span>  
  
```console
svcutil.exe [/t:code]  <metadataDocumentPath>* | <url>* | <epr>  
```  
  
## <a name="referencing-and-sharing-types"></a><span data-ttu-id="91b6b-114">參照與共用型別</span><span class="sxs-lookup"><span data-stu-id="91b6b-114">Referencing and Sharing Types</span></span>  
  
|<span data-ttu-id="91b6b-115">選項</span><span class="sxs-lookup"><span data-stu-id="91b6b-115">Option</span></span>|<span data-ttu-id="91b6b-116">描述</span><span class="sxs-lookup"><span data-stu-id="91b6b-116">Description</span></span>|  
|------------|-----------------|  
|<span data-ttu-id="91b6b-117">**/reference\<file path>**</span><span class="sxs-lookup"><span data-stu-id="91b6b-117">**/reference:\<file path>**</span></span>|<span data-ttu-id="91b6b-118">參考指定組件中的型別。</span><span class="sxs-lookup"><span data-stu-id="91b6b-118">References types in the specified assembly.</span></span> <span data-ttu-id="91b6b-119">產生用戶端時，使用這個選項即可指定組件，這些組件可能包含代表匯入之中繼資料的類型。</span><span class="sxs-lookup"><span data-stu-id="91b6b-119">When generating clients, use this option to specify assemblies that might contain types that represent the metadata being imported.</span></span><br /><br /> <span data-ttu-id="91b6b-120">簡短形式：`/r`</span><span class="sxs-lookup"><span data-stu-id="91b6b-120">Short form: `/r`</span></span>|  
|<span data-ttu-id="91b6b-121">**/excludeType:\<type>**</span><span class="sxs-lookup"><span data-stu-id="91b6b-121">**/excludeType:\<type>**</span></span>|<span data-ttu-id="91b6b-122">指定要從參考的合約類型排除的完整型別名稱或組件限定型別名稱。</span><span class="sxs-lookup"><span data-stu-id="91b6b-122">Specifies a fully-qualified or assembly-qualified type name to be excluded from referenced contract types.</span></span><br /><br /> <span data-ttu-id="91b6b-123">簡短形式：`/et`</span><span class="sxs-lookup"><span data-stu-id="91b6b-123">Short form: `/et`</span></span>|  
  
## <a name="choosing-a-serializer"></a><span data-ttu-id="91b6b-124">選擇序列化程式</span><span class="sxs-lookup"><span data-stu-id="91b6b-124">Choosing a Serializer</span></span>  
  
|<span data-ttu-id="91b6b-125">選項</span><span class="sxs-lookup"><span data-stu-id="91b6b-125">Option</span></span>|<span data-ttu-id="91b6b-126">描述</span><span class="sxs-lookup"><span data-stu-id="91b6b-126">Description</span></span>|  
|------------|-----------------|  
|<span data-ttu-id="91b6b-127">**/serializer:Auto**</span><span class="sxs-lookup"><span data-stu-id="91b6b-127">**/serializer:Auto**</span></span>|<span data-ttu-id="91b6b-128">自動選取序列化程式。</span><span class="sxs-lookup"><span data-stu-id="91b6b-128">Automatically selects the serializer.</span></span> <span data-ttu-id="91b6b-129">這會使用 `DataContract` 序列化程式。</span><span class="sxs-lookup"><span data-stu-id="91b6b-129">This uses the `DataContract` serializer.</span></span> <span data-ttu-id="91b6b-130">如果這個作業失敗，則使用 `XmlSerializer`。</span><span class="sxs-lookup"><span data-stu-id="91b6b-130">If this fails, the `XmlSerializer` is used.</span></span><br /><br /> <span data-ttu-id="91b6b-131">簡短形式：`/ser:Auto`</span><span class="sxs-lookup"><span data-stu-id="91b6b-131">Short Form: `/ser:Auto`</span></span>|  
|<span data-ttu-id="91b6b-132">**/serializer:DataContractSerializer**</span><span class="sxs-lookup"><span data-stu-id="91b6b-132">**/serializer:DataContractSerializer**</span></span>|<span data-ttu-id="91b6b-133">產生使用 `DataContract` 序列化程式以進行序列化與還原序列化的資料型別。</span><span class="sxs-lookup"><span data-stu-id="91b6b-133">Generates data types that use the `DataContract` serializer for serialization and deserialization.</span></span><br /><br /> <span data-ttu-id="91b6b-134">簡短形式：`/ser:DataContractSerializer`</span><span class="sxs-lookup"><span data-stu-id="91b6b-134">Short form: `/ser:DataContractSerializer`</span></span>|  
|<span data-ttu-id="91b6b-135">**/serializer:XmlSerializer**</span><span class="sxs-lookup"><span data-stu-id="91b6b-135">**/serializer:XmlSerializer**</span></span>|<span data-ttu-id="91b6b-136">產生使用 `XmlSerializer` 以進行序列化與還原序列化的資料型別。</span><span class="sxs-lookup"><span data-stu-id="91b6b-136">Generates data types that use the `XmlSerializer` for serialization and deserialization.</span></span><br /><br /> <span data-ttu-id="91b6b-137">簡短形式：`/ser:XmlSerializer`</span><span class="sxs-lookup"><span data-stu-id="91b6b-137">Short form: `/ser:XmlSerializer`</span></span>|  
|<span data-ttu-id="91b6b-138">**/importXmlTypes**</span><span class="sxs-lookup"><span data-stu-id="91b6b-138">**/importXmlTypes**</span></span>|<span data-ttu-id="91b6b-139">設定 `DataContract` 序列化程式將非 `DataContract` 型別匯入為 `IXmlSerializable` 型別。</span><span class="sxs-lookup"><span data-stu-id="91b6b-139">Configures the `DataContract` serializer to import non-`DataContract` types as `IXmlSerializable` types.</span></span><br /><br /> <span data-ttu-id="91b6b-140">簡短形式：`/ixt`</span><span class="sxs-lookup"><span data-stu-id="91b6b-140">Short form: `/ixt`</span></span>|  
|<span data-ttu-id="91b6b-141">**/dataContractOnly**</span><span class="sxs-lookup"><span data-stu-id="91b6b-141">**/dataContractOnly**</span></span>|<span data-ttu-id="91b6b-142">只產生 `DataContract` 型別的程式碼。</span><span class="sxs-lookup"><span data-stu-id="91b6b-142">Generates code for `DataContract` types only.</span></span> <span data-ttu-id="91b6b-143">會產生 `ServiceContract` 型別。</span><span class="sxs-lookup"><span data-stu-id="91b6b-143">`ServiceContract` types are generated.</span></span><br /><br /> <span data-ttu-id="91b6b-144">這個選項應該只能指定本機中繼資料檔案。</span><span class="sxs-lookup"><span data-stu-id="91b6b-144">You should specify only local metadata files for this option.</span></span><br /><br /> <span data-ttu-id="91b6b-145">簡短形式：`/dconly`</span><span class="sxs-lookup"><span data-stu-id="91b6b-145">Short form: `/dconly`</span></span>|  
  
## <a name="choosing-a-language-for-the-client"></a><span data-ttu-id="91b6b-146">選擇用戶端語言</span><span class="sxs-lookup"><span data-stu-id="91b6b-146">Choosing a Language for the Client</span></span>  
  
|<span data-ttu-id="91b6b-147">選項</span><span class="sxs-lookup"><span data-stu-id="91b6b-147">Option</span></span>|<span data-ttu-id="91b6b-148">描述</span><span class="sxs-lookup"><span data-stu-id="91b6b-148">Description</span></span>|  
|------------|-----------------|  
|<span data-ttu-id="91b6b-149">**/language\<language>**</span><span class="sxs-lookup"><span data-stu-id="91b6b-149">**/language:\<language>**</span></span>|<span data-ttu-id="91b6b-150">指定要用於產生程式碼的程式語言。</span><span class="sxs-lookup"><span data-stu-id="91b6b-150">Specifies the programming language to use for code generation.</span></span> <span data-ttu-id="91b6b-151">請提供在 Machine.config 檔案中註冊的語言名稱，或繼承自 <xref:System.CodeDom.Compiler.CodeDomProvider> 之類別的完整名稱。</span><span class="sxs-lookup"><span data-stu-id="91b6b-151">Provide either a language name registered in the Machine.config file or the fully-qualified name of a class that inherits from <xref:System.CodeDom.Compiler.CodeDomProvider>.</span></span><br /><br /> <span data-ttu-id="91b6b-152">值：c#、cs、csharp、vb、vbs、visualbasic、vbscript、javascript、c++、mc、cpp</span><span class="sxs-lookup"><span data-stu-id="91b6b-152">Values: c#, cs, csharp, vb, vbs, visualbasic, vbscript, javascript, c++, mc, cpp</span></span><br /><br /> <span data-ttu-id="91b6b-153">預設：csharp</span><span class="sxs-lookup"><span data-stu-id="91b6b-153">Default: csharp</span></span><br /><br /> <span data-ttu-id="91b6b-154">簡短形式：`/l`</span><span class="sxs-lookup"><span data-stu-id="91b6b-154">Short form: `/l`</span></span><br /><br /> <span data-ttu-id="91b6b-155">如需詳細資訊，請參閱 <xref:System.CodeDom.Compiler.CodeDomProvider> 類別。</span><span class="sxs-lookup"><span data-stu-id="91b6b-155">For more information, see <xref:System.CodeDom.Compiler.CodeDomProvider> class.</span></span>|  
  
## <a name="choosing-a-namespace-for-the-client"></a><span data-ttu-id="91b6b-156">選擇用戶端命名空間</span><span class="sxs-lookup"><span data-stu-id="91b6b-156">Choosing a Namespace for the Client</span></span>  
  
|<span data-ttu-id="91b6b-157">選項</span><span class="sxs-lookup"><span data-stu-id="91b6b-157">Option</span></span>|<span data-ttu-id="91b6b-158">描述</span><span class="sxs-lookup"><span data-stu-id="91b6b-158">Description</span></span>|  
|------------|-----------------|  
|<span data-ttu-id="91b6b-159">**/namespace\<string,string>**</span><span class="sxs-lookup"><span data-stu-id="91b6b-159">**/namespace:\<string,string>**</span></span>|<span data-ttu-id="91b6b-160">指定從 WSDL 或 XML 結構描述 `targetNamespace` 到 Common Language Runtime (CLR) 命名空間的對應。</span><span class="sxs-lookup"><span data-stu-id="91b6b-160">Specifies a mapping from a WSDL or XML Schema `targetNamespace` to a common language runtime (CLR) namespace.</span></span> <span data-ttu-id="91b6b-161">使用萬用字元 (\*) 做為 `targetNamespace` 會對應至所有的 `targetNamespaces`，而不會明確對應至該 CLR 命名空間。</span><span class="sxs-lookup"><span data-stu-id="91b6b-161">Using a wildcard (\*) for the `targetNamespace` maps all `targetNamespaces` without an explicit mapping to that CLR namespace.</span></span><br /><br /> <span data-ttu-id="91b6b-162">為了確保訊息合約名稱不會與作業名稱衝突，您應該以雙冒號 (`::`) 來限定型別參照，或確定名稱為唯一。</span><span class="sxs-lookup"><span data-stu-id="91b6b-162">To make sure that the message contract name does not collide with the operation name, either qualify the type reference with double colons (`::`) or make sure the names are unique.</span></span><br /><br /> <span data-ttu-id="91b6b-163">預設：衍生自 `DataContracts` 的結構描述文件之目標命名空間。</span><span class="sxs-lookup"><span data-stu-id="91b6b-163">Default: Derived from the target namespace of the schema document for `DataContracts`.</span></span> <span data-ttu-id="91b6b-164">預設命名空間用於所有其他產生的型別。</span><span class="sxs-lookup"><span data-stu-id="91b6b-164">The default namespace is used for all other generated types.</span></span><br /><br /> <span data-ttu-id="91b6b-165">簡短形式：`/n`</span><span class="sxs-lookup"><span data-stu-id="91b6b-165">Short form: `/n`</span></span>|  
  
## <a name="choosing-a-data-binding"></a><span data-ttu-id="91b6b-166">選擇資料繫結</span><span class="sxs-lookup"><span data-stu-id="91b6b-166">Choosing a Data Binding</span></span>  
  
|<span data-ttu-id="91b6b-167">選項</span><span class="sxs-lookup"><span data-stu-id="91b6b-167">Option</span></span>|<span data-ttu-id="91b6b-168">描述</span><span class="sxs-lookup"><span data-stu-id="91b6b-168">Description</span></span>|  
|------------|-----------------|  
|<span data-ttu-id="91b6b-169">**/enableDataBinding**</span><span class="sxs-lookup"><span data-stu-id="91b6b-169">**/enableDataBinding**</span></span>|<span data-ttu-id="91b6b-170">在所有 <xref:System.ComponentModel.INotifyPropertyChanged> 型別上實作 `DataContract` 介面，以啟用資料繫結。</span><span class="sxs-lookup"><span data-stu-id="91b6b-170">Implements the <xref:System.ComponentModel.INotifyPropertyChanged> interface on all `DataContract` types to enable data binding.</span></span><br /><br /> <span data-ttu-id="91b6b-171">簡短形式：`/edb`</span><span class="sxs-lookup"><span data-stu-id="91b6b-171">Short form: `/edb`</span></span>|  
  
## <a name="generating-configuration"></a><span data-ttu-id="91b6b-172">產生組態</span><span class="sxs-lookup"><span data-stu-id="91b6b-172">Generating Configuration</span></span>  
  
|<span data-ttu-id="91b6b-173">選項</span><span class="sxs-lookup"><span data-stu-id="91b6b-173">Option</span></span>|<span data-ttu-id="91b6b-174">描述</span><span class="sxs-lookup"><span data-stu-id="91b6b-174">Description</span></span>|  
|------------|-----------------|  
|<span data-ttu-id="91b6b-175">**/config\<configFile>**</span><span class="sxs-lookup"><span data-stu-id="91b6b-175">**/config:\<configFile>**</span></span>|<span data-ttu-id="91b6b-176">針對產生的組態檔指定檔案名稱。</span><span class="sxs-lookup"><span data-stu-id="91b6b-176">Specifies the file name for the generated configuration file.</span></span><br /><br /> <span data-ttu-id="91b6b-177">預設：output.config</span><span class="sxs-lookup"><span data-stu-id="91b6b-177">Default: output.config</span></span>|  
|<span data-ttu-id="91b6b-178">**/mergeConfig**</span><span class="sxs-lookup"><span data-stu-id="91b6b-178">**/mergeConfig**</span></span>|<span data-ttu-id="91b6b-179">將產生的組態合併至現有檔案，而非覆寫現有檔案。</span><span class="sxs-lookup"><span data-stu-id="91b6b-179">Merges the generated configuration into an existing file, instead of overwriting the existing file.</span></span>|  
|<span data-ttu-id="91b6b-180">**/noConfig**</span><span class="sxs-lookup"><span data-stu-id="91b6b-180">**/noConfig**</span></span>|<span data-ttu-id="91b6b-181">不要產生組態檔。</span><span class="sxs-lookup"><span data-stu-id="91b6b-181">Do not generate configuration files.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="91b6b-182">請參閱</span><span class="sxs-lookup"><span data-stu-id="91b6b-182">See also</span></span>

- [<span data-ttu-id="91b6b-183">使用中繼資料</span><span class="sxs-lookup"><span data-stu-id="91b6b-183">Using Metadata</span></span>](using-metadata.md)
- [<span data-ttu-id="91b6b-184">中繼資料架構概觀</span><span class="sxs-lookup"><span data-stu-id="91b6b-184">Metadata Architecture Overview</span></span>](metadata-architecture-overview.md)

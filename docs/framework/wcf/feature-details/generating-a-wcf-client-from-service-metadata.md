---
title: 從服務中繼資料產生 WCF 用戶端
description: 探索 Svcutil.exe 中的各種交換器，這些參數是用來根據 WSDL 或服務的原則檔案，從服務元資料檔案產生 WFC 用戶端。
ms.date: 03/30/2017
ms.assetid: 27f8f545-cc44-412a-b104-617e0781b803
ms.openlocfilehash: f755a092fb3596349a6878c61fe414f4e0a9f9d1
ms.sourcegitcommit: 358a28048f36a8dca39a9fe6e6ac1f1913acadd5
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 06/23/2020
ms.locfileid: "85247269"
---
# <a name="generating-a-wcf-client-from-service-metadata"></a><span data-ttu-id="98e9d-103">從服務中繼資料產生 WCF 用戶端</span><span class="sxs-lookup"><span data-stu-id="98e9d-103">Generating a WCF Client from Service Metadata</span></span>
<span data-ttu-id="98e9d-104">本主題說明如何使用 Svcutil.exe 中不同的參數，從中繼資料文件中產生用戶端。</span><span class="sxs-lookup"><span data-stu-id="98e9d-104">This topic describes how to use the various switches in Svcutil.exe to generate clients from metadata documents.</span></span>  
  
 <span data-ttu-id="98e9d-105">中繼資料文件可以位於永久性儲存裝置上或在線上擷取。</span><span class="sxs-lookup"><span data-stu-id="98e9d-105">Metadata documents can be on a durable storage or be retrieved online.</span></span> <span data-ttu-id="98e9d-106">線上擷取會遵循 WS-MetadataExchange 通訊協定或 Microsoft Discovery (DISCO) 通訊協定。</span><span class="sxs-lookup"><span data-stu-id="98e9d-106">Online retrieval follows either the WS-MetadataExchange protocol or the Microsoft Discovery (DISCO) protocol.</span></span> <span data-ttu-id="98e9d-107">Svcutil.exe 會同時發出以下中繼資料要求，以擷取中繼資料：</span><span class="sxs-lookup"><span data-stu-id="98e9d-107">Svcutil.exe issues the following metadata requests simultaneously to retrieve metadata:</span></span>  
  
- <span data-ttu-id="98e9d-108">對所提供位址的 WS-MetadataExchange (MEX) 要求。</span><span class="sxs-lookup"><span data-stu-id="98e9d-108">WS-MetadataExchange (MEX) request to the supplied address.</span></span>  
  
- <span data-ttu-id="98e9d-109">對附加 `/mex` 之所提供位址的 MEX 要求。</span><span class="sxs-lookup"><span data-stu-id="98e9d-109">MEX request to the supplied address with `/mex` appended.</span></span>  
  
- <span data-ttu-id="98e9d-110">DISCO 要求（使用 <xref:System.Web.Services.Discovery.DiscoveryClientProtocol> 從 ASP.NET Web 服務）到提供的位址。</span><span class="sxs-lookup"><span data-stu-id="98e9d-110">DISCO request (using the <xref:System.Web.Services.Discovery.DiscoveryClientProtocol> from ASP.NET Web services) to the supplied address.</span></span>  
  
 <span data-ttu-id="98e9d-111">Svcutil.exe 會根據 Web 服務描述語言 (WSDL) 或從服務收到的原則檔產生用戶端。</span><span class="sxs-lookup"><span data-stu-id="98e9d-111">Svcutil.exe generates the client based on the Web Services Description Language (WSDL) or policy file received from the service.</span></span> <span data-ttu-id="98e9d-112">使用者主體名稱（UPN）是藉由串連使用者名稱與 " \@ "，然後新增完整功能變數名稱（FQDN）所產生。</span><span class="sxs-lookup"><span data-stu-id="98e9d-112">The user principal name (UPN) is generated by concatenating the user name with "\@" and then adding a fully-qualified domain name (FQDN).</span></span> <span data-ttu-id="98e9d-113">不過，針對在 Active Directory 上註冊的使用者，此格式無效，且此工具產生的 UPN 會造成 Kerberos 驗證失敗，並出現下列錯誤訊息：登入**嘗試失敗。**</span><span class="sxs-lookup"><span data-stu-id="98e9d-113">However, for users who registered on Active Directory, this format is not valid and the UPN that the tool generates causes a failure in the Kerberos authentication with the following error message: **The logon attempt failed.**</span></span> <span data-ttu-id="98e9d-114">若要解決這個問題，請手動修復由此工具產生的用戶端檔案。</span><span class="sxs-lookup"><span data-stu-id="98e9d-114">To resolve this problem, manually fix the client file that the tool generated.</span></span>  
  
```console
svcutil.exe [/t:code]  <metadataDocumentPath>* | <url>* | <epr>  
```  
  
## <a name="referencing-and-sharing-types"></a><span data-ttu-id="98e9d-115">參照與共用型別</span><span class="sxs-lookup"><span data-stu-id="98e9d-115">Referencing and Sharing Types</span></span>  
  
|<span data-ttu-id="98e9d-116">選項</span><span class="sxs-lookup"><span data-stu-id="98e9d-116">Option</span></span>|<span data-ttu-id="98e9d-117">描述</span><span class="sxs-lookup"><span data-stu-id="98e9d-117">Description</span></span>|  
|------------|-----------------|  
|<span data-ttu-id="98e9d-118">**/reference\<file path>**</span><span class="sxs-lookup"><span data-stu-id="98e9d-118">**/reference:\<file path>**</span></span>|<span data-ttu-id="98e9d-119">參考指定組件中的型別。</span><span class="sxs-lookup"><span data-stu-id="98e9d-119">References types in the specified assembly.</span></span> <span data-ttu-id="98e9d-120">產生用戶端時，使用這個選項即可指定組件，這些組件可能包含代表匯入之中繼資料的類型。</span><span class="sxs-lookup"><span data-stu-id="98e9d-120">When generating clients, use this option to specify assemblies that might contain types that represent the metadata being imported.</span></span><br /><br /> <span data-ttu-id="98e9d-121">簡短形式：`/r`</span><span class="sxs-lookup"><span data-stu-id="98e9d-121">Short form: `/r`</span></span>|  
|<span data-ttu-id="98e9d-122">**/excludeType:\<type>**</span><span class="sxs-lookup"><span data-stu-id="98e9d-122">**/excludeType:\<type>**</span></span>|<span data-ttu-id="98e9d-123">指定要從參考的合約類型排除的完整型別名稱或組件限定型別名稱。</span><span class="sxs-lookup"><span data-stu-id="98e9d-123">Specifies a fully-qualified or assembly-qualified type name to be excluded from referenced contract types.</span></span><br /><br /> <span data-ttu-id="98e9d-124">簡短形式：`/et`</span><span class="sxs-lookup"><span data-stu-id="98e9d-124">Short form: `/et`</span></span>|  
  
## <a name="choosing-a-serializer"></a><span data-ttu-id="98e9d-125">選擇序列化程式</span><span class="sxs-lookup"><span data-stu-id="98e9d-125">Choosing a Serializer</span></span>  
  
|<span data-ttu-id="98e9d-126">選項</span><span class="sxs-lookup"><span data-stu-id="98e9d-126">Option</span></span>|<span data-ttu-id="98e9d-127">描述</span><span class="sxs-lookup"><span data-stu-id="98e9d-127">Description</span></span>|  
|------------|-----------------|  
|<span data-ttu-id="98e9d-128">**/serializer:Auto**</span><span class="sxs-lookup"><span data-stu-id="98e9d-128">**/serializer:Auto**</span></span>|<span data-ttu-id="98e9d-129">自動選取序列化程式。</span><span class="sxs-lookup"><span data-stu-id="98e9d-129">Automatically selects the serializer.</span></span> <span data-ttu-id="98e9d-130">這會使用 `DataContract` 序列化程式。</span><span class="sxs-lookup"><span data-stu-id="98e9d-130">This uses the `DataContract` serializer.</span></span> <span data-ttu-id="98e9d-131">如果這個作業失敗，則使用 `XmlSerializer`。</span><span class="sxs-lookup"><span data-stu-id="98e9d-131">If this fails, the `XmlSerializer` is used.</span></span><br /><br /> <span data-ttu-id="98e9d-132">簡短形式：`/ser:Auto`</span><span class="sxs-lookup"><span data-stu-id="98e9d-132">Short Form: `/ser:Auto`</span></span>|  
|<span data-ttu-id="98e9d-133">**/serializer:DataContractSerializer**</span><span class="sxs-lookup"><span data-stu-id="98e9d-133">**/serializer:DataContractSerializer**</span></span>|<span data-ttu-id="98e9d-134">產生使用 `DataContract` 序列化程式以進行序列化與還原序列化的資料型別。</span><span class="sxs-lookup"><span data-stu-id="98e9d-134">Generates data types that use the `DataContract` serializer for serialization and deserialization.</span></span><br /><br /> <span data-ttu-id="98e9d-135">簡短形式：`/ser:DataContractSerializer`</span><span class="sxs-lookup"><span data-stu-id="98e9d-135">Short form: `/ser:DataContractSerializer`</span></span>|  
|<span data-ttu-id="98e9d-136">**/serializer:XmlSerializer**</span><span class="sxs-lookup"><span data-stu-id="98e9d-136">**/serializer:XmlSerializer**</span></span>|<span data-ttu-id="98e9d-137">產生使用 `XmlSerializer` 以進行序列化與還原序列化的資料型別。</span><span class="sxs-lookup"><span data-stu-id="98e9d-137">Generates data types that use the `XmlSerializer` for serialization and deserialization.</span></span><br /><br /> <span data-ttu-id="98e9d-138">簡短形式：`/ser:XmlSerializer`</span><span class="sxs-lookup"><span data-stu-id="98e9d-138">Short form: `/ser:XmlSerializer`</span></span>|  
|<span data-ttu-id="98e9d-139">**/importXmlTypes**</span><span class="sxs-lookup"><span data-stu-id="98e9d-139">**/importXmlTypes**</span></span>|<span data-ttu-id="98e9d-140">設定 `DataContract` 序列化程式將非 `DataContract` 型別匯入為 `IXmlSerializable` 型別。</span><span class="sxs-lookup"><span data-stu-id="98e9d-140">Configures the `DataContract` serializer to import non-`DataContract` types as `IXmlSerializable` types.</span></span><br /><br /> <span data-ttu-id="98e9d-141">簡短形式：`/ixt`</span><span class="sxs-lookup"><span data-stu-id="98e9d-141">Short form: `/ixt`</span></span>|  
|<span data-ttu-id="98e9d-142">**/dataContractOnly**</span><span class="sxs-lookup"><span data-stu-id="98e9d-142">**/dataContractOnly**</span></span>|<span data-ttu-id="98e9d-143">只產生 `DataContract` 型別的程式碼。</span><span class="sxs-lookup"><span data-stu-id="98e9d-143">Generates code for `DataContract` types only.</span></span> <span data-ttu-id="98e9d-144">會產生 `ServiceContract` 型別。</span><span class="sxs-lookup"><span data-stu-id="98e9d-144">`ServiceContract` types are generated.</span></span><br /><br /> <span data-ttu-id="98e9d-145">這個選項應該只能指定本機中繼資料檔案。</span><span class="sxs-lookup"><span data-stu-id="98e9d-145">You should specify only local metadata files for this option.</span></span><br /><br /> <span data-ttu-id="98e9d-146">簡短形式：`/dconly`</span><span class="sxs-lookup"><span data-stu-id="98e9d-146">Short form: `/dconly`</span></span>|  
  
## <a name="choosing-a-language-for-the-client"></a><span data-ttu-id="98e9d-147">選擇用戶端語言</span><span class="sxs-lookup"><span data-stu-id="98e9d-147">Choosing a Language for the Client</span></span>  
  
|<span data-ttu-id="98e9d-148">選項</span><span class="sxs-lookup"><span data-stu-id="98e9d-148">Option</span></span>|<span data-ttu-id="98e9d-149">描述</span><span class="sxs-lookup"><span data-stu-id="98e9d-149">Description</span></span>|  
|------------|-----------------|  
|<span data-ttu-id="98e9d-150">**/language\<language>**</span><span class="sxs-lookup"><span data-stu-id="98e9d-150">**/language:\<language>**</span></span>|<span data-ttu-id="98e9d-151">指定要用於產生程式碼的程式語言。</span><span class="sxs-lookup"><span data-stu-id="98e9d-151">Specifies the programming language to use for code generation.</span></span> <span data-ttu-id="98e9d-152">請提供在 Machine.config 檔案中註冊的語言名稱，或繼承自 <xref:System.CodeDom.Compiler.CodeDomProvider> 之類別的完整名稱。</span><span class="sxs-lookup"><span data-stu-id="98e9d-152">Provide either a language name registered in the Machine.config file or the fully-qualified name of a class that inherits from <xref:System.CodeDom.Compiler.CodeDomProvider>.</span></span><br /><br /> <span data-ttu-id="98e9d-153">值：c#、cs、csharp、vb、vbs、visualbasic、vbscript、javascript、c++、mc、cpp</span><span class="sxs-lookup"><span data-stu-id="98e9d-153">Values: c#, cs, csharp, vb, vbs, visualbasic, vbscript, javascript, c++, mc, cpp</span></span><br /><br /> <span data-ttu-id="98e9d-154">預設：csharp</span><span class="sxs-lookup"><span data-stu-id="98e9d-154">Default: csharp</span></span><br /><br /> <span data-ttu-id="98e9d-155">簡短形式：`/l`</span><span class="sxs-lookup"><span data-stu-id="98e9d-155">Short form: `/l`</span></span><br /><br /> <span data-ttu-id="98e9d-156">如需詳細資訊，請參閱 <xref:System.CodeDom.Compiler.CodeDomProvider> 類別。</span><span class="sxs-lookup"><span data-stu-id="98e9d-156">For more information, see <xref:System.CodeDom.Compiler.CodeDomProvider> class.</span></span>|  
  
## <a name="choosing-a-namespace-for-the-client"></a><span data-ttu-id="98e9d-157">選擇用戶端命名空間</span><span class="sxs-lookup"><span data-stu-id="98e9d-157">Choosing a Namespace for the Client</span></span>  
  
|<span data-ttu-id="98e9d-158">選項</span><span class="sxs-lookup"><span data-stu-id="98e9d-158">Option</span></span>|<span data-ttu-id="98e9d-159">描述</span><span class="sxs-lookup"><span data-stu-id="98e9d-159">Description</span></span>|  
|------------|-----------------|  
|<span data-ttu-id="98e9d-160">**/namespace\<string,string>**</span><span class="sxs-lookup"><span data-stu-id="98e9d-160">**/namespace:\<string,string>**</span></span>|<span data-ttu-id="98e9d-161">指定從 WSDL 或 XML 結構描述 `targetNamespace` 到 Common Language Runtime (CLR) 命名空間的對應。</span><span class="sxs-lookup"><span data-stu-id="98e9d-161">Specifies a mapping from a WSDL or XML Schema `targetNamespace` to a common language runtime (CLR) namespace.</span></span> <span data-ttu-id="98e9d-162">使用萬用字元 (\*) 做為 `targetNamespace` 會對應至所有的 `targetNamespaces`，而不會明確對應至該 CLR 命名空間。</span><span class="sxs-lookup"><span data-stu-id="98e9d-162">Using a wildcard (\*) for the `targetNamespace` maps all `targetNamespaces` without an explicit mapping to that CLR namespace.</span></span><br /><br /> <span data-ttu-id="98e9d-163">為了確保訊息合約名稱不會與作業名稱衝突，您應該以雙冒號 (`::`) 來限定型別參照，或確定名稱為唯一。</span><span class="sxs-lookup"><span data-stu-id="98e9d-163">To make sure that the message contract name does not collide with the operation name, either qualify the type reference with double colons (`::`) or make sure the names are unique.</span></span><br /><br /> <span data-ttu-id="98e9d-164">預設：衍生自 `DataContracts` 的結構描述文件之目標命名空間。</span><span class="sxs-lookup"><span data-stu-id="98e9d-164">Default: Derived from the target namespace of the schema document for `DataContracts`.</span></span> <span data-ttu-id="98e9d-165">預設命名空間用於所有其他產生的型別。</span><span class="sxs-lookup"><span data-stu-id="98e9d-165">The default namespace is used for all other generated types.</span></span><br /><br /> <span data-ttu-id="98e9d-166">簡短形式：`/n`</span><span class="sxs-lookup"><span data-stu-id="98e9d-166">Short form: `/n`</span></span>|  
  
## <a name="choosing-a-data-binding"></a><span data-ttu-id="98e9d-167">選擇資料繫結</span><span class="sxs-lookup"><span data-stu-id="98e9d-167">Choosing a Data Binding</span></span>  
  
|<span data-ttu-id="98e9d-168">選項</span><span class="sxs-lookup"><span data-stu-id="98e9d-168">Option</span></span>|<span data-ttu-id="98e9d-169">描述</span><span class="sxs-lookup"><span data-stu-id="98e9d-169">Description</span></span>|  
|------------|-----------------|  
|<span data-ttu-id="98e9d-170">**/enableDataBinding**</span><span class="sxs-lookup"><span data-stu-id="98e9d-170">**/enableDataBinding**</span></span>|<span data-ttu-id="98e9d-171">在所有 <xref:System.ComponentModel.INotifyPropertyChanged> 型別上實作 `DataContract` 介面，以啟用資料繫結。</span><span class="sxs-lookup"><span data-stu-id="98e9d-171">Implements the <xref:System.ComponentModel.INotifyPropertyChanged> interface on all `DataContract` types to enable data binding.</span></span><br /><br /> <span data-ttu-id="98e9d-172">簡短形式：`/edb`</span><span class="sxs-lookup"><span data-stu-id="98e9d-172">Short form: `/edb`</span></span>|  
  
## <a name="generating-configuration"></a><span data-ttu-id="98e9d-173">產生組態</span><span class="sxs-lookup"><span data-stu-id="98e9d-173">Generating Configuration</span></span>  
  
|<span data-ttu-id="98e9d-174">選項</span><span class="sxs-lookup"><span data-stu-id="98e9d-174">Option</span></span>|<span data-ttu-id="98e9d-175">描述</span><span class="sxs-lookup"><span data-stu-id="98e9d-175">Description</span></span>|  
|------------|-----------------|  
|<span data-ttu-id="98e9d-176">**/config\<configFile>**</span><span class="sxs-lookup"><span data-stu-id="98e9d-176">**/config:\<configFile>**</span></span>|<span data-ttu-id="98e9d-177">針對產生的組態檔指定檔案名稱。</span><span class="sxs-lookup"><span data-stu-id="98e9d-177">Specifies the file name for the generated configuration file.</span></span><br /><br /> <span data-ttu-id="98e9d-178">預設：output.config</span><span class="sxs-lookup"><span data-stu-id="98e9d-178">Default: output.config</span></span>|  
|<span data-ttu-id="98e9d-179">**/mergeConfig**</span><span class="sxs-lookup"><span data-stu-id="98e9d-179">**/mergeConfig**</span></span>|<span data-ttu-id="98e9d-180">將產生的組態合併至現有檔案，而非覆寫現有檔案。</span><span class="sxs-lookup"><span data-stu-id="98e9d-180">Merges the generated configuration into an existing file, instead of overwriting the existing file.</span></span>|  
|<span data-ttu-id="98e9d-181">**/noConfig**</span><span class="sxs-lookup"><span data-stu-id="98e9d-181">**/noConfig**</span></span>|<span data-ttu-id="98e9d-182">不要產生組態檔。</span><span class="sxs-lookup"><span data-stu-id="98e9d-182">Do not generate configuration files.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="98e9d-183">另請參閱</span><span class="sxs-lookup"><span data-stu-id="98e9d-183">See also</span></span>

- [<span data-ttu-id="98e9d-184">使用中繼資料</span><span class="sxs-lookup"><span data-stu-id="98e9d-184">Using Metadata</span></span>](using-metadata.md)
- [<span data-ttu-id="98e9d-185">中繼資料架構概觀</span><span class="sxs-lookup"><span data-stu-id="98e9d-185">Metadata Architecture Overview</span></span>](metadata-architecture-overview.md)

---
title: 使用傳輸安全性來確保訊息的安全
ms.date: 03/30/2017
ms.assetid: 9029771a-097e-448a-a13a-55d2878330b8
ms.openlocfilehash: 7d160f6f0d1d29e34ca3365501b86d1a736de67b
ms.sourcegitcommit: cdb295dd1db589ce5169ac9ff096f01fd0c2da9d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 06/09/2020
ms.locfileid: "84589938"
---
# <a name="securing-messages-using-transport-security"></a><span data-ttu-id="1b37d-102">使用傳輸安全性來確保訊息的安全</span><span class="sxs-lookup"><span data-stu-id="1b37d-102">Securing Messages Using Transport Security</span></span>
<span data-ttu-id="1b37d-103">本節討論訊息佇列 (MSMQ) 的傳輸安全性，您可以使用這項傳輸安全性確保傳送至佇列之訊息的安全。</span><span class="sxs-lookup"><span data-stu-id="1b37d-103">This section discusses Message Queuing (MSMQ) transport security that you can use to secure messages sent to a queue.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="1b37d-104">閱讀本主題之前，建議您先閱讀[安全性概念](security-concepts.md)。</span><span class="sxs-lookup"><span data-stu-id="1b37d-104">Before reading through this topic, it is recommended that you read [Security Concepts](security-concepts.md).</span></span>  
  
 <span data-ttu-id="1b37d-105">下圖提供使用 Windows Communication Foundation （WCF）之佇列通訊的概念模型。</span><span class="sxs-lookup"><span data-stu-id="1b37d-105">The following illustration provides a conceptual model of queued communication using Windows Communication Foundation (WCF).</span></span> <span data-ttu-id="1b37d-106">這張圖與用語可用來解釋傳輸安全性的概念。</span><span class="sxs-lookup"><span data-stu-id="1b37d-106">This illustration and terminology is used to explain transport security concepts.</span></span>  
  
 <span data-ttu-id="1b37d-107">![佇列應用程式圖表](media/distributed-queue-figure.jpg "分散式-佇列-圖表")</span><span class="sxs-lookup"><span data-stu-id="1b37d-107">![Queued Application Diagram](media/distributed-queue-figure.jpg "Distributed-Queue-Figure")</span></span>  
  
 <span data-ttu-id="1b37d-108">使用 WCF 與傳送佇列訊息時 <xref:System.ServiceModel.NetMsmqBinding> ，wcf 訊息會附加為 MSMQ 訊息的主體。</span><span class="sxs-lookup"><span data-stu-id="1b37d-108">When sending queued messages using WCF with <xref:System.ServiceModel.NetMsmqBinding>, the WCF message is attached as a body of the MSMQ message.</span></span> <span data-ttu-id="1b37d-109">傳輸安全性保障整個 MSMQ 訊息 (MSMQ 訊息標頭或屬性和訊息本文) 的安全。</span><span class="sxs-lookup"><span data-stu-id="1b37d-109">Transport security secures the entire MSMQ message (MSMQ message headers or properties and the message body).</span></span> <span data-ttu-id="1b37d-110">因為它是 MSMQ 訊息的主體，所以使用傳輸安全性也會保護 WCF 訊息。</span><span class="sxs-lookup"><span data-stu-id="1b37d-110">Because it is the body of the MSMQ message, using transport security also secures the WCF message.</span></span>  
  
 <span data-ttu-id="1b37d-111">傳輸安全性的重要概念是用戶端必須滿足安全性要求，才能讓訊息傳至目標佇列。</span><span class="sxs-lookup"><span data-stu-id="1b37d-111">The key concept behind transport security is that the client has to meet security requirements to get the message to the target queue.</span></span> <span data-ttu-id="1b37d-112">這種概念與訊息安全性不同，訊息安全性保障訊息的目的是為了接收該訊息之應用程式的安全。</span><span class="sxs-lookup"><span data-stu-id="1b37d-112">This is unlike Message security, where the message is secured for the application that receives the message.</span></span>  
  
 <span data-ttu-id="1b37d-113">使用 <xref:System.ServiceModel.NetMsmqBinding> 與 <xref:System.ServiceModel.MsmqIntegration.MsmqIntegrationBinding> 的傳輸安全性，會影響 MSMQ 訊息在傳輸佇列與目標佇列之間傳輸時保障安全的方式，保障安全的意思是：</span><span class="sxs-lookup"><span data-stu-id="1b37d-113">Transport security using <xref:System.ServiceModel.NetMsmqBinding> and <xref:System.ServiceModel.MsmqIntegration.MsmqIntegrationBinding> impacts how MSMQ messages are secured in-transit between the transmission queue and the target queue where secured implies:</span></span>  
  
- <span data-ttu-id="1b37d-114">簽署訊息以確保不會被竄改。</span><span class="sxs-lookup"><span data-stu-id="1b37d-114">Signing the message to ensure it is not tampered with.</span></span>  
  
- <span data-ttu-id="1b37d-115">加密訊息以確保不會被看見或竄改。</span><span class="sxs-lookup"><span data-stu-id="1b37d-115">Encrypting the message to ensure that it cannot be seen or tampered with.</span></span> <span data-ttu-id="1b37d-116">這只是建議，可自由選擇。</span><span class="sxs-lookup"><span data-stu-id="1b37d-116">This is recommended but optional.</span></span>  
  
- <span data-ttu-id="1b37d-117">針對不可否認性，識別訊息寄件人的目標佇列管理員。</span><span class="sxs-lookup"><span data-stu-id="1b37d-117">The target queue manager that identifies the sender of the message for non-repudiation.</span></span>  
  
 <span data-ttu-id="1b37d-118">在 MSMQ 中，目標佇列擁有存取控制清單 (ACL)，用來檢查用戶端是否擁有傳送訊息至目標佇列的授權，這部分與驗證無關。</span><span class="sxs-lookup"><span data-stu-id="1b37d-118">In MSMQ, independent of authentication, the target queue has an access control list (ACL) to check whether the client has permission to send the message to the target queue.</span></span> <span data-ttu-id="1b37d-119">同時也檢查接收的應用程式是否擁有自目標佇列接收訊息的權限。</span><span class="sxs-lookup"><span data-stu-id="1b37d-119">The receiving application is also checked for permission to receive the message from the target queue.</span></span>  
  
## <a name="wcf-msmq-transport-security-properties"></a><span data-ttu-id="1b37d-120">WCF MSMQ 傳輸安全性屬性</span><span class="sxs-lookup"><span data-stu-id="1b37d-120">WCF MSMQ Transport Security Properties</span></span>  
 <span data-ttu-id="1b37d-121">MSMQ 使用 Windows 驗證安全性。</span><span class="sxs-lookup"><span data-stu-id="1b37d-121">MSMQ uses Windows security for authentication.</span></span> <span data-ttu-id="1b37d-122">它使用 Windows 安全性識別項 (SID) 識別用戶端，並使用 Active Directory 目錄服務作為驗證用戶端時的憑證授權單位。</span><span class="sxs-lookup"><span data-stu-id="1b37d-122">It uses the Windows security identifier (SID) to identify the client and uses Active Directory directory service as the certificate authority when authenticating the client.</span></span> <span data-ttu-id="1b37d-123">這需要安裝整合 Active Directory 的 MSMQ。</span><span class="sxs-lookup"><span data-stu-id="1b37d-123">This requires MSMQ to be installed with Active Directory integration.</span></span> <span data-ttu-id="1b37d-124">因為使用 Windows 網域 SID 來識別用戶端，故此安全性選項僅在用戶端與服務皆屬相同的 Windows 網域之一部分才有意義。</span><span class="sxs-lookup"><span data-stu-id="1b37d-124">Because the Windows domain SID is used to identify the client, this security option is only meaningful when both the client and service are part of the same Windows domain.</span></span>  
  
 <span data-ttu-id="1b37d-125">MSMQ 也能對未以 Active Directory 註冊的訊息附加憑證。</span><span class="sxs-lookup"><span data-stu-id="1b37d-125">MSMQ also provides the ability to attach a certificate with the message that is not registered with Active Directory.</span></span> <span data-ttu-id="1b37d-126">在這種狀況下，它能確保訊息使用附加的憑證進行簽章。</span><span class="sxs-lookup"><span data-stu-id="1b37d-126">In this case, it ensures that the message was signed using the attached certificate.</span></span>  
  
 <span data-ttu-id="1b37d-127">WCF 同時提供這兩個選項做為 MSMQ 傳輸安全性的一部分，而且是傳輸安全性的重要樞紐分析表。</span><span class="sxs-lookup"><span data-stu-id="1b37d-127">WCF provides both these options as part of MSMQ transport security and they are the key pivot for transport security.</span></span>  
  
 <span data-ttu-id="1b37d-128">根據預設，傳輸安全性為啟用狀態。</span><span class="sxs-lookup"><span data-stu-id="1b37d-128">By default, transport security is turned on.</span></span>  
  
 <span data-ttu-id="1b37d-129">有了這些基礎之後，下列章節將詳述隨附於  與 的傳輸安全性屬性。</span><span class="sxs-lookup"><span data-stu-id="1b37d-129">Given these basics, the following sections detail transport security properties bundled with <xref:System.ServiceModel.NetMsmqBinding> and <xref:System.ServiceModel.MsmqIntegration.MsmqIntegrationBinding>.</span></span>  
  
#### <a name="msmq-authentication-mode"></a><span data-ttu-id="1b37d-130">MSMQ 驗證模式</span><span class="sxs-lookup"><span data-stu-id="1b37d-130">MSMQ Authentication Mode</span></span>  
 <span data-ttu-id="1b37d-131"><xref:System.ServiceModel.MsmqTransportSecurity.MsmqAuthenticationMode%2A> 會要求使用 Windows 網域安全性或外部以憑證為基礎的安全性，藉此保障訊息的安全。</span><span class="sxs-lookup"><span data-stu-id="1b37d-131">The <xref:System.ServiceModel.MsmqTransportSecurity.MsmqAuthenticationMode%2A> dictates whether to use the Windows domain security or an external certificate-based security to secure the message.</span></span> <span data-ttu-id="1b37d-132">在這兩種驗證模式中，WCF 佇列傳輸通道會使用 `CertificateValidationMode` 服務設定中指定的。</span><span class="sxs-lookup"><span data-stu-id="1b37d-132">In both authentication modes, the WCF queued transport channel uses the `CertificateValidationMode` specified in the service configuration.</span></span> <span data-ttu-id="1b37d-133">憑證驗證模式可指定用來檢查憑證效力的機制。</span><span class="sxs-lookup"><span data-stu-id="1b37d-133">The certificate validation mode specifies the mechanism used to check the validity of the certificate.</span></span>  
  
 <span data-ttu-id="1b37d-134">啟用傳輸安全性後，預設的設定值為 <xref:System.ServiceModel.MsmqAuthenticationMode.WindowsDomain>。</span><span class="sxs-lookup"><span data-stu-id="1b37d-134">When transport security is turned on, the default setting is <xref:System.ServiceModel.MsmqAuthenticationMode.WindowsDomain>.</span></span>  
  
#### <a name="windows-domain-authentication-mode"></a><span data-ttu-id="1b37d-135">Windows 網域驗證模式</span><span class="sxs-lookup"><span data-stu-id="1b37d-135">Windows Domain Authentication Mode</span></span>  
 <span data-ttu-id="1b37d-136">若選擇使用 Windows 安全性，就需要整合 Active Directory。</span><span class="sxs-lookup"><span data-stu-id="1b37d-136">The choice of using Windows security requires Active Directory integration.</span></span> <span data-ttu-id="1b37d-137"><xref:System.ServiceModel.MsmqAuthenticationMode.WindowsDomain> 是預設的傳輸安全性模式。</span><span class="sxs-lookup"><span data-stu-id="1b37d-137"><xref:System.ServiceModel.MsmqAuthenticationMode.WindowsDomain> is the default transport security mode.</span></span> <span data-ttu-id="1b37d-138">當此設定時，WCF 通道會將 Windows SID 附加至 MSMQ 訊息，並使用從 Active Directory 取得的內部憑證。</span><span class="sxs-lookup"><span data-stu-id="1b37d-138">When this is set, the WCF channel attaches the Windows SID to the MSMQ message and uses its internal certificate obtained from Active Directory.</span></span> <span data-ttu-id="1b37d-139">MSMQ 使用此內部憑證確保訊息安全。</span><span class="sxs-lookup"><span data-stu-id="1b37d-139">MSMQ uses this internal certificate to secure the message.</span></span> <span data-ttu-id="1b37d-140">接收方的佇列管理員會使用 Active Directory 來搜尋並尋找符合的憑證以驗證用戶端，並檢查 SID 與用戶端是否相符。</span><span class="sxs-lookup"><span data-stu-id="1b37d-140">The receiving queue manager uses Active Directory to search and find a matching certificate to authenticate the client and checks that the SID also matches that of the client.</span></span> <span data-ttu-id="1b37d-141">若以 `WindowsDomain` 驗證模式內部產生的憑證或 `Certificate` 驗證模式外部產生的憑證附加於訊息時，那麼即使目標佇列未標示需要驗證，仍然會執行驗證步驟。</span><span class="sxs-lookup"><span data-stu-id="1b37d-141">This authentication step is executed if a certificate, either internally generated in the case of `WindowsDomain` authentication mode or externally generated in the case of `Certificate` authentication mode, is attached to the message even if the target queue is not marked as requiring authentication.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="1b37d-142">建立佇列時，您可標示佇列為驗證佇列，表示佇列需要對傳送訊息至佇列的用戶端進行驗證。</span><span class="sxs-lookup"><span data-stu-id="1b37d-142">When creating a queue, you can mark the queue as an authenticated queue to indicate that the queue requires authentication of the client sending messages to the queue.</span></span> <span data-ttu-id="1b37d-143">如此可確保佇列只會接受已驗證的訊息。</span><span class="sxs-lookup"><span data-stu-id="1b37d-143">This ensures that no unauthenticated messages are accepted in the queue.</span></span>  
  
 <span data-ttu-id="1b37d-144">訊息附加的 SID 也會用來和目標佇列的 ACL 檢查比對，確保用戶端擁有發送訊息至佇列的授權。</span><span class="sxs-lookup"><span data-stu-id="1b37d-144">The SID attached with the message is also used to check against the target queue's ACL to ensure that the client has the authority to send messages to the queue.</span></span>  
  
#### <a name="certificate-authentication-mode"></a><span data-ttu-id="1b37d-145">憑證驗證模式</span><span class="sxs-lookup"><span data-stu-id="1b37d-145">Certificate Authentication Mode</span></span>  
 <span data-ttu-id="1b37d-146">若選擇使用憑證驗證模式，則不需要整合 Active Directory。</span><span class="sxs-lookup"><span data-stu-id="1b37d-146">The choice of using certificate authentication mode does not require Active Directory integration.</span></span> <span data-ttu-id="1b37d-147">事實上，在某些狀況下，例如以工作群組模式 (未整合 Active Directory) 安裝 MSMQ，或是使用 SOAP Reliable Messaging Protocol (SRMP) 傳輸通訊協定傳送訊息至佇列時，只有 <xref:System.ServiceModel.MsmqAuthenticationMode.Certificate> 起作用。</span><span class="sxs-lookup"><span data-stu-id="1b37d-147">In fact, in some cases, such as when MSMQ is installed in workgroup mode (without Active Directory integration) or when using the SOAP Reliable Messaging Protocol (SRMP) transfer protocol to send messages to the queue, only <xref:System.ServiceModel.MsmqAuthenticationMode.Certificate> works.</span></span>  
  
 <span data-ttu-id="1b37d-148">使用傳送 WCF 訊息時 <xref:System.ServiceModel.MsmqAuthenticationMode.Certificate> ，wcf 通道不會將 WINDOWS SID 附加至 MSMQ 訊息。</span><span class="sxs-lookup"><span data-stu-id="1b37d-148">When sending a WCF message with <xref:System.ServiceModel.MsmqAuthenticationMode.Certificate>, the WCF channel does not attach a Windows SID to the MSMQ message.</span></span> <span data-ttu-id="1b37d-149">如此一來，目標佇列 ACL 必須允許 `Anonymous` 使用者存取，才可傳送至佇列。</span><span class="sxs-lookup"><span data-stu-id="1b37d-149">As such, the target queue ACL must allow for `Anonymous` user access to send to the queue.</span></span> <span data-ttu-id="1b37d-150">接收方的佇列管理員會檢查 MSMQ 訊息是否使用憑證簽章，但不會進行任何驗證。</span><span class="sxs-lookup"><span data-stu-id="1b37d-150">The receiving queue manager checks whether the MSMQ message was signed with the certificate but does not perform any authentication.</span></span>  
  
 <span data-ttu-id="1b37d-151">具有宣告和身分識別資訊的憑證會 <xref:System.ServiceModel.ServiceSecurityContext> 由 WCF 佇列傳輸通道在中填入。</span><span class="sxs-lookup"><span data-stu-id="1b37d-151">The certificate with its claims and identity information is populated in the <xref:System.ServiceModel.ServiceSecurityContext> by the WCF queued transport channel.</span></span> <span data-ttu-id="1b37d-152">服務可使用此資訊執行它自己對寄件人的驗證。</span><span class="sxs-lookup"><span data-stu-id="1b37d-152">The service can use this information to perform its own authentication of the sender.</span></span>  
  
### <a name="msmq-protection-level"></a><span data-ttu-id="1b37d-153">MSMQ 保護層級</span><span class="sxs-lookup"><span data-stu-id="1b37d-153">MSMQ Protection Level</span></span>  
 <span data-ttu-id="1b37d-154">保護層級會說明如何保護 MSMQ 訊息以確保不會被竄改。</span><span class="sxs-lookup"><span data-stu-id="1b37d-154">The protection level dictates how to protect the MSMQ message to ensure that it is not tampered with.</span></span> <span data-ttu-id="1b37d-155">它是在 <xref:System.ServiceModel.MsmqTransportSecurity.MsmqProtectionLevel%2A> 屬性中指定。</span><span class="sxs-lookup"><span data-stu-id="1b37d-155">It is specified in the <xref:System.ServiceModel.MsmqTransportSecurity.MsmqProtectionLevel%2A> property.</span></span> <span data-ttu-id="1b37d-156">預設值為 <xref:System.Net.Security.ProtectionLevel.Sign>。</span><span class="sxs-lookup"><span data-stu-id="1b37d-156">The default value is <xref:System.Net.Security.ProtectionLevel.Sign>.</span></span>  
  
#### <a name="sign-protection-level"></a><span data-ttu-id="1b37d-157">簽章保護層級</span><span class="sxs-lookup"><span data-stu-id="1b37d-157">Sign Protection Level</span></span>  
 <span data-ttu-id="1b37d-158">當使用 `WindowsDomain` 驗證模式內部產生的憑證或 `Certificate` 驗證模式外部產生的憑證時，MSMQ 訊息會使用內部產生的憑證簽章。</span><span class="sxs-lookup"><span data-stu-id="1b37d-158">The MSMQ message is signed using the internally generated certificate when using `WindowsDomain` authentication mode or an externally generated certificate when using `Certificate` authentication mode.</span></span>  
  
#### <a name="sign-and-encrypt-protection-level"></a><span data-ttu-id="1b37d-159">簽章與加密保護層級</span><span class="sxs-lookup"><span data-stu-id="1b37d-159">Sign and Encrypt Protection Level</span></span>  
 <span data-ttu-id="1b37d-160">當使用 `WindowsDomain` 驗證模式內部產生的憑證或 `Certificate` 驗證模式外部產生的憑證時，MSMQ 訊息會使用內部產生的憑證簽章。</span><span class="sxs-lookup"><span data-stu-id="1b37d-160">The MSMQ message is signed using the internally generated certificate when using `WindowsDomain` authentication mode or externally generated certificate when using `Certificate` authentication mode.</span></span>  
  
 <span data-ttu-id="1b37d-161">除了對訊息簽章之外，MSMQ 訊息還使用取自 Active Directory 的憑證公開金鑰進行加密。此 Active Directory 屬於裝載目標佇列之接收方的佇列管理員所有。</span><span class="sxs-lookup"><span data-stu-id="1b37d-161">In addition to signing the message, the MSMQ message is encrypted using the public key of the certificate obtained from Active Directory that belongs to the receiving queue manager that hosts the target queue.</span></span> <span data-ttu-id="1b37d-162">傳送佇列管理員會確定 MSMQ 訊息在傳輸中已加密。</span><span class="sxs-lookup"><span data-stu-id="1b37d-162">The sending queue manager ensures that the MSMQ message is encrypted in transit.</span></span> <span data-ttu-id="1b37d-163">接收佇列管理員會使用內部憑證的私密金鑰解密 MSMQ 訊息，並將訊息以明文儲存於佇列 (若已驗證並授權) 中。</span><span class="sxs-lookup"><span data-stu-id="1b37d-163">The receiving queue manager decrypts the MSMQ message using the private key of its internal certificate and stores the message in the queue (if authenticated and authorized) in clear text.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="1b37d-164">若要加密訊息，需要能存取 Active Directory (`UseActiveDirectory` 的 <xref:System.ServiceModel.NetMsmqBinding> 屬性必須設為 `true`) 並且能同時使用於 <xref:System.ServiceModel.MsmqAuthenticationMode.Certificate> 及 <xref:System.ServiceModel.MsmqAuthenticationMode.WindowsDomain>。</span><span class="sxs-lookup"><span data-stu-id="1b37d-164">To encrypt the message, Active Directory access is required (`UseActiveDirectory` property of <xref:System.ServiceModel.NetMsmqBinding> must be set to `true`) and can be used with both <xref:System.ServiceModel.MsmqAuthenticationMode.Certificate> and <xref:System.ServiceModel.MsmqAuthenticationMode.WindowsDomain>.</span></span>  
  
#### <a name="none-protection-level"></a><span data-ttu-id="1b37d-165">無保護層級</span><span class="sxs-lookup"><span data-stu-id="1b37d-165">None Protection Level</span></span>  
 <span data-ttu-id="1b37d-166">這代表  設定為 的時候。</span><span class="sxs-lookup"><span data-stu-id="1b37d-166">This is implied when <xref:System.ServiceModel.MsmqTransportSecurity.MsmqProtectionLevel%2A> is set to <xref:System.Net.Security.ProtectionLevel.None>.</span></span> <span data-ttu-id="1b37d-167">這對任何其他驗證模式而言，不是有效值。</span><span class="sxs-lookup"><span data-stu-id="1b37d-167">This cannot be a valid value for any other authentication modes.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="1b37d-168">若 MSMQ 訊息已簽章，則 MSMQ 會檢查訊息是否以附加的憑證 (內部或外部) 簽章，而不理會佇列狀態，亦即佇列是否為驗證過的佇列。</span><span class="sxs-lookup"><span data-stu-id="1b37d-168">If the MSMQ message is signed, MSMQ checks whether the message is signed with the attached certificate (internal or external) independent of the state of the queue, that is, authenticated queue or not.</span></span>  
  
### <a name="msmq-encryption-algorithm"></a><span data-ttu-id="1b37d-169">MSMQ 加密演算法</span><span class="sxs-lookup"><span data-stu-id="1b37d-169">MSMQ Encryption Algorithm</span></span>  
 <span data-ttu-id="1b37d-170">加密演算法可指定用來在網路上加密 MSMQ 訊息的演算法。</span><span class="sxs-lookup"><span data-stu-id="1b37d-170">The encryption algorithm specifies the algorithm to use to encrypt the MSMQ message on the wire.</span></span> <span data-ttu-id="1b37d-171">這個屬性只能在 <xref:System.ServiceModel.MsmqTransportSecurity.MsmqProtectionLevel%2A> 設定為 <xref:System.Net.Security.ProtectionLevel.EncryptAndSign> 時使用。</span><span class="sxs-lookup"><span data-stu-id="1b37d-171">This property is used only if <xref:System.ServiceModel.MsmqTransportSecurity.MsmqProtectionLevel%2A> is set to <xref:System.Net.Security.ProtectionLevel.EncryptAndSign>.</span></span>  
  
 <span data-ttu-id="1b37d-172">支援的演算法為 `RC4Stream` 與 `AES`，預設為 `RC4Stream`。</span><span class="sxs-lookup"><span data-stu-id="1b37d-172">The supported algorithms are `RC4Stream` and `AES` and the default is `RC4Stream`.</span></span>  
  
 <span data-ttu-id="1b37d-173">只有在送件人已安裝 MSMQ 4.0 時，您才可以使用 `AES` 演算法。</span><span class="sxs-lookup"><span data-stu-id="1b37d-173">You can use the `AES` algorithm only if the sender has MSMQ 4.0 installed.</span></span> <span data-ttu-id="1b37d-174">除此之外，目標佇列必須也必須裝載於 MSMQ 4.0 上。</span><span class="sxs-lookup"><span data-stu-id="1b37d-174">In addition, the target queue must also be hosted on MSMQ 4.0.</span></span>  
  
### <a name="msmq-hash-algorithm"></a><span data-ttu-id="1b37d-175">MSMQ 雜湊演算法</span><span class="sxs-lookup"><span data-stu-id="1b37d-175">MSMQ Hash Algorithm</span></span>  
 <span data-ttu-id="1b37d-176">雜湊演算法會指定建立 MSMQ 訊息數位簽章所使用的演算法。</span><span class="sxs-lookup"><span data-stu-id="1b37d-176">The hash algorithm specifies the algorithm used to create a digital signature of the MSMQ message.</span></span> <span data-ttu-id="1b37d-177">接收佇列管理員會使用與此相同的演算法，驗證 MSMQ 訊息。</span><span class="sxs-lookup"><span data-stu-id="1b37d-177">The receiving queue manager uses this same algorithm to authenticate the MSMQ message.</span></span> <span data-ttu-id="1b37d-178">只有在 <xref:System.ServiceModel.MsmqTransportSecurity.MsmqProtectionLevel%2A> 設為 <xref:System.Net.Security.ProtectionLevel.Sign> 或 <xref:System.Net.Security.ProtectionLevel.EncryptAndSign> 時，才會使用這個屬性。</span><span class="sxs-lookup"><span data-stu-id="1b37d-178">This property is used only if <xref:System.ServiceModel.MsmqTransportSecurity.MsmqProtectionLevel%2A> is set to <xref:System.Net.Security.ProtectionLevel.Sign> or <xref:System.Net.Security.ProtectionLevel.EncryptAndSign>.</span></span>  
  
 <span data-ttu-id="1b37d-179">支援的演算法為 `MD5`、`SHA1`、`SHA256` 和 `SHA512`。</span><span class="sxs-lookup"><span data-stu-id="1b37d-179">The supported algorithms are `MD5`, `SHA1`, `SHA256`, and `SHA512`.</span></span> <span data-ttu-id="1b37d-180">預設值為 `SHA1`。</span><span class="sxs-lookup"><span data-stu-id="1b37d-180">The default is `SHA1`.</span></span>

 <span data-ttu-id="1b37d-181">由於 MD5/SHA1 的衝突問題，Microsoft 建議使用 SHA256 或更好的方式。</span><span class="sxs-lookup"><span data-stu-id="1b37d-181">Due to collision problems with MD5/SHA1, Microsoft recommends SHA256 or better.</span></span>
  
## <a name="see-also"></a><span data-ttu-id="1b37d-182">請參閱</span><span class="sxs-lookup"><span data-stu-id="1b37d-182">See also</span></span>

- [<span data-ttu-id="1b37d-183">佇列概觀</span><span class="sxs-lookup"><span data-stu-id="1b37d-183">Queues Overview</span></span>](queues-overview.md)
- [<span data-ttu-id="1b37d-184">安全性概念</span><span class="sxs-lookup"><span data-stu-id="1b37d-184">Security Concepts</span></span>](security-concepts.md)
- [<span data-ttu-id="1b37d-185">Securing Services and Clients</span><span class="sxs-lookup"><span data-stu-id="1b37d-185">Securing Services and Clients</span></span>](securing-services-and-clients.md)

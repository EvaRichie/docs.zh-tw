---
title: WCF 服務發行
description: WCF 服務發佈可協助您將應用程式部署到生產環境，以供測試之用。
ms.date: 03/30/2017
ms.assetid: c806b253-cd47-4b96-b831-e73cbf08808f
ms.openlocfilehash: 99798b75e1dc01c8db361f4d8d1f162c7f7617b1
ms.sourcegitcommit: 358a28048f36a8dca39a9fe6e6ac1f1913acadd5
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 06/23/2020
ms.locfileid: "85245670"
---
# <a name="wcf-service-publishing"></a><span data-ttu-id="9af32-103">WCF 服務發行</span><span class="sxs-lookup"><span data-stu-id="9af32-103">WCF Service Publishing</span></span>

<span data-ttu-id="9af32-104">Windows Communication Foundation （WCF）服務發佈可協助您從 WCF 服務主機和 WCF 測試用戶端所提供的早期開發環境進行，以實際將應用程式部署到生產環境以供測試之用。</span><span class="sxs-lookup"><span data-stu-id="9af32-104">Windows Communication Foundation (WCF) Service Publishing assists you in progressing from the early development environment provided by WCF Service Host and WCF Test Client to actually deploying the application to a production environment for testing purposes.</span></span> <span data-ttu-id="9af32-105">在您認可到最終的部署計畫之前，您可以使用 Windows Communication Foundation （WCF）服務發佈，確認您的 WCF 服務是否正確執行並已準備好發行。</span><span class="sxs-lookup"><span data-stu-id="9af32-105">Before you commit to a final deployment plan, you can use Windows Communication Foundation (WCF) Service Publishing to verify that your WCF service performs correctly and is ready to be published.</span></span> <span data-ttu-id="9af32-106">您也可以選擇將 WCF 服務程式庫部署至各種目標位置，以便進行測試。</span><span class="sxs-lookup"><span data-stu-id="9af32-106">You can also choose to deploy your WCF service libraries to various target locations for testing.</span></span>

## <a name="supported-services-and-target-locations"></a><span data-ttu-id="9af32-107">支援的服務和目標位置</span><span class="sxs-lookup"><span data-stu-id="9af32-107">Supported Services and Target Locations</span></span>

<span data-ttu-id="9af32-108">WCF 服務發行支援發佈從 WCF 服務程式庫樣板集合建立的 WCF 服務，以及其對應的專案範本，包括下列各項：</span><span class="sxs-lookup"><span data-stu-id="9af32-108">WCF Service Publishing supports publishing WCF services created from the set of WCF service library templates, and their corresponding item templates, which include the following:</span></span>

- <span data-ttu-id="9af32-109">具有專案範本的 WCF 服務程式庫範本。</span><span class="sxs-lookup"><span data-stu-id="9af32-109">WCF Service Library template with item template.</span></span>

- <span data-ttu-id="9af32-110">新聞訂閱服務程式庫。</span><span class="sxs-lookup"><span data-stu-id="9af32-110">Syndication Service Library.</span></span>

<span data-ttu-id="9af32-111">您可以藉由選擇 [檔案] **File**  >  [**新增專案**] > [**Visual Basic**或**Visual c #**] > **WCF**來尋找這些服務範本。</span><span class="sxs-lookup"><span data-stu-id="9af32-111">You can find these service templates by choosing **File** > **New Project** > [**Visual Basic** or **Visual C#**] > **WCF**.</span></span> <span data-ttu-id="9af32-112">針對此位置中的其他 WCF 範本（包括 WCF 工作流程服務應用程式和 WCF 服務應用程式），您可以[針對 web 應用程式](https://docs.microsoft.com/previous-versions/aspnet/dd465337(v=vs.110))使用單鍵發行來發行。</span><span class="sxs-lookup"><span data-stu-id="9af32-112">For other WCF templates in this location (including WCF Workflow Service Application and WCF Service Application), you can publish using [One-Click publishing for web applications](https://docs.microsoft.com/previous-versions/aspnet/dd465337(v=vs.110)).</span></span>

<span data-ttu-id="9af32-113">此服務可以發行至下列目標位置。</span><span class="sxs-lookup"><span data-stu-id="9af32-113">The service can be published to the following target locations.</span></span>

- <span data-ttu-id="9af32-114">本機 IIS。</span><span class="sxs-lookup"><span data-stu-id="9af32-114">Local IIS.</span></span>

- <span data-ttu-id="9af32-115">檔案系統。</span><span class="sxs-lookup"><span data-stu-id="9af32-115">File System.</span></span>

- <span data-ttu-id="9af32-116">FTP 站台。</span><span class="sxs-lookup"><span data-stu-id="9af32-116">FTP Site.</span></span>

## <a name="using-wcf-service-publishing"></a><span data-ttu-id="9af32-117">使用 WCF 服務發行</span><span class="sxs-lookup"><span data-stu-id="9af32-117">Using WCF Service Publishing</span></span>

<span data-ttu-id="9af32-118">執行下列步驟，部署服務實作：</span><span class="sxs-lookup"><span data-stu-id="9af32-118">Perform the following steps to deploy a service implementation:</span></span>

1. <span data-ttu-id="9af32-119">以較高的許可權開啟 Visual Studio （以滑鼠右鍵按一下可執行檔，然後選擇 [以**系統管理員身分執行**] 加以開啟）。</span><span class="sxs-lookup"><span data-stu-id="9af32-119">Open Visual Studio with elevated privileges (right-click the executable and choose **Run as administrator** to open it).</span></span>  <span data-ttu-id="9af32-120">如果您使用的是 IIS 7.0 或更新版本，請確定您已使用 [控制台] 中的 [開啟或關閉 Windows 功能] 來安裝 [IIS 元資料庫和 IIS6 設定相容性] 元件。</span><span class="sxs-lookup"><span data-stu-id="9af32-120">If you are using IIS 7.0 or later, ensure that you have installed the "IIS Metabase and IIS6 Configuration Compatibility" component using "Turn Windows features on or off" in Control Panel.</span></span>

2. <span data-ttu-id="9af32-121">開啟服務專案，從主功能表中選取 [**組建**  >  **發行 \<Project Name> \*\* ]，或以滑鼠右鍵按一下**方案總管**中的專案，然後按一下 [**發佈\*\*]。</span><span class="sxs-lookup"><span data-stu-id="9af32-121">Open a service project, select **Build** > **Publish \<Project Name>** from the main menu, or right-click the project in **Solution Explorer** and click **Publish**.</span></span>

3. <span data-ttu-id="9af32-122">[**發行**] 視窗隨即出現。</span><span class="sxs-lookup"><span data-stu-id="9af32-122">The **Publish** window appears.</span></span> <span data-ttu-id="9af32-123">按一下 [ **...**]。</span><span class="sxs-lookup"><span data-stu-id="9af32-123">Click the **…**.</span></span> <span data-ttu-id="9af32-124">按鈕，指定服務應部署至其中的目標位置。</span><span class="sxs-lookup"><span data-stu-id="9af32-124">button to specify the target location that the service should be deployed to.</span></span> <span data-ttu-id="9af32-125">您可以選擇將應用程式部署到本機 IIS、檔案系統或 FTP 網站。</span><span class="sxs-lookup"><span data-stu-id="9af32-125">You can select to deploy the application to local IIS, File System, or FTP Site.</span></span> <span data-ttu-id="9af32-126">如果將應用程式部署至本機 IIS，您可以按一下右上角的 [**建立新的 Web 應用程式**] 圖示，以選取您的網站，並在其底下建立 web 應用程式。</span><span class="sxs-lookup"><span data-stu-id="9af32-126">If deploying the application to local IIS, you can select your website and create your web application under it, by clicking the **Create New Web Application** icon at the top right corner.</span></span>

4. <span data-ttu-id="9af32-127">當您按一下主視窗中的 [**發佈**] 之後，Visual Studio 會將應用程式部署至指定的目標位置，並將 Web.config、.svc 和元件檔複製到目標目錄。</span><span class="sxs-lookup"><span data-stu-id="9af32-127">After you click **Publish** in the main window, Visual Studio deploys the application to the specified target location and copies the Web.config, .svc, and assembly files to the target directory.</span></span> <span data-ttu-id="9af32-128">.</span><span class="sxs-lookup"><span data-stu-id="9af32-128">.</span></span> <span data-ttu-id="9af32-129">.Svc 的名稱將會是 "檔案名. ServiceName. .svc"。</span><span class="sxs-lookup"><span data-stu-id="9af32-129">The name of .svc will be "ProjectName.ServiceName.svc".</span></span> <span data-ttu-id="9af32-130">成功發佈服務之後，您可以在 [Visual Studio 輸出] 視窗中找到 hotlink，其看起來類似「連接到」 `http://localhost/WebApplicationFolderName...` 。</span><span class="sxs-lookup"><span data-stu-id="9af32-130">After the service is published successfully, you can find a hotlink in the Visual Studio Output window, which looks similar to "Connecting to `http://localhost/WebApplicationFolderName...`".</span></span> <span data-ttu-id="9af32-131">您可以按下 CTRL，然後按一下此連結，以便在 Visual Studio 內部開啟瀏覽器頁面來檢視服務目錄結構。</span><span class="sxs-lookup"><span data-stu-id="9af32-131">You can press CTRL and click the link to open a browser page inside Visual Studio to view the service directory structure.</span></span>

     <span data-ttu-id="9af32-132">如果您無法瀏覽至網站，可能是因為 IIS 沒有啟用目錄瀏覽器。</span><span class="sxs-lookup"><span data-stu-id="9af32-132">If you cannot browse to the site, it may because directory browser is not enabled in IIS.</span></span> <span data-ttu-id="9af32-133">請遵循「您可以嘗試的東西」一節中的秘訣來啟用它。</span><span class="sxs-lookup"><span data-stu-id="9af32-133">Please follow the tips in the "Things you can try" section to enable it.</span></span> <span data-ttu-id="9af32-134">或者，您可以直接鍵入 `http://localhost/WebApplicationFolderName/ProjectName.ServiceName.svc` 來查看您的服務頁面。</span><span class="sxs-lookup"><span data-stu-id="9af32-134">Alternatively, you can directly type `http://localhost/WebApplicationFolderName/ProjectName.ServiceName.svc` to view your service page.</span></span>

<span data-ttu-id="9af32-135">您可以使用 [**發行**] 來指定是否要將專案中定義之所有服務的元件、設定和 .svc 檔案複製到目標位置，並覆寫目的地端的現有檔案。</span><span class="sxs-lookup"><span data-stu-id="9af32-135">You can use **Publish** to specify if you want to copy the assembly, configuration, and .svc file for all services defined in the project to the target location, and overwrite existing files at the destination.</span></span>

<span data-ttu-id="9af32-136">如果您選擇將應用程式部署至本機 IIS，可能會遇到有關 IIS 安裝程式的錯誤。</span><span class="sxs-lookup"><span data-stu-id="9af32-136">If you choose to deploy your application to local IIS, you may encounter errors related to IIS setup.</span></span> <span data-ttu-id="9af32-137">請確定 IIS 已正確安裝。</span><span class="sxs-lookup"><span data-stu-id="9af32-137">Please ensure that IIS is installed properly.</span></span> <span data-ttu-id="9af32-138">您可以 `http://localhost` 在瀏覽器的網址列中輸入，並檢查是否顯示 IIS 預設頁面。</span><span class="sxs-lookup"><span data-stu-id="9af32-138">You can enter `http://localhost` in your browser's address bar and check whether the IIS default page displays.</span></span> <span data-ttu-id="9af32-139">在某些情況下，這些問題也可能是因為不正確地在 IIS 中註冊 ASP.NET 或 WCF 所造成。</span><span class="sxs-lookup"><span data-stu-id="9af32-139">In some cases, the issues may also be caused by improper registration of ASP.NET or WCF in IIS.</span></span> <span data-ttu-id="9af32-140">您可以開啟 Visual Studio 的開發人員命令提示字元，然後執行命令 `aspnet_regiis.exe -ir` 來修正 ASP.NET 註冊問題，或執行命令 `ServiceModelReg.exe –ia` 來修正 WCF 註冊問題。</span><span class="sxs-lookup"><span data-stu-id="9af32-140">You can open the Developer Command Prompt for Visual Studio and run the command `aspnet_regiis.exe -ir` to fix ASP.NET registration issues, or run command `ServiceModelReg.exe –ia` to fix WCF registration issues.</span></span>

## <a name="files-generated-for-publishing"></a><span data-ttu-id="9af32-141">針對發行產生的檔案</span><span class="sxs-lookup"><span data-stu-id="9af32-141">Files Generated for Publishing</span></span>
 <span data-ttu-id="9af32-142">在 WCF 服務程式庫可供 Web 裝載之前，下列檔案是由工具產生：元件檔、Web.config 檔案和 .svc 檔案。</span><span class="sxs-lookup"><span data-stu-id="9af32-142">Before a WCF service library can be Web-hosted, the following files are generated by the tool: assembly files, Web.config file, and .svc file.</span></span> <span data-ttu-id="9af32-143">所有檔案都會複製到目標位置。</span><span class="sxs-lookup"><span data-stu-id="9af32-143">All the files are copied to the target location.</span></span> <span data-ttu-id="9af32-144">接著便會發行服務。</span><span class="sxs-lookup"><span data-stu-id="9af32-144">The service is then published.</span></span>

### <a name="assembly-files"></a><span data-ttu-id="9af32-145">組件檔</span><span class="sxs-lookup"><span data-stu-id="9af32-145">Assembly files</span></span>
 <span data-ttu-id="9af32-146">當您使用此工具發佈 WCF 服務時，會先自動建立服務，而且元件檔會在建立後於服務專案中產生。</span><span class="sxs-lookup"><span data-stu-id="9af32-146">When you publish a WCF service using this tool, the service is automatically built first and the assembly files are generated in the service project after building.</span></span>

### <a name="svc-file"></a><span data-ttu-id="9af32-147">.SVC 檔案</span><span class="sxs-lookup"><span data-stu-id="9af32-147">.SVC File</span></span>
 <span data-ttu-id="9af32-148">發佈作業會針對每個 WCF 服務產生 \* .svc 檔案，無論檔案是否存在，以確保版本有效性。</span><span class="sxs-lookup"><span data-stu-id="9af32-148">The publishing operation generates a \*.svc file for each WCF service, whether the file exists or not, to ensure version validity.</span></span> <span data-ttu-id="9af32-149">有兩種不同的 svc 檔案：一個用於 WCF 服務程式庫和新聞訂閱服務程式庫，另一個用於順序和狀態機器工作流程服務程式庫。</span><span class="sxs-lookup"><span data-stu-id="9af32-149">There are two different kinds of svc files: one for WCF Service Library and Syndication Service Library, and another one for Sequential and State Machine Workflow Service Library.</span></span> <span data-ttu-id="9af32-150">產生的 \* .svc 檔案會複製到目標位置中的根資料夾。</span><span class="sxs-lookup"><span data-stu-id="9af32-150">The generated \*.svc file is copied to the root folder in the target location.</span></span>

### <a name="webconfig-file"></a><span data-ttu-id="9af32-151">Web.config 檔</span><span class="sxs-lookup"><span data-stu-id="9af32-151">Web.config File</span></span>
 <span data-ttu-id="9af32-152">每次服務專案發行到特定目標位置時，都會建立 Web.config 檔。</span><span class="sxs-lookup"><span data-stu-id="9af32-152">Each time a service project is published to a specific target location, a Web.config file is created.</span></span>

 <span data-ttu-id="9af32-153">產生的 Web.config 檔案包含適用于 Web 裝載的 Web 區段，以及 WCF 服務程式庫 App.config 的內容，其中包含下列變更：</span><span class="sxs-lookup"><span data-stu-id="9af32-153">The generated Web.config file includes Web sections that are useful for Web hosting, and the content of App.config for the WCF service library with the following changes:</span></span>

- <span data-ttu-id="9af32-154">已排除基底位址 (Base Address)。</span><span class="sxs-lookup"><span data-stu-id="9af32-154">The base address is excluded.</span></span>

- <span data-ttu-id="9af32-155">已排除 `<diagnostics>` 項目中的設定，以保留目標平台的追蹤設定。</span><span class="sxs-lookup"><span data-stu-id="9af32-155">Settings in the `<diagnostics>` element are excluded to preserve the tracing settings of the target platform.</span></span>

## <a name="publishing-wcf-services-with-non-http-bindings-to-iis"></a><span data-ttu-id="9af32-156">將包含非 HTTP 繫結的 WCF 服務發行至 IIS</span><span class="sxs-lookup"><span data-stu-id="9af32-156">Publishing WCF services with non-HTTP Bindings to IIS</span></span>
 <span data-ttu-id="9af32-157">如果您使用的是 IIS 7.0 或更新版本，您可以將具有非 HTTP 系結的 WCF 服務發行至 IIS。</span><span class="sxs-lookup"><span data-stu-id="9af32-157">If you are using IIS7.0 or later, you can publish WCF services with non-HTTP bindings to IIS.</span></span> <span data-ttu-id="9af32-158">不過，您必須進行一些預先組態設定。</span><span class="sxs-lookup"><span data-stu-id="9af32-158">You need to do some pre-configurations.</span></span> <span data-ttu-id="9af32-159">如需詳細資訊，請參閱在[Windows 進程啟用服務中裝載](./feature-details/hosting-in-windows-process-activation-service.md)的主題。</span><span class="sxs-lookup"><span data-stu-id="9af32-159">For more information, please see the topics at  [Hosting in Windows Process Activation Service](./feature-details/hosting-in-windows-process-activation-service.md).</span></span>

## <a name="security"></a><span data-ttu-id="9af32-160">安全性</span><span class="sxs-lookup"><span data-stu-id="9af32-160">Security</span></span>
 <span data-ttu-id="9af32-161">發行到本機 IIS 時需要具有系統管理員權限，因為 IIS 需要使用 Administrator 帳戶執行。</span><span class="sxs-lookup"><span data-stu-id="9af32-161">Publishing to local IIS requires administrator privilege, because IIS requires running in Administrator account.</span></span> <span data-ttu-id="9af32-162">如果沒有系統管理員許可權的使用者開啟 WCF 服務發行，則 IIS 無法當做目標位置使用。</span><span class="sxs-lookup"><span data-stu-id="9af32-162">If a user without administrator privilege opens WCF Service Publishing, IIS is not available as a target location.</span></span> <span data-ttu-id="9af32-163">發行至檔案系統或 FTP 網站的工作不需要系統管理員許可權。</span><span class="sxs-lookup"><span data-stu-id="9af32-163">Publishing to File System, or FTP Site works without administrator privilege.</span></span>

## <a name="see-also"></a><span data-ttu-id="9af32-164">另請參閱</span><span class="sxs-lookup"><span data-stu-id="9af32-164">See also</span></span>

- [<span data-ttu-id="9af32-165">WCF Visual Studio 範本</span><span class="sxs-lookup"><span data-stu-id="9af32-165">WCF Visual Studio Templates</span></span>](wcf-vs-templates.md)
- [<span data-ttu-id="9af32-166">WCF 服務主機 (WcfSvcHost.exe)</span><span class="sxs-lookup"><span data-stu-id="9af32-166">WCF Service Host (WcfSvcHost.exe)</span></span>](wcf-service-host-wcfsvchost-exe.md)
- [<span data-ttu-id="9af32-167">WCF 測試用戶端 (WcfTestClient.exe)</span><span class="sxs-lookup"><span data-stu-id="9af32-167">WCF Test Client (WcfTestClient.exe)</span></span>](wcf-test-client-wcftestclient-exe.md)

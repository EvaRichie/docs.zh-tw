---
title: PNRP 快取
ms.date: 03/30/2017
ms.assetid: 270068d9-1b6b-4eb9-9e14-e02326bb88df
ms.openlocfilehash: 6f45b6d829867d830a9a10acf11e8456ba65d29e
ms.sourcegitcommit: bc293b14af795e0e999e3304dd40c0222cf2ffe4
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 11/26/2020
ms.locfileid: "96263213"
---
# <a name="pnrp-caches"></a>PNRP 快取

對等名稱解析通訊協定 (PNRP) 快取是以演算法方式選取對等上所維護之對等端點的本機集合。  
  
## <a name="pnrp-cache-initialization"></a>PNRP 快取初始化  

 若要在對等節點啟動時初始化 PNRP 快取或對等名稱記錄集合，節點可以使用下列方法：  
  
- 節點關閉時存在的持續快取項目是從硬碟儲存體載入。  
  
- 如果應用程式使用 P2P 共同作業基礎結構，則可以在該節點的連絡人管理員中取得共同作業資訊。  
  
## <a name="scaling-peer-name-resolution-with-a-multi-level-cache"></a>使用多層快取調整對等名稱解析  

 為了盡量縮小 PNRP 快取的大小，對等節點會使用多層快取，而每一層都包含最大項目數。 快取中的每一層都代表 PNRP 識別碼空間的十分之一 (2<sup>256</sup>)。 快取中的最下面一層包含在本機上註冊的 PNRP 識別碼，以及其他數字接近的 PNRP 識別碼。 一層快取填滿最多 20 個項目之後，就會建立新的較低一層。 快取中的最大層數是按照 log10 的順序而定 (雲端中 PNRP 識別碼的總數)。 例如，對於含有 1 億個 PNRP 識別碼的全域雲端來說，快取中不會超過 8 (=log10(100,000,000)) 層，這與解析名稱時用來解析 PNRP 識別碼的躍點數目相似。 此機制允許使用可針對其解析任意 PNRP 識別碼的分散式雜湊表，方法是將 PNRP 要求訊息轉送至下一個最接近的對等，直到找到包含對應 CPA 的對等為止。  
  
 為確保解析能夠完成，每次節點將項目新增至其快取的最下層時，都會將該項目的複本傳送到快取最後一層內的所有節點。  
  
 快取項目會隨著時間進行重新整理。 過時的快取項目則會從快取中移除。 因此 PNRP 識別碼的分散式雜湊表會以作用中的端點為主，而不像 DNS 中，位址記錄和 DNS 通訊協定無法保證與位址建立關聯的節點在網路上也是作用中的。  
  
## <a name="other-pnrp-caches"></a>其他 PNRP 快取  

 另一個持續性資料存放區是本機快取。  除了 PNRP 活動所需的其他物件之外，它還可以包含與 PNRP 雲端或共同作業工作階段建立關聯的記錄，而 PNRP 雲端或共同作業工作階段已在雲端的所有成員之間安全地進行發行和同步處理。 這個複寫的存放區代表群組資料的檢視，而且應該適用於所有群組成員。 技術上來說，這些物件本身不是記錄，而是以本機快取為目的的應用程式、目前狀態和物件資料。 使用 PNRP 雲端，可確保將物件傳播到共同作業工作階段或 PNRP 雲端中的所有節點。  雲端成員之間的記錄複寫會使用 SSL 來提供加密和資料完整性。  
  
 對等加入雲端時，不會自動收到來自所連結之主對等的本機快取資料；它們必須訂閱主對等，才能收到應用程式、目前狀態和物件資料的更新。 初始同步處理之後，對等會定期重新同步處理其複寫的存放區，確保所有群組成員都一致具有相同的檢視。  共同作業工作階段或是共同作業工作階段內的應用程式可能也會執行相同的函式。  
  
 開始雲端的共同作業工作階段之後，應用程式可以註冊對等，並開始使用雲端範圍所定義的安全性來發行其資訊。 對等加入雲端時，會將雲端的安全性機制套用至對等，以指定它所參與的範圍。  接著可以在雲端範圍內安全地發行其記錄。 請注意，雲端範圍可能與共同作業應用程式範圍不同。  
  
 對等可以註冊要接收來自其他對等的物件。 更新物件時，會通知共同作業應用程式，並將新的物件傳遞給應用程式的所有訂閱者。 例如，群組聊天應用程式中的對等可以註冊要接收應用程式資訊，這樣會將所有交談記錄當成應用程式資料傳送給它。  這可讓它監視雲端內的聊天活動。  
  
## <a name="see-also"></a>另請參閱

- <xref:System.Net.PeerToPeer>

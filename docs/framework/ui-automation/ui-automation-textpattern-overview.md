---
title: UI 自動化 TextPattern 概觀
description: 閱讀使用者介面自動化中 TextPattern 控制項模式的總覽。 此控制項模式會公開控制項的文字內容，包括格式和樣式。
ms.date: 03/30/2017
helpviewer_keywords:
- UI Automation, TextPattern class
- TextPattern class
- classes, TextPattern
ms.assetid: 41787927-df1f-4f4a-aba3-641662854fc4
ms.openlocfilehash: 986b601bbd212582c09c559a9bb22983ba59fa17
ms.sourcegitcommit: 40de8df14289e1e05b40d6e5c1daabd3c286d70c
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 07/22/2020
ms.locfileid: "86924665"
---
# <a name="ui-automation-textpattern-overview"></a><span data-ttu-id="67cfc-104">UI 自動化 TextPattern 概觀</span><span class="sxs-lookup"><span data-stu-id="67cfc-104">UI Automation TextPattern Overview</span></span>

> [!NOTE]
> <span data-ttu-id="67cfc-105">這份文件適用於想要使用 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 命名空間中定義之 Managed <xref:System.Windows.Automation> 類別的 .NET Framework 開發人員。</span><span class="sxs-lookup"><span data-stu-id="67cfc-105">This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace.</span></span> <span data-ttu-id="67cfc-106">如需 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]的最新資訊，請參閱 [Windows Automation API：UI 自動化](/windows/win32/winauto/entry-uiauto-win32)。</span><span class="sxs-lookup"><span data-stu-id="67cfc-106">For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](/windows/win32/winauto/entry-uiauto-win32).</span></span>

<span data-ttu-id="67cfc-107">本概觀說明如何使用 [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] 來公開 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]支援平台中，文字控制項的文字內容，包括格式和樣式屬性。</span><span class="sxs-lookup"><span data-stu-id="67cfc-107">This overview describes how to use [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] to expose the textual content, including format and style attributes, of text controls in [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]-supported platforms.</span></span> <span data-ttu-id="67cfc-108">這些控制項包括（但不限於） Microsoft .NET Framework <xref:System.Windows.Controls.TextBox> 和其 Win32 對等專案 <xref:System.Windows.Controls.RichTextBox> 。</span><span class="sxs-lookup"><span data-stu-id="67cfc-108">These controls include, but are not limited to, the Microsoft .NET Framework <xref:System.Windows.Controls.TextBox> and <xref:System.Windows.Controls.RichTextBox> as well as their Win32 equivalents.</span></span>

<span data-ttu-id="67cfc-109">若要公開控制項的文字內容，您可以使用 <xref:System.Windows.Automation.TextPattern> 控制項模式，它會將文字容器的內容表示成文字資料流。</span><span class="sxs-lookup"><span data-stu-id="67cfc-109">Exposing the textual content of a control is accomplished through the use of the <xref:System.Windows.Automation.TextPattern> control pattern, which represents the contents of a text container as a text stream.</span></span> <span data-ttu-id="67cfc-110">接著， <xref:System.Windows.Automation.TextPattern> 會需要 <xref:System.Windows.Automation.Text.TextPatternRange> 類別的支援來公開格式和樣式屬性。</span><span class="sxs-lookup"><span data-stu-id="67cfc-110">In turn, <xref:System.Windows.Automation.TextPattern> requires the support of the <xref:System.Windows.Automation.Text.TextPatternRange> class to expose format and style attributes.</span></span> <span data-ttu-id="67cfc-111"><xref:System.Windows.Automation.Text.TextPatternRange> 可支援 <xref:System.Windows.Automation.TextPattern> ，其方法是使用 <xref:System.Windows.Automation.Text.TextPatternRangeEndpoint.Start> 和 <xref:System.Windows.Automation.Text.TextPatternRangeEndpoint.End> 端點的集合，來表示文字容器中的連續或多個非連續文字範圍。</span><span class="sxs-lookup"><span data-stu-id="67cfc-111"><xref:System.Windows.Automation.Text.TextPatternRange> supports <xref:System.Windows.Automation.TextPattern> by representing contiguous or multiple, disjoint text spans in a text container with a collection of <xref:System.Windows.Automation.Text.TextPatternRangeEndpoint.Start> and <xref:System.Windows.Automation.Text.TextPatternRangeEndpoint.End> endpoints.</span></span> <span data-ttu-id="67cfc-112"><xref:System.Windows.Automation.Text.TextPatternRange> 可支援選取、比較、擷取和周遊之類的功能。</span><span class="sxs-lookup"><span data-stu-id="67cfc-112"><xref:System.Windows.Automation.Text.TextPatternRange> supports functionality such as selection, comparison, retrieval and traversal.</span></span>

> [!NOTE]
> <span data-ttu-id="67cfc-113"><xref:System.Windows.Automation.TextPattern> 類別沒有提供插入或修改文字的方法。</span><span class="sxs-lookup"><span data-stu-id="67cfc-113">The <xref:System.Windows.Automation.TextPattern> classes do not provide a means to insert or modify text.</span></span> <span data-ttu-id="67cfc-114">不過，視控制項而定，這可能是由 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] <xref:System.Windows.Automation.ValuePattern> 或透過直接鍵盤輸入來完成。</span><span class="sxs-lookup"><span data-stu-id="67cfc-114">However, depending on the control, this may be accomplished by the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] <xref:System.Windows.Automation.ValuePattern> or through direct keyboard input.</span></span> <span data-ttu-id="67cfc-115">如需範例，請參閱 [TextPattern Insert Text Sample](https://github.com/Microsoft/WPF-Samples/tree/master/Accessibility/InsertText) 。</span><span class="sxs-lookup"><span data-stu-id="67cfc-115">See the [TextPattern Insert Text Sample](https://github.com/Microsoft/WPF-Samples/tree/master/Accessibility/InsertText) for an example.</span></span>

<span data-ttu-id="67cfc-116">對輔助技術廠商及其使用者而言，本概觀中所描述的功能非常重要。</span><span class="sxs-lookup"><span data-stu-id="67cfc-116">The functionality described in this overview is vital to assistive technology vendors and their end users.</span></span> <span data-ttu-id="67cfc-117">輔助技術可以使用 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 來收集使用者的完整文字格式化資訊，並依 <xref:System.Windows.Automation.Text.TextUnit> (字元、單字、字行或段落) 提供以程式設計方式巡覽和選取文字的功能。</span><span class="sxs-lookup"><span data-stu-id="67cfc-117">Assistive technologies can use [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] to gather complete text formatting information for the user and provide programmatic navigation and selection of text by <xref:System.Windows.Automation.Text.TextUnit> (character, word, line, or paragraph).</span></span>

<a name="UI_Automation_TextPattern_vs__Cicero"></a>

## <a name="ui-automation-textpattern-vs-text-services-framework"></a><span data-ttu-id="67cfc-118">UI 自動化 TextPattern 與Text Services Framework (TSF)</span><span class="sxs-lookup"><span data-stu-id="67cfc-118">UI Automation TextPattern vs. Text Services Framework</span></span>

<span data-ttu-id="67cfc-119">文字服務架構（TSF）是一個簡單且可擴充的系統架構，可在桌面上和應用程式內啟用自然語言服務和先進的文字輸入。</span><span class="sxs-lookup"><span data-stu-id="67cfc-119">Text Services Framework (TSF) is a simple and scalable system framework that enables natural language services and advanced text input on the desktop and within applications.</span></span> <span data-ttu-id="67cfc-120">除了提供介面讓應用程式公開其文字存放區之外，它也支援該文字存放區的中繼資料。</span><span class="sxs-lookup"><span data-stu-id="67cfc-120">In addition to providing interfaces for applications to expose their text store it also supports metadata for that text store.</span></span>

<span data-ttu-id="67cfc-121">不過，TSF 是針對需要將輸入插入內容感知案例中的應用程式所設計，而這 <xref:System.Windows.Automation.TextPattern> 是唯讀的解決方案（具有上述有限的因應措施），目的是針對螢幕讀取器和盲文裝置的文字存放區提供優化的存取。</span><span class="sxs-lookup"><span data-stu-id="67cfc-121">However, TSF was designed for applications that need to inject input into context-aware scenarios whereas <xref:System.Windows.Automation.TextPattern> is a read-only solution (with the limited workaround noted above) meant to provide optimized access to a text store for screen-readers and Braille devices.</span></span>

<span data-ttu-id="67cfc-122">簡單地說，需要文字存放區唯讀存取權的可存取技術可以使用 <xref:System.Windows.Automation.TextPattern> ，但需要更複雜的 TSF 功能來進行內容感知輸入。</span><span class="sxs-lookup"><span data-stu-id="67cfc-122">In short, accessible technologies that require read-only access to a text store can use <xref:System.Windows.Automation.TextPattern>, but will need the more complex functionality of TSF for context-aware input.</span></span>

<a name="Control_Types"></a>

## <a name="control-types"></a><span data-ttu-id="67cfc-123">控制項類型</span><span class="sxs-lookup"><span data-stu-id="67cfc-123">Control Types</span></span>

### <a name="text"></a><span data-ttu-id="67cfc-124">Text</span><span class="sxs-lookup"><span data-stu-id="67cfc-124">Text</span></span>

<span data-ttu-id="67cfc-125">文字控制項是用來表示螢幕上一段文字的基本項目。</span><span class="sxs-lookup"><span data-stu-id="67cfc-125">The Text control is the basic element representing a piece of text on the screen.</span></span>

<span data-ttu-id="67cfc-126">獨立的文字控制項可以用來當做標籤或表單上的靜態文字。</span><span class="sxs-lookup"><span data-stu-id="67cfc-126">A standalone text control can be used as a label or static text on a form.</span></span> <span data-ttu-id="67cfc-127">文字控制項也可以包含在 <xref:System.Windows.Automation.ControlType.ListItem>、 <xref:System.Windows.Automation.ControlType.TreeItem> 或 <xref:System.Windows.Automation.ControlType.DataItem>的結構內。</span><span class="sxs-lookup"><span data-stu-id="67cfc-127">Text controls can also be contained within the structure of a <xref:System.Windows.Automation.ControlType.ListItem>, <xref:System.Windows.Automation.ControlType.TreeItem> or <xref:System.Windows.Automation.ControlType.DataItem>.</span></span>

> [!NOTE]
> <span data-ttu-id="67cfc-128">文字控制項可能不會出現在 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 樹狀結構的內容檢視中 (請參閱 [UI Automation Tree Overview](ui-automation-tree-overview.md))。</span><span class="sxs-lookup"><span data-stu-id="67cfc-128">Text controls might not appear in the content view of the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree (see [UI Automation Tree Overview](ui-automation-tree-overview.md)).</span></span> <span data-ttu-id="67cfc-129">這是因為文字控制項通常是透過另一個控制項的名稱屬性來顯示。</span><span class="sxs-lookup"><span data-stu-id="67cfc-129">This is because text controls are often displayed through the Name property of another control.</span></span> <span data-ttu-id="67cfc-130">比方說，用來標示編輯控制項的文字，會透過編輯控制項的名稱屬性來顯示。</span><span class="sxs-lookup"><span data-stu-id="67cfc-130">For instance, the text that is used to label an Edit control is exposed through the Name property of the Edit control.</span></span> <span data-ttu-id="67cfc-131">因為編輯控制項是在 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 樹狀目錄的內容檢視中，所以文字項目本身不需要在 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 樹狀結構的那個檢視中。</span><span class="sxs-lookup"><span data-stu-id="67cfc-131">Because the Edit control is in the content view of the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree, it is not necessary for the text element itself to be in that view of the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree.</span></span> <span data-ttu-id="67cfc-132">內容檢視中唯一出現的文字是非多餘資訊的文字。</span><span class="sxs-lookup"><span data-stu-id="67cfc-132">The only text that shows up in the content view is text that is not redundant information.</span></span> <span data-ttu-id="67cfc-133">這可以讓任何輔助技術只在其使用者需要的資訊項目上快速篩選。</span><span class="sxs-lookup"><span data-stu-id="67cfc-133">This enables any assistive technology to quickly filter only on the pieces of information that their users need.</span></span>

### <a name="edit"></a><span data-ttu-id="67cfc-134">編輯</span><span class="sxs-lookup"><span data-stu-id="67cfc-134">Edit</span></span>

<span data-ttu-id="67cfc-135">編輯控制項可讓使用者檢視和編輯單行文字。</span><span class="sxs-lookup"><span data-stu-id="67cfc-135">Edit controls enable a user to view and edit a single line of text.</span></span>

> [!NOTE]
> <span data-ttu-id="67cfc-136">在某些配置案例中，單行文字可能會換行。</span><span class="sxs-lookup"><span data-stu-id="67cfc-136">The single line of text may wrap in certain layout scenarios.</span></span>

### <a name="document"></a><span data-ttu-id="67cfc-137">Document</span><span class="sxs-lookup"><span data-stu-id="67cfc-137">Document</span></span>

<span data-ttu-id="67cfc-138">文件控制項可讓使用者巡覽及取得多頁文字中的資訊。</span><span class="sxs-lookup"><span data-stu-id="67cfc-138">Document controls let a user navigate and obtain information from multiple pages of text.</span></span>

<a name="TextPattern_Client_API_s"></a>

## <a name="textpattern-client-apis"></a><span data-ttu-id="67cfc-139">TextPattern 用戶端 Api</span><span class="sxs-lookup"><span data-stu-id="67cfc-139">TextPattern Client APIs</span></span>

|||
|-|-|
|`System.Windows.Automation.TextPattern Class`|<span data-ttu-id="67cfc-140">[!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] 文字模型的進入點。</span><span class="sxs-lookup"><span data-stu-id="67cfc-140">The entry point for the [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] text model.</span></span><br /><br /> <span data-ttu-id="67cfc-141">這個類別也包含下列兩個 <xref:System.Windows.Automation.TextPattern> 事件接聽程式： <xref:System.Windows.Automation.TextPattern.TextSelectionChangedEvent> 和 <xref:System.Windows.Automation.TextPattern.TextChangedEvent>。</span><span class="sxs-lookup"><span data-stu-id="67cfc-141">This class also contains the two <xref:System.Windows.Automation.TextPattern> event listeners, <xref:System.Windows.Automation.TextPattern.TextSelectionChangedEvent> and <xref:System.Windows.Automation.TextPattern.TextChangedEvent>.</span></span>|
|`System.Windows.Automation.Text.TextPatternRange Class`|<span data-ttu-id="67cfc-142">支援 <xref:System.Windows.Automation.TextPattern>之文字容器內的一段文字表示法。</span><span class="sxs-lookup"><span data-stu-id="67cfc-142">The representation of a span of text within a text container that supports <xref:System.Windows.Automation.TextPattern>.</span></span><br /><br /> <span data-ttu-id="67cfc-143">使用者介面自動化用戶端應謹慎處理使用 <xref:System.Windows.Automation.Text.TextPatternRange>建立之文字範圍的目前有效性。</span><span class="sxs-lookup"><span data-stu-id="67cfc-143">UI Automation clients should be careful about the current validity of a text range created using <xref:System.Windows.Automation.Text.TextPatternRange>.</span></span> <span data-ttu-id="67cfc-144">如果文字控制項中的原始文字完全被新的文字所取代，目前的文字範圍就會變成無效。</span><span class="sxs-lookup"><span data-stu-id="67cfc-144">If the original text in the text control is completely replaced by new text, the current text range becomes invalid.</span></span> <span data-ttu-id="67cfc-145">不過，如果只有部分原始文字變更，且基礎文字控制項是使用錨點 (或端點) 來管理其文字「指標」，而不是使用絕對字元定位，則文字範圍可能仍有一些可行性。</span><span class="sxs-lookup"><span data-stu-id="67cfc-145">However, the text range may still have some viability if only part of the original text is changed and the underlying text control is managing its text "pointer" with anchors (or endpoints) rather than with absolute character positioning.</span></span><br /><br /> <span data-ttu-id="67cfc-146">用戶端可以接聽 <xref:System.Windows.Automation.TextPattern.TextChangedEvent> ，以取得其使用之文字內容的任何變更通知。</span><span class="sxs-lookup"><span data-stu-id="67cfc-146">Clients can listen for a <xref:System.Windows.Automation.TextPattern.TextChangedEvent> for notification of any changes to the textual content they are working with.</span></span>|
|`System.Windows.Automation.AutomationTextAttribute Class`|<span data-ttu-id="67cfc-147">用來識別文字範圍的格式化屬性。</span><span class="sxs-lookup"><span data-stu-id="67cfc-147">Used to identify the formatting attributes of a text range.</span></span>|

<a name="TextPattern_Provider_API_s"></a>

## <a name="textpattern-provider-apis"></a><span data-ttu-id="67cfc-148">TextPattern 提供者 Api</span><span class="sxs-lookup"><span data-stu-id="67cfc-148">TextPattern Provider APIs</span></span>

<span data-ttu-id="67cfc-149">藉由實作 <xref:System.Windows.Automation.TextPattern> 和 <xref:System.Windows.Automation.Provider.ITextProvider> 介面 (原生或透過 <xref:System.Windows.Automation.Provider.ITextRangeProvider> Proxy) 來支援 [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] 的 UI 項目或控制項，除了提供強大的巡覽功能，還能夠公開其包含之任何文字的詳細屬性資訊。</span><span class="sxs-lookup"><span data-stu-id="67cfc-149">UI elements or controls that support <xref:System.Windows.Automation.TextPattern> by implementing the <xref:System.Windows.Automation.Provider.ITextProvider> and <xref:System.Windows.Automation.Provider.ITextRangeProvider> interfaces, either natively or through [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] proxies, are capable of exposing detailed attribute information for any text they contain in addition to providing robust navigational capabilities.</span></span>

<span data-ttu-id="67cfc-150">如果控制項不支援任何特定屬性，則 <xref:System.Windows.Automation.TextPattern> 提供者不需要支援所有文字屬性。</span><span class="sxs-lookup"><span data-stu-id="67cfc-150">A <xref:System.Windows.Automation.TextPattern> provider does not have to support all text attributes if the control lacks support for any particular attributes.</span></span>

<span data-ttu-id="67cfc-151">如果控制項支援文字區域內之文字游標 (或系統游標) 的文字選取範圍或位置，則 <xref:System.Windows.Automation.TextPattern> 提供者必須支援 <xref:System.Windows.Automation.TextPattern.GetSelection%2A> 和 <xref:System.Windows.Automation.Text.TextPatternRange.Select%2A> 函式。</span><span class="sxs-lookup"><span data-stu-id="67cfc-151">A <xref:System.Windows.Automation.TextPattern> provider must support the <xref:System.Windows.Automation.TextPattern.GetSelection%2A> and <xref:System.Windows.Automation.Text.TextPatternRange.Select%2A> functions if the control supports text selection or placement of the text cursor (or system caret) within the text area.</span></span> <span data-ttu-id="67cfc-152">如果控制項不支援這項功能，就不需要支援其中任一種方法。</span><span class="sxs-lookup"><span data-stu-id="67cfc-152">If the control does not support this functionality then it does not need to support either of these methods.</span></span> <span data-ttu-id="67cfc-153">不過，控制項必須實作 <xref:System.Windows.Automation.Provider.ITextProvider.SupportedTextSelection%2A> 屬性，以公開其支援的文字選取範圍類型。</span><span class="sxs-lookup"><span data-stu-id="67cfc-153">However, the control must expose the type of text selection it supports by implementing the <xref:System.Windows.Automation.Provider.ITextProvider.SupportedTextSelection%2A> property.</span></span>

<span data-ttu-id="67cfc-154"><xref:System.Windows.Automation.TextPattern> 提供者必須一律支援 <xref:System.Windows.Automation.Text.TextUnit> 常數 <xref:System.Windows.Automation.Text.TextUnit.Character> 和 <xref:System.Windows.Automation.Text.TextUnit.Document> ，以及它能夠支援的任何其他 <xref:System.Windows.Automation.Text.TextUnit> 常數。</span><span class="sxs-lookup"><span data-stu-id="67cfc-154">A <xref:System.Windows.Automation.TextPattern> provider must always support the <xref:System.Windows.Automation.Text.TextUnit> constants <xref:System.Windows.Automation.Text.TextUnit.Character> and <xref:System.Windows.Automation.Text.TextUnit.Document> as well as any other <xref:System.Windows.Automation.Text.TextUnit> constants it is capable of supporting.</span></span>

> [!NOTE]
> <span data-ttu-id="67cfc-155">如果提供者要略過針對特定 <xref:System.Windows.Automation.Text.TextUnit> 的支援，可以延遲到所支援的下一個最大 <xref:System.Windows.Automation.Text.TextUnit> ，順序如下： <xref:System.Windows.Automation.Text.TextUnit.Character>、 <xref:System.Windows.Automation.Text.TextUnit.Format>、 <xref:System.Windows.Automation.Text.TextUnit.Word>、 <xref:System.Windows.Automation.Text.TextUnit.Line>、 <xref:System.Windows.Automation.Text.TextUnit.Paragraph>、 <xref:System.Windows.Automation.Text.TextUnit.Page>和 <xref:System.Windows.Automation.Text.TextUnit.Document>。</span><span class="sxs-lookup"><span data-stu-id="67cfc-155">The provider may skip support for a specific <xref:System.Windows.Automation.Text.TextUnit> by deferring to the next largest <xref:System.Windows.Automation.Text.TextUnit> supported in the following order: <xref:System.Windows.Automation.Text.TextUnit.Character>, <xref:System.Windows.Automation.Text.TextUnit.Format>, <xref:System.Windows.Automation.Text.TextUnit.Word>, <xref:System.Windows.Automation.Text.TextUnit.Line>, <xref:System.Windows.Automation.Text.TextUnit.Paragraph>, <xref:System.Windows.Automation.Text.TextUnit.Page>, and <xref:System.Windows.Automation.Text.TextUnit.Document>.</span></span>

|||
|-|-|
|`ITextProvider Interface`|<span data-ttu-id="67cfc-156">公開用戶端應用程式中支援 <xref:System.Windows.Automation.TextPattern> 的方法、屬性 (property) 和屬性 (attribute)，請參閱 <xref:System.Windows.Automation.Provider.ITextProvider>。</span><span class="sxs-lookup"><span data-stu-id="67cfc-156">Exposes methods, properties and attributes that support <xref:System.Windows.Automation.TextPattern> in client applications (see <xref:System.Windows.Automation.Provider.ITextProvider>).</span></span>|
|`ITextRangeProvider Interface`|<span data-ttu-id="67cfc-157">表示文字提供者中的一段文字，請參閱 <xref:System.Windows.Automation.Provider.ITextRangeProvider>。</span><span class="sxs-lookup"><span data-stu-id="67cfc-157">Represents a span of text in a text provider (see <xref:System.Windows.Automation.Provider.ITextRangeProvider>).</span></span>|
|`System.Windows.Automation.TextPatternIdentifiers Class`|<span data-ttu-id="67cfc-158">包含用來做為文字提供者識別項的值，請參閱 <xref:System.Windows.Automation.TextPatternIdentifiers>。</span><span class="sxs-lookup"><span data-stu-id="67cfc-158">Contains values that are used as identifiers for text providers (see <xref:System.Windows.Automation.TextPatternIdentifiers>).</span></span>|

<a name="Security"></a>

## <a name="security"></a><span data-ttu-id="67cfc-159">安全性</span><span class="sxs-lookup"><span data-stu-id="67cfc-159">Security</span></span>

<span data-ttu-id="67cfc-160">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]架構的設計是以安全性為考慮（請參閱[UI 自動化安全性總覽](ui-automation-security-overview.md)）。</span><span class="sxs-lookup"><span data-stu-id="67cfc-160">The [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] architecture was designed with security in mind (see [UI Automation Security Overview](ui-automation-security-overview.md)).</span></span> <span data-ttu-id="67cfc-161">不過，本概觀中所描述的 TextPattern 類別，需要一些特定的安全性考量。</span><span class="sxs-lookup"><span data-stu-id="67cfc-161">However, the TextPattern classes described in this overview require some specific security considerations.</span></span>

- [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] <span data-ttu-id="67cfc-162">文字提供者提供唯讀介面，而且不提供變更控制項中現有文字的能力。</span><span class="sxs-lookup"><span data-stu-id="67cfc-162">text providers supply read-only interfaces and do not provide the ability to change the existing text in a control.</span></span>

- <span data-ttu-id="67cfc-163">使用者介面自動化用戶端在完全「受信任」的情況下，只能使用 [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="67cfc-163">UI Automation clients can only use [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] if they are fully "trusted".</span></span> <span data-ttu-id="67cfc-164">此案例的範例之一，就是受保護的登入桌面，只有已知且受信任的應用程式可以在上面執行。</span><span class="sxs-lookup"><span data-stu-id="67cfc-164">An example of this would be the protected Logon Desktop, where only known and trusted applications can run.</span></span>

- <span data-ttu-id="67cfc-165">使用者介面自動化提供者的開發人員應該要知道，他們選擇透過 [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] 公開在其控制項中的所有資訊，基本上是公用的，而且完全可供其他程式碼存取。</span><span class="sxs-lookup"><span data-stu-id="67cfc-165">Developers of UI Automation providers should be aware that all information they choose to expose in their controls through [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] is essentially public and fully accessible by other code.</span></span> [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] <span data-ttu-id="67cfc-166">完全不會判斷任何使用者介面自動化用戶端的可信度，因此，使用者介面自動化提供者不應公開受保護的內容或敏感的文字資訊 (例如密碼欄位)。</span><span class="sxs-lookup"><span data-stu-id="67cfc-166">makes no effort to determine the trustworthiness of any UI Automation client and therefore the UI Automation provider should not expose protected content or sensitive textual information (such as password fields).</span></span>

- <span data-ttu-id="67cfc-167">Windows Vista 安全性的其中一項最重要的變更就是所謂的「安全輸入」，其中包含最低許可權（或有限）使用者帳戶（LUA）和 UI 許可權層級隔離（UIPI）等技術。</span><span class="sxs-lookup"><span data-stu-id="67cfc-167">One of the most significant changes in security for Windows Vista is broadly referred to as "Secure Input" which encompasses technologies such as Least-privileged (or Limited) User Accounts (LUA) and UI Privilege Level Isolation (UIPI).</span></span>

  - <span data-ttu-id="67cfc-168">UIPI 會防止一個程式控制及/或監視另一個「權限」更高的程式，以防止詐騙使用者輸入的跨處理序視窗訊息攻擊。</span><span class="sxs-lookup"><span data-stu-id="67cfc-168">UIPI prevents one program from controlling and/or monitoring another more "privileged" program, preventing cross-process window message attacks that spoof user input.</span></span>

  - <span data-ttu-id="67cfc-169">LUA 會針對系統管理員群組中之使用者所執行的應用程式，設定權限的限制。</span><span class="sxs-lookup"><span data-stu-id="67cfc-169">LUA sets limits on the privileges of applications being run by users in the Administrators group.</span></span> <span data-ttu-id="67cfc-170">應用程式不一定要有系統管理員權限，但是會以所需的最低權限來執行。</span><span class="sxs-lookup"><span data-stu-id="67cfc-170">Applications won't necessarily have administrator privileges, but will instead run with the least privileges necessary.</span></span> <span data-ttu-id="67cfc-171">因此，可能會在 LUA 案例中強制執行一些限制。</span><span class="sxs-lookup"><span data-stu-id="67cfc-171">As a consequence, there may be some restrictions enforced in LUA scenarios.</span></span> <span data-ttu-id="67cfc-172">最值得注意的字串截斷 (包括 TextPattern 字串)，其中可能需要限制從系統管理員層級應用程式擷取的字串大小，因此不會強制其將記憶體配置到停用應用程式的點。</span><span class="sxs-lookup"><span data-stu-id="67cfc-172">Most notably string truncation (including TextPattern strings), where it may be necessary to limit the size of strings being retrieved from administrator-level applications so they aren't forced to allocate memory to the point of disabling the application.</span></span>

<a name="Performance"></a>

## <a name="performance"></a><span data-ttu-id="67cfc-173">效能</span><span class="sxs-lookup"><span data-stu-id="67cfc-173">Performance</span></span>

<span data-ttu-id="67cfc-174">由於 TextPattern 依賴跨處理序呼叫來執行其大部分的功能，因此它沒有提供快取機制來改善處理內容時的效能。</span><span class="sxs-lookup"><span data-stu-id="67cfc-174">Because TextPattern relies on cross-process calls for most of its functionality, it does not provide a caching mechanism to improve performance when processing content.</span></span> <span data-ttu-id="67cfc-175">這一點不同於 [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] 中，可以使用 <xref:System.Windows.Automation.AutomationElement.GetCachedPattern%2A> 或 <xref:System.Windows.Automation.AutomationElement.TryGetCachedPattern%2A> 方法來存取的其他控制項模式。</span><span class="sxs-lookup"><span data-stu-id="67cfc-175">This is unlike other control patterns in [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] that can be accessed using the <xref:System.Windows.Automation.AutomationElement.GetCachedPattern%2A> or <xref:System.Windows.Automation.AutomationElement.TryGetCachedPattern%2A> methods.</span></span>

<span data-ttu-id="67cfc-176">改善效能的一個策略，就是確定使用者介面自動化用戶端會使用 <xref:System.Windows.Automation.Text.TextPatternRange.GetText%2A>，嘗試擷取適當調整大小的文字區塊。</span><span class="sxs-lookup"><span data-stu-id="67cfc-176">One tactic for improving performance is by making sure UI Automation clients attempt to retrieve moderately-sized blocks of text using <xref:System.Windows.Automation.Text.TextPatternRange.GetText%2A>.</span></span> <span data-ttu-id="67cfc-177">例如，GetText(1) 呼叫會針對每個字元產生跨處理序叫用，而一個 GetText(-1) 呼叫將會產生一個跨處理序叫用，但是依據文字提供者的大小，可以有高延遲。</span><span class="sxs-lookup"><span data-stu-id="67cfc-177">For example, GetText(1) calls will incur cross-process hits for each character whereas one GetText(-1) call will incur one cross-process hit, but can have high latency depending on the size of the text provider.</span></span>

<a name="Glossary"></a>

## <a name="textpattern-terminology"></a><span data-ttu-id="67cfc-178">TextPattern 術語</span><span class="sxs-lookup"><span data-stu-id="67cfc-178">TextPattern Terminology</span></span>

<span data-ttu-id="67cfc-179">**特性**</span><span class="sxs-lookup"><span data-stu-id="67cfc-179">**Attribute**</span></span>\
<span data-ttu-id="67cfc-180">文字範圍的格式化特性 (例如， <xref:System.Windows.Automation.TextPattern.IsItalicAttribute> 或 <xref:System.Windows.Automation.TextPattern.FontNameAttribute>)。</span><span class="sxs-lookup"><span data-stu-id="67cfc-180">A formatting characteristic of a text range (for example, <xref:System.Windows.Automation.TextPattern.IsItalicAttribute> or <xref:System.Windows.Automation.TextPattern.FontNameAttribute>).</span></span>

<span data-ttu-id="67cfc-181">**退化範圍**</span><span class="sxs-lookup"><span data-stu-id="67cfc-181">**Degenerate Range**</span></span>\
<span data-ttu-id="67cfc-182">變質範圍是空白或零個字元的文字範圍。</span><span class="sxs-lookup"><span data-stu-id="67cfc-182">A degenerate range is an empty or zero-character text range.</span></span> <span data-ttu-id="67cfc-183">就 TextPattern 控制項模式的目的而言，文字插入點 (或系統游標) 會被視為變質範圍。</span><span class="sxs-lookup"><span data-stu-id="67cfc-183">For the purposes of the TextPattern control pattern, the text insertion point (or system caret) is considered a degenerate range.</span></span> <span data-ttu-id="67cfc-184">如果沒有選取文字， <xref:System.Windows.Automation.TextPattern.GetSelection%2A> 會在文字插入點傳回變質範圍，而 <xref:System.Windows.Automation.TextPattern.RangeFromPoint%2A> 會傳回變質範圍，做為其起始端點。</span><span class="sxs-lookup"><span data-stu-id="67cfc-184">If no text is selected, <xref:System.Windows.Automation.TextPattern.GetSelection%2A> would return a degenerate range at the text insertion point and <xref:System.Windows.Automation.TextPattern.RangeFromPoint%2A> would return a degenerate range as its starting endpoint.</span></span> <span data-ttu-id="67cfc-185">當文字提供者找不到符合指定條件的任何文字範圍時，<xref:System.Windows.Automation.TextPattern.RangeFromChild%2A> 和 <xref:System.Windows.Automation.TextPattern.GetVisibleRanges%2A> 可能會傳回變質範圍。</span><span class="sxs-lookup"><span data-stu-id="67cfc-185"><xref:System.Windows.Automation.TextPattern.RangeFromChild%2A> and <xref:System.Windows.Automation.TextPattern.GetVisibleRanges%2A> may return degenerate ranges when the text provider cannot find any text ranges that match the given condition.</span></span> <span data-ttu-id="67cfc-186">這個變質範圍可以用來當做文字提供者內的開始端點。</span><span class="sxs-lookup"><span data-stu-id="67cfc-186">This degenerate range can be used as a starting endpoint within the text provider.</span></span> <span data-ttu-id="67cfc-187"><xref:System.Windows.Automation.Text.TextPatternRange.FindText%2A>和會傳回 <xref:System.Windows.Automation.Text.TextPatternRange.FindAttribute%2A> null 參考（ `Nothing` 在 Microsoft Visual Basic .net 中），以避免與已探索的範圍與退化範圍混淆。</span><span class="sxs-lookup"><span data-stu-id="67cfc-187"><xref:System.Windows.Automation.Text.TextPatternRange.FindText%2A> and <xref:System.Windows.Automation.Text.TextPatternRange.FindAttribute%2A> return a null reference (`Nothing` in Microsoft Visual Basic .NET) to avoid confusion with a discovered range versus a degenerate range.</span></span>

<span data-ttu-id="67cfc-188">**Embedded 物件**</span><span class="sxs-lookup"><span data-stu-id="67cfc-188">**Embedded Object**</span></span>\
<span data-ttu-id="67cfc-189">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 文字模型中有兩種類型的內嵌物件 。</span><span class="sxs-lookup"><span data-stu-id="67cfc-189">There are two types of embedded objects in the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] text model.</span></span> <span data-ttu-id="67cfc-190">其中包含以文字為基礎的內容項目 (例如超連結或資料表)，以及控制項目 (例如影像和按鈕)。</span><span class="sxs-lookup"><span data-stu-id="67cfc-190">They consist of text-based content elements such as hyperlinks or tables, and control elements such as images and buttons.</span></span> <span data-ttu-id="67cfc-191">如需詳細資訊，請參閱 [Access Embedded Objects Using UI Automation](access-embedded-objects-using-ui-automation.md)。</span><span class="sxs-lookup"><span data-stu-id="67cfc-191">For more detailed information, see [Access Embedded Objects Using UI Automation](access-embedded-objects-using-ui-automation.md).</span></span>

<span data-ttu-id="67cfc-192">**左端**</span><span class="sxs-lookup"><span data-stu-id="67cfc-192">**Endpoint**</span></span>\
<span data-ttu-id="67cfc-193">文字容器內之文字範圍的絕對 <xref:System.Windows.Automation.Text.TextPatternRangeEndpoint.Start> 或 <xref:System.Windows.Automation.Text.TextPatternRangeEndpoint.End> 點。</span><span class="sxs-lookup"><span data-stu-id="67cfc-193">The absolute <xref:System.Windows.Automation.Text.TextPatternRangeEndpoint.Start> or <xref:System.Windows.Automation.Text.TextPatternRangeEndpoint.End> point of a text range within a text container.</span></span>

<span data-ttu-id="67cfc-194">![TextPatternRangeEndpoints &#40;開始和結束&#41;。](./media/uia-textpattern-endpoints.PNG "UIA_TextPattern_Endpoints")</span><span class="sxs-lookup"><span data-stu-id="67cfc-194">![TextPatternRangeEndpoints &#40;start and end&#41;.](./media/uia-textpattern-endpoints.PNG "UIA_TextPattern_Endpoints")</span></span>
<span data-ttu-id="67cfc-195">下列範例說明一組開始和結束點。</span><span class="sxs-lookup"><span data-stu-id="67cfc-195">The following illustrates a set of start and end points.</span></span>

<span data-ttu-id="67cfc-196">**TextRange**</span><span class="sxs-lookup"><span data-stu-id="67cfc-196">**TextRange**</span></span>\
<span data-ttu-id="67cfc-197">表示包含所有相關聯屬性和功能的文字容器中的一段文字，有開始和結束點。</span><span class="sxs-lookup"><span data-stu-id="67cfc-197">A representation of a span of text, with start and end points, in a text container including all associated attributes and functionality.</span></span>

<xref:System.Windows.Automation.Text.TextUnit>\
<span data-ttu-id="67cfc-198">預先定義的文字單位 (字元、單字、字行或段落)，用於巡覽文字範圍的邏輯區段。</span><span class="sxs-lookup"><span data-stu-id="67cfc-198">A pre-defined unit of text (character, word, line, or paragraph) used for navigating through logical segments of a text range.</span></span>

## <a name="see-also"></a><span data-ttu-id="67cfc-199">另請參閱</span><span class="sxs-lookup"><span data-stu-id="67cfc-199">See also</span></span>

- [<span data-ttu-id="67cfc-200">用戶端的 UI 自動化控制項模式</span><span class="sxs-lookup"><span data-stu-id="67cfc-200">UI Automation Control Patterns for Clients</span></span>](ui-automation-control-patterns-for-clients.md)
- [<span data-ttu-id="67cfc-201">UI 自動化控制項模式概觀</span><span class="sxs-lookup"><span data-stu-id="67cfc-201">UI Automation Control Patterns Overview</span></span>](ui-automation-control-patterns-overview.md)
- [<span data-ttu-id="67cfc-202">UI 自動化樹狀目錄概觀</span><span class="sxs-lookup"><span data-stu-id="67cfc-202">UI Automation Tree Overview</span></span>](ui-automation-tree-overview.md)
- [<span data-ttu-id="67cfc-203">使用 UI 自動化中的快取</span><span class="sxs-lookup"><span data-stu-id="67cfc-203">Use Caching in UI Automation</span></span>](use-caching-in-ui-automation.md)
- [<span data-ttu-id="67cfc-204">支援 UI 自動化提供者的控制項模式</span><span class="sxs-lookup"><span data-stu-id="67cfc-204">Support Control Patterns in a UI Automation Provider</span></span>](support-control-patterns-in-a-ui-automation-provider.md)
- [<span data-ttu-id="67cfc-205">UI 自動化用戶端的控制項模式對應</span><span class="sxs-lookup"><span data-stu-id="67cfc-205">Control Pattern Mapping for UI Automation Clients</span></span>](control-pattern-mapping-for-ui-automation-clients.md)
- [<span data-ttu-id="67cfc-206">Text Services Framework (TSF)</span><span class="sxs-lookup"><span data-stu-id="67cfc-206">Text Services Framework</span></span>](/windows/desktop/api/_tsf/)

---
title: SignTool.exe (簽署工具)
description: 瞭解 SignTool.exe，簽署工具。 此命令列工具會以數位方式簽署檔案、驗證檔案中的簽章，並將時間戳記套用至檔案。
ms.date: 03/30/2017
helpviewer_keywords:
- Sign tool
- SignTool.exe
ms.assetid: 0c25ff6c-bff3-422e-b017-146a3ee86cb9
ms.openlocfilehash: 46a7453ff7de0329d9cd7f671dcaa0a3e3e0e54c
ms.sourcegitcommit: bc293b14af795e0e999e3304dd40c0222cf2ffe4
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 11/26/2020
ms.locfileid: "96238466"
---
# <a name="signtoolexe-sign-tool"></a><span data-ttu-id="b4ce1-104">SignTool.exe (簽署工具)</span><span class="sxs-lookup"><span data-stu-id="b4ce1-104">SignTool.exe (Sign Tool)</span></span>

<span data-ttu-id="b4ce1-105">簽署工具是一項命令列工具，會以數位方式簽署檔案、驗證檔案中的簽章以及為檔案加上時間戳記。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-105">Sign Tool is a command-line tool that digitally signs files, verifies signatures in files, and time-stamps files.</span></span>  
  
 <span data-ttu-id="b4ce1-106">此工具會自動與 Visual Studio 一起安裝。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-106">This tool is automatically installed with Visual Studio.</span></span> <span data-ttu-id="b4ce1-107">若要執行這項工具，請使用 [Visual Studio 開發人員命令提示字元] (或 Windows 7 中的 [Visual Studio 命令提示字元])。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-107">To run the tool, use the Developer Command Prompt for Visual Studio (or the Visual Studio Command Prompt in Windows 7).</span></span> <span data-ttu-id="b4ce1-108">如需詳細資訊，請參閱[命令提示字元](developer-command-prompt-for-vs.md)。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-108">For more information, see [Command Prompts](developer-command-prompt-for-vs.md).</span></span>

> [!Note]  
> <span data-ttu-id="b4ce1-109">Windows 10 SDK、Windows 10 的 HLK、Windows 10 WDK 和 Windows 10 ADK **組建20236和更新版本** 都需要指定摘要演算法。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-109">The Windows 10 SDK, Windows 10 HLK, Windows 10 WDK and Windows 10 ADK **builds 20236 and later** require specifying the digest algorithm.</span></span> <span data-ttu-id="b4ce1-110">SignTool `sign` 命令需要分別在 `/fd` 簽署和時間戳記期間指定檔案 **摘要演算法** 和 `/td` **時間戳記摘要演算法** 選項。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-110">The SignTool `sign` command requires the `/fd` **file digest algorithm** and the `/td` **timestamp digest algorithm** option to be specified during signing and timestamping, respectively.</span></span> <span data-ttu-id="b4ce1-111">警告 (錯誤碼0，如果在簽署期間未指定，則會擲回) ， `/fd` 而且 `/td` 在時間戳記期間未指定時，會擲回。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-111">A warning (error code 0, initially) will be thrown if `/fd` is not specified during signing and if `/td` is not specified during timestamping.</span></span> <span data-ttu-id="b4ce1-112">在 SignTool 的較新版本中，警告會變成錯誤。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-112">In later versions of SignTool, the warning will become an error.</span></span> <span data-ttu-id="b4ce1-113">建議您將 SHA256 視為比產業的 SHA1 更安全。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-113">SHA256 is recommended and considered to be more secure than SHA1 by the industry.</span></span>  
  
 <span data-ttu-id="b4ce1-114">在命令提示字元中，請輸入下列項目：</span><span class="sxs-lookup"><span data-stu-id="b4ce1-114">At the command prompt, type the following:</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="b4ce1-115">語法</span><span class="sxs-lookup"><span data-stu-id="b4ce1-115">Syntax</span></span>  
  
```console  
signtool [command] [options] [file_name | ...]  
```  
  
## <a name="parameters"></a><span data-ttu-id="b4ce1-116">參數</span><span class="sxs-lookup"><span data-stu-id="b4ce1-116">Parameters</span></span>  
  
|<span data-ttu-id="b4ce1-117">引數</span><span class="sxs-lookup"><span data-stu-id="b4ce1-117">Argument</span></span>|<span data-ttu-id="b4ce1-118">描述</span><span class="sxs-lookup"><span data-stu-id="b4ce1-118">Description</span></span>|  
|--------------|-----------------|  
|`command`|<span data-ttu-id="b4ce1-119">四個命令之一 (`catdb`、`sign`、`Timestamp` 或 `Verify`)，指定要對檔案執行的操作。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-119">One of four commands (`catdb`, `sign`, `Timestamp`, or `Verify`) that specifies an operation to perform on a file.</span></span> <span data-ttu-id="b4ce1-120">如需每個命令的描述，請參閱下一個表格。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-120">For a description of each command, see the next table.</span></span>|  
|`options`|<span data-ttu-id="b4ce1-121">修改命令的選項。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-121">An option that modifies a command.</span></span> <span data-ttu-id="b4ce1-122">除了全域 `/q` 和 `/v` 選項外，每個命令支援一組唯一的選項。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-122">In addition to the global `/q` and `/v` options, each command supports a unique set of options.</span></span>|  
|`file_name`|<span data-ttu-id="b4ce1-123">要簽署之檔案的路徑。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-123">The path to a file to sign.</span></span>|  
  
 <span data-ttu-id="b4ce1-124">簽署工具支援下列命令。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-124">The following commands are supported by Sign Tool.</span></span> <span data-ttu-id="b4ce1-125">每個命令都會搭配一組獨特選項使用，這些選項列於個別區段中。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-125">Each command is used with distinct sets of options, which are listed in their respective sections.</span></span>  
  
|<span data-ttu-id="b4ce1-126">Command</span><span class="sxs-lookup"><span data-stu-id="b4ce1-126">Command</span></span>|<span data-ttu-id="b4ce1-127">描述</span><span class="sxs-lookup"><span data-stu-id="b4ce1-127">Description</span></span>|  
|-------------|-----------------|  
|`catdb`|<span data-ttu-id="b4ce1-128">在目錄資料庫中加入或移除目錄檔。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-128">Adds a catalog file to, or removes it from, a catalog database.</span></span> <span data-ttu-id="b4ce1-129">目錄資料庫可以用來自動查閱目錄檔，並且是由 GUID 所識別。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-129">Catalog databases are used for automatic lookup of catalog files and are identified by GUID.</span></span> <span data-ttu-id="b4ce1-130">如需 `catdb` 命令支援選項的清單，請參閱 [catdb 命令選項](signtool-exe.md#catdb)。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-130">For a list of the options supported by the `catdb` command, see [catdb Command Options](signtool-exe.md#catdb).</span></span>|  
|`sign`|<span data-ttu-id="b4ce1-131">數位簽署檔案。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-131">Digitally signs files.</span></span> <span data-ttu-id="b4ce1-132">數位簽章可以防止檔案遭到篡改，而且可讓使用者根據簽署憑證確認簽署者。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-132">Digital signatures protect files from tampering, and enable users to verify the signer based on a signing certificate.</span></span> <span data-ttu-id="b4ce1-133">如需 `sign` 命令支援選項的清單，請參閱 [sign 命令選項](signtool-exe.md#sign)。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-133">For a list of the options supported by the `sign` command, see [sign Command Options](signtool-exe.md#sign).</span></span>|  
|`Timestamp`|<span data-ttu-id="b4ce1-134">為檔案加上時間戳記。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-134">Time-stamps files.</span></span> <span data-ttu-id="b4ce1-135">如需 `TimeStamp` 命令支援選項的清單，請參閱 [TimeStamp 命令選項](signtool-exe.md#TimeStamp)。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-135">For a list of the options supported by the `TimeStamp` command, see [TimeStamp Command Options](signtool-exe.md#TimeStamp).</span></span>|  
|`Verify`|<span data-ttu-id="b4ce1-136">藉由判斷簽署憑證是否由受信任的授權單位所發佈、簽署憑證是否已撤銷，以及簽署憑證是否為特定原則的有效憑證，來驗證檔案的數位簽章。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-136">Verifies the digital signature of files by determining whether the signing certificate was issued by a trusted authority, whether the signing certificate has been revoked, and, optionally, whether the signing certificate is valid for a specific policy.</span></span> <span data-ttu-id="b4ce1-137">如需 `Verify` 命令支援選項的清單，請參閱 [Verify 命令選項](signtool-exe.md#Verify)。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-137">For a list of the options supported by the `Verify` command, see [Verify Command Options](signtool-exe.md#Verify).</span></span>|  
  
 <span data-ttu-id="b4ce1-138">下列選項適用於所有簽署工具命令。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-138">The following options apply to all Sign Tool commands.</span></span>  
  
|<span data-ttu-id="b4ce1-139">Global 選項</span><span class="sxs-lookup"><span data-stu-id="b4ce1-139">Global option</span></span>|<span data-ttu-id="b4ce1-140">描述</span><span class="sxs-lookup"><span data-stu-id="b4ce1-140">Description</span></span>|  
|-------------------|-----------------|  
|<span data-ttu-id="b4ce1-141">**/q**</span><span class="sxs-lookup"><span data-stu-id="b4ce1-141">**/q**</span></span>|<span data-ttu-id="b4ce1-142">如果命令成功執行則不顯示任何輸出，如果命令失敗則顯示最少的輸出。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-142">Displays no output if the command runs successfully, and displays minimal output if the command fails.</span></span>|  
|<span data-ttu-id="b4ce1-143">**/v**</span><span class="sxs-lookup"><span data-stu-id="b4ce1-143">**/v**</span></span>|<span data-ttu-id="b4ce1-144">不論命令執行成功或失敗，都顯示詳細資訊輸出，並顯示警告訊息。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-144">Displays verbose output regardless of whether the command runs successfully or fails, and displays warning messages.</span></span>|  
|<span data-ttu-id="b4ce1-145">**/debug**</span><span class="sxs-lookup"><span data-stu-id="b4ce1-145">**/debug**</span></span>|<span data-ttu-id="b4ce1-146">顯示偵錯資訊。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-146">Displays debugging information.</span></span>|  
  
<a name="catdb"></a>

## <a name="catdb-command-options"></a><span data-ttu-id="b4ce1-147">catdb 命令選項</span><span class="sxs-lookup"><span data-stu-id="b4ce1-147">catdb Command Options</span></span>  

 <span data-ttu-id="b4ce1-148">下表列出可以搭配 `catdb` 命令使用的選項。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-148">The following table lists the options that can be used with the `catdb` command.</span></span>  
  
|<span data-ttu-id="b4ce1-149">Catdb 選項</span><span class="sxs-lookup"><span data-stu-id="b4ce1-149">Catdb option</span></span>|<span data-ttu-id="b4ce1-150">描述</span><span class="sxs-lookup"><span data-stu-id="b4ce1-150">Description</span></span>|  
|------------------|-----------------|  
|`/d`|<span data-ttu-id="b4ce1-151">指示預設目錄資料庫已經更新。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-151">Specifies that the default catalog database is updated.</span></span> <span data-ttu-id="b4ce1-152">如果未使用 `/d` 和 `/g` 選項，簽署工具就會更新系統元件和驅動程式資料庫。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-152">If neither the `/d` nor the `/g` option is used, Sign Tool updates the system component and driver database.</span></span>|  
|<span data-ttu-id="b4ce1-153">`/g`*GUID*</span><span class="sxs-lookup"><span data-stu-id="b4ce1-153">`/g` *GUID*</span></span>|<span data-ttu-id="b4ce1-154">指定由全域唯一識別項 *GUID* 所識別的目錄資料庫已更新。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-154">Specifies that the catalog database identified by the globally unique identifier *GUID* is updated.</span></span>|  
|`/r`|<span data-ttu-id="b4ce1-155">從目錄資料庫移除指定的目錄。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-155">Removes the specified catalogs from the catalog database.</span></span> <span data-ttu-id="b4ce1-156">如果沒有指定這個選項，簽署工具就會在目錄資料庫中加入指定的目錄。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-156">If this option is not specified, Sign Tool adds the specified catalogs to the catalog database.</span></span>|  
|`/u`|<span data-ttu-id="b4ce1-157">指定為加入的目錄檔自動產生一個唯一的名稱。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-157">Specifies that a unique name is automatically generated for the added catalog files.</span></span> <span data-ttu-id="b4ce1-158">必要時，目錄檔會重新命名，以避免與現有的目錄檔發生名稱衝突。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-158">If necessary, the catalog files are renamed to prevent name conflicts with existing catalog files.</span></span> <span data-ttu-id="b4ce1-159">如果沒有指定這個選項，簽署工具會覆寫具有與所要加入之目錄相同名稱的所有現有目錄。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-159">If this option is not specified, Sign Tool overwrites any existing catalog that has the same name as the catalog being added.</span></span>|  
  
<a name="sign"></a>

## <a name="sign-command-options"></a><span data-ttu-id="b4ce1-160">Sign 命令選項</span><span class="sxs-lookup"><span data-stu-id="b4ce1-160">sign Command Options</span></span>  

 <span data-ttu-id="b4ce1-161">下表列出可以搭配 `sign` 命令使用的選項。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-161">The following table lists the options that can be used with the `sign` command.</span></span>  
  
|<span data-ttu-id="b4ce1-162">Sign 命令選項</span><span class="sxs-lookup"><span data-stu-id="b4ce1-162">Sign command option</span></span>|<span data-ttu-id="b4ce1-163">描述</span><span class="sxs-lookup"><span data-stu-id="b4ce1-163">Description</span></span>|  
|-------------------------|-----------------|  
|`/a`|<span data-ttu-id="b4ce1-164">自動選取最佳的簽署憑證。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-164">Automatically selects the best signing certificate.</span></span> <span data-ttu-id="b4ce1-165">簽署工具會找到滿足所有指定條件的所有有效憑證，並且選取有效時間最長的一個。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-165">Sign Tool will find all valid certificates that satisfy all specified conditions and select the one that is valid for the longest time.</span></span> <span data-ttu-id="b4ce1-166">如果沒有這個選項，簽署工具只需要找出一個有效的簽署憑證。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-166">If this option is not present, Sign Tool expects to find only one valid signing certificate.</span></span>|  
|<span data-ttu-id="b4ce1-167">`/ac`  *檔*</span><span class="sxs-lookup"><span data-stu-id="b4ce1-167">`/ac`  *file*</span></span>|<span data-ttu-id="b4ce1-168">從 *file* 將其他憑證加入至簽章區塊。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-168">Adds an additional certificate from *file* to the signature block.</span></span>|  
|`/as`|<span data-ttu-id="b4ce1-169">附加這個簽章。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-169">Appends this signature.</span></span> <span data-ttu-id="b4ce1-170">如果主要簽章不存在，則會設定這個簽章做為主要簽章。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-170">If no primary signature is present, this signature is made the primary signature instead.</span></span>|  
|<span data-ttu-id="b4ce1-171">`/c`  *CertTemplateName*</span><span class="sxs-lookup"><span data-stu-id="b4ce1-171">`/c`  *CertTemplateName*</span></span>|<span data-ttu-id="b4ce1-172">指定適用於簽署憑證的「憑證範本名稱」(Certificate Template Name)，這是一個 Microsoft 擴充功能。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-172">Specifies the Certificate Template Name (a Microsoft extension) for the signing certificate.</span></span>|  
|<span data-ttu-id="b4ce1-173">`/csp`  *CSPName*</span><span class="sxs-lookup"><span data-stu-id="b4ce1-173">`/csp`  *CSPName*</span></span>|<span data-ttu-id="b4ce1-174">指定包含私密金鑰容器的密碼編譯服務提供者 (Cryptographic Service Provider，CSP)。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-174">Specifies the cryptographic service provider (CSP) that contains the private key container.</span></span>|  
|<span data-ttu-id="b4ce1-175">`/d`  *Desc*</span><span class="sxs-lookup"><span data-stu-id="b4ce1-175">`/d`  *Desc*</span></span>|<span data-ttu-id="b4ce1-176">指定簽署內容的描述。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-176">Specifies a description of the signed content.</span></span>|  
|<span data-ttu-id="b4ce1-177">`/du`  *URL*</span><span class="sxs-lookup"><span data-stu-id="b4ce1-177">`/du`  *URL*</span></span>|<span data-ttu-id="b4ce1-178">為已簽署的內容之擴充描述指定統一資源定位器 (Uniform Resource Locator，URL)。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-178">Specifies a Uniform Resource Locator (URL) for the expanded description of the signed content.</span></span>|  
|<span data-ttu-id="b4ce1-179">`/f`  *SignCertFile*</span><span class="sxs-lookup"><span data-stu-id="b4ce1-179">`/f`  *SignCertFile*</span></span>|<span data-ttu-id="b4ce1-180">指定檔案中的簽署憑證。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-180">Specifies the signing certificate in a file.</span></span> <span data-ttu-id="b4ce1-181">如果檔案為「個人資訊交換」(PFX) 格式並且受密碼保護，請使用 `/p` 選項指定密碼。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-181">If the file is in Personal Information Exchange (PFX) format and protected by a password, use the `/p` option to specify the password.</span></span> <span data-ttu-id="b4ce1-182">如果檔案不包含私密金鑰，請使用 `/csp` 和 `/kc` 選項，以指定 CSP 和私密金鑰容器的名稱。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-182">If the file does not contain private keys, use the `/csp` and `/kc` options to specify the CSP and private key container name.</span></span>|  
|`/fd`|<span data-ttu-id="b4ce1-183">指定要用於建立檔案簽章的檔案摘要演算法。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-183">Specifies the file digest algorithm to use for creating file signatures.</span></span> </br> <span data-ttu-id="b4ce1-184">**注意：** 如果在 `/fd` 簽署時未提供參數，則會產生警告。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-184">**Note:** A warning is generated if the`/fd` switch is not provided while signing.</span></span> <span data-ttu-id="b4ce1-185">預設演算法為 SHA1，但建議使用 SHA256。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-185">The default algorithm is SHA1 but SHA256 is recommended.</span></span>|
|<span data-ttu-id="b4ce1-186">`/fd`  *certHash*</span><span class="sxs-lookup"><span data-stu-id="b4ce1-186">`/fd`  *certHash*</span></span>|<span data-ttu-id="b4ce1-187">指定字串 *certHash* 會預設為用於簽署憑證的演算法。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-187">Specifying the string *certHash* will default to the algorithm used on the signing certificate.</span></span> </br> <span data-ttu-id="b4ce1-188">**注意：** 僅適用于 Windows 10 套件組建20236和更新版本。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-188">**Note:** Only available in Windows 10 kit builds 20236 and later.</span></span>|  
|<span data-ttu-id="b4ce1-189">`/i`  *IssuerName*</span><span class="sxs-lookup"><span data-stu-id="b4ce1-189">`/i`  *IssuerName*</span></span>|<span data-ttu-id="b4ce1-190">指定簽署憑證的簽發者名稱。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-190">Specifies the name of the issuer of the signing certificate.</span></span> <span data-ttu-id="b4ce1-191">這個值可以是完整簽發者名稱的子字串。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-191">This value can be a substring of the entire issuer name.</span></span>|  
|<span data-ttu-id="b4ce1-192">`/kc`  *PrivKeyContainerName*</span><span class="sxs-lookup"><span data-stu-id="b4ce1-192">`/kc`  *PrivKeyContainerName*</span></span>|<span data-ttu-id="b4ce1-193">指定私密金鑰容器名稱。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-193">Specifies the private key container name.</span></span>|  
|<span data-ttu-id="b4ce1-194">`/n`  *SubjectName*</span><span class="sxs-lookup"><span data-stu-id="b4ce1-194">`/n`  *SubjectName*</span></span>|<span data-ttu-id="b4ce1-195">指定簽署憑證的主體名稱。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-195">Specifies the name of the subject of the signing certificate.</span></span> <span data-ttu-id="b4ce1-196">這個值可以是完整主體名稱的子字串。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-196">This value can be a substring of the entire subject name.</span></span>|  
|`/nph`|<span data-ttu-id="b4ce1-197">如果支援，則隱藏可執行檔的頁面雜湊。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-197">If supported, suppresses page hashes for executable files.</span></span> <span data-ttu-id="b4ce1-198">預設取決於 SIGNTOOL_PAGE_HASHES 環境變數和 wintrust.dll 版本。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-198">The default is determined by the SIGNTOOL_PAGE_HASHES environment variable and by the wintrust.dll version.</span></span> <span data-ttu-id="b4ce1-199">若為非 PE 檔案，則會忽略這個選項。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-199">This option is ignored for non-PE files.</span></span>|  
|<span data-ttu-id="b4ce1-200">`/p`  *密碼*</span><span class="sxs-lookup"><span data-stu-id="b4ce1-200">`/p`  *Password*</span></span>|<span data-ttu-id="b4ce1-201">指定用來開啟 PFX 檔案的密碼 </span><span class="sxs-lookup"><span data-stu-id="b4ce1-201">Specifies the password to use when opening a PFX file.</span></span> <span data-ttu-id="b4ce1-202">(使用 `/f` 選項指定 PFX 檔)。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-202">(Use the `/f` option to specify a PFX file.)</span></span>|  
|<span data-ttu-id="b4ce1-203">`/p7` *路徑*</span><span class="sxs-lookup"><span data-stu-id="b4ce1-203">`/p7` *Path*</span></span>|<span data-ttu-id="b4ce1-204">指定為每個指定內容檔產生公開金鑰加密標準 (PKCS) #7 檔案。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-204">Specifies that a Public Key Cryptography Standards (PKCS) #7 file is produced for each specified content file.</span></span> <span data-ttu-id="b4ce1-205">PKCS #7 的檔案會 *命名為* \\ \*\* p7。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-205">PKCS #7 files are named *path*\\*filename*.p7.</span></span>|  
|<span data-ttu-id="b4ce1-206">`/p7ce` *值*</span><span class="sxs-lookup"><span data-stu-id="b4ce1-206">`/p7ce` *Value*</span></span>|<span data-ttu-id="b4ce1-207">指定已簽署的 PKCS #7 內容的選項。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-207">Specifies options for the signed PKCS #7 content.</span></span> <span data-ttu-id="b4ce1-208">將 *Value* 設定為 "Embedded" 會將簽署內容內嵌在 PKCS #7 檔案中，設定為 "DetachedSignedData" 會產生已中斷連結的 PKCS #7 檔案的簽署資料部分。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-208">Set *Value* to "Embedded" to embed the signed content in the PKCS #7 file, or to "DetachedSignedData" to produce the signed data portion of a detached PKCS #7 file.</span></span> <span data-ttu-id="b4ce1-209">如果未使用 `/p7ce` 選項，則預設會內嵌簽署的內容。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-209">If the `/p7ce` option is not used, the signed content is embedded by default.</span></span>|  
|<span data-ttu-id="b4ce1-210">`/p7co` *\<OID>*</span><span class="sxs-lookup"><span data-stu-id="b4ce1-210">`/p7co` *\<OID>*</span></span>|<span data-ttu-id="b4ce1-211">指定識別已簽署 PKCS #7 內容的物件識別項 (OID)。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-211">Specifies the object identifier (OID) that identifies the signed PKCS #7 content.</span></span>|  
|`/ph`|<span data-ttu-id="b4ce1-212">如果支援，則產生可執行檔的頁面雜湊。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-212">If supported, generates page hashes for executable files.</span></span>|  
|<span data-ttu-id="b4ce1-213">`/r`  *RootSubjectName*</span><span class="sxs-lookup"><span data-stu-id="b4ce1-213">`/r`  *RootSubjectName*</span></span>|<span data-ttu-id="b4ce1-214">指定簽署憑證必須鏈結之根憑證的主體名稱。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-214">Specifies the name of the subject of the root certificate that the signing certificate must chain to.</span></span> <span data-ttu-id="b4ce1-215">這個值可以是完整根憑證主體名稱的子字串。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-215">This value may be a substring of the entire subject name of the root certificate.</span></span>|  
|<span data-ttu-id="b4ce1-216">`/s`  *StoreName*</span><span class="sxs-lookup"><span data-stu-id="b4ce1-216">`/s`  *StoreName*</span></span>|<span data-ttu-id="b4ce1-217">指定搜尋憑證時要開啟的存放區。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-217">Specifies the store to open when searching for the certificate.</span></span> <span data-ttu-id="b4ce1-218">如果沒有指定這個選項，則會開啟 `My` 存放區。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-218">If this option is not specified, the `My` store is opened.</span></span>|  
|<span data-ttu-id="b4ce1-219">`/sha1`  *散 列*</span><span class="sxs-lookup"><span data-stu-id="b4ce1-219">`/sha1`  *Hash*</span></span>|<span data-ttu-id="b4ce1-220">指定簽署憑證的 SHA1 雜湊。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-220">Specifies the SHA1 hash of the signing certificate.</span></span> <span data-ttu-id="b4ce1-221">在多重憑證符合其餘參數指定的準則時，SHA1 雜湊最常被指定。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-221">The SHA1 hash is commonly specified when multiple certificates satisfy the criteria specified by the remaining switches.</span></span>|  
|`/sm`|<span data-ttu-id="b4ce1-222">指定使用電腦存放區，而非使用者存放區。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-222">Specifies that a machine store, instead of a user store, is used.</span></span>|  
|<span data-ttu-id="b4ce1-223">`/t`  *URL*</span><span class="sxs-lookup"><span data-stu-id="b4ce1-223">`/t`  *URL*</span></span>|<span data-ttu-id="b4ce1-224">指定時間戳記伺服器的 URL。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-224">Specifies the URL of the time stamp server.</span></span> <span data-ttu-id="b4ce1-225">如果沒有這個選項 (或 `/tr`)，簽署的檔案就不會加上時間戳記。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-225">If this option (or `/tr`) is not present, the signed file will not be time stamped.</span></span> <span data-ttu-id="b4ce1-226">如果加上時間戳記失敗，便會產生警告。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-226">A warning is generated if time stamping fails.</span></span> <span data-ttu-id="b4ce1-227">這個選項無法與 `/tr` 選項搭配使用。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-227">This option cannot be used with the `/tr` option.</span></span>|  
|<span data-ttu-id="b4ce1-228">`/td`  *alg*</span><span class="sxs-lookup"><span data-stu-id="b4ce1-228">`/td`  *alg*</span></span>|<span data-ttu-id="b4ce1-229">與 `/tr` 選項一起使用以要求 RFC 3161 時間戳記伺服器使用的摘要演算法。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-229">Used with the `/tr` option to request a digest algorithm used by the RFC 3161 time stamp server.</span></span> </br> <span data-ttu-id="b4ce1-230">**注意：** 如果在時間 `/td` 戳時未提供參數，則會產生警告。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-230">**Note:** A warning is generated if the `/td` switch is not provided while timestamping.</span></span> <span data-ttu-id="b4ce1-231">預設演算法是 SHA1，但建議使用 SHA256。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-231">The default algorithm is SHA1, but SHA256 is recommended.</span></span> <br/> <span data-ttu-id="b4ce1-232">`/td`參數必須在切換之後宣告 `/tr` ，而不是在之前。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-232">The `/td` switch must be declared after the `/tr` switch, not before.</span></span> <span data-ttu-id="b4ce1-233">如果在 `/td` 參數之前宣告參數 `/tr` ，則傳回的時間戳記是來自 SHA1 演算法，而不是預期的 SHA256 演算法。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-233">If the `/td` switch is declared before the `/tr` switch, the timestamp that is returned is from the SHA1 algorithm instead of the intended SHA256 algorithm.</span></span> |
|<span data-ttu-id="b4ce1-234">`/tr`  *URL*</span><span class="sxs-lookup"><span data-stu-id="b4ce1-234">`/tr`  *URL*</span></span>|<span data-ttu-id="b4ce1-235">指定 RFC 3161 時間戳記伺服器的 URL。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-235">Specifies the URL of the RFC 3161 time stamp server.</span></span> <span data-ttu-id="b4ce1-236">如果沒有這個選項 (或 `/t`)，簽署的檔案就不會加上時間戳記。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-236">If this option (or `/t`) is not present, the signed file will not be time stamped.</span></span> <span data-ttu-id="b4ce1-237">如果加上時間戳記失敗，便會產生警告。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-237">A warning is generated if time stamping fails.</span></span> <span data-ttu-id="b4ce1-238">這個選項無法與 `/t` 選項搭配使用。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-238">This option cannot be used with the `/t` option.</span></span>|
|<span data-ttu-id="b4ce1-239">`/u`  *使用方式*</span><span class="sxs-lookup"><span data-stu-id="b4ce1-239">`/u`  *Usage*</span></span>|<span data-ttu-id="b4ce1-240">指定在簽署憑證時必須存在的增強金鑰使用方法 (Enhanced Key Usage，EKU)。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-240">Specifies the enhanced key usage (EKU) that must be present in the signing certificate.</span></span> <span data-ttu-id="b4ce1-241">使用方法的值可以利用 OID 或字串指定。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-241">The usage value can be specified by OID or string.</span></span> <span data-ttu-id="b4ce1-242">預設的使用方法為 "Code Signing" (1.3.6.1.5.5.7.3.3)。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-242">The default usage is "Code Signing" (1.3.6.1.5.5.7.3.3).</span></span>|  
|`/uw`|<span data-ttu-id="b4ce1-243">指定「Windows 系統元件驗證」(1.3.6.1.4.1.311.10.3.6) 的使用方式。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-243">Specifies usage of "Windows System Component Verification" (1.3.6.1.4.1.311.10.3.6).</span></span>|  
  
 <span data-ttu-id="b4ce1-244">如需使用方式範例，請參閱[使用 SignTool 簽署檔案](/windows/desktop/SecCrypto/using-signtool-to-sign-a-file)。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-244">For usage examples, see [Using SignTool to Sign a File](/windows/desktop/SecCrypto/using-signtool-to-sign-a-file).</span></span>  
  
<a name="TimeStamp"></a>

## <a name="timestamp-command-options"></a><span data-ttu-id="b4ce1-245">TimeStamp 命令選項</span><span class="sxs-lookup"><span data-stu-id="b4ce1-245">TimeStamp Command Options</span></span>  

 <span data-ttu-id="b4ce1-246">下表列出可以搭配 `TimeStamp` 命令使用的選項。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-246">The following table lists the options that can be used with the `TimeStamp` command.</span></span>  
  
|<span data-ttu-id="b4ce1-247">TimeStamp 選項</span><span class="sxs-lookup"><span data-stu-id="b4ce1-247">TimeStamp option</span></span>|<span data-ttu-id="b4ce1-248">描述</span><span class="sxs-lookup"><span data-stu-id="b4ce1-248">Description</span></span>|  
|----------------------|-----------------|  
|`/p7`|<span data-ttu-id="b4ce1-249">為 PKCS #7 檔案加上時間戳記。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-249">Time stamps PKCS #7 files.</span></span>|  
|<span data-ttu-id="b4ce1-250">`/t`  *URL*</span><span class="sxs-lookup"><span data-stu-id="b4ce1-250">`/t`  *URL*</span></span>|<span data-ttu-id="b4ce1-251">指定時間戳記伺服器的 URL。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-251">Specifies the URL of the time stamp server.</span></span> <span data-ttu-id="b4ce1-252">要加上時間戳記的檔案必須先經過簽署。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-252">The file being time stamped must have previously been signed.</span></span> <span data-ttu-id="b4ce1-253">必須有 `/t` 或 `/tr` 任一選項。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-253">Either the `/t` or the `/tr` option is required.</span></span>|  
|<span data-ttu-id="b4ce1-254">`/td`  *alg*</span><span class="sxs-lookup"><span data-stu-id="b4ce1-254">`/td`  *alg*</span></span>|<span data-ttu-id="b4ce1-255">與 `/tr` 選項一起使用以要求 RFC 3161 時間戳記伺服器使用的摘要演算法。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-255">Used with the `/tr` option to request a digest algorithm used by the RFC 3161 time stamp server.</span></span> </br> <span data-ttu-id="b4ce1-256">**注意：** 如果在時間 `/td` 戳時未提供參數，則會產生警告。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-256">**Note:** A warning is generated if the `/td` switch is not provided while timestamping.</span></span> <span data-ttu-id="b4ce1-257">預設演算法是 SHA1，但建議使用 SHA256。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-257">The default algorithm is SHA1, but SHA256 is recommended.</span></span> <br/> <span data-ttu-id="b4ce1-258">`/td`參數必須在切換之後宣告 `/tr` ，而不是在之前。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-258">The `/td` switch must be declared after the `/tr` switch, not before.</span></span> <span data-ttu-id="b4ce1-259">如果在 `/td` 參數之前宣告參數 `/tr` ，則傳回的時間戳記是來自 SHA1 演算法，而不是預期的 SHA256 演算法。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-259">If the `/td` switch is declared before the `/tr` switch, the timestamp that is returned is from the SHA1 algorithm instead of the intended SHA256 algorithm.</span></span> |
|<span data-ttu-id="b4ce1-260">`/tp`*索引*</span><span class="sxs-lookup"><span data-stu-id="b4ce1-260">`/tp` *index*</span></span>|<span data-ttu-id="b4ce1-261">在 *index* 的簽章加上時間戳記。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-261">Time stamps the signature at *index*.</span></span>|  
|<span data-ttu-id="b4ce1-262">`/tr`  *URL*</span><span class="sxs-lookup"><span data-stu-id="b4ce1-262">`/tr`  *URL*</span></span>|<span data-ttu-id="b4ce1-263">指定 RFC 3161 時間戳記伺服器的 URL。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-263">Specifies the URL of the RFC 3161 time stamp server.</span></span> <span data-ttu-id="b4ce1-264">要加上時間戳記的檔案必須先經過簽署。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-264">The file being time stamped must have previously been signed.</span></span> <span data-ttu-id="b4ce1-265">必須有 `/tr` 或 `/t` 任一選項。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-265">Either the `/tr` or the `/t` option is required.</span></span>|  
  
 <span data-ttu-id="b4ce1-266">如需使用範例，請參閱[新增時間戳記至先前已簽署的檔案](/windows/desktop/SecCrypto/adding-time-stamps-to-previously-signed-files)。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-266">For a usage example, see [Adding Time Stamps to Previously Signed Files](/windows/desktop/SecCrypto/adding-time-stamps-to-previously-signed-files).</span></span>  
  
<a name="Verify"></a>

## <a name="verify-command-options"></a><span data-ttu-id="b4ce1-267">驗證命令選項</span><span class="sxs-lookup"><span data-stu-id="b4ce1-267">Verify Command Options</span></span>  
  
|<span data-ttu-id="b4ce1-268">Verify 選項</span><span class="sxs-lookup"><span data-stu-id="b4ce1-268">Verify option</span></span>|<span data-ttu-id="b4ce1-269">描述</span><span class="sxs-lookup"><span data-stu-id="b4ce1-269">Description</span></span>|  
|-------------------|-----------------|  
|`/a`|<span data-ttu-id="b4ce1-270">指定所有方法都可以用來驗證檔案。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-270">Specifies that all methods can be used to verify the file.</span></span> <span data-ttu-id="b4ce1-271">首先會搜尋目錄資料庫，判斷檔案是否已在目錄中簽署。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-271">First, the catalog databases are searched to determine whether the file is signed in a catalog.</span></span> <span data-ttu-id="b4ce1-272">如果檔案未在任何目錄中簽署，簽署工具便會嘗試驗證檔案的內嵌簽署。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-272">If the file is not signed in any catalog, Sign Tool attempts to verify the file's embedded signature.</span></span> <span data-ttu-id="b4ce1-273">驗證不一定已在目錄中簽署的檔案時，建議您採用這個選項。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-273">This option is recommended when verifying files that may or may not be signed in a catalog.</span></span> <span data-ttu-id="b4ce1-274">這些檔案的範例包括 Windows 檔案或驅動程式。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-274">Examples of these files include Windows files or drivers.</span></span>|  
|`/ad`|<span data-ttu-id="b4ce1-275">使用預設目錄資料庫尋找目錄。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-275">Finds the catalog by using the default catalog database.</span></span>|  
|<span data-ttu-id="b4ce1-276">`/ag` *CatDBGUID*</span><span class="sxs-lookup"><span data-stu-id="b4ce1-276">`/ag` *CatDBGUID*</span></span>|<span data-ttu-id="b4ce1-277">在 *CatDBGUID* 所識別的目錄資料庫中尋找目錄。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-277">Finds the catalog in the catalog database that is identified by the *CatDBGUID*.</span></span>|  
|`/all`|<span data-ttu-id="b4ce1-278">確認在包含多個簽章的檔案中的所有簽章。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-278">Verifies all signatures in a file that includes multiple signatures.</span></span>|  
|`/as`|<span data-ttu-id="b4ce1-279">使用系統元件 (驅動程式) 目錄資料庫尋找目錄。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-279">Finds the catalog by using the system component (driver) catalog database.</span></span>|  
|<span data-ttu-id="b4ce1-280">`/c` *CatFile*</span><span class="sxs-lookup"><span data-stu-id="b4ce1-280">`/c` *CatFile*</span></span>|<span data-ttu-id="b4ce1-281">依名稱指定目錄檔。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-281">Specifies the catalog file by name.</span></span>|  
|`/d`|<span data-ttu-id="b4ce1-282">指定簽署工具應列印描述及描述 URL。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-282">Specifies that Sign Tool should print the description and the description URL.</span></span>|  
|<span data-ttu-id="b4ce1-283">`/ds`  *索引*</span><span class="sxs-lookup"><span data-stu-id="b4ce1-283">`/ds`  *Index*</span></span>|<span data-ttu-id="b4ce1-284">驗證位於指定位置的簽章。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-284">Verifies the signature at a specified position.</span></span>|  
|<span data-ttu-id="b4ce1-285">`/hash` (`SHA1`&#124;`SHA256`)</span><span class="sxs-lookup"><span data-stu-id="b4ce1-285">`/hash` (`SHA1`&#124;`SHA256`)</span></span>|<span data-ttu-id="b4ce1-286">指定在目錄中搜尋檔案時，要使用的選擇性雜湊演算法。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-286">Specifies an optional hash algorithm to use when searching for a file in a catalog.</span></span>|  
|`/kp`|<span data-ttu-id="b4ce1-287">指定應以核心模式驅動程式簽署原則執行驗證。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-287">Specifies that verification should be performed with the kernel-mode driver signing policy.</span></span>|  
|`/ms`|<span data-ttu-id="b4ce1-288">使用多個驗證語意。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-288">Uses multiple verification semantics.</span></span> <span data-ttu-id="b4ce1-289">這是 Windows 8 和更新版本上 [WinVerifyTrust](/windows/desktop/api/wintrust/nf-wintrust-winverifytrust) 呼叫的預設行為。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-289">This is the default behavior of a [WinVerifyTrust](/windows/desktop/api/wintrust/nf-wintrust-winverifytrust) call on Windows 8 and above.</span></span>|  
|<span data-ttu-id="b4ce1-290">`/o` *版本*</span><span class="sxs-lookup"><span data-stu-id="b4ce1-290">`/o` *Version*</span></span>|<span data-ttu-id="b4ce1-291">根據作業系統版本驗證檔案。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-291">Verifies the file by operating system version.</span></span> <span data-ttu-id="b4ce1-292">*Version* 的格式如下：*PlatformID*:*VerMajor*.*VerMinor*.*BuildNumber*。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-292">*Version* has the following form: *PlatformID*:*VerMajor*.*VerMinor*.*BuildNumber*.</span></span> <span data-ttu-id="b4ce1-293">*PlatformID* 代表 <xref:System.PlatformID> 列舉成員的基礎值。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-293">*PlatformID* represents the underlying value of a <xref:System.PlatformID> enumeration member.</span></span> <span data-ttu-id="b4ce1-294">**重要事項：** 建議使用 `/o` 參數。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-294">**Important:**  The use of the `/o` switch is recommended.</span></span> <span data-ttu-id="b4ce1-295">如果未指定 `/o`，SignTool.exe 可能會傳回未預期的結果。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-295">If `/o` is not specified, SignTool.exe may return unexpected results.</span></span> <span data-ttu-id="b4ce1-296">例如，如果您未包含 `/o` 參數，在舊版作業系統上正確驗證的系統目錄，可能無法在較新版作業系統正確驗證。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-296">For example, if you do not include the `/o` switch, system catalogs that validate correctly on an older operating system may not validate correctly on a newer operating system.</span></span>|  
|`/p7`|<span data-ttu-id="b4ce1-297">驗證 PKCS #7 檔案。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-297">Verifies PKCS #7 files.</span></span> <span data-ttu-id="b4ce1-298">PKCS #7 驗證沒有使用任何現有的原則。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-298">No existing policies are used for PKCS #7 validation.</span></span> <span data-ttu-id="b4ce1-299">檢查簽章，並建置簽署憑證鏈結。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-299">The signature is checked and a chain is built for the signing certificate.</span></span>|  
|`/pa`|<span data-ttu-id="b4ce1-300">指定使用預設 Authenticode 驗證原則。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-300">Specifies that the Default Authenticode Verification Policy should be used.</span></span> <span data-ttu-id="b4ce1-301">如果未指定 `/pa` 選項，簽署工具便會使用「Windows 驅動程式驗證原則」(Windows Driver Verification Policy)。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-301">If the `/pa` option is not specified, Sign Tool uses the Windows Driver Verification Policy.</span></span> <span data-ttu-id="b4ce1-302">這個選項無法與 `catdb` 選項搭配使用。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-302">This option cannot be used with the `catdb` options.</span></span>|  
|<span data-ttu-id="b4ce1-303">`/pg` *PolicyGUID*</span><span class="sxs-lookup"><span data-stu-id="b4ce1-303">`/pg` *PolicyGUID*</span></span>|<span data-ttu-id="b4ce1-304">依 GUID 指定驗證原則。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-304">Specifies a verification policy by GUID.</span></span> <span data-ttu-id="b4ce1-305">*PolicyGUID* 會對應至驗證原則的 ActionID。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-305">The *PolicyGUID* corresponds to the ActionID of the verification policy.</span></span> <span data-ttu-id="b4ce1-306">這個選項無法與 `catdb` 選項搭配使用。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-306">This option cannot be used with the `catdb` options.</span></span>|  
|`/ph`|<span data-ttu-id="b4ce1-307">指定簽署工具應列印及驗證頁面雜湊值。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-307">Specifies that Sign Tool should print and verify page hash values.</span></span>|  
|<span data-ttu-id="b4ce1-308">`/r` *RootSubjectName*</span><span class="sxs-lookup"><span data-stu-id="b4ce1-308">`/r` *RootSubjectName*</span></span>|<span data-ttu-id="b4ce1-309">指定簽署憑證必須鏈結之根憑證的主體名稱。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-309">Specifies the name of the subject of the root certificate that the signing certificate must chain to.</span></span> <span data-ttu-id="b4ce1-310">這個值可以是完整根憑證主體名稱的子字串。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-310">This value can be a substring of the entire subject name of the root certificate.</span></span>|  
|`/tw`|<span data-ttu-id="b4ce1-311">指定如果簽章未加上時間戳記，則應產生警告。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-311">Specifies that a warning should be generated if the signature is not time stamped.</span></span>|  
  
 <span data-ttu-id="b4ce1-312">如需使用方式範例，請參閱[使用 SignTool 驗證檔案簽章](/windows/desktop/SecCrypto/using-signtool-to-verify-a-file-signature)。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-312">For usage examples, see [Using SignTool to Verify a File Signature](/windows/desktop/SecCrypto/using-signtool-to-verify-a-file-signature).</span></span>  
  
## <a name="return-value"></a><span data-ttu-id="b4ce1-313">傳回值</span><span class="sxs-lookup"><span data-stu-id="b4ce1-313">Return Value</span></span>  

 <span data-ttu-id="b4ce1-314">簽署工具終止時會傳回下列其中一個結束代碼。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-314">Sign Tool returns one of the following exit codes when it terminates.</span></span>  
  
|<span data-ttu-id="b4ce1-315">結束碼</span><span class="sxs-lookup"><span data-stu-id="b4ce1-315">Exit code</span></span>|<span data-ttu-id="b4ce1-316">描述</span><span class="sxs-lookup"><span data-stu-id="b4ce1-316">Description</span></span>|  
|---------------|-----------------|  
|<span data-ttu-id="b4ce1-317">0</span><span class="sxs-lookup"><span data-stu-id="b4ce1-317">0</span></span>|<span data-ttu-id="b4ce1-318">執行成功。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-318">Execution was successful.</span></span>|  
|<span data-ttu-id="b4ce1-319">1</span><span class="sxs-lookup"><span data-stu-id="b4ce1-319">1</span></span>|<span data-ttu-id="b4ce1-320">執行失敗。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-320">Execution has failed.</span></span>|  
|<span data-ttu-id="b4ce1-321">2</span><span class="sxs-lookup"><span data-stu-id="b4ce1-321">2</span></span>|<span data-ttu-id="b4ce1-322">執行已完成，但出現警告。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-322">Execution has completed with warnings.</span></span>|  

## <a name="examples"></a><span data-ttu-id="b4ce1-323">範例</span><span class="sxs-lookup"><span data-stu-id="b4ce1-323">Examples</span></span>  

 <span data-ttu-id="b4ce1-324">下列命令會將目錄檔 MyCatalogFileName.cat 加入至系統元件和驅動程式資料庫。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-324">The following command adds the catalog file MyCatalogFileName.cat to the system component and driver database.</span></span> <span data-ttu-id="b4ce1-325">如有必要防止取代名為 `/u` 的現有目錄檔案，`MyCatalogFileName.cat` 選項會產生一個唯一的名稱。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-325">The `/u` option generates a unique name if necessary to prevent replacing an existing catalog file named `MyCatalogFileName.cat`.</span></span>  
  
```console  
signtool catdb /v /u MyCatalogFileName.cat  
```  
  
 <span data-ttu-id="b4ce1-326">下列命令會使用最佳憑證自動簽署檔案。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-326">The following command signs a file automatically by using the best certificate.</span></span>  
  
```console
signtool sign /a /fd SHA256 MyFile.exe
```

 <span data-ttu-id="b4ce1-327">下列命令使用儲存在受密碼保護之 PFX 檔中的憑證存放區，對檔案進行數位簽署。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-327">The following command digitally signs a file by using a certificate stored in a password-protected PFX file.</span></span>  
  
```console  
signtool sign /f MyCert.pfx /p MyPassword /fd SHA256 MyFile.exe
```  
  
 <span data-ttu-id="b4ce1-328">下列命令會對檔案進行數位簽署和時間戳記。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-328">The following command digitally signs and time-stamps a file.</span></span> <span data-ttu-id="b4ce1-329">用於簽署檔案的憑證存放在 PFX 檔中。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-329">The certificate used to sign the file is stored in a PFX file.</span></span>  
  
```console  
signtool sign /f MyCert.pfx /t http://timestamp.digicert.com /fd SHA256 MyFile.exe
```  
  
 <span data-ttu-id="b4ce1-330">下列命令會使用位於主旨名稱為 `My` 之 `My Company Certificate` 存放區中的憑證來簽署檔案。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-330">The following command signs a file by using a certificate located in the `My` store that has a subject name of `My Company Certificate`.</span></span>  
  
```console  
signtool sign /n "My Company Certificate" /fd SHA256 MyFile.exe
```  
  
 <span data-ttu-id="b4ce1-331">下列命令會簽署 ActiveX 控制項，並在提示使用者安裝該控制項時，提供由 Internet Explorer 顯示的資訊。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-331">The following command signs an ActiveX control and provides information that is displayed by Internet Explorer when the user is prompted to install the control.</span></span>  
  
```console  
Signtool sign /f MyCert.pfx /d: "MyControl" /du http://www.example.com/MyControl/info.html /fd SHA256 MyControl.exe
```  
  
 <span data-ttu-id="b4ce1-332">下列命令會為已數位簽署的檔案加上時間戳記。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-332">The following command time-stamps a file that has already been digitally signed.</span></span>  
  
```console  
signtool timestamp /t http://timestamp.digicert.com MyFile.exe
```  

<span data-ttu-id="b4ce1-333">下列命令會將使用 RFC 3161 時間戳記伺服器的檔案加上戳記。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-333">The following command time-stamps a file using an RFC 3161 timestamp server.</span></span>  
  
```console  
signtool timestamp /tr http://timestamp.digicert.com /td SHA256 MyFile.exe
```  
  
 <span data-ttu-id="b4ce1-334">下列命令會確認檔案是否已簽署。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-334">The following command verifies that a file has been signed.</span></span>  
  
```console  
signtool verify MyFile.exe  
```  
  
 <span data-ttu-id="b4ce1-335">下列命令會驗證可能已在目錄中簽署的系統檔。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-335">The following command verifies a system file that may be signed in a catalog.</span></span>  
  
```console  
signtool verify /a SystemFile.dll  
```  
  
 <span data-ttu-id="b4ce1-336">下列命令會驗證已在名為 `MyCatalog.cat` 之目錄中簽署的系統檔。</span><span class="sxs-lookup"><span data-stu-id="b4ce1-336">The following command verifies a system file that is signed in a catalog named `MyCatalog.cat`.</span></span>  
  
```console  
signtool verify /c MyCatalog.cat SystemFile.dll  
```  
  
## <a name="see-also"></a><span data-ttu-id="b4ce1-337">另請參閱</span><span class="sxs-lookup"><span data-stu-id="b4ce1-337">See also</span></span>

- [<span data-ttu-id="b4ce1-338">工具</span><span class="sxs-lookup"><span data-stu-id="b4ce1-338">Tools</span></span>](index.md)
- [<span data-ttu-id="b4ce1-339">命令提示字元</span><span class="sxs-lookup"><span data-stu-id="b4ce1-339">Command Prompts</span></span>](developer-command-prompt-for-vs.md)

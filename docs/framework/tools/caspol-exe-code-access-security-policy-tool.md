---
title: Caspol.exe (程式碼存取安全性原則工具)
description: 請參閱 Caspol.exe， (CAS) 原則工具的代碼啟用安全性。 此工具可讓使用者和系統管理員修改不同原則層級的安全性原則。
ms.date: 03/30/2017
helpviewer_keywords:
- permission sets, modifying security policy
- security policy [.NET Framework], Code Access Security Policy tool
- enterprise security policy
- referencing code groups and permission sets
- user security policy
- Caspol.exe
- Code Access Security Policy tool
- code groups, modifying security policy
- application development [.NET Framework], security
- machine security policy
- security policy [.NET Framework], modifying
- manually editing security configuration files
ms.assetid: d2bf6123-7b0c-4e60-87ad-a39a1c3eb2e0
ms.openlocfilehash: 6567a4c738b3d6c8f14d1ab13ba005cb22bb7328
ms.sourcegitcommit: bc293b14af795e0e999e3304dd40c0222cf2ffe4
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 11/26/2020
ms.locfileid: "96247300"
---
# <a name="caspolexe-code-access-security-policy-tool"></a><span data-ttu-id="8e3ed-104">Caspol.exe (程式碼存取安全性原則工具)</span><span class="sxs-lookup"><span data-stu-id="8e3ed-104">Caspol.exe (Code Access Security Policy Tool)</span></span>

<span data-ttu-id="8e3ed-105">程式碼存取安全性 (CAS) 原則工具 (Caspol.exe) 可以讓使用者和系統管理員修改電腦原則層級、使用者原則層級和企業原則層級的安全性原則。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-105">The Code Access Security (CAS) Policy tool (Caspol.exe) enables users and administrators to modify security policy for the machine policy level, the user policy level, and the enterprise policy level.</span></span>  
  
> [!IMPORTANT]
> <span data-ttu-id="8e3ed-106">從 .NET Framework 4 開始，除非[ \<legacyCasPolicy> 元素](../configure-apps/file-schema/runtime/netfx40-legacysecuritypolicy-element.md)設定為，否則 Caspol.exe 不會影響 CAS 原則 `true` 。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-106">Starting with the .NET Framework 4, Caspol.exe does not affect CAS policy unless the [\<legacyCasPolicy> element](../configure-apps/file-schema/runtime/netfx40-legacysecuritypolicy-element.md) is set to `true`.</span></span> <span data-ttu-id="8e3ed-107">只有在您選擇使用 CAS 原則後，CasPol.exe 所顯示或修改的任何設定才會影響應用程式。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-107">Any settings shown or modified by CasPol.exe will only affect applications that opt into using CAS policy.</span></span> <span data-ttu-id="8e3ed-108">如需詳細資訊，請參閱[安全性變更](/previous-versions/dotnet/framework/security/security-changes)。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-108">For more information, see [Security Changes](/previous-versions/dotnet/framework/security/security-changes).</span></span>  
  
> [!NOTE]
> <span data-ttu-id="8e3ed-109">64 位元電腦包含 64 位元和 32 位元版本的安全性原則。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-109">64-bit computers include both 64-bit and 32-bit versions of security policy.</span></span> <span data-ttu-id="8e3ed-110">為了確保您的原則變更同時套用至 32 位元和 64 位元應用程式，請執行 Caspol.exe 的 32 位元和 64 位元這兩種版本。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-110">To ensure that your policy changes apply to both 32-bit and 64-bit applications, run both the 32-bit and 64-bit versions of Caspol.exe.</span></span>  
  
 <span data-ttu-id="8e3ed-111">程式碼存取安全性原則工具會自動隨 .NET Framework 和 Visual Studio 安裝。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-111">The Code Access Security Policy tool is automatically installed with the .NET Framework and with Visual Studio.</span></span> <span data-ttu-id="8e3ed-112">您可以在 32 位元系統上的 %windir%\Microsoft.NET\Framework\\*版本* 或 64 位元系統上的 %windir%\Microsoft.NET\Framework64\\*版本* 找到 Caspol.exe </span><span class="sxs-lookup"><span data-stu-id="8e3ed-112">You can find Caspol.exe in %windir%\Microsoft.NET\Framework\\*version* on 32-bit systems or %windir%\Microsoft.NET\Framework64\\*version* on 64-bit systems.</span></span> <span data-ttu-id="8e3ed-113"> (例如，在64位系統上，位置為 .NET Framework 4 的% windir% \Microsoft.NET\Framework64\v4.030319\caspol.exe ) 。如果您的電腦並存執行多個版本的 .NET Framework，則可能會安裝工具的多個版本。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-113">(For example, the location is %windir%\Microsoft.NET\Framework64\v4.030319\caspol.exe for the .NET Framework 4 on a 64-bit system.) Multiple versions of the tool might be installed if your computer is running multiple versions of the .NET Framework side by side.</span></span> <span data-ttu-id="8e3ed-114">您可以從安裝目錄執行此工具。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-114">You can run the tool from the installation directory.</span></span> <span data-ttu-id="8e3ed-115">不過，建議您使用[命令提示字元](developer-command-prompt-for-vs.md)，就不需要巡覽至安裝資料夾。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-115">However, we recommend that you use the [Command Prompts](developer-command-prompt-for-vs.md), which does not require you to navigate to the installation folder.</span></span>  
  
 <span data-ttu-id="8e3ed-116">在命令提示字元中，請輸入下列項目：</span><span class="sxs-lookup"><span data-stu-id="8e3ed-116">At the command prompt, type the following:</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="8e3ed-117">語法</span><span class="sxs-lookup"><span data-stu-id="8e3ed-117">Syntax</span></span>  
  
```console
caspol [options]  
```  
  
## <a name="parameters"></a><span data-ttu-id="8e3ed-118">參數</span><span class="sxs-lookup"><span data-stu-id="8e3ed-118">Parameters</span></span>  
  
|<span data-ttu-id="8e3ed-119">選項</span><span class="sxs-lookup"><span data-stu-id="8e3ed-119">Option</span></span>|<span data-ttu-id="8e3ed-120">描述</span><span class="sxs-lookup"><span data-stu-id="8e3ed-120">Description</span></span>|  
|------------|-----------------|  
|<span data-ttu-id="8e3ed-121">**-addfulltrust** *assembly_file*</span><span class="sxs-lookup"><span data-stu-id="8e3ed-121">**-addfulltrust** *assembly_file*</span></span><br /><br /> <span data-ttu-id="8e3ed-122">或</span><span class="sxs-lookup"><span data-stu-id="8e3ed-122">or</span></span><br /><br /> <span data-ttu-id="8e3ed-123">**-af** *assembly_file*</span><span class="sxs-lookup"><span data-stu-id="8e3ed-123">**-af** *assembly_file*</span></span>|<span data-ttu-id="8e3ed-124">將實作自訂安全物件 (例如，自訂授權或自訂成員資格條件) 的組件加入至特定原則層級的完全信任組件清單。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-124">Adds an assembly that implements a custom security object (such as a custom permission or a custom membership condition) to the full trust assembly list for a specific policy level.</span></span> <span data-ttu-id="8e3ed-125">*assembly_file* 引數會指定要新增的組件。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-125">The *assembly_file* argument specifies the assembly to add.</span></span> <span data-ttu-id="8e3ed-126">此檔案必須使用[強式名稱](../../standard/assembly/strong-named.md)簽署。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-126">This file must be signed with a [strong name](../../standard/assembly/strong-named.md).</span></span> <span data-ttu-id="8e3ed-127">您可以使用[強式名稱工具 (Sn.exe)](sn-exe-strong-name-tool.md)，以強式名稱來簽署組件。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-127">You can sign an assembly with a strong name using the [Strong Name Tool (Sn.exe)](sn-exe-strong-name-tool.md).</span></span><br /><br /> <span data-ttu-id="8e3ed-128">只要將包含自訂權限的權限集合加入至原則，就必須將實作自訂權限的組件加入至該原則層級的完全信任清單。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-128">Whenever a permission set containing a custom permission is added to policy, the assembly implementing the custom permission must be added to the full trust list for that policy level.</span></span> <span data-ttu-id="8e3ed-129">實作安全性原則 (例如，電腦原則) 中所使用之自訂安全性物件 (例如自訂程式碼群組或成員資格條件) 的組件，應一律加入至完全信任組件清單。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-129">Assemblies that implement custom security objects (such as custom code groups or membership conditions) used in a security policy (such as the machine policy) should always be added to the full trust assembly list.</span></span> <span data-ttu-id="8e3ed-130">**注意：** 如果實作自訂安全性物件的組件有參考其他組件，您就必須先將參考的組件新增至完全信任組件清單中。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-130">**Caution:**  If the assembly implementing the custom security object references other assemblies, you must first add the referenced assemblies to the full trust assembly list.</span></span> <span data-ttu-id="8e3ed-131">使用 Visual Basic、C++ 和 JScript 建立的自訂安全性物件會分別參考 Microsoft.VisualBasic.dll、Microsoft.VisualC.dll 或 Microsoft.JScript.dll。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-131">Custom security objects created using Visual Basic, C++, and JScript reference either Microsoft.VisualBasic.dll, Microsoft.VisualC.dll, or Microsoft.JScript.dll, respectively.</span></span> <span data-ttu-id="8e3ed-132">依預設，這些組件不在完全信任組件清單中。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-132">These assemblies are not in the full trust assembly list by default.</span></span> <span data-ttu-id="8e3ed-133">您必須在加入自訂安全性物件之前，先將適當的組件加入至完全信任清單中，</span><span class="sxs-lookup"><span data-stu-id="8e3ed-133">You must add the appropriate assembly to the full trust list before you add a custom security object.</span></span> <span data-ttu-id="8e3ed-134">否則將會破壞安全性系統，造成所有的組件都無法載入。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-134">Failure to do so will break the security system, causing all assemblies to fail to load.</span></span> <span data-ttu-id="8e3ed-135">在這種情況下，Caspol.exe **-all -reset** 選項將不會修復安全性。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-135">In this situation, the Caspol.exe **-all -reset** option will not repair security.</span></span> <span data-ttu-id="8e3ed-136">若要修復安全性，您必須手動編輯安全性檔案，以移除自訂安全性物件。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-136">To repair security, you must manually edit the security files to remove the custom security object.</span></span>|  
|<span data-ttu-id="8e3ed-137">**-addgroup** {*parent_label &#124; parent_name*} *mship pset_name* [*flags*]</span><span class="sxs-lookup"><span data-stu-id="8e3ed-137">**-addgroup** {*parent_label &#124; parent_name*} *mship pset_name* [*flags*]</span></span><br /><br /> <span data-ttu-id="8e3ed-138">或</span><span class="sxs-lookup"><span data-stu-id="8e3ed-138">or</span></span><br /><br /> <span data-ttu-id="8e3ed-139">**-ag** {*parent_label &#124; parent_name*} *mship pset_name* [*flags*]</span><span class="sxs-lookup"><span data-stu-id="8e3ed-139">**-ag** {*parent_label &#124; parent_name*} *mship pset_name* [*flags*]</span></span>|<span data-ttu-id="8e3ed-140">將新的程式碼群組加入至程式碼群組階層架構。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-140">Adds a new code group to the code group hierarchy.</span></span> <span data-ttu-id="8e3ed-141">您可以指定 *parent_label* 或 *parent_name*。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-141">You can specify either the *parent_label* or *parent_name*.</span></span> <span data-ttu-id="8e3ed-142">*parent_label* 引數會指定所新增程式碼群組之父代的程式碼群組標籤 (例如 1.</span><span class="sxs-lookup"><span data-stu-id="8e3ed-142">The *parent_label* argument specifies the label (such as 1.</span></span> <span data-ttu-id="8e3ed-143">或 1.1.)。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-143">or 1.1.) of the code group that is the parent of the code group being added.</span></span> <span data-ttu-id="8e3ed-144">*parent_name* 引數會指定要新增之程式碼群組父代的程式碼群組名稱。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-144">The *parent_name* argument specifies the name of the code group that is the parent of the code group being added.</span></span> <span data-ttu-id="8e3ed-145">由於 *parent_label* 和 *parent_name* 可以交替使用，所以 Caspol.exe 必須能夠區分這兩者。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-145">Because *parent_label* and *parent_name* can be used interchangeably, Caspol.exe must be able to distinguish between them.</span></span> <span data-ttu-id="8e3ed-146">因此，*parent_name* 不能以數字開頭。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-146">Therefore, *parent_name* cannot begin with a number.</span></span> <span data-ttu-id="8e3ed-147">此外，*parent_name* 只能包含 A-Z、0-9 以及底線字元。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-147">Additionally, *parent_name* can only contain A-Z, 0-9 and the underscore character.</span></span><br /><br /> <span data-ttu-id="8e3ed-148">*mship* 引數會指定新程式碼群組的成員資格條件。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-148">The *mship* argument specifies the membership condition for the new code group.</span></span> <span data-ttu-id="8e3ed-149">如需詳細資訊，請參閱本節稍後的 *mship* 引數表。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-149">For more information, see the table of *mship* arguments later in this section.</span></span><br /><br /> <span data-ttu-id="8e3ed-150">*pset_name* 引數是權限集合的名稱，其會與新的程式碼群組產生關聯。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-150">The *pset_name* argument is the name of the permission set that will be associated with the new code group.</span></span> <span data-ttu-id="8e3ed-151">您也可以為新群組設定一個或多個 *flags*。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-151">You can also set one or more *flags* for the new group.</span></span> <span data-ttu-id="8e3ed-152">如需詳細資訊，請參閱本節稍後的 *flags* 引數表。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-152">For more information, see the table of *flags* arguments later in this section.</span></span>|  
|<span data-ttu-id="8e3ed-153">**-addpset** {*psfile* &#124; *psfile* p *set_name*}</span><span class="sxs-lookup"><span data-stu-id="8e3ed-153">**-addpset** {*psfile* &#124; *psfile* p *set_name*}</span></span><br /><br /> <span data-ttu-id="8e3ed-154">或</span><span class="sxs-lookup"><span data-stu-id="8e3ed-154">or</span></span><br /><br /> <span data-ttu-id="8e3ed-155">**-ap** {*named* _ *psfile* &#124; *psfile* *pset_name*}</span><span class="sxs-lookup"><span data-stu-id="8e3ed-155">**-ap** {*named* _ *psfile* &#124; *psfile* *pset_name*}</span></span>|<span data-ttu-id="8e3ed-156">將新的具名權限集合加入至原則。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-156">Adds a new named permission set to policy.</span></span> <span data-ttu-id="8e3ed-157">權限集合必須以 XML 撰寫並儲存於 .xml 檔案中。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-157">The permission set must be authored in XML and stored in an .xml file.</span></span> <span data-ttu-id="8e3ed-158">如果 XML 檔案包含權限集合的名稱，則只會指定該檔案 (*psfile*)。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-158">If the XML file contains the name of the permission set, only that file (*psfile*) is specified.</span></span> <span data-ttu-id="8e3ed-159">如果 XML 檔案未包含權限集合名稱，則必須同時指定 XML 檔案名稱 (*psfile*) 和權限集合名稱 (*pset_name*)。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-159">If the XML file does not contain the permission set name, you must specify both the XML file name (*psfile*) and the permission set name (*pset_name*).</span></span><br /><br /> <span data-ttu-id="8e3ed-160">請注意，權限集合中使用的所有權限都必須在全域組件快取內含的組件中定義。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-160">Note that all permissions used in a permission set must be defined in assemblies contained in the global assembly cache.</span></span>|  
|<span data-ttu-id="8e3ed-161">**-a**[**ll**]</span><span class="sxs-lookup"><span data-stu-id="8e3ed-161">**-a**[**ll**]</span></span>|<span data-ttu-id="8e3ed-162">指出這個選項之後的所有選項都會套用至電腦、使用者和企業原則。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-162">Indicates that all options following this one apply to the machine, user, and enterprise policies.</span></span> <span data-ttu-id="8e3ed-163">**-all** 選項一律會參考目前已登入使用者的原則。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-163">The **-all** option always refers to the policy of the currently logged-on user.</span></span> <span data-ttu-id="8e3ed-164">若要參考目前使用者以外的使用者原則，請參閱 **-customall** 選項。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-164">See the **-customall** option to refer to the user policy of a user other than the current user.</span></span>|  
|<span data-ttu-id="8e3ed-165">**-chggroup** {*label &#124;name*} {*mship* &#124; *pset_name* &#124;</span><span class="sxs-lookup"><span data-stu-id="8e3ed-165">**-chggroup** {*label &#124;name*} {*mship* &#124; *pset_name* &#124;</span></span><br /><br /> <span data-ttu-id="8e3ed-166">*旗標*`}`</span><span class="sxs-lookup"><span data-stu-id="8e3ed-166">*flags* `}`</span></span><br /><br /> <span data-ttu-id="8e3ed-167">或</span><span class="sxs-lookup"><span data-stu-id="8e3ed-167">or</span></span><br /><br /> <span data-ttu-id="8e3ed-168">**-cg** {*label &#124;name*} {*mship* &#124; *pset_name* &#124;</span><span class="sxs-lookup"><span data-stu-id="8e3ed-168">**-cg** {*label &#124;name*} {*mship* &#124; *pset_name* &#124;</span></span><br /><br /> <span data-ttu-id="8e3ed-169">*旗標*`}`</span><span class="sxs-lookup"><span data-stu-id="8e3ed-169">*flags* `}`</span></span>|<span data-ttu-id="8e3ed-170">可變更程式碼群組的成員資格條件、權限集合或是 **exclusive**、**levelfinal**、**name** 或 **description** 旗標的設定。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-170">Changes a code group's membership condition, permission set, or the settings of the **exclusive**, **levelfinal**, **name**, or **description** flags.</span></span> <span data-ttu-id="8e3ed-171">您可以指定 *label* 或是 *name*。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-171">You can specify either the *label* or *name*.</span></span> <span data-ttu-id="8e3ed-172">*label* 引數會指定程式碼群組的標籤 (例如 1.</span><span class="sxs-lookup"><span data-stu-id="8e3ed-172">The *label* argument specifies the label (such as 1.</span></span> <span data-ttu-id="8e3ed-173">或 1.1.)。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-173">or 1.1.) of the code group.</span></span> <span data-ttu-id="8e3ed-174">*name* 引數會指定要變更的程式碼群組名稱。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-174">The *name* argument specifies the name of the code group to change.</span></span> <span data-ttu-id="8e3ed-175">由於 *label* 和 *name* 可以交替使用，所以 Caspol.exe 必須能夠區分這兩者。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-175">Because *label* and *name* can be used interchangeably, Caspol.exe must be able to distinguish between them.</span></span> <span data-ttu-id="8e3ed-176">因此，*name* 不能以數字開頭。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-176">Therefore, *name* cannot begin with a number.</span></span> <span data-ttu-id="8e3ed-177">此外，*name* 只能包含 A-Z、0-9 以及底線字元。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-177">Additionally, *name* can only contain A-Z, 0-9 and the underscore character.</span></span><br /><br /> <span data-ttu-id="8e3ed-178">*pset_name* 引數會指定要與程式碼群組產生關聯的權限集合名稱。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-178">The *pset_name* argument specifies the name of the permission set to associate with the code group.</span></span> <span data-ttu-id="8e3ed-179">如需 *mship* 和 *flags* 引數的詳細資訊，請參閱本節稍後的表格。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-179">See the tables later in this section for information on the *mship* and *flags* arguments.</span></span>|  
|<span data-ttu-id="8e3ed-180">**-chgpset**  *psfile pset_name*</span><span class="sxs-lookup"><span data-stu-id="8e3ed-180">**-chgpset**  *psfile pset_name*</span></span><br /><br /> <span data-ttu-id="8e3ed-181">或</span><span class="sxs-lookup"><span data-stu-id="8e3ed-181">or</span></span><br /><br /> <span data-ttu-id="8e3ed-182">**-cp** *psfile pset_name*</span><span class="sxs-lookup"><span data-stu-id="8e3ed-182">**-cp** *psfile pset_name*</span></span>|<span data-ttu-id="8e3ed-183">變更具名權限集合。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-183">Changes a named permission set.</span></span> <span data-ttu-id="8e3ed-184">*psfile* 引數為權限集合提供新定義，其為 XML 格式的序列化權限集合檔案。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-184">The *psfile* argument supplies the new definition for the permission set; it is a serialized permission set file in XML format.</span></span> <span data-ttu-id="8e3ed-185">*pset_name* 引數會指定您想要變更的權限集合名稱。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-185">The *pset_name* argument specifies the name of the permission set you want to change.</span></span>|  
|<span data-ttu-id="8e3ed-186">**-customall**  *path*</span><span class="sxs-lookup"><span data-stu-id="8e3ed-186">**-customall**  *path*</span></span><br /><br /> <span data-ttu-id="8e3ed-187">或</span><span class="sxs-lookup"><span data-stu-id="8e3ed-187">or</span></span><br /><br /> <span data-ttu-id="8e3ed-188">**-ca**  *path*</span><span class="sxs-lookup"><span data-stu-id="8e3ed-188">**-ca**  *path*</span></span>|<span data-ttu-id="8e3ed-189">指出這個選項之後的所有選項都會套用至電腦、企業和指定的自訂使用者原則。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-189">Indicates that all options following this one apply to the machine, enterprise, and the specified custom user policies.</span></span> <span data-ttu-id="8e3ed-190">您必須使用 *path* 引數來指定自訂使用者的安全性組態檔位置。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-190">You must specify the location of the custom user's security configuration file with the *path* argument.</span></span>|  
|<span data-ttu-id="8e3ed-191">**-cu**[**stomuser**] *path*</span><span class="sxs-lookup"><span data-stu-id="8e3ed-191">**-cu**[**stomuser**] *path*</span></span>|<span data-ttu-id="8e3ed-192">允許管理不屬於目前執行 Caspol.exe 之使用者的自訂使用者原則。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-192">Allows the administration of a custom user policy that does not belong to the user on whose behalf Caspol.exe is currently running.</span></span> <span data-ttu-id="8e3ed-193">您必須使用 *path* 引數來指定自訂使用者的安全性組態檔位置。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-193">You must specify the location of the custom user's security configuration file with the *path* argument.</span></span>|  
|<span data-ttu-id="8e3ed-194">**-enterprise**</span><span class="sxs-lookup"><span data-stu-id="8e3ed-194">**-enterprise**</span></span><br /><br /> <span data-ttu-id="8e3ed-195">或</span><span class="sxs-lookup"><span data-stu-id="8e3ed-195">or</span></span><br /><br /> <span data-ttu-id="8e3ed-196">**-en**</span><span class="sxs-lookup"><span data-stu-id="8e3ed-196">**-en**</span></span>|<span data-ttu-id="8e3ed-197">指出這個選項之後的所有選項都會套用至企業層級原則。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-197">Indicates that all options following this one apply to the enterprise level policy.</span></span> <span data-ttu-id="8e3ed-198">不是企業系統管理員的使用者沒有足夠的權限可修改企業原則，但是可以檢視原則。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-198">Users who are not enterprise administrators do not have sufficient rights to modify the enterprise policy, although they can view it.</span></span> <span data-ttu-id="8e3ed-199">在非企業情節中，這個原則預設不會與電腦和使用者原則牴觸。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-199">In nonenterprise scenarios, this policy, by default, does not interfere with machine and user policy.</span></span>|  
|<span data-ttu-id="8e3ed-200">**-e**[**xecution**] {**on** &#124; **off**}</span><span class="sxs-lookup"><span data-stu-id="8e3ed-200">**-e**[**xecution**] {**on** &#124; **off**}</span></span>|<span data-ttu-id="8e3ed-201">開啟或關閉在程式碼開始執行前檢查要執行之權限的機制。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-201">Turns on or off the mechanism that checks for the permission to run before code starts to execute.</span></span> <span data-ttu-id="8e3ed-202">**注意：**  .NET Framework 4 和更新版本中已移除此參數。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-202">**Note:**  This switch is removed in the .NET Framework 4 and later versions.</span></span> <span data-ttu-id="8e3ed-203">如需詳細資訊，請參閱[安全性變更](/previous-versions/dotnet/framework/security/security-changes)。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-203">For more information, see [Security Changes](/previous-versions/dotnet/framework/security/security-changes).</span></span>|  
|<span data-ttu-id="8e3ed-204">**-f**[**orce**]</span><span class="sxs-lookup"><span data-stu-id="8e3ed-204">**-f**[**orce**]</span></span>|<span data-ttu-id="8e3ed-205">抑制工具的自行解構測試，並依照使用者指定的方式變更原則。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-205">Suppresses the tool's self-destruct test and changes the policy as specified by the user.</span></span> <span data-ttu-id="8e3ed-206">一般來說，Caspol.exe 會檢查是否有造成 Caspol.exe 本身無法正常執行的任何原則變更，如果有的話，Caspol.exe 不會儲存該原則變更，而且會印出錯誤訊息。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-206">Normally, Caspol.exe checks whether any policy changes would prevent Caspol.exe itself from running properly; if so, Caspol.exe does not save the policy change and prints an error message.</span></span> <span data-ttu-id="8e3ed-207">若要強制 Caspol.exe 變更原則 (即使這個原則會造成 Caspol.exe 本身無法執行)，請使用 **–force** 選項。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-207">To force Caspol.exe to change policy even if this prevents Caspol.exe itself from running, use the **–force** option.</span></span>|  
|<span data-ttu-id="8e3ed-208">**-h**[**elp**]</span><span class="sxs-lookup"><span data-stu-id="8e3ed-208">**-h**[**elp**]</span></span>|<span data-ttu-id="8e3ed-209">顯示 Caspol.exe 的命令語法和選項。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-209">Displays command syntax and options for Caspol.exe.</span></span>|  
|<span data-ttu-id="8e3ed-210">**-l**[**ist**]</span><span class="sxs-lookup"><span data-stu-id="8e3ed-210">**-l**[**ist**]</span></span>|<span data-ttu-id="8e3ed-211">列出程式碼群組階層架構以及所指定電腦、使用者、企業或所有原則層級的權限集合。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-211">Lists the code group hierarchy and the permission sets for the specified machine, user, enterprise, or all policy levels.</span></span> <span data-ttu-id="8e3ed-212">Caspol.exe 會先顯示程式碼群組的標籤，後面接著名稱 (如果不是 null 的話)。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-212">Caspol.exe displays the code group's label first, followed by the name, if it is not null.</span></span>|  
|<span data-ttu-id="8e3ed-213">**-listdescription**</span><span class="sxs-lookup"><span data-stu-id="8e3ed-213">**-listdescription**</span></span><br /><br /> <span data-ttu-id="8e3ed-214">或</span><span class="sxs-lookup"><span data-stu-id="8e3ed-214">or</span></span><br /><br /> <span data-ttu-id="8e3ed-215">**-ld**</span><span class="sxs-lookup"><span data-stu-id="8e3ed-215">**-ld**</span></span>|<span data-ttu-id="8e3ed-216">列出所指定原則層級的所有程式碼群組描述。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-216">Lists all code group descriptions for the specified policy level.</span></span>|  
|<span data-ttu-id="8e3ed-217">**-listfulltrust**</span><span class="sxs-lookup"><span data-stu-id="8e3ed-217">**-listfulltrust**</span></span><br /><br /> <span data-ttu-id="8e3ed-218">或</span><span class="sxs-lookup"><span data-stu-id="8e3ed-218">or</span></span><br /><br /> <span data-ttu-id="8e3ed-219">**-lf**</span><span class="sxs-lookup"><span data-stu-id="8e3ed-219">**-lf**</span></span>|<span data-ttu-id="8e3ed-220">列出所指定原則層級的完全信任組件清單內容。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-220">Lists the contents of the full trust assembly list for the specified policy level.</span></span>|  
|<span data-ttu-id="8e3ed-221">**-listgroups**</span><span class="sxs-lookup"><span data-stu-id="8e3ed-221">**-listgroups**</span></span><br /><br /> <span data-ttu-id="8e3ed-222">或</span><span class="sxs-lookup"><span data-stu-id="8e3ed-222">or</span></span><br /><br /> <span data-ttu-id="8e3ed-223">**-lg**</span><span class="sxs-lookup"><span data-stu-id="8e3ed-223">**-lg**</span></span>|<span data-ttu-id="8e3ed-224">顯示所指定原則層級或所有原則層級的程式碼群組。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-224">Displays the code groups of the specified policy level or all policy levels.</span></span> <span data-ttu-id="8e3ed-225">Caspol.exe 會先顯示程式碼群組的標籤，後面接著名稱 (如果不是 null 的話)。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-225">Caspol.exe displays the code group's label first, followed by the name, if it is not null.</span></span>|  
|<span data-ttu-id="8e3ed-226">**-listpset** 或 **-lp**</span><span class="sxs-lookup"><span data-stu-id="8e3ed-226">**-listpset** or **-lp**</span></span>|<span data-ttu-id="8e3ed-227">顯示所指定原則層級或所有原則層級的權限集合。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-227">Displays the permission sets for the specified policy level or all policy levels.</span></span>|  
|<span data-ttu-id="8e3ed-228">**-m**[**achine**]</span><span class="sxs-lookup"><span data-stu-id="8e3ed-228">**-m**[**achine**]</span></span>|<span data-ttu-id="8e3ed-229">指出這個選項之後的所有選項都會套用至電腦層級原則。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-229">Indicates that all options following this one apply to the machine level policy.</span></span> <span data-ttu-id="8e3ed-230">不是系統管理員的使用者沒有足夠的權限可修改電腦原則，但是可以檢視原則。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-230">Users who are not administrators do not have sufficient rights to modify the machine policy, although they can view it.</span></span> <span data-ttu-id="8e3ed-231">對於系統管理員，**-machine** 是預設值。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-231">For administrators, **-machine** is the default.</span></span>|  
|<span data-ttu-id="8e3ed-232">**-polchgprompt** {**on** &#124; **off**}</span><span class="sxs-lookup"><span data-stu-id="8e3ed-232">**-polchgprompt** {**on** &#124; **off**}</span></span><br /><br /> <span data-ttu-id="8e3ed-233">或</span><span class="sxs-lookup"><span data-stu-id="8e3ed-233">or</span></span><br /><br /> <span data-ttu-id="8e3ed-234">**-pp** {**on** &#124; **off**}</span><span class="sxs-lookup"><span data-stu-id="8e3ed-234">**-pp** {**on** &#124; **off**}</span></span>|<span data-ttu-id="8e3ed-235">啟用或停用每當使用會造成原則變更的選項來執行 Caspol.exe 時所顯示的提示。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-235">Enables or disables the prompt that is displayed whenever Caspol.exe is run using an option that would cause policy changes.</span></span>|  
|<span data-ttu-id="8e3ed-236">**-quiet**</span><span class="sxs-lookup"><span data-stu-id="8e3ed-236">**-quiet**</span></span><br /><br /> <span data-ttu-id="8e3ed-237">或</span><span class="sxs-lookup"><span data-stu-id="8e3ed-237">or</span></span><br /><br /> <span data-ttu-id="8e3ed-238">**-q**</span><span class="sxs-lookup"><span data-stu-id="8e3ed-238">**-q**</span></span>|<span data-ttu-id="8e3ed-239">暫時停用通常會對造成原則變更的選項顯示的提示。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-239">Temporarily disables the prompt that is normally displayed for an option that causes policy changes.</span></span> <span data-ttu-id="8e3ed-240">不過，全域變更提示設定不會變更。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-240">The global change prompt setting does not change.</span></span> <span data-ttu-id="8e3ed-241">僅針對單一命令使用這個選項，如此才不會停用所有 Caspol.exe 命令的提示。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-241">Use the option only on a single command basis to avoid disabling the prompt for all Caspol.exe commands.</span></span>|  
|<span data-ttu-id="8e3ed-242">**-r**[**ecover**]</span><span class="sxs-lookup"><span data-stu-id="8e3ed-242">**-r**[**ecover**]</span></span>|<span data-ttu-id="8e3ed-243">從備份檔復原原則。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-243">Recovers policy from a backup file.</span></span> <span data-ttu-id="8e3ed-244">每當原則變更時，Caspol.exe 都會將舊原則儲存到備份檔中。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-244">Whenever a policy change is made, Caspol.exe stores the old policy in a backup file.</span></span>|  
|<span data-ttu-id="8e3ed-245">**-remfulltrust** *assembly_file*</span><span class="sxs-lookup"><span data-stu-id="8e3ed-245">**-remfulltrust** *assembly_file*</span></span><br /><br /> <span data-ttu-id="8e3ed-246">或</span><span class="sxs-lookup"><span data-stu-id="8e3ed-246">or</span></span><br /><br /> <span data-ttu-id="8e3ed-247">**-rf**  *assembly_file*</span><span class="sxs-lookup"><span data-stu-id="8e3ed-247">**-rf**  *assembly_file*</span></span>|<span data-ttu-id="8e3ed-248">從原則層級的完全信任清單中移除組件。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-248">Removes an assembly from the full trust list of a policy level.</span></span> <span data-ttu-id="8e3ed-249">如果原則不再使用包含自訂權限的權限集合，則應該執行這項作業。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-249">This operation should be performed if a permission set that contains a custom permission is no longer used by policy.</span></span> <span data-ttu-id="8e3ed-250">不過，只有在組件未實作任何其他仍在使用的自訂權限時，才可以從完全信任清單中移除實作自訂權限的組件。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-250">However, you should remove an assembly that implements a custom permission from the full trust list only if the assembly does not implement any other custom permissions that are still being used.</span></span> <span data-ttu-id="8e3ed-251">當您從清單中移除組件時，也應該移除該組件所依存的任何其他組件。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-251">When you remove an assembly from the list, you should also remove any other assemblies that it depends on.</span></span>|  
|<span data-ttu-id="8e3ed-252">**-remgroup** {*label &#124;name*}</span><span class="sxs-lookup"><span data-stu-id="8e3ed-252">**-remgroup** {*label &#124;name*}</span></span><br /><br /> <span data-ttu-id="8e3ed-253">或</span><span class="sxs-lookup"><span data-stu-id="8e3ed-253">or</span></span><br /><br /> <span data-ttu-id="8e3ed-254">**-rg** {l *abel &#124; name*}</span><span class="sxs-lookup"><span data-stu-id="8e3ed-254">**-rg** {l *abel &#124; name*}</span></span>|<span data-ttu-id="8e3ed-255">移除以標籤或名稱指定的程式碼群組。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-255">Removes the code group specified by either its label or name.</span></span> <span data-ttu-id="8e3ed-256">如果指定的程式碼群組包含子程式碼群組，Caspol.exe 也會移除所有子程式碼群組。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-256">If the specified code group has child code groups, Caspol.exe also removes all the child code groups.</span></span>|  
|<span data-ttu-id="8e3ed-257">**-rempset** *pset_name*</span><span class="sxs-lookup"><span data-stu-id="8e3ed-257">**-rempset** *pset_name*</span></span><br /><br /> <span data-ttu-id="8e3ed-258">或</span><span class="sxs-lookup"><span data-stu-id="8e3ed-258">or</span></span><br /><br /> <span data-ttu-id="8e3ed-259">**-rp** *pset_name*</span><span class="sxs-lookup"><span data-stu-id="8e3ed-259">**-rp** *pset_name*</span></span>|<span data-ttu-id="8e3ed-260">從原則中移除指定的權限集合。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-260">Removes the specified permission set from policy.</span></span> <span data-ttu-id="8e3ed-261">*pset_name* 引數會指出要移除的權限集合。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-261">The *pset_name* argument indicates which permission set to remove.</span></span> <span data-ttu-id="8e3ed-262">只有在權限集合未與任何程式碼群組相關聯時，Caspol.exe 才會將該權限集合移除。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-262">Caspol.exe removes the permission set only if it is not associated with any code group.</span></span> <span data-ttu-id="8e3ed-263">無法移除預設 (內建) 權限集合。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-263">The default (built-in) permission sets cannot be removed.</span></span>|  
|<span data-ttu-id="8e3ed-264">**-reset**</span><span class="sxs-lookup"><span data-stu-id="8e3ed-264">**-reset**</span></span><br /><br /> <span data-ttu-id="8e3ed-265">或</span><span class="sxs-lookup"><span data-stu-id="8e3ed-265">or</span></span><br /><br /> <span data-ttu-id="8e3ed-266">**-rs**</span><span class="sxs-lookup"><span data-stu-id="8e3ed-266">**-rs**</span></span>|<span data-ttu-id="8e3ed-267">將原則回復到其預設狀態並保存 (Persist) 到磁碟中。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-267">Returns policy to its default state and persists it to disk.</span></span> <span data-ttu-id="8e3ed-268">每當變更的原則似乎無法修復，而您想要以安裝預設值重新開始時，這樣做會非常有用。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-268">This is useful whenever a changed policy seems to be beyond repair and you want to start over with the installation defaults.</span></span> <span data-ttu-id="8e3ed-269">當您想要使用預設原則做為修改特定安全性設定檔的起點時，重設也會很方便。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-269">Resetting can also be convenient when you want to use the default policy as a starting point for modifications to specific security configuration files.</span></span> <span data-ttu-id="8e3ed-270">如需詳細資訊，請參閱[手動編輯安全性組態檔](#cpgrfcodeaccesssecuritypolicyutilitycaspolexeanchor1)。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-270">For more information, see [Manually Editing the Security Configuration Files](#cpgrfcodeaccesssecuritypolicyutilitycaspolexeanchor1).</span></span>|  
|<span data-ttu-id="8e3ed-271">**-resetlockdown**</span><span class="sxs-lookup"><span data-stu-id="8e3ed-271">**-resetlockdown**</span></span><br /><br /> <span data-ttu-id="8e3ed-272">或</span><span class="sxs-lookup"><span data-stu-id="8e3ed-272">or</span></span><br /><br /> <span data-ttu-id="8e3ed-273">**-rsld**</span><span class="sxs-lookup"><span data-stu-id="8e3ed-273">**-rsld**</span></span>|<span data-ttu-id="8e3ed-274">將原則回復為預設狀態的更嚴格版本並將它保存至磁碟，建立先前電腦原則的備份並將它保存至稱為 `security.config.bac` 的檔案。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-274">Returns policy to a more restrictive version of the default state and persists it to disk; creates a backup of the previous machine policy and persists it to a file called `security.config.bac`.</span></span>  <span data-ttu-id="8e3ed-275">鎖定原則類似於預設原則，差別在於鎖定原則不會授與可從 `Local Intranet`、`Trusted Sites` 和 `Internet` 區域撰寫程式碼的權限，而且對應的程式碼群組沒有子程式碼群組。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-275">The locked down policy is similar to the default policy, except that the policy grants no permission to code from the `Local Intranet`, `Trusted Sites`, and `Internet` zones and the corresponding code groups have no child code groups.</span></span>|  
|<span data-ttu-id="8e3ed-276">**-resolvegroup** *assembly_file*</span><span class="sxs-lookup"><span data-stu-id="8e3ed-276">**-resolvegroup** *assembly_file*</span></span><br /><br /> <span data-ttu-id="8e3ed-277">或</span><span class="sxs-lookup"><span data-stu-id="8e3ed-277">or</span></span><br /><br /> <span data-ttu-id="8e3ed-278">**-rsg**  *assembly_file*</span><span class="sxs-lookup"><span data-stu-id="8e3ed-278">**-rsg**  *assembly_file*</span></span>|<span data-ttu-id="8e3ed-279">顯示特定組件 (*assembly_file*) 所屬的程式碼群組。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-279">Shows the code groups that a specific assembly (*assembly_file*) belongs to.</span></span> <span data-ttu-id="8e3ed-280">根據預設，這個選項會顯示組件所屬的電腦、使用者和企業原則層級。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-280">By default, this option displays the machine, user, and enterprise policy levels to which the assembly belongs.</span></span> <span data-ttu-id="8e3ed-281">若只要檢視一個原則層級，請搭配使用這個選項與 **-machine**、**-user** 或 **-enterprise** 選項。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-281">To view only one policy level, use this option with either the **-machine**, **-user**, or **-enterprise** option.</span></span>|  
|<span data-ttu-id="8e3ed-282">**-resolveperm** *assembly_file*</span><span class="sxs-lookup"><span data-stu-id="8e3ed-282">**-resolveperm** *assembly_file*</span></span><br /><br /> <span data-ttu-id="8e3ed-283">或</span><span class="sxs-lookup"><span data-stu-id="8e3ed-283">or</span></span><br /><br /> <span data-ttu-id="8e3ed-284">**-rsp** *assembly_file*</span><span class="sxs-lookup"><span data-stu-id="8e3ed-284">**-rsp** *assembly_file*</span></span>|<span data-ttu-id="8e3ed-285">在允許組件執行的情況下，顯示指定 (或預設) 的安全性原則層級會授與該組件的所有權限。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-285">Displays all permissions that the specified (or default) level of security policy would grant the assembly if the assembly were allowed to run.</span></span> <span data-ttu-id="8e3ed-286">*assembly_file* 引數會指定組件。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-286">The *assembly_file* argument specifies the assembly.</span></span> <span data-ttu-id="8e3ed-287">如果指定 **-all** 選項，Caspol.exe 會根據使用者、電腦和企業原則計算組件的權限；若未指定，則會套用預設行為規則。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-287">If you specify the **-all** option, Caspol.exe calculates the permissions for the assembly based on user, machine, and enterprise policy; otherwise, default behavior rules apply.</span></span>|  
|<span data-ttu-id="8e3ed-288">**-s**[**ecurity**] {**on** &#124; **off**}</span><span class="sxs-lookup"><span data-stu-id="8e3ed-288">**-s**[**ecurity**] {**on** &#124; **off**}</span></span>|<span data-ttu-id="8e3ed-289">開啟或關閉程式碼存取安全性。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-289">Turns code access security on or off.</span></span> <span data-ttu-id="8e3ed-290">指定 **-s off** 選項時，並不會停用以角色為基礎的安全性。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-290">Specifying the **-s off** option does not disable role-based security.</span></span> <span data-ttu-id="8e3ed-291">**注意：**  .NET Framework 4 和更新版本中已移除此參數。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-291">**Note:**  This switch is removed in the .NET Framework 4 and later versions.</span></span> <span data-ttu-id="8e3ed-292">如需詳細資訊，請參閱[安全性變更](/previous-versions/dotnet/framework/security/security-changes)。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-292">For more information, see [Security Changes](/previous-versions/dotnet/framework/security/security-changes).</span></span> <span data-ttu-id="8e3ed-293">**注意：** 停用程式碼存取安全性時，所有的程式碼存取要求都會成功。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-293">**Caution:**  When code access security is disabled, all code access demands succeed.</span></span> <span data-ttu-id="8e3ed-294">停用程式碼存取安全性會讓系統容易受惡意程式碼的攻擊，如病毒和破壞程式。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-294">Disabling code access security makes the system vulnerable to attacks by malicious code such as viruses and worms.</span></span> <span data-ttu-id="8e3ed-295">關閉安全性可獲得額外的效能，但是只有在已採取其他安全措施來協助確保整體系統安全性沒有漏洞的情況下，才可以這樣做。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-295">Turning off security gains some extra performance but should only be done when other security measures have been taken to help make sure overall system security is not breached.</span></span> <span data-ttu-id="8e3ed-296">其他安全性措施的範例，包括從公用網路中斷連結、用實際方法保全電腦等等。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-296">Examples of other security precautions include disconnecting from public networks, physically securing computers, and so on.</span></span>|  
|<span data-ttu-id="8e3ed-297">**-u**[**ser**]</span><span class="sxs-lookup"><span data-stu-id="8e3ed-297">**-u**[**ser**]</span></span>|<span data-ttu-id="8e3ed-298">指出這個選項之後的所有選項都會套用至執行 Caspol.exe 之使用者的使用者層級原則。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-298">Indicates that all options following this one apply to the user level policy for the user on whose behalf Caspol.exe is running.</span></span> <span data-ttu-id="8e3ed-299">對於非系統管理使用者，**-user** 是預設值。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-299">For nonadministrative users, **-user** is the default.</span></span>|  
|<span data-ttu-id="8e3ed-300">**-?**</span><span class="sxs-lookup"><span data-stu-id="8e3ed-300">**-?**</span></span>|<span data-ttu-id="8e3ed-301">顯示 Caspol.exe 的命令語法和選項。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-301">Displays command syntax and options for Caspol.exe.</span></span>|  
  
 <span data-ttu-id="8e3ed-302">*mship* 引數可以搭配 **-addgroup** 和 **-chggroup** 選項使用，以指定程式碼群組的成員資格條件 。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-302">The *mship* argument, which specifies the membership condition for a code group, can be used with the **-addgroup** and **-chggroup** options.</span></span> <span data-ttu-id="8e3ed-303">系統會以 .NET Framework 類別的形式來實作每個 *mship* 引數。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-303">Each *mship* argument is implemented as a .NET Framework class.</span></span> <span data-ttu-id="8e3ed-304">若要指定 *mship,*，請使用下列其中一種方式。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-304">To specify *mship,* use one of the following.</span></span>  
  
|<span data-ttu-id="8e3ed-305">引數</span><span class="sxs-lookup"><span data-stu-id="8e3ed-305">Argument</span></span>|<span data-ttu-id="8e3ed-306">描述</span><span class="sxs-lookup"><span data-stu-id="8e3ed-306">Description</span></span>|  
|--------------|-----------------|  
|<span data-ttu-id="8e3ed-307">**-allcode**</span><span class="sxs-lookup"><span data-stu-id="8e3ed-307">**-allcode**</span></span>|<span data-ttu-id="8e3ed-308">指定所有程式碼。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-308">Specifies all code.</span></span> <span data-ttu-id="8e3ed-309">如需這個成員資格條件的詳細資訊，請參閱 <xref:System.Security.Policy.AllMembershipCondition?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-309">For more information about this membership condition, see <xref:System.Security.Policy.AllMembershipCondition?displayProperty=nameWithType>.</span></span>|  
|<span data-ttu-id="8e3ed-310">**-appdir**</span><span class="sxs-lookup"><span data-stu-id="8e3ed-310">**-appdir**</span></span>|<span data-ttu-id="8e3ed-311">指定應用程式目錄。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-311">Specifies the application directory.</span></span> <span data-ttu-id="8e3ed-312">如果您將 **–appdir** 指定為成員資格條件，系統會比較程式碼的 URL 辨識項與該程式碼的應用程式目錄辨識項。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-312">If you specify **–appdir** as the membership condition, the URL evidence of code is compared with the application directory evidence of that code.</span></span> <span data-ttu-id="8e3ed-313">如果兩個辨識項的值相同，表示符合這個成員條件。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-313">If both evidence values are the same, this membership condition is satisfied.</span></span> <span data-ttu-id="8e3ed-314">如需這個成員資格條件的詳細資訊，請參閱 <xref:System.Security.Policy.ApplicationDirectoryMembershipCondition?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-314">For more information about this membership condition, see <xref:System.Security.Policy.ApplicationDirectoryMembershipCondition?displayProperty=nameWithType>.</span></span>|  
|<span data-ttu-id="8e3ed-315">**-custom**  *xmlfile*</span><span class="sxs-lookup"><span data-stu-id="8e3ed-315">**-custom**  *xmlfile*</span></span>|<span data-ttu-id="8e3ed-316">加入自訂成員資格條件。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-316">Adds a custom membership condition.</span></span> <span data-ttu-id="8e3ed-317">強制 *xmlfile* 引數會指定包含自訂成員資格條件之 XML 序列化的 .xml 檔。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-317">The mandatory *xmlfile* argument specifies the .xml file that contains XML serialization of the custom membership condition.</span></span>|  
|<span data-ttu-id="8e3ed-318">**-hash** *hashAlg* {**-hex** *hashValue* &#124; **-file** *assembly_file* }</span><span class="sxs-lookup"><span data-stu-id="8e3ed-318">**-hash** *hashAlg* {**-hex** *hashValue* &#124; **-file** *assembly_file* }</span></span>|<span data-ttu-id="8e3ed-319">指定具有指定組件雜湊的程式碼。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-319">Specifies code that has the given assembly hash.</span></span> <span data-ttu-id="8e3ed-320">若要使用雜湊做為程式碼群組成員資格條件，則必須指定雜湊值或組件檔。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-320">To use a hash as a code group membership condition, you must specify either the hash value or the assembly file.</span></span> <span data-ttu-id="8e3ed-321">如需這個成員資格條件的詳細資訊，請參閱 <xref:System.Security.Policy.HashMembershipCondition?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-321">For more information about this membership condition, see <xref:System.Security.Policy.HashMembershipCondition?displayProperty=nameWithType>.</span></span>|  
|<span data-ttu-id="8e3ed-322">**-pub** { **-cert** *cert_file_name* &#124;</span><span class="sxs-lookup"><span data-stu-id="8e3ed-322">**-pub** { **-cert** *cert_file_name* &#124;</span></span><br /><br /> <span data-ttu-id="8e3ed-323">**-file** *signed_file_name* &#124; **-hex**  *hex_string* }</span><span class="sxs-lookup"><span data-stu-id="8e3ed-323">**-file** *signed_file_name* &#124; **-hex**  *hex_string* }</span></span>|<span data-ttu-id="8e3ed-324">指定具有所指軟體發行者的程式碼，該發行者的表示方式為憑證檔、檔案上的簽章或 X509 憑證的十六進位表示。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-324">Specifies code that has the given software publisher, as denoted by a certificate file, a signature on a file, or the hexadecimal representation of an X509 certificate.</span></span> <span data-ttu-id="8e3ed-325">如需這個成員資格條件的詳細資訊，請參閱 <xref:System.Security.Policy.PublisherMembershipCondition?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-325">For more information about this membership condition, see <xref:System.Security.Policy.PublisherMembershipCondition?displayProperty=nameWithType>.</span></span>|  
|<span data-ttu-id="8e3ed-326">**-site** *website*</span><span class="sxs-lookup"><span data-stu-id="8e3ed-326">**-site** *website*</span></span>|<span data-ttu-id="8e3ed-327">指定具有所指來源網站的程式碼。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-327">Specifies code that has the given site of origin.</span></span> <span data-ttu-id="8e3ed-328">例如：</span><span class="sxs-lookup"><span data-stu-id="8e3ed-328">For example:</span></span><br /><br /> `-site** www.proseware.com`<br /><br /> <span data-ttu-id="8e3ed-329">如需這個成員資格條件的詳細資訊，請參閱 <xref:System.Security.Policy.SiteMembershipCondition?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-329">For more information about this membership condition, see <xref:System.Security.Policy.SiteMembershipCondition?displayProperty=nameWithType>.</span></span>|  
|<span data-ttu-id="8e3ed-330">**-strong -file** *file_name* {*name* &#124; **-noname**} {*version* &#124; **-noversion**}</span><span class="sxs-lookup"><span data-stu-id="8e3ed-330">**-strong -file** *file_name* {*name* &#124; **-noname**} {*version* &#124; **-noversion**}</span></span>|<span data-ttu-id="8e3ed-331">可指定具有特定強式名稱的程式碼，該名稱的指定方式為檔案名稱、組件名稱 (字串形式)，以及格式為 *major*.*minor*.*build*.*revision* 的組件版本。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-331">Specifies code that has a specific strong name, as designated by the file name, the assembly name as a string, and the assembly version in the format *major*.*minor*.*build*.*revision*.</span></span> <span data-ttu-id="8e3ed-332">例如：</span><span class="sxs-lookup"><span data-stu-id="8e3ed-332">For example:</span></span><br /><br /> <span data-ttu-id="8e3ed-333">**-strong -file** myAssembly.exe myAssembly 1.2.3.4</span><span class="sxs-lookup"><span data-stu-id="8e3ed-333">**-strong -file** myAssembly.exe myAssembly 1.2.3.4</span></span><br /><br /> <span data-ttu-id="8e3ed-334">如需這個成員資格條件的詳細資訊，請參閱 <xref:System.Security.Policy.StrongNameMembershipCondition?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-334">For more information about this membership condition, see <xref:System.Security.Policy.StrongNameMembershipCondition?displayProperty=nameWithType>.</span></span>|  
|<span data-ttu-id="8e3ed-335">**-url** *URL*</span><span class="sxs-lookup"><span data-stu-id="8e3ed-335">**-url** *URL*</span></span>|<span data-ttu-id="8e3ed-336">指定來自所指 URL 的程式碼。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-336">Specifies code that originates from the given URL.</span></span> <span data-ttu-id="8e3ed-337">這個 URL 必須包括通訊協定，例如 `http://` 或 `ftp://`。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-337">The URL must include a protocol, such as `http://` or `ftp://`.</span></span> <span data-ttu-id="8e3ed-338">此外，您可以使用萬用字元 (\*) 指定來自特定 URL 的多個組件。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-338">Additionally, a wildcard character (\*) can be used to specify multiple assemblies from a particular URL.</span></span> <span data-ttu-id="8e3ed-339">**注意：** 因為 URL 可以使用多個名稱來識別，所以將 URL 作為成員資格條件來確定程式碼識別並不安全。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-339">**Note:**  Because a URL can be identified using multiple names, using a URL as a membership condition is not a safe way to ascertain the identity of code.</span></span> <span data-ttu-id="8e3ed-340">請盡可能使用強式名稱 (Strong Name) 成員資格條件、發行者成員資格條件或雜湊成員資格條件。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-340">Where possible, use a strong name membership condition, a publisher membership condition, or the hash membership condition.</span></span> <br /><br /> <span data-ttu-id="8e3ed-341">如需這個成員資格條件的詳細資訊，請參閱 <xref:System.Security.Policy.UrlMembershipCondition?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-341">For more information about this membership condition, see <xref:System.Security.Policy.UrlMembershipCondition?displayProperty=nameWithType>.</span></span>|  
|<span data-ttu-id="8e3ed-342">**-zone** *zonename*</span><span class="sxs-lookup"><span data-stu-id="8e3ed-342">**-zone** *zonename*</span></span>|<span data-ttu-id="8e3ed-343">指定具有所指原始區域的程式碼。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-343">Specifies code with the given zone of origin.</span></span> <span data-ttu-id="8e3ed-344">*zonename* 引數可以是下列其中一個值：**MyComputer**、**Intranet**、**Trusted**、**Internet** 或 **Untrusted**。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-344">The *zonename* argument can be one of the following values: **MyComputer**, **Intranet**, **Trusted**, **Internet**, or **Untrusted**.</span></span> <span data-ttu-id="8e3ed-345">如需這個成員資格條件的詳細資訊，請參閱 <xref:System.Security.Policy.ZoneMembershipCondition> 類別。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-345">For more information about this membership condition, see the <xref:System.Security.Policy.ZoneMembershipCondition> Class.</span></span>|  
  
 <span data-ttu-id="8e3ed-346">*flags* 引數是使用下列其中一種方式指定，並且可以搭配 **–addgroup** 和 **–chggroup** 選項使用。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-346">The *flags* argument, which can be used with the **–addgroup** and **–chggroup** options, is specified using one of the following.</span></span>  
  
|<span data-ttu-id="8e3ed-347">引數</span><span class="sxs-lookup"><span data-stu-id="8e3ed-347">Argument</span></span>|<span data-ttu-id="8e3ed-348">描述</span><span class="sxs-lookup"><span data-stu-id="8e3ed-348">Description</span></span>|  
|--------------|-----------------|  
|<span data-ttu-id="8e3ed-349">**-description** "*description*"</span><span class="sxs-lookup"><span data-stu-id="8e3ed-349">**-description** "*description*"</span></span>|<span data-ttu-id="8e3ed-350">如果搭配 **–addgroup** 選項使用，可指定要新增的程式碼群組描述。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-350">If used with the **–addgroup** option, specifies the description for a code group to add.</span></span> <span data-ttu-id="8e3ed-351">如果搭配 **–chggroup** 選項使用，可指定要編輯的程式碼群組描述。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-351">If used with the **–chggroup** option, specifies the description for a code group to edit.</span></span> <span data-ttu-id="8e3ed-352">*description* 引數必須括在雙引號中。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-352">The *description* argument must be enclosed in double quotes.</span></span>|  
|<span data-ttu-id="8e3ed-353">**-exclusive** {**on**&#124;**off**}</span><span class="sxs-lookup"><span data-stu-id="8e3ed-353">**-exclusive** {**on**&#124;**off**}</span></span>|<span data-ttu-id="8e3ed-354">設為 **on** 時，表示當部分程式碼符合程式碼群組的成員資格條件時，只會考慮與您要新增或修改的程式碼群組相關聯的權限集合。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-354">When set to **on**, indicates that only the permission set associated with the code group you are adding or modifying is considered when some code fits the membership condition of the code group.</span></span> <span data-ttu-id="8e3ed-355">這個選項設為 **off** 時，Caspol.exe 會考慮原則層級中所有相符程式碼群組的權限集合。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-355">When this option is set to **off**, Caspol.exe considers the permission sets of all matching code groups in the policy level.</span></span>|  
|<span data-ttu-id="8e3ed-356">**-levelfinal** {**on**&#124;**off**}</span><span class="sxs-lookup"><span data-stu-id="8e3ed-356">**-levelfinal** {**on**&#124;**off**}</span></span>|<span data-ttu-id="8e3ed-357">設為 **on** 時，表示不會考慮新增或修改程式碼群組所在層級之下的原則層級。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-357">When set to **on**, indicates that no policy level below the level in which the added or modified code group occurs is considered.</span></span> <span data-ttu-id="8e3ed-358">這個選項通常於電腦原則層級使用。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-358">This option is typically used at the machine policy level.</span></span> <span data-ttu-id="8e3ed-359">例如，如果您在電腦層級為程式碼群組設定這個旗標，而某個程式碼符合這個程式碼群組的成員資格條件，Caspol.exe 將不會為這個程式碼計算或套用使用者層級原則。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-359">For example, if you set this flag for a code group at the machine level and some code matches this code group's membership condition, Caspol.exe does not calculate or apply the user level policy for this code.</span></span>|  
|<span data-ttu-id="8e3ed-360">**-name** "*name*"</span><span class="sxs-lookup"><span data-stu-id="8e3ed-360">**-name** "*name*"</span></span>|<span data-ttu-id="8e3ed-361">如果搭配 **–addgroup** 選項使用，可指定要新增之程式碼群組的指令碼名稱。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-361">If used with the **–addgroup** option, specifies the scripting name for a code group to add.</span></span> <span data-ttu-id="8e3ed-362">如果搭配 **-chggroup** 選項使用，可指定要編輯之程式碼群組的指令碼名稱。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-362">If used with the **-chggroup** option, specifies the scripting name for a code group to edit.</span></span> <span data-ttu-id="8e3ed-363">*name* 引數必須括在雙引號中。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-363">The *name* argument must be enclosed in double quotes.</span></span> <span data-ttu-id="8e3ed-364">*name* 引數不能以數字開頭，而且只能包含 A-Z、0-9 和底線字元。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-364">The *name* argument cannot begin with a number, and can only contain A-Z, 0-9, and the underscore character.</span></span> <span data-ttu-id="8e3ed-365">您可以藉由這個 *name* 來參考程式碼群組，而不是藉由其數值標籤。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-365">Code groups can be referred to by this *name* instead of by their numeric label.</span></span> <span data-ttu-id="8e3ed-366">*name* 對於編寫指令碼也非常有用。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-366">The *name* is also highly useful for scripting purposes.</span></span>|  
  
## <a name="remarks"></a><span data-ttu-id="8e3ed-367">備註</span><span class="sxs-lookup"><span data-stu-id="8e3ed-367">Remarks</span></span>  

 <span data-ttu-id="8e3ed-368">安全性原則是使用三個原則層級表示：電腦原則、使用者原則和企業原則。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-368">Security policy is expressed using three policy levels: machine policy, user policy, and enterprise policy.</span></span> <span data-ttu-id="8e3ed-369">組件收到的權限集合是由這三種原則層級允許的權限集合交集所決定。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-369">The set of permissions that an assembly receives is determined by the intersection of the permission sets allowed by these three policy levels.</span></span> <span data-ttu-id="8e3ed-370">每個原則層級是以程式碼群組的階層結構表示。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-370">Each policy level is represented by a hierarchical structure of code groups.</span></span> <span data-ttu-id="8e3ed-371">每個程式碼群組都具有成員資格條件，用以判斷哪一個程式碼是該群組的成員。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-371">Every code group has a membership condition that determines which code is a member of that group.</span></span> <span data-ttu-id="8e3ed-372">具名權限集合也會與每個程式碼群組相關聯。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-372">A named permission set is also associated with each code group.</span></span> <span data-ttu-id="8e3ed-373">這個權限集合會指定執行階段允許符合成員資格條件的程式碼具備的權限。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-373">This permission set specifies the permissions the runtime allows code that satisfies the membership condition to have.</span></span> <span data-ttu-id="8e3ed-374">程式碼群組階層架構與相關聯的具名權限集合一起定義並維護每一個層級的安全性原則。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-374">A code group hierarchy, along with its associated named permission sets, defines and maintains each level of security policy.</span></span> <span data-ttu-id="8e3ed-375">您可以使用 **–user**、**-customuser**、**–machine** 和 **-enterprise** 選項來設定安全性原則的層級。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-375">You can use the **–user**, **-customuser**, **–machine** and **-enterprise** options to set the level of security policy.</span></span>  
  
 <span data-ttu-id="8e3ed-376">如需安全性原則以及執行階段如何決定要授與程式碼之權限的詳細資訊，請參閱[安全性原則管理](/previous-versions/dotnet/netframework-4.0/c1k0eed6(v=vs.100))。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-376">For more information about security policy and how the runtime determines which permissions to grant to code, see [Security Policy Management](/previous-versions/dotnet/netframework-4.0/c1k0eed6(v=vs.100)).</span></span>  
  
## <a name="referencing-code-groups-and-permission-sets"></a><span data-ttu-id="8e3ed-377">參考程式碼群組和權限集合</span><span class="sxs-lookup"><span data-stu-id="8e3ed-377">Referencing Code Groups and Permission Sets</span></span>  

 <span data-ttu-id="8e3ed-378">為了簡化階層架構中程式碼群組的參考，**-list** 選項會以縮排方式顯示程式碼群組清單與其數字標籤 (1、1.1、1.1.1，以此類推)。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-378">To facilitate references to code groups in a hierarchy, the **-list** option displays an indented list of code groups along with their numerical labels (1, 1.1, 1.1.1, and so on).</span></span> <span data-ttu-id="8e3ed-379">其他以程式碼群組為目標的命令列作業也會使用數字標籤參考特定程式碼群組。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-379">The other command-line operations that target code groups also use the numerical labels to refer to specific code groups.</span></span>  
  
 <span data-ttu-id="8e3ed-380">具名權限集合是藉由其名稱參考。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-380">Named permission sets are referenced by their names.</span></span> <span data-ttu-id="8e3ed-381">**–list** 選項會顯示程式碼群組清單，後接該原則中可用的具名權限集合清單。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-381">The **–list** option displays the list of code groups followed by a list of named permission sets available in that policy.</span></span>  
  
## <a name="caspolexe-behavior"></a><span data-ttu-id="8e3ed-382">Caspol.exe 行為</span><span class="sxs-lookup"><span data-stu-id="8e3ed-382">Caspol.exe Behavior</span></span>  

 <span data-ttu-id="8e3ed-383">**-s**[**ecurity**] {**on** &#124; **off**} 以外的所有選項都會使用安裝 Caspol.exe 的 .NET Framework 版本。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-383">All options except **-s**[**ecurity**] {**on** &#124; **off**} use the version of the .NET Framework that Caspol.exe was installed with.</span></span> <span data-ttu-id="8e3ed-384">如果您執行的 Caspol.exe 是使用 *X* 版的執行階段進行安裝，則變更只會套用至該版本。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-384">If you run the Caspol.exe that was installed with version *X* of the runtime, the changes apply only to that version.</span></span> <span data-ttu-id="8e3ed-385">其他並存的執行階段安裝 (如果有的話) 則不受影響。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-385">Other side-by-side installations of the runtime, if any, are not affected.</span></span> <span data-ttu-id="8e3ed-386">如果您從命令列執行 Caspol.exe，而不是在特定執行階段版本的目錄中執行，則該工具會從路徑中的第一個執行階段版本目錄執行 (通常是安裝的最新執行階段版本)。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-386">If you run Caspol.exe from the command line without being in a directory for a specific runtime version, the tool is executed from the first runtime version directory in the path (usually the most recent runtime version installed).</span></span>  
  
 <span data-ttu-id="8e3ed-387">**-s**[**ecurity**] {**on** &#124; **off**} 選項是整個電腦的作業。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-387">The **-s**[**ecurity**] {**on** &#124; **off**} option is a computer-wide operation.</span></span> <span data-ttu-id="8e3ed-388">關閉程式碼存取安全性會終止電腦上所有 Managed 程式碼和所有使用者的安全性檢查。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-388">Turning off code access security terminates security checks for all managed code and for all users on the computer.</span></span> <span data-ttu-id="8e3ed-389">如果已安裝並存的 .NET Framework 版本，這個命令會關閉電腦上安裝之所有版本的安全性。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-389">If side-by-side versions of the .NET Framework are installed, this command turns off security for every version installed on the computer.</span></span> <span data-ttu-id="8e3ed-390">雖然 **-list** 選項會顯示安全性已關閉，但是不會對其他使用者清楚指出安全性已關閉。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-390">Although the **-list** option shows that security is turned off, nothing else clearly indicates for other users that security has been turned off.</span></span>  
  
 <span data-ttu-id="8e3ed-391">當未具備管理權限的使用者執行 Caspol.exe 時，除非指定 **–machine** 選項，否則所有選項都會參考使用者層級原則。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-391">When a user without administrative rights runs Caspol.exe, all options refer to the user level policy unless the **–machine** option is specified.</span></span> <span data-ttu-id="8e3ed-392">當系統管理員執行 Caspol.exe 時，除非指定 **–user** 選項，否則所有選項都會參考電腦原則。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-392">When an administrator runs Caspol.exe, all options refer to the machine policy unless the **–user** option is specified.</span></span>  
  
 <span data-ttu-id="8e3ed-393">Caspol.exe 必須具有與 **Everything** 權限集合對等的權限才能運作。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-393">Caspol.exe must be granted the equivalent of the **Everything** permission set to function.</span></span> <span data-ttu-id="8e3ed-394">此工具有保護機制，可防止原則遭到修改，而造成 Caspol.exe 無法獲得執行所需的權限。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-394">The tool has a protective mechanism that prevents policy from being modified in ways that would prevent Caspol.exe from being granted the permissions it needs to run.</span></span> <span data-ttu-id="8e3ed-395">如果您嘗試進行這類變更，Caspol.exe 會通知您要求的原則變更將中斷工具，並且拒絕原則變更。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-395">If you try to make such changes, Caspol.exe notifies you that the requested policy change will break the tool, and the policy change is rejected.</span></span> <span data-ttu-id="8e3ed-396">您可以使用 **–force** 選項，針對特定命令關閉這項保護機制。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-396">You can turn this protective mechanism off for a given command by using the **–force** option.</span></span>  
  
<a name="cpgrfcodeaccesssecuritypolicyutilitycaspolexeanchor1"></a>

## <a name="manually-editing-the-security-configuration-files"></a><span data-ttu-id="8e3ed-397">手動編輯安全性設定檔</span><span class="sxs-lookup"><span data-stu-id="8e3ed-397">Manually Editing the Security Configuration Files</span></span>  

 <span data-ttu-id="8e3ed-398">三個安全性設定檔分別對應 Caspol.exe 支援的三個原則層級：一個對應到電腦原則、一個對應到所指使用者的原則，還有一個對應到企業原則。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-398">Three security configuration files correspond to the three policy levels supported by Caspol.exe: one for the machine policy, one for a given user's policy, and one for the enterprise policy.</span></span> <span data-ttu-id="8e3ed-399">只有在使用 Caspol.exe 變更電腦、使用者或企業原則時，才會在磁碟上建立這些檔案。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-399">These files are created on disk only when machine, user, or enterprise policy is changed using Caspol.exe.</span></span> <span data-ttu-id="8e3ed-400">如有需要，您可以在 Caspol.exe 中使用 **–reset** 選項，將預設的安全性原則儲存到磁碟中。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-400">You can use the **–reset** option in Caspol.exe to save the default security policy to disk, if needed.</span></span>  
  
 <span data-ttu-id="8e3ed-401">在大部分狀況下，不建議手動編輯安全性設定檔。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-401">In most cases, manually editing the security configuration files is not recommended.</span></span> <span data-ttu-id="8e3ed-402">不過，有些情況下會需要修改這些檔案，例如系統管理員想要編輯特定使用者的安全性設定檔。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-402">But there might be scenarios in which modifying these files becomes necessary, such as when an administrator wants to edit the security configuration for a particular user.</span></span>  
  
## <a name="examples"></a><span data-ttu-id="8e3ed-403">範例</span><span class="sxs-lookup"><span data-stu-id="8e3ed-403">Examples</span></span>  

 <span data-ttu-id="8e3ed-404">**-addfulltrust**</span><span class="sxs-lookup"><span data-stu-id="8e3ed-404">**-addfulltrust**</span></span>  
  
 <span data-ttu-id="8e3ed-405">假設已將包含自訂權限的權限集合加入至電腦原則。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-405">Assume that a permission set containing a custom permission has been added to machine policy.</span></span> <span data-ttu-id="8e3ed-406">這個自訂權限是在 `MyPerm.exe` 中實作，而 `MyPerm.exe` 會參考 `MyOther.exe` 中的類別。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-406">This custom permission is implemented in `MyPerm.exe`, and `MyPerm.exe` references classes in `MyOther.exe`.</span></span> <span data-ttu-id="8e3ed-407">這兩個組件都必須加入至完全信任組件清單。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-407">Both assemblies must be added to the full trust assembly list.</span></span> <span data-ttu-id="8e3ed-408">下列命令會將 `MyPerm.exe` 組件加入至電腦原則的完全信任清單。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-408">The following command adds the `MyPerm.exe` assembly to the full trust list for the machine policy.</span></span>  
  
```console  
caspol -machine -addfulltrust MyPerm.exe  
```  
  
 <span data-ttu-id="8e3ed-409">下列命令會將 `MyOther.exe` 組件加入至電腦原則的完全信任清單。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-409">The following command adds the `MyOther.exe` assembly to the full trust list for the machine policy.</span></span>  
  
```console  
caspol -machine -addfulltrust MyOther.exe  
```  
  
 <span data-ttu-id="8e3ed-410">**-addgroup**</span><span class="sxs-lookup"><span data-stu-id="8e3ed-410">**-addgroup**</span></span>  
  
 <span data-ttu-id="8e3ed-411">下列命令會將子程式碼群組加入至電腦原則程式碼群組階層架構的根。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-411">The following command adds a child code group to the root of the machine policy code group hierarchy.</span></span> <span data-ttu-id="8e3ed-412">新的程式碼群組是 **Internet** 區域的成員，並且與 **Execution** 權限集合產生關聯。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-412">The new code group is a member of the **Internet** zone and is associated with the **Execution** permission set.</span></span>  
  
```console  
caspol -machine -addgroup 1.  -zone Internet Execution  
```  
  
 <span data-ttu-id="8e3ed-413">下列命令會新增子節點群組，可提供共用 \\\netserver\netshare 近端內部網路權限。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-413">The following command adds a child code group that gives the share \\\netserver\netshare local intranet permissions.</span></span>  
  
```console  
caspol -machine -addgroup 1. -url \\netserver\netshare\* LocalIntranet  
```  
  
 <span data-ttu-id="8e3ed-414">**-addpset**</span><span class="sxs-lookup"><span data-stu-id="8e3ed-414">**-addpset**</span></span>  
  
 <span data-ttu-id="8e3ed-415">下列命令會將 `Mypset` 權限集合加入至使用者原則。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-415">The following command adds the `Mypset` permission set to the user policy.</span></span>  
  
```console  
caspol -user -addpset Mypset.xml Mypset  
```  
  
 <span data-ttu-id="8e3ed-416">**-chggroup**</span><span class="sxs-lookup"><span data-stu-id="8e3ed-416">**-chggroup**</span></span>  
  
 <span data-ttu-id="8e3ed-417">下列命令會將標記為 1.2. 之程式碼群組的使用者原則中的權限集合，變更為</span><span class="sxs-lookup"><span data-stu-id="8e3ed-417">The following command changes the permission set in the user policy of the code group labeled 1.2.</span></span> <span data-ttu-id="8e3ed-418">**Execution** 權限集合。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-418">to the **Execution** permission set.</span></span>  
  
```console  
caspol -user -chggroup 1.2. Execution  
```  
  
 <span data-ttu-id="8e3ed-419">下列命令會變更標記為 1.2.1. 之程式碼群組的預設原則成員資格條件，</span><span class="sxs-lookup"><span data-stu-id="8e3ed-419">The following command changes the membership condition in the default policy of the code group labeled 1.2.1.</span></span> <span data-ttu-id="8e3ed-420">並且變更 **exclusive** 旗標的設定。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-420">and changes the setting of the **exclusive** flag.</span></span> <span data-ttu-id="8e3ed-421">系統會將成員資格條件定義為源自 **Internet** 區域的程式碼，而且會開啟 **exclusive** 旗標。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-421">The membership condition is defined to be code that originates from the **Internet** zone and the **exclusive** flag is switched on.</span></span>  
  
```console  
caspol -chggroup 1.2.1. -zone Internet -exclusive on  
```  
  
 <span data-ttu-id="8e3ed-422">**-chgpset**</span><span class="sxs-lookup"><span data-stu-id="8e3ed-422">**-chgpset**</span></span>  
  
 <span data-ttu-id="8e3ed-423">下列命令會將名稱為 `Mypset` 的權限集合變更為 `newpset.xml` 中包含的權限集合。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-423">The following command changes the permission set with name `Mypset` to the permission set contained in `newpset.xml`.</span></span> <span data-ttu-id="8e3ed-424">請注意，目前版本不支援變更程式碼群組階層架構所使用的權限集合。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-424">Note that the current release does not support changing permission sets that are being used by the code group hierarchy.</span></span>  
  
```console  
caspol -chgpset Mypset newpset.xml  
```  
  
 <span data-ttu-id="8e3ed-425">**-force**</span><span class="sxs-lookup"><span data-stu-id="8e3ed-425">**-force**</span></span>  
  
 <span data-ttu-id="8e3ed-426">下列命令會讓使用者原則的根程式碼群組 (標記為 1) 與 **Nothing** 具名權限集合產生關聯。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-426">The following command causes the user policy's root code group (labeled 1) to be associated with the **Nothing** named permission set.</span></span> <span data-ttu-id="8e3ed-427">這樣會使 Caspol.exe 無法執行。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-427">This prevents Caspol.exe from running.</span></span>  
  
```console  
caspol -force -user -chggroup 1 Nothing  
```  
  
 <span data-ttu-id="8e3ed-428">**-復原**</span><span class="sxs-lookup"><span data-stu-id="8e3ed-428">**-recover**</span></span>  
  
 <span data-ttu-id="8e3ed-429">下列命令會復原最近儲存的電腦原則。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-429">The following command recovers the most recently saved machine policy.</span></span>  
  
```console  
caspol -machine -recover  
```  
  
 <span data-ttu-id="8e3ed-430">**-remgroup**</span><span class="sxs-lookup"><span data-stu-id="8e3ed-430">**-remgroup**</span></span>  
  
 <span data-ttu-id="8e3ed-431">下列命令會將標記為 1.1 的程式碼群組移除。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-431">The following command removes the code group labeled 1.1.</span></span> <span data-ttu-id="8e3ed-432">如果這個程式碼群組有任何子程式碼群組，則這些群組也會一併刪除。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-432">If this code group has any child code groups, those groups are also deleted.</span></span>  
  
```console  
caspol -remgroup 1.1.  
```  
  
 <span data-ttu-id="8e3ed-433">**-rempset**</span><span class="sxs-lookup"><span data-stu-id="8e3ed-433">**-rempset**</span></span>  
  
 <span data-ttu-id="8e3ed-434">下列命令會將 **Execution** 權限集合從使用者原則中移除。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-434">The following command removes the **Execution** permission set from the user policy.</span></span>  
  
```console  
caspol -user -rempset Execution  
```  
  
 <span data-ttu-id="8e3ed-435">下列命令會將 `Mypset` 從使用者原則層級中移除。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-435">The following command removes `Mypset` from the user policy level.</span></span>  
  
```console  
caspol -rempset MyPset  
```  
  
 <span data-ttu-id="8e3ed-436">**-resolvegroup**</span><span class="sxs-lookup"><span data-stu-id="8e3ed-436">**-resolvegroup**</span></span>  
  
 <span data-ttu-id="8e3ed-437">下列命令會顯示 `myassembly` 所屬之電腦原則的所有程式碼群組。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-437">The following command shows all code groups of the machine policy that `myassembly` belongs to.</span></span>  
  
```console  
caspol -machine -resolvegroup myassembly  
```  
  
 <span data-ttu-id="8e3ed-438">下列命令會顯示 `myassembly` 所屬之電腦、企業和指定之自訂使用者原則的所有程式碼群組。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-438">The following command shows all code groups of the machine, enterprise, and specified custom user policy that `myassembly` belongs to.</span></span>  
  
```console  
caspol -customall "c:\config_test\security.config" -resolvegroup myassembly  
```  
  
 <span data-ttu-id="8e3ed-439">**-resolveperm**</span><span class="sxs-lookup"><span data-stu-id="8e3ed-439">**-resolveperm**</span></span>  
  
 <span data-ttu-id="8e3ed-440">下列命令會依據電腦和使用者原則層級計算 `testassembly` 的權限。</span><span class="sxs-lookup"><span data-stu-id="8e3ed-440">The following command calculates the permissions for `testassembly` based on the machine and user policy levels.</span></span>  
  
```console  
caspol -all -resolveperm testassembly  
```  
  
## <a name="see-also"></a><span data-ttu-id="8e3ed-441">另請參閱</span><span class="sxs-lookup"><span data-stu-id="8e3ed-441">See also</span></span>

- [<span data-ttu-id="8e3ed-442">工具</span><span class="sxs-lookup"><span data-stu-id="8e3ed-442">Tools</span></span>](index.md)
- [<span data-ttu-id="8e3ed-443">命令提示字元</span><span class="sxs-lookup"><span data-stu-id="8e3ed-443">Command Prompts</span></span>](developer-command-prompt-for-vs.md)

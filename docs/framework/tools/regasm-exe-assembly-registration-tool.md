---
title: Regasm.exe (組件登錄工具)
description: 使用元件註冊工具 Regasm.exe。 讀取元件中繼資料，並將所需的專案新增至登錄，讓 COM 用戶端能夠建立 .NET 類別。
ms.date: 03/30/2017
helpviewer_keywords:
- Assembly Registration tool
- assemblies [.NET Framework], registering
- Regasm.exe
- registering assemblies
ms.assetid: e190e342-36ef-4651-a0b4-0e8c2c0281cb
ms.openlocfilehash: a3af6a0fbc7c9c695e18448da285977f04fd72ef
ms.sourcegitcommit: b4f8849c47c1a7145eb26ce68bc9f9976e0dbec3
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/03/2020
ms.locfileid: "87517252"
---
# <a name="regasmexe-assembly-registration-tool"></a><span data-ttu-id="5295c-104">Regasm.exe (組件登錄工具)</span><span class="sxs-lookup"><span data-stu-id="5295c-104">Regasm.exe (Assembly Registration Tool)</span></span>

<span data-ttu-id="5295c-105">組件註冊工具會讀取組件內的中繼資料，並將必要的項目加入至登錄，這樣可讓 COM 用戶端順利地建立 .NET Framework 類別。</span><span class="sxs-lookup"><span data-stu-id="5295c-105">The Assembly Registration tool reads the metadata within an assembly and adds the necessary entries to the registry, which allows COM clients to create .NET Framework classes transparently.</span></span> <span data-ttu-id="5295c-106">註冊類別之後，任何 COM 用戶端都可以將它當做 COM 類別使用。</span><span class="sxs-lookup"><span data-stu-id="5295c-106">Once a class is registered, any COM client can use it as though the class were a COM class.</span></span> <span data-ttu-id="5295c-107">類別只會在安裝組件時註冊一次。</span><span class="sxs-lookup"><span data-stu-id="5295c-107">The class is registered only once, when the assembly is installed.</span></span> <span data-ttu-id="5295c-108">在實際註冊類別之後，才能從 COM 建立組件內類別的執行個體。</span><span class="sxs-lookup"><span data-stu-id="5295c-108">Instances of classes within the assembly cannot be created from COM until they are actually registered.</span></span>

<span data-ttu-id="5295c-109">若要執行此工具，請使用 Visual Studio 的開發人員命令提示字元。</span><span class="sxs-lookup"><span data-stu-id="5295c-109">To run the tool, use the Developer Command Prompt for Visual Studio.</span></span> <span data-ttu-id="5295c-110">如需詳細資訊，請參閱[命令提示字元](developer-command-prompt-for-vs.md)。</span><span class="sxs-lookup"><span data-stu-id="5295c-110">For more information, see [Command Prompts](developer-command-prompt-for-vs.md).</span></span>

<span data-ttu-id="5295c-111">在命令提示字元中，請輸入下列項目：</span><span class="sxs-lookup"><span data-stu-id="5295c-111">At the command prompt, type the following:</span></span>

## <a name="syntax"></a><span data-ttu-id="5295c-112">語法</span><span class="sxs-lookup"><span data-stu-id="5295c-112">Syntax</span></span>

```console
regasm assemblyFile [options]
```

## <a name="parameters"></a><span data-ttu-id="5295c-113">參數</span><span class="sxs-lookup"><span data-stu-id="5295c-113">Parameters</span></span>

|<span data-ttu-id="5295c-114">參數</span><span class="sxs-lookup"><span data-stu-id="5295c-114">Parameter</span></span>|<span data-ttu-id="5295c-115">描述</span><span class="sxs-lookup"><span data-stu-id="5295c-115">Description</span></span>|
|---------------|-----------------|
|<span data-ttu-id="5295c-116">*assemblyFile*</span><span class="sxs-lookup"><span data-stu-id="5295c-116">*assemblyFile*</span></span>|<span data-ttu-id="5295c-117">要向 COM 註冊的組件。</span><span class="sxs-lookup"><span data-stu-id="5295c-117">The assembly to be registered with COM.</span></span>|

|<span data-ttu-id="5295c-118">選項</span><span class="sxs-lookup"><span data-stu-id="5295c-118">Option</span></span>|<span data-ttu-id="5295c-119">說明</span><span class="sxs-lookup"><span data-stu-id="5295c-119">Description</span></span>|
|------------|-----------------|
|<span data-ttu-id="5295c-120">**/codebase**</span><span class="sxs-lookup"><span data-stu-id="5295c-120">**/codebase**</span></span>|<span data-ttu-id="5295c-121">在登錄中建立一個程式碼基底項目。</span><span class="sxs-lookup"><span data-stu-id="5295c-121">Creates a Codebase entry in the registry.</span></span> <span data-ttu-id="5295c-122">程式碼基底專案會指定未安裝在全域組件快取中之元件的檔案路徑。</span><span class="sxs-lookup"><span data-stu-id="5295c-122">The Codebase entry specifies the file path for an assembly that's not installed in the global assembly cache.</span></span> <span data-ttu-id="5295c-123">如果您接著將安裝您要註冊到全域組件快取中的元件，請不要指定此選項。</span><span class="sxs-lookup"><span data-stu-id="5295c-123">Don't specify this option if you will subsequently install the assembly that you're registering into the global assembly cache.</span></span> <span data-ttu-id="5295c-124">您使用 **/codebase** 選項指定的 *assemblyFile* 引數必須是[強式名稱組件](../../standard/assembly/strong-named.md)。</span><span class="sxs-lookup"><span data-stu-id="5295c-124">The *assemblyFile* argument that you specify with the **/codebase** option must be a [strong-named assembly](../../standard/assembly/strong-named.md).</span></span>|
|<span data-ttu-id="5295c-125">**/registered**</span><span class="sxs-lookup"><span data-stu-id="5295c-125">**/registered**</span></span>|<span data-ttu-id="5295c-126">指定這個工具只會參考已註冊的類型程式庫。</span><span class="sxs-lookup"><span data-stu-id="5295c-126">Specifies that this tool will only refer to type libraries that have already been registered.</span></span>|
|<span data-ttu-id="5295c-127">**/asmpath:directory**</span><span class="sxs-lookup"><span data-stu-id="5295c-127">**/asmpath:directory**</span></span>|<span data-ttu-id="5295c-128">指定包含組件參考的目錄。</span><span class="sxs-lookup"><span data-stu-id="5295c-128">Specifies a directory containing assembly references.</span></span> <span data-ttu-id="5295c-129">必須與 **/regfile** 選項一起使用。</span><span class="sxs-lookup"><span data-stu-id="5295c-129">Must be used with the **/regfile** option.</span></span>|
|<span data-ttu-id="5295c-130">**/nologo**</span><span class="sxs-lookup"><span data-stu-id="5295c-130">**/nologo**</span></span>|<span data-ttu-id="5295c-131">隱藏 Microsoft 程式啟始資訊顯示。</span><span class="sxs-lookup"><span data-stu-id="5295c-131">Suppresses the Microsoft startup banner display.</span></span>|
|<span data-ttu-id="5295c-132">**/regfile** [**：** *regfile.reg assembly*]</span><span class="sxs-lookup"><span data-stu-id="5295c-132">**/regfile** [**:** *regFile*]</span></span>|<span data-ttu-id="5295c-133">產生組件的指定 .reg 檔，其中包含所需的登錄項目。</span><span class="sxs-lookup"><span data-stu-id="5295c-133">Generates the specified .reg file for the assembly, which contains the needed registry entries.</span></span> <span data-ttu-id="5295c-134">指定這個選項並不會變更登錄。</span><span class="sxs-lookup"><span data-stu-id="5295c-134">Specifying this option does not change the registry.</span></span> <span data-ttu-id="5295c-135">這個選項不可與 **/u** 或 **/tlb** 選項一起使用。</span><span class="sxs-lookup"><span data-stu-id="5295c-135">You cannot use this option with the **/u** or **/tlb** options.</span></span>|
|<span data-ttu-id="5295c-136">**/silent** 或 **/s**</span><span class="sxs-lookup"><span data-stu-id="5295c-136">**/silent** or **/s**</span></span>|<span data-ttu-id="5295c-137">隱藏顯示成功訊息。</span><span class="sxs-lookup"><span data-stu-id="5295c-137">Suppresses the display of success messages.</span></span>|
|<span data-ttu-id="5295c-138">**/tlb** [**：** *typeLibFile*]</span><span class="sxs-lookup"><span data-stu-id="5295c-138">**/tlb** [**:** *typeLibFile*]</span></span>|<span data-ttu-id="5295c-139">從指定的組件中產生類型程式庫，其中包含組件內所定義之可存取類型的定義。</span><span class="sxs-lookup"><span data-stu-id="5295c-139">Generates a type library from the specified assembly containing definitions of the accessible types defined within the assembly.</span></span>|
|<span data-ttu-id="5295c-140">**/unregister** 或 **/u**</span><span class="sxs-lookup"><span data-stu-id="5295c-140">**/unregister** or **/u**</span></span>|<span data-ttu-id="5295c-141">移除註冊 *assemblyFile* 中所找到的可建立類別。</span><span class="sxs-lookup"><span data-stu-id="5295c-141">Unregisters the creatable classes found in *assemblyFile*.</span></span> <span data-ttu-id="5295c-142">省略這個選項會造成 Regasm.exe 註冊組件中可建立的類別。</span><span class="sxs-lookup"><span data-stu-id="5295c-142">Omitting this option causes Regasm.exe to register the creatable classes in the assembly.</span></span>|
|<span data-ttu-id="5295c-143">**/verbose**</span><span class="sxs-lookup"><span data-stu-id="5295c-143">**/verbose**</span></span>|<span data-ttu-id="5295c-144">指定詳細資訊模式，與 **/tlb** 選項一起指定時，顯示需要產生型別程式庫之任何參考組件的清單。</span><span class="sxs-lookup"><span data-stu-id="5295c-144">Specifies verbose mode; displays a list of any referenced assemblies for which a type library needs to be generated, when specified with the **/tlb** option.</span></span>|
|<span data-ttu-id="5295c-145">**/?**</span><span class="sxs-lookup"><span data-stu-id="5295c-145">**/?**</span></span> <span data-ttu-id="5295c-146">或 **/help**</span><span class="sxs-lookup"><span data-stu-id="5295c-146">or **/help**</span></span>|<span data-ttu-id="5295c-147">顯示工具的命令語法和選項。</span><span class="sxs-lookup"><span data-stu-id="5295c-147">Displays command syntax and options for the tool.</span></span>|

> [!NOTE]
> <span data-ttu-id="5295c-148">Regasm.exe 命令列選項不區分大小寫。</span><span class="sxs-lookup"><span data-stu-id="5295c-148">The Regasm.exe command-line options are case insensitive.</span></span> <span data-ttu-id="5295c-149">您只需要提供足夠的選項資訊，就可唯一識別該選項。</span><span class="sxs-lookup"><span data-stu-id="5295c-149">You only need to provide enough of the option to uniquely identify it.</span></span> <span data-ttu-id="5295c-150">例如，**/n** 相當於 **/nologo**，且 **/t:** *outfile.tlb* 相當於 **/tlb:** *outfile.tlb*。</span><span class="sxs-lookup"><span data-stu-id="5295c-150">For example, **/n** is equivalent to **/nologo** and **/t:** *outfile.tlb* is equivalent to **/tlb:** *outfile.tlb*.</span></span>

## <a name="remarks"></a><span data-ttu-id="5295c-151">備註</span><span class="sxs-lookup"><span data-stu-id="5295c-151">Remarks</span></span>

<span data-ttu-id="5295c-152">您可以使用 **/regfile** 選項產生包含登錄項目的 .reg 檔，而不是直接變更登錄。</span><span class="sxs-lookup"><span data-stu-id="5295c-152">You can use the **/regfile** option to generate a .reg file that contains the registry entries instead of making the changes directly to the registry.</span></span> <span data-ttu-id="5295c-153">您可以使用登錄編輯程式工具 (Regedit.exe) 匯入 .reg 檔，藉此更新電腦上的登錄。</span><span class="sxs-lookup"><span data-stu-id="5295c-153">You can update the registry on a computer by importing the .reg file with the Registry Editor tool (Regedit.exe).</span></span> <span data-ttu-id="5295c-154">.Reg 檔案不包含任何可由使用者定義的暫存器功能進行的登錄更新。</span><span class="sxs-lookup"><span data-stu-id="5295c-154">The .reg file does not contain any registry updates that can be made by user-defined register functions.</span></span> <span data-ttu-id="5295c-155">**/Regfile**選項只會發出 managed 類別的登錄專案。</span><span class="sxs-lookup"><span data-stu-id="5295c-155">The **/regfile** option only emits registry entries for managed classes.</span></span> <span data-ttu-id="5295c-156">這個選項不會發出 `TypeLibID` 或 `InterfaceID` 的項目。</span><span class="sxs-lookup"><span data-stu-id="5295c-156">This option does not emit entries for `TypeLibID`s or `InterfaceID`s.</span></span>

<span data-ttu-id="5295c-157">當您指定 **/tlb** 選項時，Regasm.exe 會產生及註冊型別程式庫，描述組件中找到的類型。</span><span class="sxs-lookup"><span data-stu-id="5295c-157">When you specify the **/tlb** option, Regasm.exe generates and registers a type library describing the types found in the assembly.</span></span> <span data-ttu-id="5295c-158">Regasm.exe 會將產生的類型程式庫放入目前的工作目錄中，或是為輸出檔指定的目錄中。</span><span class="sxs-lookup"><span data-stu-id="5295c-158">Regasm.exe places the generated type libraries in the current working directory or the directory specified for the output file.</span></span> <span data-ttu-id="5295c-159">為參考其他組件的組件產生類型程式庫可能導致一次產生多個類型程式庫。</span><span class="sxs-lookup"><span data-stu-id="5295c-159">Generating a type library for an assembly that references other assemblies may cause several type libraries to be generated at once.</span></span> <span data-ttu-id="5295c-160">您可以使用型別程式庫提供型別資訊給 Visual Studio 這類開發工具。</span><span class="sxs-lookup"><span data-stu-id="5295c-160">You can use the type library to provide type information to development tools like Visual Studio.</span></span> <span data-ttu-id="5295c-161">如果您要註冊的元件是由類型程式庫匯入工具（[Tlbimp.exe](tlbimp-exe-type-library-importer.md)）所產生，請勿使用 **/tlb**選項。</span><span class="sxs-lookup"><span data-stu-id="5295c-161">Don't use the **/tlb** option if the assembly you are registering was produced by the Type Library Importer ([Tlbimp.exe](tlbimp-exe-type-library-importer.md)).</span></span> <span data-ttu-id="5295c-162">您無法從原本自類型程式庫匯入的組件匯出類型程式庫。</span><span class="sxs-lookup"><span data-stu-id="5295c-162">You cannot export a type library from an assembly that was imported from a type library.</span></span> <span data-ttu-id="5295c-163">使用 **/tlb** 選項與使用類型程式庫匯出工具 ([Tlbexp.exe](tlbexp-exe-type-library-exporter.md)) 和 Regasm.exe 的效果相同，但是有一點除外，就是 Tlbexp.exe 不會註冊本身所產生的類型資料庫。</span><span class="sxs-lookup"><span data-stu-id="5295c-163">Using the **/tlb** option has the same effect as using the Type Library Exporter ([Tlbexp.exe](tlbexp-exe-type-library-exporter.md)) and Regasm.exe, with the exception that Tlbexp.exe does not register the type library it produces.</span></span>  <span data-ttu-id="5295c-164">如果您使用 **/tlb**選項註冊類型程式庫，您可以使用 **/tlb**選項搭配 **/unregister**選項來取消註冊類型程式庫。</span><span class="sxs-lookup"><span data-stu-id="5295c-164">If you use the **/tlb** option to register a type library, you can use the **/tlb** option with the **/unregister** option to unregister the type library.</span></span> <span data-ttu-id="5295c-165">這兩個選項一起使用時，將會移除類型程式庫和介面項目的註冊，因而大幅清除登錄。</span><span class="sxs-lookup"><span data-stu-id="5295c-165">Using the two options together will unregister the type library and interface entries, which can clean the registry considerably.</span></span>

<span data-ttu-id="5295c-166">當您註冊 COM 要使用的組件時，Regasm.exe 會將項目加入至本機電腦上的登錄。</span><span class="sxs-lookup"><span data-stu-id="5295c-166">When you register an assembly for use by COM, Regasm.exe adds entries to the registry on the local computer.</span></span> <span data-ttu-id="5295c-167">更精確地說，它會建立與版本相關的登錄機碼，允許相同組件的多個版本在電腦上並存執行。</span><span class="sxs-lookup"><span data-stu-id="5295c-167">More specifically, it creates version-dependent registry keys that allow multiple versions of the same assembly to run side by side on a computer.</span></span> <span data-ttu-id="5295c-168">第一次註冊元件時，會為元件建立一個最上層的索引鍵，並為特定版本建立唯一的子機碼。</span><span class="sxs-lookup"><span data-stu-id="5295c-168">The first time an assembly is registered, one top-level key is created for the assembly, and a unique subkey is created for the specific version.</span></span> <span data-ttu-id="5295c-169">每次您註冊新的組件版本時，Regasm.exe 就會為這個新的版本建立一個子機碼。</span><span class="sxs-lookup"><span data-stu-id="5295c-169">Each time you register a new version of the assembly, Regasm.exe creates a subkey for the new version.</span></span>

<span data-ttu-id="5295c-170">例如，假設您註冊 Managed 元件 myComp.dll 1.0.0.0 版以供 COM 使用。</span><span class="sxs-lookup"><span data-stu-id="5295c-170">For example, consider a scenario where you register the managed component, myComp.dll, version 1.0.0.0 for use by COM.</span></span> <span data-ttu-id="5295c-171">稍後您又註冊 myComp.dll 2.0.0.0 版。</span><span class="sxs-lookup"><span data-stu-id="5295c-171">Later, you register myComp.dll, version 2.0.0.0.</span></span> <span data-ttu-id="5295c-172">您決定讓電腦上的所有 COM 用戶端應用程式都使用 myComp.dll 2.0.0.0 版，並決定移除 myComponent.dll 1.0.0.0 版的註冊。</span><span class="sxs-lookup"><span data-stu-id="5295c-172">You determine that all COM client applications on the computer are using myComp.dll version 2.0.0.0 and you decide to unregister myComponent.dll version 1.0.0.0.</span></span> <span data-ttu-id="5295c-173">這項登錄配置可讓您移除 myComp.dll 1.0.0.0 版的註冊，因為只會移除 1.0.0.0 版的子機碼。</span><span class="sxs-lookup"><span data-stu-id="5295c-173">This registry scheme allows you to unregister myComp.dll version 1.0.0.0 because only the version 1.0.0.0 subkey is removed.</span></span>

<span data-ttu-id="5295c-174">使用 Regasm.exe 註冊組件之後，您可以將它安裝在[全域組件快取](../app-domains/gac.md)中，以便可以從任何 COM 用戶端將它啟用。</span><span class="sxs-lookup"><span data-stu-id="5295c-174">After registering an assembly using Regasm.exe, you can install it in the [global assembly cache](../app-domains/gac.md) so that it can be activated from any COM client.</span></span> <span data-ttu-id="5295c-175">如果組件將只會由單一應用程式啟用，您可以將它放置到該應用程式的目錄中。</span><span class="sxs-lookup"><span data-stu-id="5295c-175">If the assembly is only going to be activated by a single application, you can place it in that application's directory.</span></span>

## <a name="examples"></a><span data-ttu-id="5295c-176">範例</span><span class="sxs-lookup"><span data-stu-id="5295c-176">Examples</span></span>

<span data-ttu-id="5295c-177">下列命令會註冊所有包含在 `myTest.dll` 中的公用類別。</span><span class="sxs-lookup"><span data-stu-id="5295c-177">The following command registers all public classes contained in `myTest.dll`.</span></span>

```console
regasm myTest.dll
```

<span data-ttu-id="5295c-178">下列命令會產生 `myTest.reg` 檔案，該檔案中包含所有必要的登錄項目。</span><span class="sxs-lookup"><span data-stu-id="5295c-178">The following command generates the file `myTest.reg`, which contains all the necessary registry entries.</span></span> <span data-ttu-id="5295c-179">這個命令不會更新登錄。</span><span class="sxs-lookup"><span data-stu-id="5295c-179">This command does not update the registry.</span></span>

```console
regasm myTest.dll /regfile:myTest.reg
```

<span data-ttu-id="5295c-180">下列命令會註冊包含在 `myTest.dll` 檔中的所有公用類別，並且產生和註冊 `myTest.tlb` 類型程式庫，其中包含所有在 `myTest.dll` 中定義之公用類型的定義。</span><span class="sxs-lookup"><span data-stu-id="5295c-180">The following command registers all public classes contained in `myTest.dll`, and generates and registers the type library `myTest.tlb`, which contains definitions of all the public types defined in `myTest.dll`.</span></span>

```console
regasm myTest.dll /tlb:myTest.tlb
```

## <a name="see-also"></a><span data-ttu-id="5295c-181">另請參閱</span><span class="sxs-lookup"><span data-stu-id="5295c-181">See also</span></span>

- [<span data-ttu-id="5295c-182">工具</span><span class="sxs-lookup"><span data-stu-id="5295c-182">Tools</span></span>](index.md)
- [<span data-ttu-id="5295c-183">Tlbexp.exe （類型程式庫匯出工具）</span><span class="sxs-lookup"><span data-stu-id="5295c-183">Tlbexp.exe (Type Library Exporter)</span></span>](tlbexp-exe-type-library-exporter.md)
- [<span data-ttu-id="5295c-184">Tlbimp.exe （類型程式庫匯入工具）</span><span class="sxs-lookup"><span data-stu-id="5295c-184">Tlbimp.exe (Type Library Importer)</span></span>](tlbimp-exe-type-library-importer.md)
- [<span data-ttu-id="5295c-185">向 COM 註冊組件</span><span class="sxs-lookup"><span data-stu-id="5295c-185">Registering Assemblies with COM</span></span>](../interop/registering-assemblies-with-com.md)
- [<span data-ttu-id="5295c-186">命令提示字元</span><span class="sxs-lookup"><span data-stu-id="5295c-186">Command Prompts</span></span>](developer-command-prompt-for-vs.md)

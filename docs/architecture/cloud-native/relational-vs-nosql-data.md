---
title: 關聯式與NoSQL 資料
description: 瞭解雲端原生應用程式中的關聯式和 NoSQL 資料
author: robvet
ms.date: 05/17/2020
ms.openlocfilehash: 11db5cdca06b9c2c8ce12598456c4b147ac379ba
ms.sourcegitcommit: 98d20cb038669dca4a195eb39af37d22ea9d008e
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/22/2020
ms.locfileid: "92434865"
---
# <a name="relational-vs-nosql-data"></a><span data-ttu-id="fd775-103">關聯式與NoSQL 資料</span><span class="sxs-lookup"><span data-stu-id="fd775-103">Relational vs. NoSQL data</span></span>

<span data-ttu-id="fd775-104">關聯式和 NoSQL 是在雲端原生應用程式中通常會實作為兩種類型的資料庫系統。</span><span class="sxs-lookup"><span data-stu-id="fd775-104">Relational and NoSQL are two types of database systems commonly implemented in cloud-native apps.</span></span> <span data-ttu-id="fd775-105">它們的建立方式不同，以不同的方式儲存資料，並以不同的方式存取。</span><span class="sxs-lookup"><span data-stu-id="fd775-105">They're built differently, store data differently, and accessed differently.</span></span> <span data-ttu-id="fd775-106">在本節中，我們將探討這兩者。</span><span class="sxs-lookup"><span data-stu-id="fd775-106">In this section, we'll look at both.</span></span> <span data-ttu-id="fd775-107">在本章稍後，我們將探討稱為 *NewSQL*的新興資料庫技術。</span><span class="sxs-lookup"><span data-stu-id="fd775-107">Later in this chapter, we'll look at an emerging database technology called *NewSQL*.</span></span>

<span data-ttu-id="fd775-108">*關係資料庫* 是數十年來的普遍技術。</span><span class="sxs-lookup"><span data-stu-id="fd775-108">*Relational databases* have been a prevalent technology for decades.</span></span> <span data-ttu-id="fd775-109">這些都是成熟、證明且廣泛實行的。</span><span class="sxs-lookup"><span data-stu-id="fd775-109">They're mature, proven, and widely implemented.</span></span> <span data-ttu-id="fd775-110">競爭的資料庫產品、工具和專業知識為數眾多。</span><span class="sxs-lookup"><span data-stu-id="fd775-110">Competing database products, tooling, and expertise abound.</span></span> <span data-ttu-id="fd775-111">關係資料庫會提供相關資料表的存放區。</span><span class="sxs-lookup"><span data-stu-id="fd775-111">Relational databases provide a store of related data tables.</span></span> <span data-ttu-id="fd775-112">這些資料表有固定的架構、使用 SQL (結構化查詢語言 (SQL) ) 來管理資料，並支援 ACID 保證。</span><span class="sxs-lookup"><span data-stu-id="fd775-112">These tables have a fixed schema, use SQL (Structured Query Language) to manage data, and support ACID guarantees.</span></span>

<span data-ttu-id="fd775-113">*無 SQL 資料庫* 是指高效能、非關聯式資料存放區。</span><span class="sxs-lookup"><span data-stu-id="fd775-113">*No-SQL databases* refer to high-performance, non-relational data stores.</span></span> <span data-ttu-id="fd775-114">他們以易用性、可調整性、彈性和可用性等特性的方式使用 excel。</span><span class="sxs-lookup"><span data-stu-id="fd775-114">They excel in their ease-of-use, scalability, resilience, and availability characteristics.</span></span> <span data-ttu-id="fd775-115">NoSQL 會儲存非結構化或半結構化的資料，而不是聯結正規化資料的資料表，通常是在機碼值組或 JSON 檔中。</span><span class="sxs-lookup"><span data-stu-id="fd775-115">Instead of joining tables of normalized data, NoSQL stores unstructured or semi-structured data, often in key-value pairs or JSON documents.</span></span> <span data-ttu-id="fd775-116">非 SQL 資料庫通常不會提供超過單一資料庫分割範圍的 ACID 保證。</span><span class="sxs-lookup"><span data-stu-id="fd775-116">No-SQL databases typically don't provide ACID guarantees beyond the scope of a single database partition.</span></span> <span data-ttu-id="fd775-117">需要第二次回應時間的大量服務需要 NoSQL 資料存放區。</span><span class="sxs-lookup"><span data-stu-id="fd775-117">High volume services that require sub second response time favor NoSQL datastores.</span></span>

<span data-ttu-id="fd775-118">[NoSQL](https://www.geeksforgeeks.org/introduction-to-nosql/)技術對於分散式雲端原生系統的影響無法過。</span><span class="sxs-lookup"><span data-stu-id="fd775-118">The impact of [NoSQL](https://www.geeksforgeeks.org/introduction-to-nosql/) technologies for distributed cloud-native systems can't be overstated.</span></span> <span data-ttu-id="fd775-119">在此空間中，新資料技術的激增，會中斷以獨佔方式依賴關係資料庫的解決方案。</span><span class="sxs-lookup"><span data-stu-id="fd775-119">The proliferation of new data technologies in this space has disrupted solutions that once exclusively relied on relational databases.</span></span>

<span data-ttu-id="fd775-120">NoSQL 資料庫包含數種不同的模型來存取和管理資料，每個都適合特定的使用案例。</span><span class="sxs-lookup"><span data-stu-id="fd775-120">NoSQL databases include several different models for accessing and managing data, each suited to specific use cases.</span></span> <span data-ttu-id="fd775-121">圖5-9 提供四個常見的模型。</span><span class="sxs-lookup"><span data-stu-id="fd775-121">Figure 5-9 presents four common models.</span></span>

![NoSQL 資料模型](./media/types-of-nosql-datastores.png)

<span data-ttu-id="fd775-123">**圖 5-9**： NoSQL 資料庫的資料模型</span><span class="sxs-lookup"><span data-stu-id="fd775-123">**Figure 5-9**: Data models for NoSQL databases</span></span>

| <span data-ttu-id="fd775-124">型號</span><span class="sxs-lookup"><span data-stu-id="fd775-124">Model</span></span> | <span data-ttu-id="fd775-125">特性</span><span class="sxs-lookup"><span data-stu-id="fd775-125">Characteristics</span></span> |
| :-------- | :-------- |
| <span data-ttu-id="fd775-126">文件存放區</span><span class="sxs-lookup"><span data-stu-id="fd775-126">Document Store</span></span> | <span data-ttu-id="fd775-127">資料和中繼資料會以階層方式儲存在資料庫內以 JSON 為基礎的檔中。</span><span class="sxs-lookup"><span data-stu-id="fd775-127">Data and metadata are stored hierarchically in JSON-based documents inside the database.</span></span> |
| <span data-ttu-id="fd775-128">機碼值存放區</span><span class="sxs-lookup"><span data-stu-id="fd775-128">Key Value Store</span></span> | <span data-ttu-id="fd775-129">NoSQL 資料庫最簡單的資料會以索引鍵/值組的集合表示。</span><span class="sxs-lookup"><span data-stu-id="fd775-129">The simplest of the NoSQL databases, data is represented as a collection of key-value pairs.</span></span> |
| <span data-ttu-id="fd775-130">Wide-Column 存放區</span><span class="sxs-lookup"><span data-stu-id="fd775-130">Wide-Column Store</span></span> | <span data-ttu-id="fd775-131">相關資料會以一組嵌套索引鍵/值組的形式儲存在單一資料行中。</span><span class="sxs-lookup"><span data-stu-id="fd775-131">Related data is stored as a set of nested-key/value pairs within a single column.</span></span> |
| <span data-ttu-id="fd775-132">圖形存放區</span><span class="sxs-lookup"><span data-stu-id="fd775-132">Graph Store</span></span> | <span data-ttu-id="fd775-133">資料會以節點、邊緣和資料屬性的形式儲存在圖形結構中。</span><span class="sxs-lookup"><span data-stu-id="fd775-133">Data is stored in a graph structure as node, edge, and data properties.</span></span> |

## <a name="the-cap-theorem"></a><span data-ttu-id="fd775-134">端點定理</span><span class="sxs-lookup"><span data-stu-id="fd775-134">The CAP theorem</span></span>

<span data-ttu-id="fd775-135">若要瞭解這些資料庫類型之間的差異，請考慮 CAP 定理，這是一組套用至儲存狀態之分散式系統的原則。</span><span class="sxs-lookup"><span data-stu-id="fd775-135">As a way to understand the differences between these types of databases, consider the CAP theorem, a set of principles applied to distributed systems that store state.</span></span> <span data-ttu-id="fd775-136">圖5-10 顯示端點定理的三個屬性。</span><span class="sxs-lookup"><span data-stu-id="fd775-136">Figure 5-10 shows the three properties of the CAP theorem.</span></span>

![CAP 定理](./media/cap-theorem.png)

<span data-ttu-id="fd775-138">**圖 5-10**。</span><span class="sxs-lookup"><span data-stu-id="fd775-138">**Figure 5-10**.</span></span> <span data-ttu-id="fd775-139">端點定理</span><span class="sxs-lookup"><span data-stu-id="fd775-139">The CAP theorem</span></span>

<span data-ttu-id="fd775-140">定理指出分散式資料系統將會提供一致性、可用性和分割區容錯之間的取捨。</span><span class="sxs-lookup"><span data-stu-id="fd775-140">The theorem states that distributed data systems will offer a trade-off between consistency, availability, and partition tolerance.</span></span> <span data-ttu-id="fd775-141">而且，任何資料庫都只能保證三個屬性的其中 *兩個* ：</span><span class="sxs-lookup"><span data-stu-id="fd775-141">And, that any database can only guarantee *two* of the three properties:</span></span>

- <span data-ttu-id="fd775-142">*一致性。*</span><span class="sxs-lookup"><span data-stu-id="fd775-142">*Consistency.*</span></span> <span data-ttu-id="fd775-143">叢集中的每個節點都會以最新的資料回應，即使系統必須封鎖要求，直到所有複本更新為止。</span><span class="sxs-lookup"><span data-stu-id="fd775-143">Every node in the cluster responds with the most recent data, even if the system must block the request until all replicas update.</span></span> <span data-ttu-id="fd775-144">如果您針對目前正在更新的專案查詢「一致的系統」，您將會等候該回應，直到所有複本都成功更新為止。</span><span class="sxs-lookup"><span data-stu-id="fd775-144">If you query a "consistent system" for an item that is currently updating, you'll wait for that response until all replicas successfully update.</span></span> <span data-ttu-id="fd775-145">不過，您將會收到最新的資料。</span><span class="sxs-lookup"><span data-stu-id="fd775-145">However, you'll receive the most current data.</span></span>

- <span data-ttu-id="fd775-146">*可用 性。*</span><span class="sxs-lookup"><span data-stu-id="fd775-146">*Availability.*</span></span> <span data-ttu-id="fd775-147">每個節點都會傳回立即回應，即使該回應不是最新的資料。</span><span class="sxs-lookup"><span data-stu-id="fd775-147">Every node returns an immediate response, even if that response isn't the most recent data.</span></span> <span data-ttu-id="fd775-148">如果您查詢「可用的系統」以取得正在更新的專案，您將會得到最可能的答案，也就是服務可以在當時提供的答案。</span><span class="sxs-lookup"><span data-stu-id="fd775-148">If you query an "available system" for an item that is updating, you'll get the best possible answer the service can provide at that moment.</span></span>

- <span data-ttu-id="fd775-149">*資料分割容錯。*</span><span class="sxs-lookup"><span data-stu-id="fd775-149">*Partition Tolerance.*</span></span> <span data-ttu-id="fd775-150">保證即使複寫的資料節點失敗或失去與其他複寫資料節點的連接，系統仍會繼續運作。</span><span class="sxs-lookup"><span data-stu-id="fd775-150">Guarantees the system continues to operate even if a replicated data node fails or loses connectivity with other replicated data nodes.</span></span>

<span data-ttu-id="fd775-151">關係資料庫通常會提供一致性和可用性，但不會提供資料分割容錯。</span><span class="sxs-lookup"><span data-stu-id="fd775-151">Relational databases typically provide consistency and availability, but not partition tolerance.</span></span> <span data-ttu-id="fd775-152">它們通常會布建到單一伺服器，並藉由將更多資源新增至電腦來垂直調整。</span><span class="sxs-lookup"><span data-stu-id="fd775-152">They're typically provisioned to a single server and scale vertically by adding more resources to the machine.</span></span>

<span data-ttu-id="fd775-153">許多關係資料庫系統都支援內建的複寫功能，也就是可以對其他次要伺服器實例建立主資料庫的複本。</span><span class="sxs-lookup"><span data-stu-id="fd775-153">Many relational database systems support built-in replication features where copies of the primary database can be made to other secondary server instances.</span></span> <span data-ttu-id="fd775-154">系統會對主要實例進行寫入作業，並將其複寫到每個次要複本。</span><span class="sxs-lookup"><span data-stu-id="fd775-154">Write operations are made to the primary instance and replicated to each of the secondaries.</span></span> <span data-ttu-id="fd775-155">失敗時，主要實例可以容錯移轉至次要資料庫，以提供高可用性。</span><span class="sxs-lookup"><span data-stu-id="fd775-155">Upon a failure, the primary instance can fail over to a secondary to provide high availability.</span></span> <span data-ttu-id="fd775-156">次要複本也可以用來散發讀取作業。</span><span class="sxs-lookup"><span data-stu-id="fd775-156">Secondaries can also be used to distribute read operations.</span></span> <span data-ttu-id="fd775-157">雖然寫入作業一律會針對主要複本進行，但是讀取作業可以路由傳送至任何次要複本，以減少系統負載。</span><span class="sxs-lookup"><span data-stu-id="fd775-157">While writes operations always go against the primary replica, read operations can be routed to any of the secondaries to reduce system load.</span></span>

<span data-ttu-id="fd775-158">資料也可以跨多個節點進行水準分割，例如使用 [分區化](/azure/sql-database/sql-database-elastic-scale-introduction)。</span><span class="sxs-lookup"><span data-stu-id="fd775-158">Data can also be horizontally partitioned across multiple nodes, such as with [sharding](/azure/sql-database/sql-database-elastic-scale-introduction).</span></span> <span data-ttu-id="fd775-159">但是，分區化會在無法輕鬆通訊的許多片段之間分隔資料，以大幅增加作業的額外負荷。</span><span class="sxs-lookup"><span data-stu-id="fd775-159">But, sharding dramatically increases operational overhead by spitting data across many pieces that cannot easily communicate.</span></span> <span data-ttu-id="fd775-160">管理成本可能很高且耗時。</span><span class="sxs-lookup"><span data-stu-id="fd775-160">It can be costly and time consuming to manage.</span></span> <span data-ttu-id="fd775-161">最後可能會影響效能、資料表聯結和參考完整性。</span><span class="sxs-lookup"><span data-stu-id="fd775-161">It can end up impacting performance, table joins, and referential integrity.</span></span>

<span data-ttu-id="fd775-162">如果資料複本在「高度一致」的關係資料庫叢集中遺失網路連線能力，您將無法寫入資料庫。</span><span class="sxs-lookup"><span data-stu-id="fd775-162">If data replicas were to lose network connectivity in a "highly consistent" relational database cluster, you wouldn't be able to write to the database.</span></span> <span data-ttu-id="fd775-163">系統會拒絕寫入作業，因為它無法將變更複寫到其他資料複本。</span><span class="sxs-lookup"><span data-stu-id="fd775-163">The system would reject the write operation as it can't replicate that change to the other data replica.</span></span> <span data-ttu-id="fd775-164">每個資料複本都必須更新，才能完成交易。</span><span class="sxs-lookup"><span data-stu-id="fd775-164">Every data replica has to update before the transaction can complete.</span></span>

<span data-ttu-id="fd775-165">NoSQL 資料庫通常會支援高可用性和資料分割容錯。</span><span class="sxs-lookup"><span data-stu-id="fd775-165">NoSQL databases typically support high availability and partition tolerance.</span></span> <span data-ttu-id="fd775-166">它們會水準水準延展，通常是在商用伺服器上進行擴充。</span><span class="sxs-lookup"><span data-stu-id="fd775-166">They scale out horizontally, often across commodity servers.</span></span> <span data-ttu-id="fd775-167">這種方法可讓您以較低的成本，在地理區域內和跨地區提供極高的可用性。</span><span class="sxs-lookup"><span data-stu-id="fd775-167">This approach provides tremendous availability, both within and across geographical regions at a reduced cost.</span></span> <span data-ttu-id="fd775-168">您可以在這些機器或節點之間分割及複寫資料，以提供冗余和容錯功能。</span><span class="sxs-lookup"><span data-stu-id="fd775-168">You partition and replicate data across these machines, or nodes, providing redundancy and fault tolerance.</span></span> <span data-ttu-id="fd775-169">缺點是一致的。</span><span class="sxs-lookup"><span data-stu-id="fd775-169">The downside is consistency.</span></span> <span data-ttu-id="fd775-170">變更一個 NoSQL 節點上的資料可能需要一些時間才能傳播到其他節點。</span><span class="sxs-lookup"><span data-stu-id="fd775-170">A change to data on one NoSQL node can take some time to propagate to other nodes.</span></span> <span data-ttu-id="fd775-171">一般來說，NoSQL 資料庫節點會提供對查詢的立即回應，即使呈現的資料已過時且尚未更新也是一樣。</span><span class="sxs-lookup"><span data-stu-id="fd775-171">Typically, a NoSQL database node will provide an immediate response to a query - even if the data that is presented is stale and hasn't updated yet.</span></span>

<span data-ttu-id="fd775-172">如果資料複本遺失「高可用性」 NoSQL 資料庫叢集中的連線能力，您仍然可以完成對資料庫的寫入操作。</span><span class="sxs-lookup"><span data-stu-id="fd775-172">If data replicas were to lose connectivity in a "highly available" NoSQL database cluster, you could still complete a write operation to the database.</span></span> <span data-ttu-id="fd775-173">資料庫叢集會允許寫入作業，並在每個資料複本可用時加以更新。</span><span class="sxs-lookup"><span data-stu-id="fd775-173">The database cluster would allow the write operation and update each data replica as it becomes available.</span></span>

<span data-ttu-id="fd775-174">這類結果稱為「最終一致性」，這是不支援 ACID 交易的分散式資料系統特性。</span><span class="sxs-lookup"><span data-stu-id="fd775-174">This kind of result is known as eventual consistency, a characteristic of distributed data systems where ACID transactions aren't supported.</span></span> <span data-ttu-id="fd775-175">這是資料項目目更新與將該更新傳播到每個複本節點所需的時間之間的短暫延遲。</span><span class="sxs-lookup"><span data-stu-id="fd775-175">It's a brief delay between the update of a data item and time that it takes to propagate that update to each of the replica nodes.</span></span> <span data-ttu-id="fd775-176">在正常狀況下，延遲通常很短，但在發生問題時可能會增加。</span><span class="sxs-lookup"><span data-stu-id="fd775-176">Under normal conditions, the lag is typically short, but can increase when problems arise.</span></span> <span data-ttu-id="fd775-177">例如，如果您要更新美國 NoSQL 資料庫中的產品專案，並且從歐洲的複本節點查詢相同資料項目時，會發生什麼事？</span><span class="sxs-lookup"><span data-stu-id="fd775-177">For example, what would happen if you were to update a product item in a NoSQL database in the United States and query that same data item from a replica node in Europe?</span></span> <span data-ttu-id="fd775-178">您會收到先前的產品資訊，直到叢集以產品變更更新歐洲節點為止。</span><span class="sxs-lookup"><span data-stu-id="fd775-178">You would receive the earlier product information, until the cluster updates the European node with the product change.</span></span> <span data-ttu-id="fd775-179">藉由立即傳回查詢結果，而不是等待所有複本節點進行更新，您可以取得龐大的規模和量，但有可能呈現較舊的資料。</span><span class="sxs-lookup"><span data-stu-id="fd775-179">By immediately returning a query result and not waiting for all replica nodes to update, you gain enormous scale and volume, but with the possibility of presenting older data.</span></span>

<span data-ttu-id="fd775-180">高可用性和大規模的擴充性對於企業來說，通常比強式一致性更為重要。</span><span class="sxs-lookup"><span data-stu-id="fd775-180">High availability and massive scalability are often more critical to the business than strong consistency.</span></span> <span data-ttu-id="fd775-181">開發人員可以實行 Sagas 故事、CQRS 和非同步訊息等技術與模式，以採用最終一致性。</span><span class="sxs-lookup"><span data-stu-id="fd775-181">Developers can implement techniques and patterns such as Sagas, CQRS, and asynchronous messaging to embrace eventual consistency.</span></span>

> <span data-ttu-id="fd775-182">現今，在考慮 CAP 定理條件約束時必須小心。</span><span class="sxs-lookup"><span data-stu-id="fd775-182">Nowadays, care must be taken when considering the CAP theorem constraints.</span></span> <span data-ttu-id="fd775-183">有一種新的資料庫類型，稱為 NewSQL，它會擴充關係資料庫引擎，以同時支援 NoSQL 系統的水準擴充性和可調整的效能。</span><span class="sxs-lookup"><span data-stu-id="fd775-183">A new type of database, called NewSQL, has emerged which extends the relational database engine to support both horizontal scalability and the scalable performance of NoSQL systems.</span></span>

## <a name="considerations-for-relational-vs-nosql-systems"></a><span data-ttu-id="fd775-184">關聯式與 NoSQL 系統的考慮</span><span class="sxs-lookup"><span data-stu-id="fd775-184">Considerations for relational vs. NoSQL systems</span></span>

<span data-ttu-id="fd775-185">根據特定的資料需求，雲端原生的微服務可以執行關聯式、NoSQL 資料存放區或兩者。</span><span class="sxs-lookup"><span data-stu-id="fd775-185">Based upon specific data requirements, a cloud-native-based microservice can implement a relational, NoSQL datastore or both.</span></span>

|  <span data-ttu-id="fd775-186">當下列情況時，請考慮 NoSQL 資料存放區：</span><span class="sxs-lookup"><span data-stu-id="fd775-186">Consider a NoSQL datastore when:</span></span> | <span data-ttu-id="fd775-187">當下列情況時，請考慮關係資料庫：</span><span class="sxs-lookup"><span data-stu-id="fd775-187">Consider a relational database when:</span></span> |
| :-------- | :-------- |
| <span data-ttu-id="fd775-188">您的大量工作負載需要大規模</span><span class="sxs-lookup"><span data-stu-id="fd775-188">You have high volume workloads that require large scale</span></span> | <span data-ttu-id="fd775-189">您的工作負載磁片區一致，需要中型到大型規模</span><span class="sxs-lookup"><span data-stu-id="fd775-189">Your workload volume is consistent and requires medium to large scale</span></span> |
| <span data-ttu-id="fd775-190">您的工作負載不需要 ACID 保證</span><span class="sxs-lookup"><span data-stu-id="fd775-190">Your workloads don't require ACID guarantees</span></span> |  <span data-ttu-id="fd775-191">需要 ACID 保證</span><span class="sxs-lookup"><span data-stu-id="fd775-191">ACID guarantees are required</span></span> |
| <span data-ttu-id="fd775-192">您的資料是動態且經常變更</span><span class="sxs-lookup"><span data-stu-id="fd775-192">Your data is dynamic and frequently changes</span></span> | <span data-ttu-id="fd775-193">您的資料是可預測且高度結構化</span><span class="sxs-lookup"><span data-stu-id="fd775-193">Your data is predictable and highly structured</span></span> |
| <span data-ttu-id="fd775-194">資料可以不具關聯性表示</span><span class="sxs-lookup"><span data-stu-id="fd775-194">Data can be expressed without relationships</span></span> | <span data-ttu-id="fd775-195">資料的最佳表示 relationally</span><span class="sxs-lookup"><span data-stu-id="fd775-195">Data is best expressed relationally</span></span> |  
| <span data-ttu-id="fd775-196">您需要快速寫入和寫入安全性並不重要</span><span class="sxs-lookup"><span data-stu-id="fd775-196">You need fast writes and write safety isn't critical</span></span> | <span data-ttu-id="fd775-197">需要撰寫安全性</span><span class="sxs-lookup"><span data-stu-id="fd775-197">Write safety is a requirement</span></span> |  
| <span data-ttu-id="fd775-198">資料抓取很簡單，且通常是一般的</span><span class="sxs-lookup"><span data-stu-id="fd775-198">Data retrieval is simple and tends to be flat</span></span> | <span data-ttu-id="fd775-199">您使用複雜的查詢和報表</span><span class="sxs-lookup"><span data-stu-id="fd775-199">You work with complex queries and reports</span></span>|
| <span data-ttu-id="fd775-200">您的資料需要廣泛的地理分佈</span><span class="sxs-lookup"><span data-stu-id="fd775-200">Your data requires a wide geographic distribution</span></span> | <span data-ttu-id="fd775-201">您的使用者更集中</span><span class="sxs-lookup"><span data-stu-id="fd775-201">Your users are more centralized</span></span> |
| <span data-ttu-id="fd775-202">您的應用程式將會部署到商用硬體，例如使用公用雲端</span><span class="sxs-lookup"><span data-stu-id="fd775-202">Your application will be deployed to commodity hardware, such as with public clouds</span></span> | <span data-ttu-id="fd775-203">您的應用程式將會部署到大型、高階硬體</span><span class="sxs-lookup"><span data-stu-id="fd775-203">Your application will be deployed to large, high-end hardware</span></span> |

<span data-ttu-id="fd775-204">在接下來的幾節中，我們將探索 Azure 雲端中可用的選項，以儲存和管理您的雲端原生資料。</span><span class="sxs-lookup"><span data-stu-id="fd775-204">In the next sections, we'll explore the options available in the Azure cloud for storing and managing your cloud-native data.</span></span>

## <a name="database-as-a-service"></a><span data-ttu-id="fd775-205">資料庫為服務</span><span class="sxs-lookup"><span data-stu-id="fd775-205">Database as a Service</span></span>

<span data-ttu-id="fd775-206">若要開始，您可以布建 Azure 虛擬機器，並為每個服務安裝您選擇的資料庫。</span><span class="sxs-lookup"><span data-stu-id="fd775-206">To start, you could provision an Azure virtual machine and install your database of choice for each service.</span></span> <span data-ttu-id="fd775-207">雖然您可以完全掌控您的環境，但您會放棄雲端平臺的許多內建功能。</span><span class="sxs-lookup"><span data-stu-id="fd775-207">While you'd have full control over the environment, you'd forgo many built-in features of the cloud platform.</span></span> <span data-ttu-id="fd775-208">您也必須負責管理每個服務的虛擬機器和資料庫。</span><span class="sxs-lookup"><span data-stu-id="fd775-208">You'd also be responsible for managing the virtual machine and database for each service.</span></span> <span data-ttu-id="fd775-209">這種方法很快就會耗費時間和成本。</span><span class="sxs-lookup"><span data-stu-id="fd775-209">This approach could quickly become time-consuming and expensive.</span></span>

<span data-ttu-id="fd775-210">取而代之的是，雲端原生應用程式偏好以 [資料庫即服務形式 ](https://www.stratoscale.com/blog/dbaas/what-is-database-as-a-service/)公開的資料服務 (DBaaS) 。</span><span class="sxs-lookup"><span data-stu-id="fd775-210">Instead, cloud-native applications favor data services exposed as a [Database as a Service (DBaaS)](https://www.stratoscale.com/blog/dbaas/what-is-database-as-a-service/).</span></span> <span data-ttu-id="fd775-211">這些服務完全由雲端廠商管理，提供內建的安全性、擴充性和監視功能。</span><span class="sxs-lookup"><span data-stu-id="fd775-211">Fully managed by a cloud vendor, these services provide built-in security, scalability, and monitoring.</span></span> <span data-ttu-id="fd775-212">您只需將服務作為 [支援服務](./definition.md#backing-services)使用，而不是擁有服務。</span><span class="sxs-lookup"><span data-stu-id="fd775-212">Instead of owning the service, you simply consume it as a [backing service](./definition.md#backing-services).</span></span> <span data-ttu-id="fd775-213">此提供者會大規模地操作資源，並承擔效能和維護的責任。</span><span class="sxs-lookup"><span data-stu-id="fd775-213">The provider operates the resource at scale and bears the responsibility for performance and maintenance.</span></span>

<span data-ttu-id="fd775-214">您可以跨雲端可用性區域和區域設定這些設定，以達成高可用性。</span><span class="sxs-lookup"><span data-stu-id="fd775-214">They can be configured across cloud availability zones and regions to achieve high availability.</span></span> <span data-ttu-id="fd775-215">它們全都支援即時容量和隨用隨付模型。</span><span class="sxs-lookup"><span data-stu-id="fd775-215">They all support just-in-time capacity and a pay-as-you-go model.</span></span> <span data-ttu-id="fd775-216">Azure 具有不同種類的受控資料服務選項，每個選項都有特定的優點。</span><span class="sxs-lookup"><span data-stu-id="fd775-216">Azure features different kinds of managed data service options, each with specific benefits.</span></span>

<span data-ttu-id="fd775-217">我們會先查看 Azure 中可用的關聯式 DBaaS 服務。</span><span class="sxs-lookup"><span data-stu-id="fd775-217">We'll first look at relational DBaaS services available in Azure.</span></span> <span data-ttu-id="fd775-218">您會看到 Microsoft 的旗艦 SQL Server 資料庫與數個開放原始碼選項搭配使用。</span><span class="sxs-lookup"><span data-stu-id="fd775-218">You'll see that Microsoft's flagship SQL Server database is available along with several open-source options.</span></span> <span data-ttu-id="fd775-219">然後，我們將討論 Azure 中的 NoSQL 資料服務。</span><span class="sxs-lookup"><span data-stu-id="fd775-219">Then, we'll talk about the NoSQL data services in Azure.</span></span>

## <a name="azure-relational-databases"></a><span data-ttu-id="fd775-220">Azure 關係資料庫</span><span class="sxs-lookup"><span data-stu-id="fd775-220">Azure relational databases</span></span>

<span data-ttu-id="fd775-221">對於需要關聯式資料的雲端原生微服務，Azure 提供四個受控關係資料庫即服務 (DBaaS) 供應專案，如圖5-11 所示。</span><span class="sxs-lookup"><span data-stu-id="fd775-221">For cloud-native microservices that require relational data, Azure offers four managed relational databases as a service (DBaaS) offerings, shown in Figure 5-11.</span></span>

![Azure 中的受控關係資料庫](./media/azure-managed-databases.png)

<span data-ttu-id="fd775-223">**圖 5-11**。</span><span class="sxs-lookup"><span data-stu-id="fd775-223">**Figure 5-11**.</span></span> <span data-ttu-id="fd775-224">Azure 中可用的受控關係資料庫</span><span class="sxs-lookup"><span data-stu-id="fd775-224">Managed relational databases available in Azure</span></span>

<span data-ttu-id="fd775-225">在上圖中，請注意，每一個都位於一般的 DBaaS 基礎結構上，其具有不需額外成本的重要功能。</span><span class="sxs-lookup"><span data-stu-id="fd775-225">In the previous figure, note how each sits upon a common DBaaS infrastructure which features key capabilities at no additional cost.</span></span>

<span data-ttu-id="fd775-226">這些功能對於布建大量資料庫，但具有有限資源來管理這些資料庫的組織而言尤其重要。</span><span class="sxs-lookup"><span data-stu-id="fd775-226">These features are especially important to organizations who provision large numbers of databases, but have limited resources to administer them.</span></span>
<span data-ttu-id="fd775-227">您可以藉由選取處理核心、記憶體和基礎儲存體的數量，在幾分鐘內布建 Azure 資料庫。</span><span class="sxs-lookup"><span data-stu-id="fd775-227">You can provision an Azure database in minutes by selecting the amount of processing cores, memory, and underlying storage.</span></span> <span data-ttu-id="fd775-228">您可以即時調整資料庫，並以幾乎不停機的方式動態調整資源。</span><span class="sxs-lookup"><span data-stu-id="fd775-228">You can scale the database on-the-fly and dynamically adjust resources with little to no downtime.</span></span>

## <a name="azure-sql-database"></a><span data-ttu-id="fd775-229">Azure SQL Database</span><span class="sxs-lookup"><span data-stu-id="fd775-229">Azure SQL Database</span></span>

<span data-ttu-id="fd775-230">具有 Microsoft SQL Server 專長的開發小組應該考慮 [Azure SQL Database](/azure/sql-database/)。</span><span class="sxs-lookup"><span data-stu-id="fd775-230">Development teams with expertise in Microsoft SQL Server should consider [Azure SQL Database](/azure/sql-database/).</span></span> <span data-ttu-id="fd775-231">它是完全受控的關係資料庫即服務， (根據 Microsoft SQL Server 資料庫引擎 DBaaS) 。</span><span class="sxs-lookup"><span data-stu-id="fd775-231">It's a fully managed relational database-as-a-service (DBaaS) based on the Microsoft SQL Server Database Engine.</span></span> <span data-ttu-id="fd775-232">服務會共用 SQL Server 內部部署版本中的許多功能，並執行 SQL Server 資料庫引擎的最新穩定版本。</span><span class="sxs-lookup"><span data-stu-id="fd775-232">The service shares many features found in the on-premises version of SQL Server and runs the latest stable version of the SQL Server Database Engine.</span></span>

<span data-ttu-id="fd775-233">適用于雲端原生微服務的 Azure SQL Database 可透過三種部署選項來使用：</span><span class="sxs-lookup"><span data-stu-id="fd775-233">For use with a cloud-native microservice, Azure SQL Database is available with three deployment options:</span></span>

- <span data-ttu-id="fd775-234">單一資料庫代表在 Azure 雲端的 [Azure SQL Database 伺服器](/azure/sql-database/sql-database-servers) 上執行的完全受控 SQL Database。</span><span class="sxs-lookup"><span data-stu-id="fd775-234">A Single Database represents a fully managed SQL Database running on an [Azure SQL Database server](/azure/sql-database/sql-database-servers) in the Azure cloud.</span></span> <span data-ttu-id="fd775-235">資料庫會被視為 [*包含*](/sql/relational-databases/databases/contained-databases) ，因為它在基礎資料庫伺服器上沒有設定相依性。</span><span class="sxs-lookup"><span data-stu-id="fd775-235">The database is considered [*contained*](/sql/relational-databases/databases/contained-databases) as it has no configuration dependencies on the underlying database server.</span></span>
  
- <span data-ttu-id="fd775-236">[受控執行個體](/azure/sql-database/sql-database-managed-instance)是 Microsoft SQL Server 資料庫引擎的完全受控實例，可提供與內部部署 SQL Server 接近100% 的相容性。</span><span class="sxs-lookup"><span data-stu-id="fd775-236">A [Managed Instance](/azure/sql-database/sql-database-managed-instance) is a fully managed instance of the Microsoft SQL Server Database Engine that provides near-100% compatibility with an on-premises SQL Server.</span></span> <span data-ttu-id="fd775-237">此選項支援較大的資料庫（最多 35 TB），並放在 [Azure 虛擬網路](/azure/virtual-network/virtual-networks-overview) 中，以獲得更好的隔離。</span><span class="sxs-lookup"><span data-stu-id="fd775-237">This option supports larger databases, up to 35 TB and is placed in an [Azure Virtual Network](/azure/virtual-network/virtual-networks-overview) for better isolation.</span></span>

- <span data-ttu-id="fd775-238">[Azure SQL Database 無伺服器](/azure/sql-database/sql-database-serverless) 是單一資料庫的計算層，可根據工作負載需求自動調整規模。</span><span class="sxs-lookup"><span data-stu-id="fd775-238">[Azure SQL Database serverless](/azure/sql-database/sql-database-serverless) is a compute tier for a single database that automatically scales based on workload demand.</span></span> <span data-ttu-id="fd775-239">它只會針對每秒使用的計算量計費。</span><span class="sxs-lookup"><span data-stu-id="fd775-239">It bills only for the amount of compute used per second.</span></span> <span data-ttu-id="fd775-240">這項服務非常適合具有間歇、無法預測的使用模式的工作負載，並與非使用中的時間間隔。</span><span class="sxs-lookup"><span data-stu-id="fd775-240">The service is well suited for workloads with intermittent, unpredictable usage patterns, interspersed with periods of inactivity.</span></span> <span data-ttu-id="fd775-241">無伺服器計算層也會在非使用期間自動暫停資料庫，因此只會收取儲存體費用。</span><span class="sxs-lookup"><span data-stu-id="fd775-241">The serverless compute tier also automatically pauses databases during inactive periods so that only storage charges are billed.</span></span> <span data-ttu-id="fd775-242">它會在活動傳回時自動繼續。</span><span class="sxs-lookup"><span data-stu-id="fd775-242">It automatically resumes when activity returns.</span></span>

<span data-ttu-id="fd775-243">除了傳統的 Microsoft SQL Server 堆疊之外，Azure 也提供三個熱門開放原始碼資料庫的受控版本。</span><span class="sxs-lookup"><span data-stu-id="fd775-243">Beyond the traditional Microsoft SQL Server stack, Azure also features managed versions of three popular open-source databases.</span></span>

## <a name="open-source-databases-in-azure"></a><span data-ttu-id="fd775-244">Azure 中的開放原始碼資料庫</span><span class="sxs-lookup"><span data-stu-id="fd775-244">Open-source databases in Azure</span></span>

<span data-ttu-id="fd775-245">開放原始碼關係資料庫已成為適用于雲端原生應用程式的熱門選擇。</span><span class="sxs-lookup"><span data-stu-id="fd775-245">Open-source relational databases have become a popular choice for cloud-native applications.</span></span> <span data-ttu-id="fd775-246">許多企業都優先于商務資料庫產品，特別是為了節省成本。</span><span class="sxs-lookup"><span data-stu-id="fd775-246">Many enterprises favor them over commercial database products, especially for cost savings.</span></span> <span data-ttu-id="fd775-247">許多開發團隊都享有其彈性、支援社區的開發，以及工具和擴充功能的生態系統。</span><span class="sxs-lookup"><span data-stu-id="fd775-247">Many development teams enjoy their flexibility, community-backed development, and ecosystem of tools and extensions.</span></span> <span data-ttu-id="fd775-248">開放原始碼資料庫可跨多個雲端提供者部署，協助將「廠商鎖定」的顧慮降至最低。</span><span class="sxs-lookup"><span data-stu-id="fd775-248">Open-source databases can be deployed across multiple cloud providers, helping minimize the concern of "vendor lock-in."</span></span>

<span data-ttu-id="fd775-249">開發人員可以輕鬆地自我裝載 Azure VM 上的任何開放原始碼資料庫。</span><span class="sxs-lookup"><span data-stu-id="fd775-249">Developers can easily self-host any open-source database on an Azure VM.</span></span> <span data-ttu-id="fd775-250">雖然提供完整控制權，但這種方法可讓您將資料庫和 VM 的管理、監視和維護進行攔截。</span><span class="sxs-lookup"><span data-stu-id="fd775-250">While providing full control, this approach puts you on the hook for the management, monitoring, and maintenance of the database and VM.</span></span>

<span data-ttu-id="fd775-251">不過，Microsoft 藉由提供數個熱門的開放原始碼資料庫做為 *完全受控* 的 DBaaS 服務，繼續承諾讓 Azure 成為「開放平臺」。</span><span class="sxs-lookup"><span data-stu-id="fd775-251">However, Microsoft continues its commitment to keeping Azure an “open platform” by offering several popular open-source databases as *fully managed* DBaaS services.</span></span>

### <a name="azure-database-for-mysql"></a><span data-ttu-id="fd775-252">適用於 MySQL 的 Azure 資料庫</span><span class="sxs-lookup"><span data-stu-id="fd775-252">Azure Database for MySQL</span></span>

<span data-ttu-id="fd775-253">[MySQL](https://en.wikipedia.org/wiki/MySQL) 是開放原始碼關係資料庫，也是以 [燈泡軟體堆疊](https://en.wikipedia.org/wiki/LAMP_(software_bundle))為基礎的應用程式要件。</span><span class="sxs-lookup"><span data-stu-id="fd775-253">[MySQL](https://en.wikipedia.org/wiki/MySQL) is an open-source relational database and a pillar for applications built on the [LAMP software stack](https://en.wikipedia.org/wiki/LAMP_(software_bundle)).</span></span> <span data-ttu-id="fd775-254">廣泛為大量 *讀取* 的工作負載選擇，包括 Facebook、Twitter 和 YouTube 在內的許多大型組織都會使用它。</span><span class="sxs-lookup"><span data-stu-id="fd775-254">Widely chosen for *read heavy* workloads, it's used by many large organizations, including Facebook, Twitter, and YouTube.</span></span> <span data-ttu-id="fd775-255">您可以免費使用該社區版，而 enterprise edition 則需要購買授權。</span><span class="sxs-lookup"><span data-stu-id="fd775-255">The community edition is available for free, while the enterprise edition requires a license purchase.</span></span> <span data-ttu-id="fd775-256">此產品最初是在1995中建立的，在2008中是由 Sun Microsystems 購買。</span><span class="sxs-lookup"><span data-stu-id="fd775-256">Originally created in 1995, the product was purchased by Sun Microsystems in 2008.</span></span> <span data-ttu-id="fd775-257">Oracle 在2010中取得 Sun 和 MySQL。</span><span class="sxs-lookup"><span data-stu-id="fd775-257">Oracle acquired Sun and MySQL in 2010.</span></span>

<span data-ttu-id="fd775-258">[適用於 MySQL 的 Azure 資料庫](https://azure.microsoft.com/services/mysql/) 是以開放原始碼 MySQL 伺服器引擎為基礎的受控關係資料庫服務。</span><span class="sxs-lookup"><span data-stu-id="fd775-258">[Azure Database for MySQL](https://azure.microsoft.com/services/mysql/) is a managed relational database service based on the open-source MySQL Server engine.</span></span> <span data-ttu-id="fd775-259">它會使用 MySQL 的社區版。</span><span class="sxs-lookup"><span data-stu-id="fd775-259">It uses the MySQL Community edition.</span></span> <span data-ttu-id="fd775-260">Azure MySQL 伺服器是服務的管理點。</span><span class="sxs-lookup"><span data-stu-id="fd775-260">The Azure MySQL server is the administrative point for the service.</span></span> <span data-ttu-id="fd775-261">它與用於內部部署的 MySQL 伺服器引擎相同。</span><span class="sxs-lookup"><span data-stu-id="fd775-261">It's the same MySQL server engine used for on-premises deployments.</span></span> <span data-ttu-id="fd775-262">引擎可以針對每個伺服器建立單一資料庫，或為每個共用資源的伺服器建立多個資料庫。</span><span class="sxs-lookup"><span data-stu-id="fd775-262">The engine can create a single database per server or multiple databases per server that share resources.</span></span> <span data-ttu-id="fd775-263">您可以繼續使用相同的開放原始碼工具來管理資料，而不需要學習新技能或管理虛擬機器。</span><span class="sxs-lookup"><span data-stu-id="fd775-263">You can continue to manage data using the same open-source tools without having to learn new skills or manage virtual machines.</span></span>

### <a name="azure-database-for-mariadb"></a><span data-ttu-id="fd775-264">適用於 MariaDB 的 Azure 資料庫</span><span class="sxs-lookup"><span data-stu-id="fd775-264">Azure Database for MariaDB</span></span>

<span data-ttu-id="fd775-265">[適用于 mariadb](https://mariadb.com/) 伺服器是另一個受歡迎的開放原始碼資料庫伺服器。</span><span class="sxs-lookup"><span data-stu-id="fd775-265">[MariaDB](https://mariadb.com/) Server is another popular open-source database server.</span></span> <span data-ttu-id="fd775-266">當 Oracle 購買 Sun Microsystems （擁有 MySQL）時，它會建立為 MySQL 的 *分支* 。</span><span class="sxs-lookup"><span data-stu-id="fd775-266">It was created as a *fork* of MySQL when Oracle purchased Sun Microsystems, who owned MySQL.</span></span> <span data-ttu-id="fd775-267">其目的是要確保適用于 mariadb 保持開放原始碼。</span><span class="sxs-lookup"><span data-stu-id="fd775-267">The intent was to ensure that MariaDB remained open-source.</span></span> <span data-ttu-id="fd775-268">由於適用于 mariadb 是 MySQL 的分支，資料和資料表定義是相容的，而且用戶端通訊協定、結構和 Api 都是緊密結合。</span><span class="sxs-lookup"><span data-stu-id="fd775-268">As MariaDB is a fork of MySQL, the data and table definitions are compatible, and the client protocols, structures, and APIs, are close-knit.</span></span>

<span data-ttu-id="fd775-269">適用于 mariadb 有一個強大的社區，由許多大型企業使用。</span><span class="sxs-lookup"><span data-stu-id="fd775-269">MariaDB has a strong community and is used by many large enterprises.</span></span> <span data-ttu-id="fd775-270">雖然 Oracle 會持續維護、增強及支援 MySQL，但適用于 mariadb foundation 會管理適用于 mariadb，允許對產品和檔的公開投稿。</span><span class="sxs-lookup"><span data-stu-id="fd775-270">While Oracle continues to maintain, enhance, and support MySQL, the MariaDB foundation manages MariaDB, allowing public contributions to the product and documentation.</span></span>

<span data-ttu-id="fd775-271">[適用於 MariaDB 的 Azure 資料庫](https://azure.microsoft.com/services/mariadb/) 是 Azure 雲端中完全受控的關係資料庫即服務。</span><span class="sxs-lookup"><span data-stu-id="fd775-271">[Azure Database for MariaDB](https://azure.microsoft.com/services/mariadb/) is a fully managed relational database as a service in the Azure cloud.</span></span> <span data-ttu-id="fd775-272">此服務是以適用于 mariadb 社區 edition 伺服器引擎為基礎。</span><span class="sxs-lookup"><span data-stu-id="fd775-272">The service is based on the MariaDB community edition server engine.</span></span> <span data-ttu-id="fd775-273">它可透過可預測的效能和動態擴充性來處理任務關鍵性工作負載。</span><span class="sxs-lookup"><span data-stu-id="fd775-273">It can handle mission-critical workloads with predictable performance and dynamic scalability.</span></span>

### <a name="azure-database-for-postgresql"></a><span data-ttu-id="fd775-274">適用於 PostgreSQL 的 Azure 資料庫</span><span class="sxs-lookup"><span data-stu-id="fd775-274">Azure Database for PostgreSQL</span></span>

<span data-ttu-id="fd775-275">[于 postgresql](https://www.postgresql.org/) 是開放原始碼關係資料庫，有超過30多年的積極開發。</span><span class="sxs-lookup"><span data-stu-id="fd775-275">[PostgreSQL](https://www.postgresql.org/) is an open-source relational database with over 30 years of active development.</span></span> <span data-ttu-id="fd775-276">PostgresSQL 具有可靠性與資料完整性的強大信譽。</span><span class="sxs-lookup"><span data-stu-id="fd775-276">PostgresSQL has a strong reputation for reliability and data integrity.</span></span> <span data-ttu-id="fd775-277">它的功能豐富、符合 SQL 規範，且比 MySQL 更具效能，特別是針對具有複雜查詢和大量寫入的工作負載。</span><span class="sxs-lookup"><span data-stu-id="fd775-277">It’s feature rich, SQL compliant, and considered more performant than MySQL - especially for workloads with complex queries and heavy writes.</span></span> <span data-ttu-id="fd775-278">許多大型企業（包括 Apple、Red Hat 和 Fujitsu）都使用於 postgresql 建立了產品。</span><span class="sxs-lookup"><span data-stu-id="fd775-278">Many large enterprises including Apple, Red Hat, and Fujitsu have built products using PostgreSQL.</span></span>

<span data-ttu-id="fd775-279">[適用於 PostgreSQL 的 Azure 資料庫](https://azure.microsoft.com/services/postgresql/) 是完全受控的關係資料庫服務，以開放原始碼 Postgres 資料庫引擎為基礎。</span><span class="sxs-lookup"><span data-stu-id="fd775-279">[Azure Database for PostgreSQL](https://azure.microsoft.com/services/postgresql/) is a fully managed relational database service, based on the open-source Postgres database engine.</span></span> <span data-ttu-id="fd775-280">此服務支援許多開發平臺，包括 c + +、JAVA、Python、Node、C \# 和 PHP。</span><span class="sxs-lookup"><span data-stu-id="fd775-280">The service supports many development platforms, including C++, Java, Python, Node, C\#, and PHP.</span></span> <span data-ttu-id="fd775-281">您可以使用 [命令列介面](https://datamigration.microsoft.com/scenario/postgresql-to-azurepostgresql?step=1) 工具或 Azure 資料移轉服務，將于 postgresql 資料庫移轉至其中。</span><span class="sxs-lookup"><span data-stu-id="fd775-281">You can migrate PostgreSQL databases to it using the [command-line interface](https://datamigration.microsoft.com/scenario/postgresql-to-azurepostgresql?step=1) tool or Azure Data Migration Service.</span></span>

<span data-ttu-id="fd775-282">有兩個部署選項可使用適用於 PostgreSQL 的 Azure 資料庫：</span><span class="sxs-lookup"><span data-stu-id="fd775-282">Azure Database for PostgreSQL is available with two deployment options:</span></span>

- <span data-ttu-id="fd775-283">[單一伺服器](/azure/postgresql/concepts-servers)部署選項是您可以部署多個資料庫的多個資料庫的中央管理點。</span><span class="sxs-lookup"><span data-stu-id="fd775-283">The [Single Server](/azure/postgresql/concepts-servers) deployment option is a central administrative point for multiple databases to which you can deploy many databases.</span></span> <span data-ttu-id="fd775-284">定價是根據核心和儲存體，以每一伺服器為基礎進行結構化。</span><span class="sxs-lookup"><span data-stu-id="fd775-284">The pricing is structured per-server based upon cores and storage.</span></span>

- <span data-ttu-id="fd775-285">[超大規模 (Citus) 選項](https://azure.microsoft.com/blog/get-high-performance-scaling-for-your-azure-database-workloads-with-hyperscale/)是由 Citus 資料技術提供技術支援。</span><span class="sxs-lookup"><span data-stu-id="fd775-285">The [Hyperscale (Citus) option](https://azure.microsoft.com/blog/get-high-performance-scaling-for-your-azure-database-workloads-with-hyperscale/) is powered by Citus Data technology.</span></span> <span data-ttu-id="fd775-286">它藉由 *水準調整* 數百個節點的單一資料庫，以提供快速的效能和規模，讓效能達到高效能。</span><span class="sxs-lookup"><span data-stu-id="fd775-286">It enables high performance by *horizontally scaling* a single database across hundreds of nodes to deliver fast performance and scale.</span></span> <span data-ttu-id="fd775-287">此選項可讓引擎在記憶體中容納更多資料、跨數百個節點平行處理查詢，以及更快編制索引資料。</span><span class="sxs-lookup"><span data-stu-id="fd775-287">This option allows the engine to fit more data in memory, parallelize queries across hundreds of nodes, and index data faster.</span></span>

## <a name="nosql-data-in-azure"></a><span data-ttu-id="fd775-288">Azure 中的 NoSQL 資料</span><span class="sxs-lookup"><span data-stu-id="fd775-288">NoSQL data in Azure</span></span>

<span data-ttu-id="fd775-289">Cosmos DB 是 Azure 雲端中完全受控、全域散發的 NoSQL 資料庫服務。</span><span class="sxs-lookup"><span data-stu-id="fd775-289">Cosmos DB is a fully managed, globally distributed NoSQL database service in the Azure cloud.</span></span> <span data-ttu-id="fd775-290">全球各地的許多大型公司都採用了它，包括可哥-Cola、Skype、ExxonMobil 和自由的相互。</span><span class="sxs-lookup"><span data-stu-id="fd775-290">It has been adopted by many large companies across the world,  including Coca-Cola, Skype, ExxonMobil, and Liberty Mutual.</span></span>

<span data-ttu-id="fd775-291">如果您的服務需要來自世界各地的快速回應、高可用性或彈性的擴充性，Cosmos DB 是絕佳的選擇。</span><span class="sxs-lookup"><span data-stu-id="fd775-291">If your services require fast response from anywhere in the world, high availability, or elastic scalability, Cosmos DB is a great choice.</span></span> <span data-ttu-id="fd775-292">圖5-12 顯示 Cosmos DB。</span><span class="sxs-lookup"><span data-stu-id="fd775-292">Figure 5-12 shows Cosmos DB.</span></span>

![Cosmos DB 總覽](./media/cosmos-db-overview.png)

<span data-ttu-id="fd775-294">**圖 5-12**： Cosmos DB 的總覽</span><span class="sxs-lookup"><span data-stu-id="fd775-294">**Figure 5-12**: Overview of Cosmos DB</span></span>

<span data-ttu-id="fd775-295">上圖顯示 Cosmos DB 中提供的許多內建雲端原生功能。</span><span class="sxs-lookup"><span data-stu-id="fd775-295">The previous figure presents many of the built-in cloud-native capabilities available in Cosmos DB.</span></span> <span data-ttu-id="fd775-296">在本節中，我們將進一步瞭解它們。</span><span class="sxs-lookup"><span data-stu-id="fd775-296">In this section, we’ll take a closer look at them.</span></span>

### <a name="global-support"></a><span data-ttu-id="fd775-297">全球支援</span><span class="sxs-lookup"><span data-stu-id="fd775-297">Global support</span></span>

<span data-ttu-id="fd775-298">雲端原生應用程式通常有全球受眾，需要全球規模。</span><span class="sxs-lookup"><span data-stu-id="fd775-298">Cloud-native applications often have a global audience and require global scale.</span></span>

<span data-ttu-id="fd775-299">您可以跨區域或世界各地散發 Cosmos 資料庫、將資料放在您的使用者附近、改善回應時間，以及降低延遲。</span><span class="sxs-lookup"><span data-stu-id="fd775-299">You can distribute Cosmos databases across regions or around the world, placing data close to your users, improving response time, and reducing latency.</span></span> <span data-ttu-id="fd775-300">您可以新增或移除區域中的資料庫，而不需暫停或重新部署您的服務。</span><span class="sxs-lookup"><span data-stu-id="fd775-300">You can add or remove a database from a region without pausing or redeploying your services.</span></span> <span data-ttu-id="fd775-301">在背景中，Cosmos DB 會以透明方式將資料複寫到每個已設定的區域。</span><span class="sxs-lookup"><span data-stu-id="fd775-301">In the background, Cosmos DB transparently replicates the data to each of the configured regions.</span></span>

<span data-ttu-id="fd775-302">Cosmos DB 支援全域層級的 [主動/主動](https://kemptechnologies.com/white-papers/unfog-confusion-active-passive-activeactive-load-balancing/) 叢集，可讓您設定任何資料庫區域以 *同時支援寫入和讀取*。</span><span class="sxs-lookup"><span data-stu-id="fd775-302">Cosmos DB supports [active/active](https://kemptechnologies.com/white-papers/unfog-confusion-active-passive-activeactive-load-balancing/) clustering at the global level, enabling you to configure any of your database regions to support *both writes and reads*.</span></span>

<span data-ttu-id="fd775-303">[多](/azure/cosmos-db/multi-master-benefits)宿主通訊協定是 Cosmos DB 中的一項重要功能，可啟用下列功能：</span><span class="sxs-lookup"><span data-stu-id="fd775-303">The [Multi-Master](/azure/cosmos-db/multi-master-benefits) protocol is an important feature in Cosmos DB that enables the following functionality:</span></span>

- <span data-ttu-id="fd775-304">無限制的彈性寫入和讀取的擴充性。</span><span class="sxs-lookup"><span data-stu-id="fd775-304">Unlimited elastic write and read scalability.</span></span>

- <span data-ttu-id="fd775-305">在世界各地具有 99.999% 的讀取和寫入可用性。</span><span class="sxs-lookup"><span data-stu-id="fd775-305">99.999% read and write availability all around the world.</span></span>

- <span data-ttu-id="fd775-306">保證讀取和寫入會以第 99 百分位數且小於 10 毫秒的方式提供服務。</span><span class="sxs-lookup"><span data-stu-id="fd775-306">Guaranteed reads and writes served in less than 10 milliseconds at the 99th percentile.</span></span>

<span data-ttu-id="fd775-307">使用 Cosmos DB [多路連接 api](/azure/cosmos-db/distribute-data-globally)時，您的微服務會自動察覺最接近的 Azure 區域，並將要求傳送給它。</span><span class="sxs-lookup"><span data-stu-id="fd775-307">With the Cosmos DB [Multi-Homing APIs](/azure/cosmos-db/distribute-data-globally), your microservice is automatically aware of the nearest Azure region and sends requests to it.</span></span> <span data-ttu-id="fd775-308">最接近的區域是由 Cosmos DB 識別，不需要任何設定變更。</span><span class="sxs-lookup"><span data-stu-id="fd775-308">The nearest region is identified by Cosmos DB without any configuration changes.</span></span> <span data-ttu-id="fd775-309">如果區域變得無法使用，多路連接功能就會自動將要求路由傳送至下一個最接近的可用區域。</span><span class="sxs-lookup"><span data-stu-id="fd775-309">Should a region become unavailable, the Multi-Homing feature will automatically route requests to the next nearest available region.</span></span>

### <a name="multi-model-support"></a><span data-ttu-id="fd775-310">多模型支援</span><span class="sxs-lookup"><span data-stu-id="fd775-310">Multi-model support</span></span>

<span data-ttu-id="fd775-311">將整合型應用程式遷移到雲端原生架構時，開發小組有時必須遷移開放原始碼的 NoSQL 資料存放區。</span><span class="sxs-lookup"><span data-stu-id="fd775-311">When replatforming monolithic applications to a cloud-native architecture, development teams sometimes have to migrate open-source, NoSQL data stores.</span></span> <span data-ttu-id="fd775-312">Cosmos DB 可協助您使用它的 *多模型* 資料平臺，將這些 NoSQL 資料存放區的投資保持在一起。</span><span class="sxs-lookup"><span data-stu-id="fd775-312">Cosmos DB can help you preserve your investment in these NoSQL datastores with its *multi-model* data platform.</span></span> <span data-ttu-id="fd775-313">下表顯示支援的 NoSQL [相容性 api](https://www.wikiwand.com/en/Cosmos_DB)。</span><span class="sxs-lookup"><span data-stu-id="fd775-313">The following table shows the supported NoSQL [compatibility APIs](https://www.wikiwand.com/en/Cosmos_DB).</span></span>

| <span data-ttu-id="fd775-314">提供者</span><span class="sxs-lookup"><span data-stu-id="fd775-314">Provider</span></span> | <span data-ttu-id="fd775-315">描述</span><span class="sxs-lookup"><span data-stu-id="fd775-315">Description</span></span>  |
| :-------- | :-------- |
| <span data-ttu-id="fd775-316">SQL API</span><span class="sxs-lookup"><span data-stu-id="fd775-316">SQL API</span></span> | <span data-ttu-id="fd775-317">專屬的 API，可支援 JSON 檔和以 SQL 為基礎的查詢</span><span class="sxs-lookup"><span data-stu-id="fd775-317">Proprietary API that supports JSON documents and SQL-based queries</span></span> |
| <span data-ttu-id="fd775-318">Mongo DB API</span><span class="sxs-lookup"><span data-stu-id="fd775-318">Mongo DB API</span></span> | <span data-ttu-id="fd775-319">支援 Mongo DB Api 和 JSON 檔</span><span class="sxs-lookup"><span data-stu-id="fd775-319">Supports Mongo DB APIs and JSON documents</span></span>|
| <span data-ttu-id="fd775-320">Gremlin API</span><span class="sxs-lookup"><span data-stu-id="fd775-320">Gremlin API</span></span> | <span data-ttu-id="fd775-321">支援 Gremlin API 與以圖形為基礎的節點和邊緣資料表示</span><span class="sxs-lookup"><span data-stu-id="fd775-321">Supports Gremlin API with graph-based nodes and edge data representations</span></span> |
| <span data-ttu-id="fd775-322">Cassandra API</span><span class="sxs-lookup"><span data-stu-id="fd775-322">Cassandra API</span></span> | <span data-ttu-id="fd775-323">支援適用于寬資料行資料表示的 Casandra API</span><span class="sxs-lookup"><span data-stu-id="fd775-323">Supports Casandra API for wide-column data representations</span></span> |  
| <span data-ttu-id="fd775-324">資料表 API</span><span class="sxs-lookup"><span data-stu-id="fd775-324">Table API</span></span>  | <span data-ttu-id="fd775-325">使用 premium 增強功能支援 Azure 資料表儲存體</span><span class="sxs-lookup"><span data-stu-id="fd775-325">Supports Azure Table Storage with premium enhancements</span></span> |  
| <span data-ttu-id="fd775-326">etcd API</span><span class="sxs-lookup"><span data-stu-id="fd775-326">etcd API</span></span> | <span data-ttu-id="fd775-327">啟用 Cosmos DB 作為 Azure Kubernetes Service 叢集的備份存放區</span><span class="sxs-lookup"><span data-stu-id="fd775-327">Enables Cosmos DB as a backing store for Azure Kubernetes Service clusters</span></span> |

<span data-ttu-id="fd775-328">開發小組可以將現有的 Mongo、Gremlin 或 Cassandra 資料庫移轉至 Cosmos DB，只要對資料或程式碼進行極短的變更即可。</span><span class="sxs-lookup"><span data-stu-id="fd775-328">Development teams can migrate existing Mongo, Gremlin, or Cassandra databases into Cosmos DB with minimal changes to data or code.</span></span> <span data-ttu-id="fd775-329">針對新的應用程式，開發小組可以在開放原始碼選項或內建的 SQL API 模型中選擇。</span><span class="sxs-lookup"><span data-stu-id="fd775-329">For new apps, development teams can choose among open-source options or the built-in SQL API model.</span></span>

> <span data-ttu-id="fd775-330">就內部而言，Cosmos 會以基本資料類型所組成的簡單結構格式來儲存資料。</span><span class="sxs-lookup"><span data-stu-id="fd775-330">Internally, Cosmos stores the data in a simple struct format made up of primitive data types.</span></span> <span data-ttu-id="fd775-331">針對每個要求，資料庫引擎會將基本資料轉譯為您所選取的模型標記法。</span><span class="sxs-lookup"><span data-stu-id="fd775-331">For each request, the database engine translates the primitive data into the model representation you've selected.</span></span>

<span data-ttu-id="fd775-332">在上表中，請注意 [資料表 API](/azure/cosmos-db/table-introduction) 選項。</span><span class="sxs-lookup"><span data-stu-id="fd775-332">In the previous table, note the [Table API](/azure/cosmos-db/table-introduction) option.</span></span> <span data-ttu-id="fd775-333">此 API 是 Azure 資料表儲存體的演進。</span><span class="sxs-lookup"><span data-stu-id="fd775-333">This API is an evolution of Azure Table Storage.</span></span> <span data-ttu-id="fd775-334">兩者都會共用相同的基礎資料表模型，但 Cosmos DB 資料表 API 會新增 Azure 儲存體 API 中未提供的 premium 增強功能。</span><span class="sxs-lookup"><span data-stu-id="fd775-334">Both share the same underlying table model, but the Cosmos DB Table API adds premium enhancements not available in the Azure Storage API.</span></span> <span data-ttu-id="fd775-335">下表會對照這些功能。</span><span class="sxs-lookup"><span data-stu-id="fd775-335">The following table contrasts the features.</span></span>

|  | <span data-ttu-id="fd775-336">Azure 表格儲存體</span><span class="sxs-lookup"><span data-stu-id="fd775-336">Azure Table Storage</span></span>  | <span data-ttu-id="fd775-337">Azure Cosmos DB</span><span class="sxs-lookup"><span data-stu-id="fd775-337">Azure Cosmos DB</span></span>  |
| :-------- | :-------- |:-------- |
| <span data-ttu-id="fd775-338">Latency</span><span class="sxs-lookup"><span data-stu-id="fd775-338">Latency</span></span> | <span data-ttu-id="fd775-339">快速</span><span class="sxs-lookup"><span data-stu-id="fd775-339">Fast</span></span> | <span data-ttu-id="fd775-340">在世界各地讀取和寫入的一位數毫秒延遲</span><span class="sxs-lookup"><span data-stu-id="fd775-340">Single-digit millisecond latency for reads and writes anywhere in the world</span></span> |
| <span data-ttu-id="fd775-341">輸送量</span><span class="sxs-lookup"><span data-stu-id="fd775-341">Throughput</span></span> | <span data-ttu-id="fd775-342">每個資料表的20000作業限制</span><span class="sxs-lookup"><span data-stu-id="fd775-342">Limit of 20,000 operations per table</span></span> | <span data-ttu-id="fd775-343">每個資料表10000000個作業</span><span class="sxs-lookup"><span data-stu-id="fd775-343">10 Million operations per table</span></span> |
| <span data-ttu-id="fd775-344">全域散發</span><span class="sxs-lookup"><span data-stu-id="fd775-344">Global Distribution</span></span> | <span data-ttu-id="fd775-345">具有選擇性單一次要讀取區域的單一區域</span><span class="sxs-lookup"><span data-stu-id="fd775-345">Single region with optional single secondary read region</span></span> | <span data-ttu-id="fd775-346">具有自動容錯移轉的所有區域的通行分佈</span><span class="sxs-lookup"><span data-stu-id="fd775-346">Turnkey distributions to all regions with automatic failover</span></span> |
| <span data-ttu-id="fd775-347">編製索引</span><span class="sxs-lookup"><span data-stu-id="fd775-347">Indexing</span></span> | <span data-ttu-id="fd775-348">僅適用于分割區和資料列索引鍵屬性</span><span class="sxs-lookup"><span data-stu-id="fd775-348">Available for partition and row key properties only</span></span> | <span data-ttu-id="fd775-349">自動編制所有屬性的索引</span><span class="sxs-lookup"><span data-stu-id="fd775-349">Automatic indexing of all properties</span></span> |
| <span data-ttu-id="fd775-350">定價</span><span class="sxs-lookup"><span data-stu-id="fd775-350">Pricing</span></span> | <span data-ttu-id="fd775-351">以儲存體為基礎</span><span class="sxs-lookup"><span data-stu-id="fd775-351">Based on storage</span></span> | <span data-ttu-id="fd775-352">根據輸送量</span><span class="sxs-lookup"><span data-stu-id="fd775-352">Based on throughput</span></span> |

<span data-ttu-id="fd775-353">使用 Azure 資料表儲存體的微服務可輕鬆地遷移至 Cosmos DB 資料表 API。</span><span class="sxs-lookup"><span data-stu-id="fd775-353">Microservices that consume Azure Table storage can easily migrate to the Cosmos DB Table API.</span></span> <span data-ttu-id="fd775-354">不需要變更程式碼。</span><span class="sxs-lookup"><span data-stu-id="fd775-354">No code changes are required.</span></span>

### <a name="tunable-consistency"></a><span data-ttu-id="fd775-355">可調整的一致性</span><span class="sxs-lookup"><span data-stu-id="fd775-355">Tunable consistency</span></span>

<span data-ttu-id="fd775-356">稍早在 *關聯式與 NoSQL* 區段中，我們討論了 *資料一致性*的主體。</span><span class="sxs-lookup"><span data-stu-id="fd775-356">Earlier in the *Relational vs. NoSQL* section, we discussed the subject of *data consistency*.</span></span> <span data-ttu-id="fd775-357">資料一致性指的是資料的 *完整性* 。</span><span class="sxs-lookup"><span data-stu-id="fd775-357">Data consistency refers to the *integrity* of your data.</span></span> <span data-ttu-id="fd775-358">具有分散式資料的雲端原生服務依賴複寫，而且必須在讀取一致性、可用性和延遲之間進行基本取捨。</span><span class="sxs-lookup"><span data-stu-id="fd775-358">Cloud-native services with distributed data rely on replication and must make a fundamental tradeoff between read consistency, availability, and latency.</span></span>

<span data-ttu-id="fd775-359">大部分的分散式資料庫可讓開發人員在兩個一致性模型之間做選擇：強式一致性和最終一致性。</span><span class="sxs-lookup"><span data-stu-id="fd775-359">Most distributed databases allow developers to choose between two consistency models: strong consistency and eventual consistency.</span></span> <span data-ttu-id="fd775-360">*強式一致性* 是資料可程式性的黃金標準。</span><span class="sxs-lookup"><span data-stu-id="fd775-360">*Strong consistency* is the gold standard of data programmability.</span></span> <span data-ttu-id="fd775-361">它保證查詢一律會傳回最新的資料，即使系統必須產生等待更新複寫到所有資料庫複本的延遲。</span><span class="sxs-lookup"><span data-stu-id="fd775-361">It guarantees that a query will always return the most current data - even if the system must incur latency waiting for an update to replicate across all database copies.</span></span> <span data-ttu-id="fd775-362">如果設定為 *最終一致性* 的資料庫會立即傳回資料，即使該資料不是最新的複本。</span><span class="sxs-lookup"><span data-stu-id="fd775-362">While a database configured for *eventual consistency* will return data immediately, even if that data isn't the most current copy.</span></span> <span data-ttu-id="fd775-363">第二個選項可提供更高的可用性、更高的規模和更高的效能。</span><span class="sxs-lookup"><span data-stu-id="fd775-363">The latter option enables higher availability, greater scale, and increased performance.</span></span>

<span data-ttu-id="fd775-364">Azure Cosmos DB 提供五個定義完善的 [一致性模型](/azure/cosmos-db/consistency-levels) ，如圖5-13 所示。</span><span class="sxs-lookup"><span data-stu-id="fd775-364">Azure Cosmos DB offers five well-defined [consistency models](/azure/cosmos-db/consistency-levels) shown in Figure 5-13.</span></span>

![Cosmos DB 一致性圖形](./media/cosmos-consistency-level-graph.png)

<span data-ttu-id="fd775-366">**圖 5-13**： Cosmos DB 一致性層級</span><span class="sxs-lookup"><span data-stu-id="fd775-366">**Figure 5-13**: Cosmos DB Consistency Levels</span></span>

 <span data-ttu-id="fd775-367">這些選項可讓您針對一致性、可用性和資料的效能進行精確的選擇和細微的權衡取捨。</span><span class="sxs-lookup"><span data-stu-id="fd775-367">These options enable you to make precise choices and granular tradeoffs for consistency, availability, and the performance for your data.</span></span> <span data-ttu-id="fd775-368">下表會顯示這些層級。</span><span class="sxs-lookup"><span data-stu-id="fd775-368">The levels are presented in the following table.</span></span>

| <span data-ttu-id="fd775-369">一致性層級</span><span class="sxs-lookup"><span data-stu-id="fd775-369">Consistency Level</span></span> | <span data-ttu-id="fd775-370">描述</span><span class="sxs-lookup"><span data-stu-id="fd775-370">Description</span></span>  |
| :-------- | :-------- |
| <span data-ttu-id="fd775-371">最終</span><span class="sxs-lookup"><span data-stu-id="fd775-371">Eventual</span></span> | <span data-ttu-id="fd775-372">讀取沒有排序保證。</span><span class="sxs-lookup"><span data-stu-id="fd775-372">No ordering guarantee for reads.</span></span> <span data-ttu-id="fd775-373">複本最終將會聚合。</span><span class="sxs-lookup"><span data-stu-id="fd775-373">Replicas will eventually converge.</span></span> |
| <span data-ttu-id="fd775-374">常數前置詞</span><span class="sxs-lookup"><span data-stu-id="fd775-374">Constant Prefix</span></span> | <span data-ttu-id="fd775-375">讀取仍是最終的，但資料會依照寫入的順序傳回。</span><span class="sxs-lookup"><span data-stu-id="fd775-375">Reads are still eventual, but data is returned in the ordering in which it is written.</span></span> |
| <span data-ttu-id="fd775-376">工作階段</span><span class="sxs-lookup"><span data-stu-id="fd775-376">Session</span></span> | <span data-ttu-id="fd775-377">保證您可以讀取目前會話期間所寫入的任何資料。</span><span class="sxs-lookup"><span data-stu-id="fd775-377">Guarantees you can read any data written during the current session.</span></span> <span data-ttu-id="fd775-378">這是預設的一致性層級。</span><span class="sxs-lookup"><span data-stu-id="fd775-378">It is the default consistency level.</span></span> |
| <span data-ttu-id="fd775-379">限定過期</span><span class="sxs-lookup"><span data-stu-id="fd775-379">Bounded Staleness</span></span> | <span data-ttu-id="fd775-380">讀取以您指定的間隔寫入記錄。</span><span class="sxs-lookup"><span data-stu-id="fd775-380">Reads trail writes by interval that you specify.</span></span> |  
| <span data-ttu-id="fd775-381">強式</span><span class="sxs-lookup"><span data-stu-id="fd775-381">Strong</span></span>  | <span data-ttu-id="fd775-382">保證讀取會傳回專案的最新認可版本。</span><span class="sxs-lookup"><span data-stu-id="fd775-382">Reads are guaranteed to return most recent committed version of an item.</span></span> <span data-ttu-id="fd775-383">用戶端永遠不會看到未認可或部分讀取。</span><span class="sxs-lookup"><span data-stu-id="fd775-383">A client never sees an uncommitted or partial read.</span></span> |  

<span data-ttu-id="fd775-384">在《 [9 球後方： Cosmos DB 一致性層級](https://blog.jeremylikness.com/blog/2018-03-23_getting-behind-the-9ball-cosmosdb-consistency-levels/)的文章中，Microsoft Program Manager Jeremy Likness 提供五個模型的絕佳說明。</span><span class="sxs-lookup"><span data-stu-id="fd775-384">In the article [Getting Behind the 9-Ball: Cosmos DB Consistency Levels Explained](https://blog.jeremylikness.com/blog/2018-03-23_getting-behind-the-9ball-cosmosdb-consistency-levels/), Microsoft Program Manager Jeremy Likness provides an excellent explanation of the five models.</span></span>

### <a name="partitioning"></a><span data-ttu-id="fd775-385">資料分割</span><span class="sxs-lookup"><span data-stu-id="fd775-385">Partitioning</span></span>

<span data-ttu-id="fd775-386">Azure Cosmos DB 採用自動 [分割](/azure/cosmos-db/partitioning-overview) 來調整資料庫，以符合雲端原生服務的效能需求。</span><span class="sxs-lookup"><span data-stu-id="fd775-386">Azure Cosmos DB embraces automatic [partitioning](/azure/cosmos-db/partitioning-overview) to scale a database to meet the performance needs of your cloud-native services.</span></span>

<span data-ttu-id="fd775-387">您可以藉由建立資料庫、容器和專案來管理 Cosmos DB 資料中的資料。</span><span class="sxs-lookup"><span data-stu-id="fd775-387">You manage data in Cosmos DB data by creating databases, containers, and items.</span></span>

<span data-ttu-id="fd775-388">容器會存留在 Cosmos DB 資料庫中，並代表與架構無關的專案群組。</span><span class="sxs-lookup"><span data-stu-id="fd775-388">Containers live in a Cosmos DB database and represent a schema-agnostic grouping of items.</span></span> <span data-ttu-id="fd775-389">專案是您新增至容器的資料。</span><span class="sxs-lookup"><span data-stu-id="fd775-389">Items are the data that you add to the container.</span></span> <span data-ttu-id="fd775-390">它們是以檔、資料列、節點或邊緣表示。</span><span class="sxs-lookup"><span data-stu-id="fd775-390">They're represented as documents, rows, nodes, or edges.</span></span> <span data-ttu-id="fd775-391">新增至容器的所有專案都會自動編制索引。</span><span class="sxs-lookup"><span data-stu-id="fd775-391">All items added to a container are automatically indexed.</span></span>

<span data-ttu-id="fd775-392">若要分割容器，專案會分割成不同的子集，稱為邏輯分割區。</span><span class="sxs-lookup"><span data-stu-id="fd775-392">To partition the container, items are divided into distinct subsets called logical partitions.</span></span> <span data-ttu-id="fd775-393">邏輯分割區會根據與容器中每個專案相關聯的分割區索引鍵值來填入。</span><span class="sxs-lookup"><span data-stu-id="fd775-393">Logical partitions are populated based on the value of a partition key that is associated with each item in a container.</span></span> <span data-ttu-id="fd775-394">圖5-14 顯示兩個容器，每個容器都有以分割區索引鍵值為基礎的邏輯分割區。</span><span class="sxs-lookup"><span data-stu-id="fd775-394">Figure 5-14 shows two containers each with a logical partition based on a partition key value.</span></span>

![Cosmos DB 資料分割機制](./media/cosmos-db-partitioning.png)

<span data-ttu-id="fd775-396">**圖 5-14**： Cosmos DB 資料分割機制</span><span class="sxs-lookup"><span data-stu-id="fd775-396">**Figure 5-14**: Cosmos DB partitioning mechanics</span></span>

<span data-ttu-id="fd775-397">請注意，在上圖中，每個專案都包含「城市」或「機場」的分割區索引鍵。</span><span class="sxs-lookup"><span data-stu-id="fd775-397">Note in the  previous figure how each item includes a partition key of either ‘city’ or ‘airport’.</span></span> <span data-ttu-id="fd775-398">索引鍵會決定專案的邏輯分割區。</span><span class="sxs-lookup"><span data-stu-id="fd775-398">The key determines the item’s logical partition.</span></span> <span data-ttu-id="fd775-399">具有城市代碼的專案會指派給左邊的容器，並將具有機場程式碼的專案指派給右邊的容器。</span><span class="sxs-lookup"><span data-stu-id="fd775-399">Items with a city code are assigned to the container on the left, and items with an airport code, to the container on the right.</span></span> <span data-ttu-id="fd775-400">結合資料分割索引鍵值與識別碼值會建立可唯一識別專案的專案索引。</span><span class="sxs-lookup"><span data-stu-id="fd775-400">Combining the partition key value with the ID value creates an item's index, which uniquely identifies the item.</span></span>

<span data-ttu-id="fd775-401">Cosmos DB 會在內部自動管理實體分割區上的 [邏輯](/azure/cosmos-db/partition-data) 分割區位置，以滿足容器的擴充性和效能需求。</span><span class="sxs-lookup"><span data-stu-id="fd775-401">Internally, Cosmos DB automatically manages the placement of [logical partitions](/azure/cosmos-db/partition-data) on physical partitions to satisfy the scalability and performance needs of the container.</span></span> <span data-ttu-id="fd775-402">隨著應用程式輸送量和存放裝置需求的增加，Azure Cosmos DB 會將邏輯磁碟分割分散到更多伺服器。</span><span class="sxs-lookup"><span data-stu-id="fd775-402">As application throughput and storage requirements  increase, Azure Cosmos DB redistributes logical partitions across a greater number of servers.</span></span> <span data-ttu-id="fd775-403">重新發佈作業是由 Cosmos DB 管理，並在不中斷或停機的情況下叫用。</span><span class="sxs-lookup"><span data-stu-id="fd775-403">Redistribution operations are managed by Cosmos DB and invoked without interruption or downtime.</span></span>

## <a name="newsql-databases"></a><span data-ttu-id="fd775-404">NewSQL 資料庫</span><span class="sxs-lookup"><span data-stu-id="fd775-404">NewSQL databases</span></span>

<span data-ttu-id="fd775-405">*NewSQL* 是一種新興的資料庫技術，將 NoSQL 的分散式擴充性與關係資料庫的 ACID 保證結合在一起。</span><span class="sxs-lookup"><span data-stu-id="fd775-405">*NewSQL* is an emerging database technology that combines the distributed scalability of NoSQL with the ACID guarantees of a relational database.</span></span> <span data-ttu-id="fd775-406">NewSQL 資料庫對於必須跨分散式環境處理大量資料的商務系統而言很重要，並具備完整的交易式支援和 ACID 合規性。</span><span class="sxs-lookup"><span data-stu-id="fd775-406">NewSQL databases are important for business systems that must process high-volumes of data, across distributed environments, with full transactional support and ACID compliance.</span></span> <span data-ttu-id="fd775-407">雖然 NoSQL 資料庫可提供大規模的擴充性，但不保證資料的一致性。</span><span class="sxs-lookup"><span data-stu-id="fd775-407">While a NoSQL database can provide massive scalability, it does not guarantee data consistency.</span></span> <span data-ttu-id="fd775-408">不一致資料的間歇性問題可能會對開發小組造成負擔。</span><span class="sxs-lookup"><span data-stu-id="fd775-408">Intermittent problems from inconsistent data can place a burden on the development team.</span></span> <span data-ttu-id="fd775-409">開發人員必須在其微服務程式代碼中設計防護措施，以管理不一致資料所造成的問題。</span><span class="sxs-lookup"><span data-stu-id="fd775-409">Developers must construct safeguards into their microservice code to manage problems caused by inconsistent data.</span></span>

<span data-ttu-id="fd775-410">雲端原生運算基礎 (CNCF) 提供數個 NewSQL 資料庫專案的功能。</span><span class="sxs-lookup"><span data-stu-id="fd775-410">The Cloud Native Computing Foundation (CNCF) features several NewSQL database projects.</span></span>

| <span data-ttu-id="fd775-411">Project</span><span class="sxs-lookup"><span data-stu-id="fd775-411">Project</span></span> | <span data-ttu-id="fd775-412">特性</span><span class="sxs-lookup"><span data-stu-id="fd775-412">Characteristics</span></span> |
| :-------- | :-------- |
| <span data-ttu-id="fd775-413">Cockroach DB</span><span class="sxs-lookup"><span data-stu-id="fd775-413">Cockroach DB</span></span> |<span data-ttu-id="fd775-414">符合 ACID 規範的關係資料庫，可進行全域調整。</span><span class="sxs-lookup"><span data-stu-id="fd775-414">An ACID-compliant, relational database that scales globally.</span></span> <span data-ttu-id="fd775-415">將新節點新增至叢集，CockroachDB 會負責平衡實例和地理位置之間的資料。</span><span class="sxs-lookup"><span data-stu-id="fd775-415">Add a new node to a cluster and CockroachDB takes care of balancing the data across instances and geographies.</span></span> <span data-ttu-id="fd775-416">它會建立、管理及散發複本，以確保可靠性。</span><span class="sxs-lookup"><span data-stu-id="fd775-416">It creates, manages, and distributes replicas to ensure reliability.</span></span> <span data-ttu-id="fd775-417">它是開放原始碼且可免費使用。</span><span class="sxs-lookup"><span data-stu-id="fd775-417">It’s open source and freely available.</span></span>  |
| <span data-ttu-id="fd775-418">TiDB</span><span class="sxs-lookup"><span data-stu-id="fd775-418">TiDB</span></span> | <span data-ttu-id="fd775-419">支援混合式交易和分析處理 (HTAP) 工作負載的開放原始碼資料庫。</span><span class="sxs-lookup"><span data-stu-id="fd775-419">An open-source database that supports Hybrid Transactional and Analytical Processing (HTAP) workloads.</span></span> <span data-ttu-id="fd775-420">它是 MySQL 相容的功能，可提供水準擴充性、強式一致性和高可用性。</span><span class="sxs-lookup"><span data-stu-id="fd775-420">It is MySQL-compatible and features horizontal scalability, strong consistency, and high availability.</span></span>  <span data-ttu-id="fd775-421">TiDB 的作用就像是 MySQL 伺服器。</span><span class="sxs-lookup"><span data-stu-id="fd775-421">TiDB acts like a MySQL server.</span></span> <span data-ttu-id="fd775-422">您可以繼續使用現有的 MySQL 用戶端程式庫，而不需要對應用程式進行大量的程式碼變更。</span><span class="sxs-lookup"><span data-stu-id="fd775-422">You can continue to use existing MySQL client libraries, without requiring extensive code changes to your application.</span></span> |
| <span data-ttu-id="fd775-423">YugabyteDB</span><span class="sxs-lookup"><span data-stu-id="fd775-423">YugabyteDB</span></span> | <span data-ttu-id="fd775-424">開放原始碼、高效能的分散式 SQL database。</span><span class="sxs-lookup"><span data-stu-id="fd775-424">An open source, high-performance, distributed SQL database.</span></span> <span data-ttu-id="fd775-425">它支援低查詢延遲、可因應失敗的恢復功能，以及全域資料散發。</span><span class="sxs-lookup"><span data-stu-id="fd775-425">It supports low query latency, resilience against failures, and global data distribution.</span></span> <span data-ttu-id="fd775-426">YugabyteDB 與 PostgressSQL 相容，並且會處理相應放大 RDBMS 和網際網路規模的 OLTP 工作負載。</span><span class="sxs-lookup"><span data-stu-id="fd775-426">YugabyteDB is PostgressSQL-compatible and handles scale-out RDBMS and internet-scale OLTP workloads.</span></span> <span data-ttu-id="fd775-427">此產品也支援 NoSQL 並且與 Cassandra 相容。</span><span class="sxs-lookup"><span data-stu-id="fd775-427">The product also supports NoSQL and is compatible with Cassandra.</span></span> |
|<span data-ttu-id="fd775-428">Vitess</span><span class="sxs-lookup"><span data-stu-id="fd775-428">Vitess</span></span> | <span data-ttu-id="fd775-429">Vitess 是一種資料庫解決方案，可用於部署、調整及管理大型的 MySQL 實例叢集。</span><span class="sxs-lookup"><span data-stu-id="fd775-429">Vitess is a database solution for deploying, scaling, and managing large clusters of MySQL instances.</span></span> <span data-ttu-id="fd775-430">它可以在公用或私用雲端架構中執行。</span><span class="sxs-lookup"><span data-stu-id="fd775-430">It can run in a public or private cloud architecture.</span></span> <span data-ttu-id="fd775-431">Vitess 結合和延伸許多重要的 MySQL 功能，以及垂直和水準分區化支援的功能。</span><span class="sxs-lookup"><span data-stu-id="fd775-431">Vitess combines and extends many important MySQL features and features both vertical and horizontal sharding support.</span></span> <span data-ttu-id="fd775-432">由 YouTube 產生，Vitess 自2011起提供所有 YouTube 資料庫流量。</span><span class="sxs-lookup"><span data-stu-id="fd775-432">Originated by YouTube, Vitess has been serving all YouTube database traffic since 2011.</span></span> |

<span data-ttu-id="fd775-433">上圖中的開放原始碼專案可從雲端原生運算基礎進行取得。</span><span class="sxs-lookup"><span data-stu-id="fd775-433">The open-source projects in the previous figure are available from the Cloud Native Computing Foundation.</span></span> <span data-ttu-id="fd775-434">其中有三個供應專案是完整的資料庫產品，包括 .NET Core 支援。</span><span class="sxs-lookup"><span data-stu-id="fd775-434">Three of the offerings are full database products, which include .NET Core support.</span></span> <span data-ttu-id="fd775-435">另一種是 Vitess，它是一種資料庫群集系統，可水準調整大型的 MySQL 實例叢集。</span><span class="sxs-lookup"><span data-stu-id="fd775-435">The other, Vitess, is a database clustering system that horizontally scales large clusters of MySQL instances.</span></span>

<span data-ttu-id="fd775-436">NewSQL 資料庫的主要設計目標是要在 Kubernetes 中以原生方式運作，並利用平臺的復原能力和擴充性。</span><span class="sxs-lookup"><span data-stu-id="fd775-436">A key design goal for NewSQL databases is to work natively in Kubernetes, taking advantage of the platform's resiliency and scalability.</span></span>

<span data-ttu-id="fd775-437">NewSQL 資料庫的設計目的是要在暫時雲端環境中，重新開機或重新排程底層的虛擬機器。</span><span class="sxs-lookup"><span data-stu-id="fd775-437">NewSQL databases are designed to thrive in ephemeral cloud environments where underlying virtual machines can be restarted or rescheduled at a moment’s notice.</span></span> <span data-ttu-id="fd775-438">這些資料庫的設計是為了在不遺失資料或停機的情況下，在節點失敗的情況下</span><span class="sxs-lookup"><span data-stu-id="fd775-438">The databases are designed to survive node failures without data loss nor downtime.</span></span> <span data-ttu-id="fd775-439">例如，CockroachDB 藉由在叢集中的各個節點上維護三個一致的資料複本，來維持電腦遺失的能力。</span><span class="sxs-lookup"><span data-stu-id="fd775-439">CockroachDB, for example, is able to survive a machine loss by maintaining three consistent replicas of any data across the nodes in a cluster.</span></span>

<span data-ttu-id="fd775-440">Kubernetes 會使用 *服務結構* ，以允許用戶端從單一 DNS 專案定址一組相同的 NewSQL 資料庫處理常式。</span><span class="sxs-lookup"><span data-stu-id="fd775-440">Kubernetes uses a *Services construct* to allow a client to address a group of identical NewSQL databases processes from a single DNS entry.</span></span> <span data-ttu-id="fd775-441">藉由將資料庫實例與相關聯之服務的位址分離，我們就可以調整，而不會中斷現有的應用程式實例。</span><span class="sxs-lookup"><span data-stu-id="fd775-441">By decoupling the database instances from the address of the service with which it's associated, we can scale without disrupting existing application instances.</span></span> <span data-ttu-id="fd775-442">在指定時間將要求傳送至任何服務時，一律會產生相同的結果。</span><span class="sxs-lookup"><span data-stu-id="fd775-442">Sending a request to any service at a given time will always yield the same result.</span></span>

<span data-ttu-id="fd775-443">在此案例中，所有資料庫實例都相等。</span><span class="sxs-lookup"><span data-stu-id="fd775-443">In this scenario, all database instances are equal.</span></span> <span data-ttu-id="fd775-444">沒有主要或次要關聯性。</span><span class="sxs-lookup"><span data-stu-id="fd775-444">There are no primary or secondary relationships.</span></span> <span data-ttu-id="fd775-445">在 CockroachDB 中找到的 *共識* 複寫之類的技術，可讓任何資料庫節點處理任何要求。</span><span class="sxs-lookup"><span data-stu-id="fd775-445">Techniques like *consensus replication* found in CockroachDB allow any database node to handle any request.</span></span> <span data-ttu-id="fd775-446">如果接收負載平衡要求的節點具有在本機所需的資料，則會立即回應。</span><span class="sxs-lookup"><span data-stu-id="fd775-446">If the node that receives a load-balanced request has the data it needs locally, it responds immediately.</span></span> <span data-ttu-id="fd775-447">如果沒有，節點就會變成閘道，並將要求轉送至適當的節點，以取得正確的答案。</span><span class="sxs-lookup"><span data-stu-id="fd775-447">If not, the node becomes a gateway and forwards the request to the appropriate nodes to get the correct answer.</span></span> <span data-ttu-id="fd775-448">從用戶端的觀點來看，每個資料庫節點都是相同的：它們會顯示為具有單一電腦系統一致性保證的單一 *邏輯* 資料庫，儘管有數十個或甚至數百個節點在幕後運作。</span><span class="sxs-lookup"><span data-stu-id="fd775-448">From the client's perspective, every database node is the same: They appear as a single *logical* database with the consistency guarantees of a single-machine system, despite having dozens or even hundreds of nodes that are working behind the scenes.</span></span>

<span data-ttu-id="fd775-449">若要深入瞭解 NewSQL 資料庫背後的機制，請參閱 [虛線： Kubernetes-Native 資料庫的四個屬性](https://thenewstack.io/dash-four-properties-of-kubernetes-native-databases/) 文章。</span><span class="sxs-lookup"><span data-stu-id="fd775-449">For a detailed look at the mechanics behind NewSQL databases, see the [DASH: Four Properties of Kubernetes-Native Databases](https://thenewstack.io/dash-four-properties-of-kubernetes-native-databases/) article.</span></span>

## <a name="data-migration-to-the-cloud"></a><span data-ttu-id="fd775-450">資料移轉至雲端</span><span class="sxs-lookup"><span data-stu-id="fd775-450">Data migration to the cloud</span></span>

<span data-ttu-id="fd775-451">更耗時的工作之一，就是將資料從一個資料平臺遷移到另一個。</span><span class="sxs-lookup"><span data-stu-id="fd775-451">One of the more time-consuming tasks is migrating data from one data platform to another.</span></span> <span data-ttu-id="fd775-452">[Azure 資料移轉服務](https://azure.microsoft.com/services/database-migration/)可協助加速這類工作。</span><span class="sxs-lookup"><span data-stu-id="fd775-452">The [Azure Data Migration Service](https://azure.microsoft.com/services/database-migration/) can help expedite such efforts.</span></span> <span data-ttu-id="fd775-453">它可以將數個外部資料庫來源的資料移轉到 Azure 資料平臺，將停機時間降到一。</span><span class="sxs-lookup"><span data-stu-id="fd775-453">It can migrate data from several external database sources into Azure Data platforms with minimal downtime.</span></span> <span data-ttu-id="fd775-454">目標平臺包括下列服務：</span><span class="sxs-lookup"><span data-stu-id="fd775-454">Target platforms include the following services:</span></span>

- <span data-ttu-id="fd775-455">Azure SQL Database</span><span class="sxs-lookup"><span data-stu-id="fd775-455">Azure SQL Database</span></span>
- <span data-ttu-id="fd775-456">適用於 MySQL 的 Azure 資料庫</span><span class="sxs-lookup"><span data-stu-id="fd775-456">Azure Database for MySQL</span></span>
- <span data-ttu-id="fd775-457">適用於 MariaDB 的 Azure 資料庫</span><span class="sxs-lookup"><span data-stu-id="fd775-457">Azure Database for MariaDB</span></span>
- <span data-ttu-id="fd775-458">適用於 PostgreSQL 的 Azure 資料庫</span><span class="sxs-lookup"><span data-stu-id="fd775-458">Azure Database for PostgreSQL</span></span>
- <span data-ttu-id="fd775-459">CosmosDB</span><span class="sxs-lookup"><span data-stu-id="fd775-459">CosmosDB</span></span>
  
<span data-ttu-id="fd775-460">此服務會提供建議以引導您完成執行遷移（小型或大型）所需的變更。</span><span class="sxs-lookup"><span data-stu-id="fd775-460">The service provides recommendations to guide you through the changes required to execute a migration, both small or large.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="fd775-461">[上一個](distributed-data.md) 
>[下一步](azure-caching.md)</span><span class="sxs-lookup"><span data-stu-id="fd775-461">[Previous](distributed-data.md)
[Next](azure-caching.md)</span></span>

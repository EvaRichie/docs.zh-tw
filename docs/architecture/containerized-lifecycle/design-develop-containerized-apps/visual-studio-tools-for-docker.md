---
title: Windows 上的 Visual Studio Tools for Docker
description: 了解 Visual Studio 2017 15.7 版和更新版本中可用的 Docker 工具。
ms.date: 08/06/2020
ms.custom: vs-dotnet
ms.openlocfilehash: ae20ebf7c3c27d7f2ebe51c33719b82048f86241
ms.sourcegitcommit: aa6d8a90a4f5d8fe0f6e967980b8c98433f05a44
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/16/2020
ms.locfileid: "90678923"
---
# <a name="use-docker-tools-in-visual-studio-on-windows"></a><span data-ttu-id="e390b-103">在 Windows 上的 Visual Studio 中使用 Docker 工具</span><span class="sxs-lookup"><span data-stu-id="e390b-103">Use Docker Tools in Visual Studio on Windows</span></span>

<span data-ttu-id="e390b-104">使用 Docker 工具時包含在 Visual Studio 2017 15.7 版和更新版本中的開發人員工作流程，類似於使用 Visual Studio Code 和 Docker CLI (事實上，它是以相同的 Docker CLI 為基礎)，但它可以更輕鬆地開始使用、簡化此處理序，以及針對建置、執行和撰寫工作提供更高的生產力。</span><span class="sxs-lookup"><span data-stu-id="e390b-104">The developer workflow when using the Docker Tools included in Visual Studio 2017 version 15.7 and later, is similar to using Visual Studio Code and Docker CLI (in fact, it's based on the same Docker CLI), but it's easier to get started, simplifies the process, and provides greater productivity for the build, run, and compose tasks.</span></span> <span data-ttu-id="e390b-105">它也可以從 Visual Studio 透過常用的 `F5` 和 `Ctrl+F5` 按鍵執行容器並對其進行偵錯。</span><span class="sxs-lookup"><span data-stu-id="e390b-105">It can also run and debug your containers via the usual `F5` and `Ctrl+F5` keys from Visual Studio.</span></span> <span data-ttu-id="e390b-106">如果其容器是在解決方案層級的同一個 `docker-compose.yml` 檔案中定義，您甚至可以對整個解決方案進行偵錯。</span><span class="sxs-lookup"><span data-stu-id="e390b-106">You can even debug a whole solution if its containers are defined in the same `docker-compose.yml` file at the solution level.</span></span>

## <a name="configure-your-local-environment"></a><span data-ttu-id="e390b-107">設定您的本機環境</span><span class="sxs-lookup"><span data-stu-id="e390b-107">Configure your local environment</span></span>

<span data-ttu-id="e390b-108">使用適用於 Windows 的最新版本 Docker 時，因為設定非常簡單，所以開發 Docker 應用程式比以往更加容易，如下列參考中所述。</span><span class="sxs-lookup"><span data-stu-id="e390b-108">With the latest versions of Docker for Windows, it's easier than ever to develop Docker applications because the setup is straightforward, as explained in the following references.</span></span>

> [!TIP]
> <span data-ttu-id="e390b-109">若要深入了解如何安裝適用於 Windows 的 Docker，請前往 (<https://docs.docker.com/docker-for-windows/>)。</span><span class="sxs-lookup"><span data-stu-id="e390b-109">To learn more about installing Docker for Windows, go to (<https://docs.docker.com/docker-for-windows/>).</span></span>

## <a name="docker-support-in-visual-studio"></a><span data-ttu-id="e390b-110">Visual Studio 中的 Docker 支援</span><span class="sxs-lookup"><span data-stu-id="e390b-110">Docker support in Visual Studio</span></span>

<span data-ttu-id="e390b-111">您可以將兩種 Docker 支援層級新增至專案。</span><span class="sxs-lookup"><span data-stu-id="e390b-111">There are two levels of Docker support you can add to a project.</span></span> <span data-ttu-id="e390b-112">在 ASP.NET Core 專案中，您可以啟用 Docker 支援，只將 `Dockerfile` 檔案新增至專案。</span><span class="sxs-lookup"><span data-stu-id="e390b-112">In ASP.NET Core projects, you can just add a `Dockerfile` file to the project by enabling Docker support.</span></span> <span data-ttu-id="e390b-113">下一個層級是容器協調流程支援，這會將 `Dockerfile` 新增至專案 (如果它尚未存在) 和解決方案層級的 `docker-compose.yml` 檔案。</span><span class="sxs-lookup"><span data-stu-id="e390b-113">The next level is container orchestration support, which adds a `Dockerfile` to the project (if it doesn't already exist) and a `docker-compose.yml` file at the solution level.</span></span> <span data-ttu-id="e390b-114">預設會透過 Docker Compose 在 Visual Studio 2017 15.0 版至 15.7 版中新增容器協調流程支援。</span><span class="sxs-lookup"><span data-stu-id="e390b-114">Container orchestration support, via Docker Compose, is added by default in Visual Studio 2017 versions 15.0 to 15.7.</span></span> <span data-ttu-id="e390b-115">容器協調流程支援是 Visual Studio 2017 15.8 版或更新版本中的選擇性功能。</span><span class="sxs-lookup"><span data-stu-id="e390b-115">Container orchestration support is an opt-in feature in Visual Studio 2017 versions 15.8 or later.</span></span> <span data-ttu-id="e390b-116">Visual Studio 2019 和更新版本也支援 **Kubernetes/Helm** 部署。</span><span class="sxs-lookup"><span data-stu-id="e390b-116">Visual Studio 2019 and later supports **Kubernetes/Helm** deployment as well.</span></span>

<span data-ttu-id="e390b-117">[新增] > [Docker 支援]\*\*\*\* 和 [新增] > [容器協調器支援]\*\*\*\* 命令位於 [方案總管]\*\*\*\* 中 ASP.NET Core 專案的專案節點右鍵功能表 (或操作功能表) 上，如圖 4-31 所示：</span><span class="sxs-lookup"><span data-stu-id="e390b-117">The **Add > Docker Support** and **Add > Container Orchestrator Support** commands are located on the right-click menu (or context menu) of the project node for an ASP.NET Core project in **Solution Explorer**, as shown in Figure 4-31:</span></span>

![Visual Studio 中的 [新增 Docker 支援] 功能表選項](media/add-docker-support-menu.png)

<span data-ttu-id="e390b-119">**圖 4-31**。</span><span class="sxs-lookup"><span data-stu-id="e390b-119">**Figure 4-31**.</span></span> <span data-ttu-id="e390b-120">將 Docker 支援新增至 Visual Studio 2019 專案</span><span class="sxs-lookup"><span data-stu-id="e390b-120">Adding Docker support to a Visual Studio 2019 project</span></span>

### <a name="add-docker-support"></a><span data-ttu-id="e390b-121">新增 Docker 支援</span><span class="sxs-lookup"><span data-stu-id="e390b-121">Add Docker support</span></span>

<span data-ttu-id="e390b-122">除了如上一節所示，將 Docker 支援新增至現有應用程式的選項之外，您也可以在專案建立期間啟用 docker 支援，方法是在 [**新增專案**] 對話方塊中按一下 **[確定**] 之後，在 [**新增 ASP.NET Core Web 應用程式**] 對話方塊中選取 [**啟用 docker 支援**]，如圖4-32 所示。</span><span class="sxs-lookup"><span data-stu-id="e390b-122">Besides the option to add Docker support to an existing application, as shown in the previous section, you can also enable Docker support during project creation by selecting **Enable Docker Support** in the **New ASP.NET Core Web Application** dialog box that opens after you click **OK** in the **New Project** dialog box, as shown in Figure 4-32.</span></span>

![在 Visual Studio 中為新的 ASP.NET Core Web 應用程式啟用 Docker 支援](media/enable-docker-support-visual-studio.png)

<span data-ttu-id="e390b-124">**圖 4-32**。</span><span class="sxs-lookup"><span data-stu-id="e390b-124">**Figure 4-32**.</span></span> <span data-ttu-id="e390b-125">在 Visual Studio 2019 的專案建立期間啟用 Docker 支援</span><span class="sxs-lookup"><span data-stu-id="e390b-125">Enable Docker support during project creation in Visual Studio 2019</span></span>

<span data-ttu-id="e390b-126">當您新增或啟用 Docker 支援時，Visual Studio 會將 _Dockerfile_ 檔案新增至專案，其中包含解決方案中所有必要專案的參考。</span><span class="sxs-lookup"><span data-stu-id="e390b-126">When you add or enable Docker support, Visual Studio adds a _Dockerfile_ file to the project, that includes references to all required project from the solution.</span></span>

### <a name="add-container-orchestration-support"></a><span data-ttu-id="e390b-127">新增容器協調流程支援</span><span class="sxs-lookup"><span data-stu-id="e390b-127">Add container orchestration support</span></span>

<span data-ttu-id="e390b-128">若要撰寫多容器解決方案，請將容器協調流程支援新增至您的專案。</span><span class="sxs-lookup"><span data-stu-id="e390b-128">When you want to compose a multi-container solution, add container orchestration support to your projects.</span></span> <span data-ttu-id="e390b-129">如果它們在同一個 _docker-compose.yml_ 文件中定義，則允許您同時執行一組容器 (整個解決方案) 並對其進行偵錯。</span><span class="sxs-lookup"><span data-stu-id="e390b-129">This lets you run and debug a group of containers (a whole solution) at the same time if they're defined in the same _docker-compose.yml_ file.</span></span>

<span data-ttu-id="e390b-130">若要新增容器協調流程支援，請以滑鼠右鍵按一下 [方案總管]\*\*\*\* 中的解決方案或專案節點，然後選擇 [新增] > [容器協調流程支援]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="e390b-130">To add container orchestration support, right-click on the solution or project node in **Solution Explorer**, and choose **Add > Container Orchestration Support**.</span></span> <span data-ttu-id="e390b-131">然後選擇 **Kubernetes/Helm** 或 **Docker Compose** 來管理容器。</span><span class="sxs-lookup"><span data-stu-id="e390b-131">Then choose **Kubernetes/Helm** or **Docker Compose** to manage the containers.</span></span>

<span data-ttu-id="e390b-132">將容器協調流程支援新增至您的專案之後，您會看到已新增至專案的 Dockerfile，以及在**方案總管**中新增至解決方案的**docker 組成**資料夾，如圖4-33 所示：</span><span class="sxs-lookup"><span data-stu-id="e390b-132">After you add container orchestration support to your project, you see a Dockerfile added to the project and a **docker-compose** folder added to the solution in **Solution Explorer**, as shown in Figure 4-33:</span></span>

![Visual Studio 中 [方案總管] 中的 Docker 檔案](media/docker-support-solution-explorer.png)

<span data-ttu-id="e390b-134">**圖 4-33**。</span><span class="sxs-lookup"><span data-stu-id="e390b-134">**Figure 4-33**.</span></span> <span data-ttu-id="e390b-135">Visual Studio 2019 中方案總管的 Docker 檔案</span><span class="sxs-lookup"><span data-stu-id="e390b-135">Docker files in Solution Explorer in Visual Studio 2019</span></span>

<span data-ttu-id="e390b-136">如果 _docker-compose.yml_ 已存在，則 Visual Studio 只會向其新增所需的組態程式碼行。</span><span class="sxs-lookup"><span data-stu-id="e390b-136">If _docker-compose.yml_ already exists, Visual Studio just adds the required lines of configuration code to it.</span></span>

## <a name="configure-docker-tools"></a><span data-ttu-id="e390b-137">設定 Docker 工具</span><span class="sxs-lookup"><span data-stu-id="e390b-137">Configure Docker tools</span></span>

<span data-ttu-id="e390b-138">從主功能表中，選擇 [工具] > [選項]\*\*\*\*，並展開 [容器工具] > [設定]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="e390b-138">From the main menu, choose **Tools > Options**, and expand **Container Tools > Settings**.</span></span> <span data-ttu-id="e390b-139">容器工具設定隨即出現。</span><span class="sxs-lookup"><span data-stu-id="e390b-139">The container tools settings appear.</span></span>

![Visual Studio Docker 工具選項，顯示三個頁面： [一般]、[單一專案] 和 [Docker Compose] 文章文字中的詳細資料。](media/visual-studio-docker-tools-options.png)

<span data-ttu-id="e390b-141">**圖 4-34**.</span><span class="sxs-lookup"><span data-stu-id="e390b-141">**Figure 4-34**.</span></span> <span data-ttu-id="e390b-142">Docker 工具選項</span><span class="sxs-lookup"><span data-stu-id="e390b-142">Docker Tools Options</span></span>

<span data-ttu-id="e390b-143">下表可協助您決定如何設定這些選項。</span><span class="sxs-lookup"><span data-stu-id="e390b-143">The following table might help you decide how to set these options.</span></span>

| <span data-ttu-id="e390b-144">頁面/設定</span><span class="sxs-lookup"><span data-stu-id="e390b-144">Page/Setting</span></span>                                |  <span data-ttu-id="e390b-145">預設值</span><span class="sxs-lookup"><span data-stu-id="e390b-145">Default Setting</span></span>   | <span data-ttu-id="e390b-146">描述</span><span class="sxs-lookup"><span data-stu-id="e390b-146">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                           |
| ------------------------------------------- | :----------------: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| <span data-ttu-id="e390b-147">**一般頁面**</span><span class="sxs-lookup"><span data-stu-id="e390b-147">**General page**</span></span>                            |
| <span data-ttu-id="e390b-148">視需要安裝 Docker Desktop</span><span class="sxs-lookup"><span data-stu-id="e390b-148">Install Docker Desktop if needed</span></span>            |     <span data-ttu-id="e390b-149">提示我</span><span class="sxs-lookup"><span data-stu-id="e390b-149">Prompt me</span></span>      |
| <span data-ttu-id="e390b-150">視需要啟動 Docker Desktop</span><span class="sxs-lookup"><span data-stu-id="e390b-150">Start Docker Desktop if needed</span></span>              |     <span data-ttu-id="e390b-151">提示我</span><span class="sxs-lookup"><span data-stu-id="e390b-151">Prompt me</span></span>      |
| <span data-ttu-id="e390b-152">信任 ASP.NET Core SSL 憑證</span><span class="sxs-lookup"><span data-stu-id="e390b-152">Trust ASP.NET Core SSL certificate</span></span>          |     <span data-ttu-id="e390b-153">提示我</span><span class="sxs-lookup"><span data-stu-id="e390b-153">Prompt me</span></span>      | <span data-ttu-id="e390b-154">如果未將 localhost SSL 憑證標示為受信任的 (`dotnet dev-certs https --trust`) ，Visual Studio 會在每次執行專案時提示。</span><span class="sxs-lookup"><span data-stu-id="e390b-154">If the localhost SSL certificate hasn't been marked as trusted (with `dotnet dev-certs https --trust`), Visual Studio will prompt every time you run your project.</span></span>                                                                                                                                                                                                                                                    |
| <span data-ttu-id="e390b-155">**單一專案頁面**</span><span class="sxs-lookup"><span data-stu-id="e390b-155">**Single Project page**</span></span>                     |
| <span data-ttu-id="e390b-156">在專案開啟時提取所需的 Docker 映射</span><span class="sxs-lookup"><span data-stu-id="e390b-156">Pull required Docker images on project open</span></span> |        <span data-ttu-id="e390b-157">是</span><span class="sxs-lookup"><span data-stu-id="e390b-157">True</span></span>        | <span data-ttu-id="e390b-158">為了提高執行專案時的效能，Visual Studio 會在背景中啟動 Docker 提取作業，如此一來，當您準備好要執行程式碼時，影像就已經下載或正在下載。</span><span class="sxs-lookup"><span data-stu-id="e390b-158">For increased performance when running the project, Visual Studio will start a Docker pull operation in the background so that when you're ready to run your code, the image is already downloaded or in the process of downloading.</span></span> <span data-ttu-id="e390b-159">如果您只要載入專案並瀏覽程式碼，則可以關閉這項功能，避免下載您不需要的容器映像。</span><span class="sxs-lookup"><span data-stu-id="e390b-159">If you're just loading projects and browsing code, you can turn this off to avoid downloading container images you don't need.</span></span> <span data-ttu-id="e390b-160">這可能會使開放式專案使用者體驗變慢。</span><span class="sxs-lookup"><span data-stu-id="e390b-160">This could slow the open project user experience.</span></span> |
| <span data-ttu-id="e390b-161">在專案載入時提取更新的 Docker 映射</span><span class="sxs-lookup"><span data-stu-id="e390b-161">Pull updated Docker images on project load</span></span>  | <span data-ttu-id="e390b-162">.NET Core 專案</span><span class="sxs-lookup"><span data-stu-id="e390b-162">.NET Core projects</span></span> | <span data-ttu-id="e390b-163">提取現有映射的更新，以取得專案開啟的最新更新。</span><span class="sxs-lookup"><span data-stu-id="e390b-163">Pull updates to existing images to get the latest updates on project open.</span></span> <span data-ttu-id="e390b-164">這可能會使開放式專案使用者體驗變慢。</span><span class="sxs-lookup"><span data-stu-id="e390b-164">This could slow the open project user experience.</span></span>                                                                                                                                                                                                                                                                                          |
| <span data-ttu-id="e390b-165">在專案關閉時移除容器</span><span class="sxs-lookup"><span data-stu-id="e390b-165">Remove containers on project close</span></span>          |        <span data-ttu-id="e390b-166">是</span><span class="sxs-lookup"><span data-stu-id="e390b-166">True</span></span>        | <span data-ttu-id="e390b-167">清除專案關閉時，這可能會使關閉專案的使用者體驗變慢，但通常仍會快速。</span><span class="sxs-lookup"><span data-stu-id="e390b-167">Clean up on project close, This could slow the close project user experience but it's usually fast anyway.</span></span>                                                                                                                                                                                                                                                                                                            |
| <span data-ttu-id="e390b-168">在專案開啟時執行容器</span><span class="sxs-lookup"><span data-stu-id="e390b-168">Run containers on project open</span></span>              |        <span data-ttu-id="e390b-169">是</span><span class="sxs-lookup"><span data-stu-id="e390b-169">True</span></span>        | <span data-ttu-id="e390b-170">為了提高執行專案時的效能，Visual Studio 會啟動方案中的所有容器。</span><span class="sxs-lookup"><span data-stu-id="e390b-170">For increased performance when running the project, Visual Studio will start all containers in the solution.</span></span> <span data-ttu-id="e390b-171">這可能會使開放式專案使用者體驗變慢。</span><span class="sxs-lookup"><span data-stu-id="e390b-171">This could slow the open project user experience.</span></span>                                                                                                                                                                                                                                                        |
| <span data-ttu-id="e390b-172">**Docker Compose**</span><span class="sxs-lookup"><span data-stu-id="e390b-172">**Docker Compose**</span></span>                          |                    | <span data-ttu-id="e390b-173">Docker Compose 頁面包含與單一專案頁面相同的設定，但這些設定適用于多容器解決方案。</span><span class="sxs-lookup"><span data-stu-id="e390b-173">The Docker Compose page contains the same settings as the Single Project page, but they apply to multi-container solutions.</span></span>                                                                                                                                                                                                                                                                                           |

> [!WARNING]
> <span data-ttu-id="e390b-174">如果 localhost SSL 憑證不受信任，而且您將此選項設定為 [ **永不**]，則 HTTPS web 要求可能會在您的應用程式或服務中的執行時間失敗。</span><span class="sxs-lookup"><span data-stu-id="e390b-174">If the localhost SSL certificate is not trusted, and you set the option to **Never**, then HTTPS web requests might fail at runtime in your app or service.</span></span> <span data-ttu-id="e390b-175">在這種情況下，請再次將值設定為 [ **提示我** ]，或者，更好的是，使用命令來信任您開發電腦上的憑證 `dotnet dev-certs https --trust` 。</span><span class="sxs-lookup"><span data-stu-id="e390b-175">In that case, set the value back again to **Prompt me** or, better again, trust the certificates in your dev machine using the command `dotnet dev-certs https --trust`.</span></span>

> [!TIP]
> <span data-ttu-id="e390b-176">如需服務實作和使用 Visual Studio Tools for Docker 的進一步詳細資料，請閱讀下列文章：</span><span class="sxs-lookup"><span data-stu-id="e390b-176">For further details on the services implementation and use of Visual Studio Tools for Docker, read the following articles:</span></span>
>
> <span data-ttu-id="e390b-177">在本機 Docker 容器中偵錯工具： <https://docs.microsoft.com/visualstudio/containers/edit-and-refresh></span><span class="sxs-lookup"><span data-stu-id="e390b-177">Debug apps in a local Docker container: <https://docs.microsoft.com/visualstudio/containers/edit-and-refresh></span></span>
>
> <span data-ttu-id="e390b-178">使用 Visual Studio 將 ASP.NET 容器部署到容器登錄：<https://docs.microsoft.com/visualstudio/containers/hosting-web-apps-in-docker></span><span class="sxs-lookup"><span data-stu-id="e390b-178">Deploy an ASP.NET container to a container registry using Visual Studio: <https://docs.microsoft.com/visualstudio/containers/hosting-web-apps-in-docker></span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="e390b-179">[上一個](docker-apps-inner-loop-workflow.md) 
> [下一步](set-up-windows-containers-with-powershell.md)</span><span class="sxs-lookup"><span data-stu-id="e390b-179">[Previous](docker-apps-inner-loop-workflow.md)
[Next](set-up-windows-containers-with-powershell.md)</span></span>

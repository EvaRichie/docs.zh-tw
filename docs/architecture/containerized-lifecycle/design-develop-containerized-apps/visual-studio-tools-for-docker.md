---
title: Windows 上的 Visual Studio Tools for Docker
description: 了解 Visual Studio 2017 15.7 版和更新版本中可用的 Docker 工具。
ms.date: 08/06/2020
ms.custom: vs-dotnet
ms.openlocfilehash: 74cffaae5885a7079ec774b1e8c68241cddda99a
ms.sourcegitcommit: ef50c99928183a0bba75e07b9f22895cd4c480f8
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/07/2020
ms.locfileid: "87915297"
---
# <a name="use-docker-tools-in-visual-studio-on-windows"></a><span data-ttu-id="a6469-103">在 Windows 上的 Visual Studio 中使用 Docker 工具</span><span class="sxs-lookup"><span data-stu-id="a6469-103">Use Docker Tools in Visual Studio on Windows</span></span>

<span data-ttu-id="a6469-104">使用 Docker 工具時包含在 Visual Studio 2017 15.7 版和更新版本中的開發人員工作流程，類似於使用 Visual Studio Code 和 Docker CLI (事實上，它是以相同的 Docker CLI 為基礎)，但它可以更輕鬆地開始使用、簡化此處理序，以及針對建置、執行和撰寫工作提供更高的生產力。</span><span class="sxs-lookup"><span data-stu-id="a6469-104">The developer workflow when using the Docker Tools included in Visual Studio 2017 version 15.7 and later, is similar to using Visual Studio Code and Docker CLI (in fact, it's based on the same Docker CLI), but it's easier to get started, simplifies the process, and provides greater productivity for the build, run, and compose tasks.</span></span> <span data-ttu-id="a6469-105">它也可以從 Visual Studio 透過常用的 `F5` 和 `Ctrl+F5` 按鍵執行容器並對其進行偵錯。</span><span class="sxs-lookup"><span data-stu-id="a6469-105">It can also run and debug your containers via the usual `F5` and `Ctrl+F5` keys from Visual Studio.</span></span> <span data-ttu-id="a6469-106">如果其容器是在解決方案層級的同一個 `docker-compose.yml` 檔案中定義，您甚至可以對整個解決方案進行偵錯。</span><span class="sxs-lookup"><span data-stu-id="a6469-106">You can even debug a whole solution if its containers are defined in the same `docker-compose.yml` file at the solution level.</span></span>

## <a name="configure-your-local-environment"></a><span data-ttu-id="a6469-107">設定您的本機環境</span><span class="sxs-lookup"><span data-stu-id="a6469-107">Configure your local environment</span></span>

<span data-ttu-id="a6469-108">使用適用於 Windows 的最新版本 Docker 時，因為設定非常簡單，所以開發 Docker 應用程式比以往更加容易，如下列參考中所述。</span><span class="sxs-lookup"><span data-stu-id="a6469-108">With the latest versions of Docker for Windows, it's easier than ever to develop Docker applications because the setup is straightforward, as explained in the following references.</span></span>

> [!TIP]
> <span data-ttu-id="a6469-109">若要深入了解如何安裝適用於 Windows 的 Docker，請前往 (<https://docs.docker.com/docker-for-windows/>)。</span><span class="sxs-lookup"><span data-stu-id="a6469-109">To learn more about installing Docker for Windows, go to (<https://docs.docker.com/docker-for-windows/>).</span></span>

## <a name="docker-support-in-visual-studio"></a><span data-ttu-id="a6469-110">Visual Studio 中的 Docker 支援</span><span class="sxs-lookup"><span data-stu-id="a6469-110">Docker support in Visual Studio</span></span>

<span data-ttu-id="a6469-111">您可以將兩種 Docker 支援層級新增至專案。</span><span class="sxs-lookup"><span data-stu-id="a6469-111">There are two levels of Docker support you can add to a project.</span></span> <span data-ttu-id="a6469-112">在 ASP.NET Core 專案中，您可以啟用 Docker 支援，只將 `Dockerfile` 檔案新增至專案。</span><span class="sxs-lookup"><span data-stu-id="a6469-112">In ASP.NET Core projects, you can just add a `Dockerfile` file to the project by enabling Docker support.</span></span> <span data-ttu-id="a6469-113">下一個層級是容器協調流程支援，這會將 `Dockerfile` 新增至專案 (如果它尚未存在) 和解決方案層級的 `docker-compose.yml` 檔案。</span><span class="sxs-lookup"><span data-stu-id="a6469-113">The next level is container orchestration support, which adds a `Dockerfile` to the project (if it doesn't already exist) and a `docker-compose.yml` file at the solution level.</span></span> <span data-ttu-id="a6469-114">預設會透過 Docker Compose 在 Visual Studio 2017 15.0 版至 15.7 版中新增容器協調流程支援。</span><span class="sxs-lookup"><span data-stu-id="a6469-114">Container orchestration support, via Docker Compose, is added by default in Visual Studio 2017 versions 15.0 to 15.7.</span></span> <span data-ttu-id="a6469-115">容器協調流程支援是 Visual Studio 2017 15.8 版或更新版本中的選擇性功能。</span><span class="sxs-lookup"><span data-stu-id="a6469-115">Container orchestration support is an opt-in feature in Visual Studio 2017 versions 15.8 or later.</span></span> <span data-ttu-id="a6469-116">Visual Studio 2019 和更新版本也支援**Kubernetes/Helm**部署。</span><span class="sxs-lookup"><span data-stu-id="a6469-116">Visual Studio 2019 and later supports **Kubernetes/Helm** deployment as well.</span></span>

<span data-ttu-id="a6469-117">[新增] > [Docker 支援]\*\*\*\* 和 [新增] > [容器協調器支援]\*\*\*\* 命令位於 [方案總管]\*\*\*\* 中 ASP.NET Core 專案的專案節點右鍵功能表 (或操作功能表) 上，如圖 4-31 所示：</span><span class="sxs-lookup"><span data-stu-id="a6469-117">The **Add > Docker Support** and **Add > Container Orchestrator Support** commands are located on the right-click menu (or context menu) of the project node for an ASP.NET Core project in **Solution Explorer**, as shown in Figure 4-31:</span></span>

![Visual Studio 中的 [新增 Docker 支援] 功能表選項](media/add-docker-support-menu.png)

<span data-ttu-id="a6469-119">**圖 4-31**。</span><span class="sxs-lookup"><span data-stu-id="a6469-119">**Figure 4-31**.</span></span> <span data-ttu-id="a6469-120">將 Docker 支援新增至 Visual Studio 2019 專案</span><span class="sxs-lookup"><span data-stu-id="a6469-120">Adding Docker support to a Visual Studio 2019 project</span></span>

### <a name="add-docker-support"></a><span data-ttu-id="a6469-121">新增 Docker 支援</span><span class="sxs-lookup"><span data-stu-id="a6469-121">Add Docker support</span></span>

<span data-ttu-id="a6469-122">除了將 Docker 支援新增至現有應用程式的選項（如上一節所示）之外，您也可以在建立專案期間啟用 docker 支援，方法是在 [新增**專案**] 對話方塊中按一下 [**確定]** 之後，在 [新增**ASP.NET Core Web 應用程式**] 對話方塊中選取 [**啟用 docker 支援**]，如圖4-32 所示。</span><span class="sxs-lookup"><span data-stu-id="a6469-122">Besides the option to add Docker support to an existing application, as shown in the previous section, you can also enable Docker support during project creation by selecting **Enable Docker Support** in the **New ASP.NET Core Web Application** dialog box that opens after you click **OK** in the **New Project** dialog box, as shown in Figure 4-32.</span></span>

![在 Visual Studio 中為新的 ASP.NET Core Web 應用程式啟用 Docker 支援](media/enable-docker-support-visual-studio.png)

<span data-ttu-id="a6469-124">**圖 4-32**。</span><span class="sxs-lookup"><span data-stu-id="a6469-124">**Figure 4-32**.</span></span> <span data-ttu-id="a6469-125">在 Visual Studio 2019 的專案建立期間啟用 Docker 支援</span><span class="sxs-lookup"><span data-stu-id="a6469-125">Enable Docker support during project creation in Visual Studio 2019</span></span>

<span data-ttu-id="a6469-126">當您新增或啟用 Docker 支援時，Visual Studio 會將_Dockerfile_檔案加入至專案，其中包含方案中所有必要專案的參考。</span><span class="sxs-lookup"><span data-stu-id="a6469-126">When you add or enable Docker support, Visual Studio adds a _Dockerfile_ file to the project, that includes references to all required project from the solution.</span></span>

### <a name="add-container-orchestration-support"></a><span data-ttu-id="a6469-127">新增容器協調流程支援</span><span class="sxs-lookup"><span data-stu-id="a6469-127">Add container orchestration support</span></span>

<span data-ttu-id="a6469-128">若要撰寫多容器解決方案，請將容器協調流程支援新增至您的專案。</span><span class="sxs-lookup"><span data-stu-id="a6469-128">When you want to compose a multi-container solution, add container orchestration support to your projects.</span></span> <span data-ttu-id="a6469-129">如果它們在同一個 _docker-compose.yml_ 文件中定義，則允許您同時執行一組容器 (整個解決方案) 並對其進行偵錯。</span><span class="sxs-lookup"><span data-stu-id="a6469-129">This lets you run and debug a group of containers (a whole solution) at the same time if they're defined in the same _docker-compose.yml_ file.</span></span>

<span data-ttu-id="a6469-130">若要新增容器協調流程支援，請以滑鼠右鍵按一下 [方案總管]\*\*\*\* 中的解決方案或專案節點，然後選擇 [新增] > [容器協調流程支援]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="a6469-130">To add container orchestration support, right-click on the solution or project node in **Solution Explorer**, and choose **Add > Container Orchestration Support**.</span></span> <span data-ttu-id="a6469-131">然後選擇 [ **Kubernetes]/[Helm** ] 或 [ **Docker Compose** ] 來管理容器。</span><span class="sxs-lookup"><span data-stu-id="a6469-131">Then choose **Kubernetes/Helm** or **Docker Compose** to manage the containers.</span></span>

<span data-ttu-id="a6469-132">在您將容器協調流程支援新增至專案之後，您會看到新增至專案的 Dockerfile，以及新增至方案中**方案總管**的**docker 撰寫**資料夾，如圖4-33 所示：</span><span class="sxs-lookup"><span data-stu-id="a6469-132">After you add container orchestration support to your project, you see a Dockerfile added to the project and a **docker-compose** folder added to the solution in **Solution Explorer**, as shown in Figure 4-33:</span></span>

![Visual Studio 中 [方案總管] 中的 Docker 檔案](media/docker-support-solution-explorer.png)

<span data-ttu-id="a6469-134">**圖 4-33**。</span><span class="sxs-lookup"><span data-stu-id="a6469-134">**Figure 4-33**.</span></span> <span data-ttu-id="a6469-135">Visual Studio 2019 中方案總管中的 Docker 檔案</span><span class="sxs-lookup"><span data-stu-id="a6469-135">Docker files in Solution Explorer in Visual Studio 2019</span></span>

<span data-ttu-id="a6469-136">如果 _docker-compose.yml_ 已存在，則 Visual Studio 只會向其新增所需的組態程式碼行。</span><span class="sxs-lookup"><span data-stu-id="a6469-136">If _docker-compose.yml_ already exists, Visual Studio just adds the required lines of configuration code to it.</span></span>

## <a name="configure-docker-tools"></a><span data-ttu-id="a6469-137">設定 Docker 工具</span><span class="sxs-lookup"><span data-stu-id="a6469-137">Configure Docker tools</span></span>

<span data-ttu-id="a6469-138">從主功能表中，選擇 [工具] > [選項]\*\*\*\*，並展開 [容器工具] > [設定]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="a6469-138">From the main menu, choose **Tools > Options**, and expand **Container Tools > Settings**.</span></span> <span data-ttu-id="a6469-139">容器工具設定隨即出現。</span><span class="sxs-lookup"><span data-stu-id="a6469-139">The container tools settings appear.</span></span>

![Visual Studio Docker 工具選項，顯示三個頁面： [一般]、[單一專案] 和 [Docker Compose]、[文章文字] 中的詳細資料。](media/visual-studio-docker-tools-options.png)

<span data-ttu-id="a6469-141">**圖 4-34**.</span><span class="sxs-lookup"><span data-stu-id="a6469-141">**Figure 4-34**.</span></span> <span data-ttu-id="a6469-142">Docker 工具選項</span><span class="sxs-lookup"><span data-stu-id="a6469-142">Docker Tools Options</span></span>

<span data-ttu-id="a6469-143">下表可協助您決定如何設定這些選項。</span><span class="sxs-lookup"><span data-stu-id="a6469-143">The following table might help you decide how to set these options.</span></span>

| <span data-ttu-id="a6469-144">頁面/設定</span><span class="sxs-lookup"><span data-stu-id="a6469-144">Page/Setting</span></span>                                |  <span data-ttu-id="a6469-145">預設值</span><span class="sxs-lookup"><span data-stu-id="a6469-145">Default Setting</span></span>   | <span data-ttu-id="a6469-146">描述</span><span class="sxs-lookup"><span data-stu-id="a6469-146">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                           |
| ------------------------------------------- | :----------------: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| <span data-ttu-id="a6469-147">**一般頁面**</span><span class="sxs-lookup"><span data-stu-id="a6469-147">**General page**</span></span>                            |
| <span data-ttu-id="a6469-148">視需要安裝 Docker Desktop</span><span class="sxs-lookup"><span data-stu-id="a6469-148">Install Docker Desktop if needed</span></span>            |     <span data-ttu-id="a6469-149">提示我</span><span class="sxs-lookup"><span data-stu-id="a6469-149">Prompt me</span></span>      |
| <span data-ttu-id="a6469-150">視需要啟動 Docker Desktop</span><span class="sxs-lookup"><span data-stu-id="a6469-150">Start Docker Desktop if needed</span></span>              |     <span data-ttu-id="a6469-151">提示我</span><span class="sxs-lookup"><span data-stu-id="a6469-151">Prompt me</span></span>      |
| <span data-ttu-id="a6469-152">信任 ASP.NET Core SSL 憑證</span><span class="sxs-lookup"><span data-stu-id="a6469-152">Trust ASP.NET Core SSL certificate</span></span>          |     <span data-ttu-id="a6469-153">提示我</span><span class="sxs-lookup"><span data-stu-id="a6469-153">Prompt me</span></span>      | <span data-ttu-id="a6469-154">如果 localhost SSL 憑證尚未標示為信任的 (與 `dotnet dev-certs https --trust`) ，Visual Studio 會在每次您執行專案時提示。</span><span class="sxs-lookup"><span data-stu-id="a6469-154">If the localhost SSL certificate hasn't been marked as trusted (with `dotnet dev-certs https --trust`), Visual Studio will prompt every time you run your project.</span></span>                                                                                                                                                                                                                                                    |
| <span data-ttu-id="a6469-155">**單一專案頁面**</span><span class="sxs-lookup"><span data-stu-id="a6469-155">**Single Project page**</span></span>                     |
| <span data-ttu-id="a6469-156">在專案開啟時提取所需的 Docker 映射</span><span class="sxs-lookup"><span data-stu-id="a6469-156">Pull required Docker images on project open</span></span> |        <span data-ttu-id="a6469-157">True</span><span class="sxs-lookup"><span data-stu-id="a6469-157">True</span></span>        | <span data-ttu-id="a6469-158">為了在執行專案時提高效能，Visual Studio 會在背景啟動 Docker pull 作業，以便在您準備好要執行您的程式碼時，映射已經下載或正在下載的過程中。</span><span class="sxs-lookup"><span data-stu-id="a6469-158">For increased performance when running the project, Visual Studio will start a Docker pull operation in the background so that when you're ready to run your code, the image is already downloaded or in the process of downloading.</span></span> <span data-ttu-id="a6469-159">如果您只要載入專案並瀏覽程式碼，則可以關閉這項功能，避免下載您不需要的容器映像。</span><span class="sxs-lookup"><span data-stu-id="a6469-159">If you're just loading projects and browsing code, you can turn this off to avoid downloading container images you don't need.</span></span> <span data-ttu-id="a6469-160">這可能會使開啟的專案使用者體驗變慢。</span><span class="sxs-lookup"><span data-stu-id="a6469-160">This could slow the open project user experience.</span></span> |
| <span data-ttu-id="a6469-161">在專案載入時提取更新的 Docker 映射</span><span class="sxs-lookup"><span data-stu-id="a6469-161">Pull updated Docker images on project load</span></span>  | <span data-ttu-id="a6469-162">.NET Core 專案</span><span class="sxs-lookup"><span data-stu-id="a6469-162">.NET Core projects</span></span> | <span data-ttu-id="a6469-163">提取現有影像的更新，以在專案開啟時取得最新的更新。</span><span class="sxs-lookup"><span data-stu-id="a6469-163">Pull updates to existing images to get the latest updates on project open.</span></span> <span data-ttu-id="a6469-164">這可能會使開啟的專案使用者體驗變慢。</span><span class="sxs-lookup"><span data-stu-id="a6469-164">This could slow the open project user experience.</span></span>                                                                                                                                                                                                                                                                                          |
| <span data-ttu-id="a6469-165">在專案關閉時移除容器</span><span class="sxs-lookup"><span data-stu-id="a6469-165">Remove containers on project close</span></span>          |        <span data-ttu-id="a6469-166">True</span><span class="sxs-lookup"><span data-stu-id="a6469-166">True</span></span>        | <span data-ttu-id="a6469-167">清理專案關閉時，這可能會使關閉專案使用者體驗變慢，但通常還是會快速。</span><span class="sxs-lookup"><span data-stu-id="a6469-167">Clean up on project close, This could slow the close project user experience but it's usually fast anyway.</span></span>                                                                                                                                                                                                                                                                                                            |
| <span data-ttu-id="a6469-168">在專案開啟時執行容器</span><span class="sxs-lookup"><span data-stu-id="a6469-168">Run containers on project open</span></span>              |        <span data-ttu-id="a6469-169">True</span><span class="sxs-lookup"><span data-stu-id="a6469-169">True</span></span>        | <span data-ttu-id="a6469-170">為了在執行專案時提高效能，Visual Studio 會啟動解決方案中的所有容器。</span><span class="sxs-lookup"><span data-stu-id="a6469-170">For increased performance when running the project, Visual Studio will start all containers in the solution.</span></span> <span data-ttu-id="a6469-171">這可能會使開啟的專案使用者體驗變慢。</span><span class="sxs-lookup"><span data-stu-id="a6469-171">This could slow the open project user experience.</span></span>                                                                                                                                                                                                                                                        |
| <span data-ttu-id="a6469-172">**Docker Compose**</span><span class="sxs-lookup"><span data-stu-id="a6469-172">**Docker Compose**</span></span>                          |                    | <span data-ttu-id="a6469-173">[Docker Compose] 頁面包含與 [單一專案] 頁面相同的設定，但它們適用于多容器解決方案。</span><span class="sxs-lookup"><span data-stu-id="a6469-173">The Docker Compose page contains the same settings as the Single Project page, but they apply to multi-container solutions.</span></span>                                                                                                                                                                                                                                                                                           |

> [!WARNING]
> <span data-ttu-id="a6469-174">如果 localhost SSL 憑證不受信任，而且您將此選項設定為 [**永不**]，則 HTTPS web 要求可能會在您的應用程式或服務中的執行時間失敗。</span><span class="sxs-lookup"><span data-stu-id="a6469-174">If the localhost SSL certificate is not trusted, and you set the option to **Never**, then HTTPS web requests might fail at runtime in your app or service.</span></span> <span data-ttu-id="a6469-175">在這種情況下，請再次將值設定為 [**提示我**]，然後使用命令，以更好的方式來信任開發電腦上的憑證 `dotnet dev-certs https --trust` 。</span><span class="sxs-lookup"><span data-stu-id="a6469-175">In that case, set the value back again to **Prompt me** or, better again, trust the certificates in your dev machine using the command `dotnet dev-certs https --trust`.</span></span>

> [!TIP]
> <span data-ttu-id="a6469-176">如需服務實作和使用 Visual Studio Tools for Docker 的進一步詳細資料，請閱讀下列文章：</span><span class="sxs-lookup"><span data-stu-id="a6469-176">For further details on the services implementation and use of Visual Studio Tools for Docker, read the following articles:</span></span>
>
> <span data-ttu-id="a6469-177">在本機 Docker 容器中的偵錯工具：<https://docs.microsoft.com/azure/vs-azure-tools-docker-edit-and-refresh></span><span class="sxs-lookup"><span data-stu-id="a6469-177">Debug apps in a local Docker container: <https://docs.microsoft.com/azure/vs-azure-tools-docker-edit-and-refresh></span></span>
>
> <span data-ttu-id="a6469-178">使用 Visual Studio 將 ASP.NET 容器部署到容器登錄：<https://docs.microsoft.com/azure/vs-azure-tools-docker-hosting-web-apps-in-docker></span><span class="sxs-lookup"><span data-stu-id="a6469-178">Deploy an ASP.NET container to a container registry using Visual Studio: <https://docs.microsoft.com/azure/vs-azure-tools-docker-hosting-web-apps-in-docker></span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="a6469-179">[上一個](docker-apps-inner-loop-workflow.md) 
> [下一步](set-up-windows-containers-with-powershell.md)</span><span class="sxs-lookup"><span data-stu-id="a6469-179">[Previous](docker-apps-inner-loop-workflow.md)
[Next](set-up-windows-containers-with-powershell.md)</span></span>

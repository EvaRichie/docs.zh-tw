---
title: 將現有節點從一個文件複製到另一個文件
ms.date: 03/30/2017
ms.assetid: 3caa78c1-3448-4b7b-b83c-228ee857635e
ms.openlocfilehash: f4d58fa5aafdd48feff1a768ab0463ac09315476
ms.sourcegitcommit: 965a5af7918acb0a3fd3baf342e15d511ef75188
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 11/18/2020
ms.locfileid: "94829605"
---
# <a name="copying-existing-nodes-from-one-document-to-another"></a><span data-ttu-id="ca1d3-102">將現有節點從一個文件複製到另一個文件</span><span class="sxs-lookup"><span data-stu-id="ca1d3-102">Copying Existing Nodes from One Document to Another</span></span>
<span data-ttu-id="ca1d3-103">**ImportNode** 方法是一種機制，藉由這個機制，節點或整個節點樹狀子目錄會從一個 **XmlDocument** 複製到另一個。</span><span class="sxs-lookup"><span data-stu-id="ca1d3-103">The **ImportNode** method is the mechanism by which a node or entire node subtree is copied from one **XmlDocument** to another.</span></span> <span data-ttu-id="ca1d3-104">從呼叫傳回的節點是來自來源文件的節點複本，包括屬性值、節點名稱、節點型別和所有與命名空間相關的屬性，例如前置詞、區域名稱和命名空間統一資源識別元 (URI)。</span><span class="sxs-lookup"><span data-stu-id="ca1d3-104">The node returned from the call is a copy of the node from the source document, including attribute values, the node name, node type, and all namespace-related attributes such as the prefix, local name, and namespace Uniform Resource Identifier (URI).</span></span> <span data-ttu-id="ca1d3-105">來源文件不會變更。</span><span class="sxs-lookup"><span data-stu-id="ca1d3-105">The source document is not changed.</span></span> <span data-ttu-id="ca1d3-106">在匯入節點之後，您仍然必須使用用於插入節點的其中一種方法將它加入至樹狀結構。</span><span class="sxs-lookup"><span data-stu-id="ca1d3-106">After you have imported the node, you still have to add it to the tree using one of the methods used to insert nodes.</span></span>  
  
 <span data-ttu-id="ca1d3-107">當節點附加於它的新文件時，新文件即擁有節點。</span><span class="sxs-lookup"><span data-stu-id="ca1d3-107">When the node is attached to its new document, the new document owns the node.</span></span> <span data-ttu-id="ca1d3-108">原因是在建立時，每個節點都會有自己的文件，即使節點是建立在不同的文件片段中也一樣。</span><span class="sxs-lookup"><span data-stu-id="ca1d3-108">The reason is that each node, when created, has an owning document, even if the nodes are created in separate document fragments.</span></span> <span data-ttu-id="ca1d3-109">這是 XML 文件物件模型 (DOM) 的必要需求，**XmlDocument** 類別上的原廠建立設計會加以強制執行。</span><span class="sxs-lookup"><span data-stu-id="ca1d3-109">This is a requirement of the XML Document Object Model (DOM) and is enforced by the factory creation design on the **XmlDocument** class.</span></span> <span data-ttu-id="ca1d3-110">例如，**CreateElement** 即為建立新節點的方式之一。</span><span class="sxs-lookup"><span data-stu-id="ca1d3-110">For example, **CreateElement**, is the only way to create new nodes.</span></span>  
  
 <span data-ttu-id="ca1d3-111">根據匯入節點的節點型別和 *deep* 參數的值，其他的資訊會適當的複製。</span><span class="sxs-lookup"><span data-stu-id="ca1d3-111">Depending on the node type of the imported node and the value of the *deep* parameter, additional information is copied as appropriate.</span></span> <span data-ttu-id="ca1d3-112">若 XML 或 HTML 來源的片段是從某份文件複製到另一份文件，則這個方法會嘗試反映預期的行為，這表示對於 XML，這兩份文件可能具有不同的文件類型定義 (DTD)。</span><span class="sxs-lookup"><span data-stu-id="ca1d3-112">This method attempts to mirror the behavior expected if a fragment of XML or HTML source was copied from one document to another, accounting for the fact that for XML, the two documents may have different document type definitions (DTDs).</span></span>  
  
 <span data-ttu-id="ca1d3-113">下列表格說明可以匯入之每種節點型別的特定行為。</span><span class="sxs-lookup"><span data-stu-id="ca1d3-113">The following table describes the specific behavior for each type of node that can be imported.</span></span>  
  
|<span data-ttu-id="ca1d3-114">節點類型</span><span class="sxs-lookup"><span data-stu-id="ca1d3-114">Node Type</span></span>|<span data-ttu-id="ca1d3-115">*deep* 參數為 true</span><span class="sxs-lookup"><span data-stu-id="ca1d3-115">*deep* parameter is true</span></span>|<span data-ttu-id="ca1d3-116">*deep* 參數為 false</span><span class="sxs-lookup"><span data-stu-id="ca1d3-116">*deep* parameter is false</span></span>|  
|---------------|------------------------------|-------------------------------|  
|<span data-ttu-id="ca1d3-117">XmlAttribute</span><span class="sxs-lookup"><span data-stu-id="ca1d3-117">XmlAttribute</span></span>|<span data-ttu-id="ca1d3-118"><xref:System.Xml.XmlAttribute.Specified%2A> 在 XmlAttribute 上會設為 **true**。</span><span class="sxs-lookup"><span data-stu-id="ca1d3-118">The <xref:System.Xml.XmlAttribute.Specified%2A> is set to **true** on the XmlAttribute.</span></span> <span data-ttu-id="ca1d3-119">來源 **XmlAttribute** 的子代會遞迴匯入，而且產生的節點會重組以形成對應的樹狀子目錄。</span><span class="sxs-lookup"><span data-stu-id="ca1d3-119">The descendants of the source **XmlAttribute** are recursively imported and the resulting nodes reassembled to form the corresponding subtree.</span></span>|<span data-ttu-id="ca1d3-120">*deep* 參數不會套用至 **XmlAttribute** 節點，因為它們在匯入時一定會帶著它們的子節點。</span><span class="sxs-lookup"><span data-stu-id="ca1d3-120">The *deep* parameter does not apply to **XmlAttribute** nodes, because they always carry their child nodes with them when imported.</span></span>|  
|<span data-ttu-id="ca1d3-121">XmlCDataSection</span><span class="sxs-lookup"><span data-stu-id="ca1d3-121">XmlCDataSection</span></span>|<span data-ttu-id="ca1d3-122">複製節點，包含其資料。</span><span class="sxs-lookup"><span data-stu-id="ca1d3-122">Copies the node, including its data.</span></span>|<span data-ttu-id="ca1d3-123">複製節點，包含其資料。</span><span class="sxs-lookup"><span data-stu-id="ca1d3-123">Copies the node, including its data.</span></span>|  
|<span data-ttu-id="ca1d3-124">XmlComment</span><span class="sxs-lookup"><span data-stu-id="ca1d3-124">XmlComment</span></span>|<span data-ttu-id="ca1d3-125">複製節點，包含其資料。</span><span class="sxs-lookup"><span data-stu-id="ca1d3-125">Copies the node, including its data.</span></span>|<span data-ttu-id="ca1d3-126">複製節點，包含其資料。</span><span class="sxs-lookup"><span data-stu-id="ca1d3-126">Copies the node, including its data.</span></span>|  
|<span data-ttu-id="ca1d3-127">XmlDocumentFragment</span><span class="sxs-lookup"><span data-stu-id="ca1d3-127">XmlDocumentFragment</span></span>|<span data-ttu-id="ca1d3-128">來源節點的子代會遞迴匯入，而且產生的節點會重組以形成對應的樹狀子目錄。</span><span class="sxs-lookup"><span data-stu-id="ca1d3-128">The descendants of the source node are recursively imported and the resulting nodes reassembled to form the corresponding subtree.</span></span>|<span data-ttu-id="ca1d3-129">會建立空白的 **XmlDocumentFragment**。</span><span class="sxs-lookup"><span data-stu-id="ca1d3-129">An empty **XmlDocumentFragment** is created.</span></span>|  
|<span data-ttu-id="ca1d3-130">XmlDocumentType</span><span class="sxs-lookup"><span data-stu-id="ca1d3-130">XmlDocumentType</span></span>|<span data-ttu-id="ca1d3-131">複製節點，包含其 data.\*</span><span class="sxs-lookup"><span data-stu-id="ca1d3-131">Copies the node, including its data.\*</span></span>|<span data-ttu-id="ca1d3-132">複製節點，包含其 data.\*</span><span class="sxs-lookup"><span data-stu-id="ca1d3-132">Copies the node, including its data.\*</span></span>|  
|<span data-ttu-id="ca1d3-133">XmlElement</span><span class="sxs-lookup"><span data-stu-id="ca1d3-133">XmlElement</span></span>|<span data-ttu-id="ca1d3-134">來源項目的子代會遞迴匯入，而且產生的節點會重組以形成對應的樹狀子目錄。</span><span class="sxs-lookup"><span data-stu-id="ca1d3-134">The descendants of the source element are recursively imported and the resulting nodes reassembled to form the corresponding subtree.</span></span> <span data-ttu-id="ca1d3-135">**注意：** 不會複製預設屬性。</span><span class="sxs-lookup"><span data-stu-id="ca1d3-135">**Note:**  Default attributes are not copied.</span></span> <span data-ttu-id="ca1d3-136">如果要匯入的文件定義這個項目名稱的預設屬性，就會指派這些屬性。</span><span class="sxs-lookup"><span data-stu-id="ca1d3-136">If the document being imported into defines default attributes for this element name, those are assigned.</span></span>|<span data-ttu-id="ca1d3-137">來源項目的指定屬性節點會匯入，而且產生的 **XmlAttribute** 節點會附加至新項目。</span><span class="sxs-lookup"><span data-stu-id="ca1d3-137">Specified attribute nodes of the source element are imported, and the generated **XmlAttribute** nodes are attached to the new element.</span></span> <span data-ttu-id="ca1d3-138">不會複製子代節點。</span><span class="sxs-lookup"><span data-stu-id="ca1d3-138">The descendant nodes are not copied.</span></span> <span data-ttu-id="ca1d3-139">**注意：** 不會複製預設屬性。</span><span class="sxs-lookup"><span data-stu-id="ca1d3-139">**Note:**  Default attributes are not copied.</span></span> <span data-ttu-id="ca1d3-140">如果要匯入的文件定義這個項目名稱的預設屬性，就會指派這些屬性。</span><span class="sxs-lookup"><span data-stu-id="ca1d3-140">If the document being imported into defines default attributes for this element name, those are assigned.</span></span>|  
|<span data-ttu-id="ca1d3-141">XmlEntityReference</span><span class="sxs-lookup"><span data-stu-id="ca1d3-141">XmlEntityReference</span></span>|<span data-ttu-id="ca1d3-142">因為來源和目的文件可以擁有定義不同的實體，這個方法只會複製 **XmlEntityReference** 節點。</span><span class="sxs-lookup"><span data-stu-id="ca1d3-142">Because the source and destination documents could have the entities defined differently, this method only copies the **XmlEntityReference** node.</span></span> <span data-ttu-id="ca1d3-143">不包括取代文字。</span><span class="sxs-lookup"><span data-stu-id="ca1d3-143">The replacement text is not included.</span></span> <span data-ttu-id="ca1d3-144">如果目的文件有定義的實體，就會指派它的值。</span><span class="sxs-lookup"><span data-stu-id="ca1d3-144">If the destination document has the entity defined, its value is assigned.</span></span>|<span data-ttu-id="ca1d3-145">因為來源和目的文件可以擁有定義不同的實體，這個方法只會複製 **XmlEntityReference** 節點。</span><span class="sxs-lookup"><span data-stu-id="ca1d3-145">Because the source and destination documents could have the entities defined differently, this method only copies the **XmlEntityReference** node.</span></span> <span data-ttu-id="ca1d3-146">不包括取代文字。</span><span class="sxs-lookup"><span data-stu-id="ca1d3-146">The replacement text is not included.</span></span> <span data-ttu-id="ca1d3-147">如果目的文件有定義的實體，就會指派它的值。</span><span class="sxs-lookup"><span data-stu-id="ca1d3-147">If the destination document has the entity defined, its value is assigned.</span></span>|  
|<span data-ttu-id="ca1d3-148">XmlProcessingInstruction</span><span class="sxs-lookup"><span data-stu-id="ca1d3-148">XmlProcessingInstruction</span></span>|<span data-ttu-id="ca1d3-149">從匯入的節點複製目標和資料值。</span><span class="sxs-lookup"><span data-stu-id="ca1d3-149">Copies the target and data value from the imported node.</span></span>|<span data-ttu-id="ca1d3-150">從匯入的節點複製目標和資料值。</span><span class="sxs-lookup"><span data-stu-id="ca1d3-150">Copies the target and data value from the imported node.</span></span>|  
|<span data-ttu-id="ca1d3-151">XmlText</span><span class="sxs-lookup"><span data-stu-id="ca1d3-151">XmlText</span></span>|<span data-ttu-id="ca1d3-152">複製節點，包含其資料。</span><span class="sxs-lookup"><span data-stu-id="ca1d3-152">Copies the node, including its data.</span></span>|<span data-ttu-id="ca1d3-153">複製節點，包含其資料。</span><span class="sxs-lookup"><span data-stu-id="ca1d3-153">Copies the node, including its data.</span></span>|  
|<span data-ttu-id="ca1d3-154">XmlSignificantWhitespace</span><span class="sxs-lookup"><span data-stu-id="ca1d3-154">XmlSignificantWhitespace</span></span>|<span data-ttu-id="ca1d3-155">複製節點，包含其資料。</span><span class="sxs-lookup"><span data-stu-id="ca1d3-155">Copies the node, including its data.</span></span>|<span data-ttu-id="ca1d3-156">複製節點，包含其資料。</span><span class="sxs-lookup"><span data-stu-id="ca1d3-156">Copies the node, including its data.</span></span>|  
|<span data-ttu-id="ca1d3-157">XmlWhitespace</span><span class="sxs-lookup"><span data-stu-id="ca1d3-157">XmlWhitespace</span></span>|<span data-ttu-id="ca1d3-158">複製節點，包含其資料。</span><span class="sxs-lookup"><span data-stu-id="ca1d3-158">Copies the node, including its data.</span></span>|<span data-ttu-id="ca1d3-159">複製節點，包含其資料。</span><span class="sxs-lookup"><span data-stu-id="ca1d3-159">Copies the node, including its data.</span></span>|  
|<span data-ttu-id="ca1d3-160">XmlDeclaration</span><span class="sxs-lookup"><span data-stu-id="ca1d3-160">XmlDeclaration</span></span>|<span data-ttu-id="ca1d3-161">從匯入的節點複製目標和資料值。</span><span class="sxs-lookup"><span data-stu-id="ca1d3-161">Copies the target and data value from the imported node.</span></span>|<span data-ttu-id="ca1d3-162">從匯入的節點複製目標和資料值。</span><span class="sxs-lookup"><span data-stu-id="ca1d3-162">Copies the target and data value from the imported node.</span></span>|  
|<span data-ttu-id="ca1d3-163">其他所有的節點型別</span><span class="sxs-lookup"><span data-stu-id="ca1d3-163">All other node types</span></span>|<span data-ttu-id="ca1d3-164">這些節點型別不會匯入。</span><span class="sxs-lookup"><span data-stu-id="ca1d3-164">These node types cannot be imported.</span></span>|<span data-ttu-id="ca1d3-165">這些節點型別不會匯入。</span><span class="sxs-lookup"><span data-stu-id="ca1d3-165">These node types cannot be imported.</span></span>|  
  
> [!NOTE]
> <span data-ttu-id="ca1d3-166">雖然 DocumentType 節點可以匯入，但是一份文件只能有一個 DocumentType。</span><span class="sxs-lookup"><span data-stu-id="ca1d3-166">Although DocumentType nodes can be imported, a document can only have one DocumentType.</span></span> <span data-ttu-id="ca1d3-167">因此，當您匯入文件型別之後，在將它插入樹狀之前，您必須確定文件中有文件型別。</span><span class="sxs-lookup"><span data-stu-id="ca1d3-167">So, once you have imported the document type, before inserting it into tree you have to make sure that there is no document type in the document.</span></span> <span data-ttu-id="ca1d3-168">如需移除節點的資訊，請參閱[從 XML 文件移除節點、內容和值](removing-nodes-content-and-values-from-an-xml-document.md)。</span><span class="sxs-lookup"><span data-stu-id="ca1d3-168">For information on removing nodes, see [Removing Nodes, Content, and Values from an XML Document](removing-nodes-content-and-values-from-an-xml-document.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="ca1d3-169">請參閱</span><span class="sxs-lookup"><span data-stu-id="ca1d3-169">See also</span></span>

- [<span data-ttu-id="ca1d3-170">XML 文件物件模型 (DOM)</span><span class="sxs-lookup"><span data-stu-id="ca1d3-170">XML Document Object Model (DOM)</span></span>](xml-document-object-model-dom.md)

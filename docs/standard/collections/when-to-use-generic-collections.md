---
title: 何時使用泛型集合
ms.date: 04/30/2020
ms.technology: dotnet-standard
helpviewer_keywords:
- collections [.NET Framework], generic
- generic collections [.NET Framework]
ms.assetid: e7b868b1-11fe-4ac5-bed3-de68aca47739
ms.openlocfilehash: c59a125a8df95e3c4fe6e1839956d800bd6ee910
ms.sourcegitcommit: 33deec3e814238fb18a49b2a7e89278e27888291
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 06/02/2020
ms.locfileid: "84290379"
---
# <a name="when-to-use-generic-collections"></a><span data-ttu-id="63336-102">何時使用泛型集合</span><span class="sxs-lookup"><span data-stu-id="63336-102">When to use generic collections</span></span>

<span data-ttu-id="63336-103">使用泛型集合可提供型別安全的自動優點，而不需要衍生自基底集合型別和實作為型別特定成員。</span><span class="sxs-lookup"><span data-stu-id="63336-103">Using generic collections gives you the automatic benefit of type safety without having to derive from a base collection type and implement type-specific members.</span></span> <span data-ttu-id="63336-104">當集合元素是實值型別時，泛型集合型別的效能通常會比對應的非泛型集合型別（而且比衍生自非泛型基底集合型別的類型更好），因為有了泛型，因此不需要將元素框在一起。</span><span class="sxs-lookup"><span data-stu-id="63336-104">Generic collection types also generally perform better than the corresponding nongeneric collection types (and better than types that are derived from nongeneric base collection types) when the collection elements are value types, because with generics, there's no need to box the elements.</span></span>

<span data-ttu-id="63336-105">針對以 .NET Standard 1.0 或更新版本為目標的程式， <xref:System.Collections.Concurrent> 當多個執行緒可能同時新增或移除集合中的專案時，請使用命名空間中的泛型集合類別。</span><span class="sxs-lookup"><span data-stu-id="63336-105">For programs that target .NET Standard 1.0 or later, use the generic collection classes in the <xref:System.Collections.Concurrent> namespace when multiple threads might be adding or removing items from the collection concurrently.</span></span> <span data-ttu-id="63336-106">此外，如果需要不必要的，請考慮命名空間中的泛型集合類別 <xref:System.Collections.Immutable> 。</span><span class="sxs-lookup"><span data-stu-id="63336-106">Additionally, when immutability is desired, consider the generic collection classes in the <xref:System.Collections.Immutable> namespace.</span></span>

<span data-ttu-id="63336-107">下列泛型類型對應至現有的集合類型：</span><span class="sxs-lookup"><span data-stu-id="63336-107">The following generic types correspond to existing collection types:</span></span>

- <span data-ttu-id="63336-108"><xref:System.Collections.Generic.List%601> 是對應至 <xref:System.Collections.ArrayList>的泛型類別。</span><span class="sxs-lookup"><span data-stu-id="63336-108"><xref:System.Collections.Generic.List%601> is the generic class that corresponds to <xref:System.Collections.ArrayList>.</span></span>

- <span data-ttu-id="63336-109"><xref:System.Collections.Generic.Dictionary%602> 和 <xref:System.Collections.Concurrent.ConcurrentDictionary%602> 是對應至 <xref:System.Collections.Hashtable>的泛型類別。</span><span class="sxs-lookup"><span data-stu-id="63336-109"><xref:System.Collections.Generic.Dictionary%602> and <xref:System.Collections.Concurrent.ConcurrentDictionary%602> are the generic classes that correspond to <xref:System.Collections.Hashtable>.</span></span>

- <span data-ttu-id="63336-110"><xref:System.Collections.ObjectModel.Collection%601> 是對應至 <xref:System.Collections.CollectionBase>的泛型類別。</span><span class="sxs-lookup"><span data-stu-id="63336-110"><xref:System.Collections.ObjectModel.Collection%601> is the generic class that corresponds to <xref:System.Collections.CollectionBase>.</span></span> <span data-ttu-id="63336-111"><xref:System.Collections.ObjectModel.Collection%601>可以當做基類使用，但不同 <xref:System.Collections.CollectionBase> 于，它不是抽象的，這使得使用起來更容易。</span><span class="sxs-lookup"><span data-stu-id="63336-111"><xref:System.Collections.ObjectModel.Collection%601> can be used as a base class, but unlike <xref:System.Collections.CollectionBase>, it is not abstract, which makes it much easier to use.</span></span>

- <span data-ttu-id="63336-112"><xref:System.Collections.ObjectModel.ReadOnlyCollection%601> 是對應至 <xref:System.Collections.ReadOnlyCollectionBase>的泛型類別。</span><span class="sxs-lookup"><span data-stu-id="63336-112"><xref:System.Collections.ObjectModel.ReadOnlyCollection%601> is the generic class that corresponds to <xref:System.Collections.ReadOnlyCollectionBase>.</span></span> <span data-ttu-id="63336-113"><xref:System.Collections.ObjectModel.ReadOnlyCollection%601>不是抽象的，而且具有可讓您輕鬆地將現有的公開 <xref:System.Collections.Generic.List%601> 為唯讀集合的函數。</span><span class="sxs-lookup"><span data-stu-id="63336-113"><xref:System.Collections.ObjectModel.ReadOnlyCollection%601> is not abstract and has a constructor that makes it easy to expose an existing <xref:System.Collections.Generic.List%601> as a read-only collection.</span></span>

- <span data-ttu-id="63336-114"><xref:System.Collections.Generic.Queue%601>、 <xref:System.Collections.Concurrent.ConcurrentQueue%601> 、 <xref:System.Collections.Immutable.ImmutableQueue%601> 、 <xref:System.Collections.Immutable.ImmutableArray%601> 、 <xref:System.Collections.Generic.SortedList%602> 和 <xref:System.Collections.Immutable.ImmutableSortedSet%601> 泛型類別會對應至具有相同名稱的個別非泛型類別。</span><span class="sxs-lookup"><span data-stu-id="63336-114">The <xref:System.Collections.Generic.Queue%601>, <xref:System.Collections.Concurrent.ConcurrentQueue%601>, <xref:System.Collections.Immutable.ImmutableQueue%601>, <xref:System.Collections.Immutable.ImmutableArray%601>, <xref:System.Collections.Generic.SortedList%602>, and <xref:System.Collections.Immutable.ImmutableSortedSet%601> generic classes correspond to the respective nongeneric classes with the same names.</span></span>

## <a name="additional-types"></a><span data-ttu-id="63336-115">其他類型</span><span class="sxs-lookup"><span data-stu-id="63336-115">Additional Types</span></span>

<span data-ttu-id="63336-116">數個泛型集合類型沒有非泛型的對應項目。</span><span class="sxs-lookup"><span data-stu-id="63336-116">Several generic collection types do not have nongeneric counterparts.</span></span> <span data-ttu-id="63336-117">其包括：</span><span class="sxs-lookup"><span data-stu-id="63336-117">They include the following:</span></span>

- <span data-ttu-id="63336-118"><xref:System.Collections.Generic.LinkedList%601> 是提供 O(1) 插入和移除作業的一般用途連結清單。</span><span class="sxs-lookup"><span data-stu-id="63336-118"><xref:System.Collections.Generic.LinkedList%601> is a general-purpose linked list that provides O(1) insertion and removal operations.</span></span>

- <span data-ttu-id="63336-119"><xref:System.Collections.Generic.SortedDictionary%602> 是 O(log `n`) 插入和擷取作業的已排序字典，這讓它成為 <xref:System.Collections.Generic.SortedList%602>相當實用的替代方法。</span><span class="sxs-lookup"><span data-stu-id="63336-119"><xref:System.Collections.Generic.SortedDictionary%602> is a sorted dictionary with O(log `n`) insertion and retrieval operations, which makes it a useful alternative to <xref:System.Collections.Generic.SortedList%602>.</span></span>

- <span data-ttu-id="63336-120"><xref:System.Collections.ObjectModel.KeyedCollection%602> 是清單與字典之間的混合體，它提供方法來儲存包含自己索引鍵的物件。</span><span class="sxs-lookup"><span data-stu-id="63336-120"><xref:System.Collections.ObjectModel.KeyedCollection%602> is a hybrid between a list and a dictionary, which provides a way to store objects that contain their own keys.</span></span>

- <span data-ttu-id="63336-121"><xref:System.Collections.Concurrent.BlockingCollection%601> 會實作具有週框和封鎖功能的集合類別。</span><span class="sxs-lookup"><span data-stu-id="63336-121"><xref:System.Collections.Concurrent.BlockingCollection%601> implements a collection class with bounding and blocking functionality.</span></span>

- <span data-ttu-id="63336-122"><xref:System.Collections.Concurrent.ConcurrentBag%601> 提供未排序項目的快速插入和移除。</span><span class="sxs-lookup"><span data-stu-id="63336-122"><xref:System.Collections.Concurrent.ConcurrentBag%601> provides fast insertion and removal of unordered elements.</span></span>

### <a name="immutable-builders"></a><span data-ttu-id="63336-123">不可變的產生器</span><span class="sxs-lookup"><span data-stu-id="63336-123">Immutable builders</span></span>

<span data-ttu-id="63336-124">當您想要在應用程式中使用不可變性的功能時， <xref:System.Collections.Immutable> 命名空間會提供您可以使用的泛型集合類型。</span><span class="sxs-lookup"><span data-stu-id="63336-124">When you desire immutability functionality in your app, the <xref:System.Collections.Immutable> namespace offers generic collection types you can use.</span></span> <span data-ttu-id="63336-125">所有不可變的集合類型都提供 `Builder` 可在您執行多個變化時優化效能的類別。</span><span class="sxs-lookup"><span data-stu-id="63336-125">All of the immutable collection types offer `Builder` classes that can optimize performance when you're performing multiple mutations.</span></span> <span data-ttu-id="63336-126">`Builder`類別會以可變狀態批次作業。</span><span class="sxs-lookup"><span data-stu-id="63336-126">The `Builder` class batches operations in a mutable state.</span></span> <span data-ttu-id="63336-127">當所有變化都完成時，請呼叫 `ToImmutable` 方法以「凍結」所有節點，並建立不可變的泛型集合，例如 <xref:System.Collections.Immutable.ImmutableList%601> 。</span><span class="sxs-lookup"><span data-stu-id="63336-127">When all mutations have been completed, call the `ToImmutable` method to "freeze" all nodes and create an immutable generic collection, for example, an <xref:System.Collections.Immutable.ImmutableList%601>.</span></span>

<span data-ttu-id="63336-128">您 `Builder` 可以藉由呼叫非泛型方法來建立物件 `CreateBuilder()` 。</span><span class="sxs-lookup"><span data-stu-id="63336-128">The `Builder` object can be created by calling the nongeneric `CreateBuilder()` method.</span></span> <span data-ttu-id="63336-129">`Builder`您可以從實例呼叫 `ToImmutable()` 。</span><span class="sxs-lookup"><span data-stu-id="63336-129">From a `Builder` instance, you can call `ToImmutable()`.</span></span> <span data-ttu-id="63336-130">同樣地，從 `Immutable*` 集合中，您可以呼叫， `ToBuilder()` 以從泛型不可變集合建立產生器實例。</span><span class="sxs-lookup"><span data-stu-id="63336-130">Likewise, from the `Immutable*` collection, you can call `ToBuilder()` to create a builder instance from the generic immutable collection.</span></span> <span data-ttu-id="63336-131">以下是各種 `Builder` 類型。</span><span class="sxs-lookup"><span data-stu-id="63336-131">The following are the various `Builder` types.</span></span>

- <xref:System.Collections.Immutable.ImmutableArray%601.Builder>
- <xref:System.Collections.Immutable.ImmutableDictionary%602.Builder>
- <xref:System.Collections.Immutable.ImmutableHashSet%601.Builder>
- <xref:System.Collections.Immutable.ImmutableList%601.Builder>
- <xref:System.Collections.Immutable.ImmutableSortedDictionary%602.Builder>
- <xref:System.Collections.Immutable.ImmutableSortedSet%601.Builder>

## <a name="linq-to-objects"></a><span data-ttu-id="63336-132">LINQ to Objects</span><span class="sxs-lookup"><span data-stu-id="63336-132">LINQ to Objects</span></span>

<span data-ttu-id="63336-133">只要物件類型實作 <xref:System.Collections.IEnumerable?displayProperty=nameWithType> 或 <xref:System.Collections.Generic.IEnumerable%601?displayProperty=nameWithType> 介面，LINQ to Objects 功能就可讓您使用 LINQ 查詢以存取記憶體中的物件。</span><span class="sxs-lookup"><span data-stu-id="63336-133">The LINQ to Objects feature enables you to use LINQ queries to access in-memory objects as long as the object type implements the <xref:System.Collections.IEnumerable?displayProperty=nameWithType> or <xref:System.Collections.Generic.IEnumerable%601?displayProperty=nameWithType> interface.</span></span> <span data-ttu-id="63336-134">LINQ 查詢提供存取資料的常見模式;通常比標準迴圈更精簡且更容易閱讀， `foreach` 並提供篩選、排序和群組功能。</span><span class="sxs-lookup"><span data-stu-id="63336-134">LINQ queries provide a common pattern for accessing data; are typically more concise and readable than standard `foreach` loops; and provide filtering, ordering, and grouping capabilities.</span></span> <span data-ttu-id="63336-135">LINQ 查詢也可以提升效能。</span><span class="sxs-lookup"><span data-stu-id="63336-135">LINQ queries can also improve performance.</span></span> <span data-ttu-id="63336-136">如需詳細資訊，請參閱 [LINQ to Objects (C#)](../../csharp/programming-guide/concepts/linq/linq-to-objects.md)、[LINQ to Objects (Visual Basic)](../../visual-basic/programming-guide/concepts/linq/linq-to-objects.md) 和 [Parallel LINQ (PLINQ)](../parallel-programming/introduction-to-plinq.md)。</span><span class="sxs-lookup"><span data-stu-id="63336-136">For more information, see [LINQ to Objects (C#)](../../csharp/programming-guide/concepts/linq/linq-to-objects.md), [LINQ to Objects (Visual Basic)](../../visual-basic/programming-guide/concepts/linq/linq-to-objects.md), and [Parallel LINQ (PLINQ)](../parallel-programming/introduction-to-plinq.md).</span></span>

## <a name="additional-functionality"></a><span data-ttu-id="63336-137">其他功能</span><span class="sxs-lookup"><span data-stu-id="63336-137">Additional Functionality</span></span>
<span data-ttu-id="63336-138">某些泛型類型具有非泛型集合類型中找不到的功能。</span><span class="sxs-lookup"><span data-stu-id="63336-138">Some of the generic types have functionality that is not found in the nongeneric collection types.</span></span> <span data-ttu-id="63336-139">例如， <xref:System.Collections.Generic.List%601> 類別 (對應至非泛型 <xref:System.Collections.ArrayList> 類別) 有許多接受泛型委派的方法，例如 <xref:System.Predicate%601> 委派 (允許您指定方法來搜尋清單)、 <xref:System.Action%601> 委派 (代表對清單每個項目採取動作的方法)，以及 <xref:System.Converter%602> 委派 (可定義類型之間的轉換)。</span><span class="sxs-lookup"><span data-stu-id="63336-139">For example, the <xref:System.Collections.Generic.List%601> class, which corresponds to the nongeneric <xref:System.Collections.ArrayList> class, has a number of methods that accept generic delegates, such as the <xref:System.Predicate%601> delegate that allows you to specify methods for searching the list, the <xref:System.Action%601> delegate that represents methods that act on each element of the list, and the <xref:System.Converter%602> delegate that lets you define conversions between types.</span></span>

<span data-ttu-id="63336-140"><xref:System.Collections.Generic.List%601> 類別可讓您指定自己的 <xref:System.Collections.Generic.IComparer%601> 泛型介面實作，以排序及搜尋清單。</span><span class="sxs-lookup"><span data-stu-id="63336-140">The <xref:System.Collections.Generic.List%601> class allows you to specify your own <xref:System.Collections.Generic.IComparer%601> generic interface implementations for sorting and searching the list.</span></span> <span data-ttu-id="63336-141"><xref:System.Collections.Generic.SortedDictionary%602> 和 <xref:System.Collections.Generic.SortedList%602> 類別也具有這項功能。</span><span class="sxs-lookup"><span data-stu-id="63336-141">The <xref:System.Collections.Generic.SortedDictionary%602> and <xref:System.Collections.Generic.SortedList%602> classes also have this capability.</span></span> <span data-ttu-id="63336-142">此外，這些類別可讓您在建立集合時，指定比較子。</span><span class="sxs-lookup"><span data-stu-id="63336-142">In addition, these classes let you specify comparers when the collection is created.</span></span> <span data-ttu-id="63336-143"><xref:System.Collections.Generic.Dictionary%602> 和 <xref:System.Collections.ObjectModel.KeyedCollection%602> 類別會以類似的方式，讓您能指定自己的相等比較子。</span><span class="sxs-lookup"><span data-stu-id="63336-143">In similar fashion, the <xref:System.Collections.Generic.Dictionary%602> and <xref:System.Collections.ObjectModel.KeyedCollection%602> classes let you specify your own equality comparers.</span></span>

## <a name="see-also"></a><span data-ttu-id="63336-144">另請參閱</span><span class="sxs-lookup"><span data-stu-id="63336-144">See also</span></span>

- [<span data-ttu-id="63336-145">集合和資料結構</span><span class="sxs-lookup"><span data-stu-id="63336-145">Collections and Data Structures</span></span>](index.md)
- [<span data-ttu-id="63336-146">常用的集合類型</span><span class="sxs-lookup"><span data-stu-id="63336-146">Commonly Used Collection Types</span></span>](commonly-used-collection-types.md)
- [<span data-ttu-id="63336-147">泛型</span><span class="sxs-lookup"><span data-stu-id="63336-147">Generics</span></span>](../generics/index.md)

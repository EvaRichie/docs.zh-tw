---
title: Hashtable 和 Dictionary 集合類型
ms.date: 03/30/2017
ms.technology: dotnet-standard
helpviewer_keywords:
- Hashtable class, grouping data in collections
- Hashtable collection type
- hash tables
- grouping data in collections, Hashtable collection type
- hash function
- collections [.NET Framework], Hashtable collection type
ms.assetid: bfc20837-3d02-4fc7-8a8f-c5215b6b7913
ms.openlocfilehash: b228f5db16ba01969b77d601becfb94ac0506d1e
ms.sourcegitcommit: 33deec3e814238fb18a49b2a7e89278e27888291
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 06/02/2020
ms.locfileid: "84287961"
---
# <a name="hashtable-and-dictionary-collection-types"></a><span data-ttu-id="fb3d2-102">Hashtable 和 Dictionary 集合類型</span><span class="sxs-lookup"><span data-stu-id="fb3d2-102">Hashtable and Dictionary Collection Types</span></span>
<span data-ttu-id="fb3d2-103"><xref:System.Collections.Hashtable?displayProperty=nameWithType> 類別以及 <xref:System.Collections.Generic.Dictionary%602?displayProperty=nameWithType> 和 <xref:System.Collections.Concurrent.ConcurrentDictionary%602?displayProperty=nameWithType> 泛型類別會實作 <xref:System.Collections.IDictionary?displayProperty=nameWithType> 介面。</span><span class="sxs-lookup"><span data-stu-id="fb3d2-103">The <xref:System.Collections.Hashtable?displayProperty=nameWithType> class, and the <xref:System.Collections.Generic.Dictionary%602?displayProperty=nameWithType> and <xref:System.Collections.Concurrent.ConcurrentDictionary%602?displayProperty=nameWithType> generic classes, implement the <xref:System.Collections.IDictionary?displayProperty=nameWithType> interface.</span></span> <span data-ttu-id="fb3d2-104"><xref:System.Collections.Generic.Dictionary%602> 泛型類別還會實作 <xref:System.Collections.Generic.IDictionary%602> 泛型介面。</span><span class="sxs-lookup"><span data-stu-id="fb3d2-104">The <xref:System.Collections.Generic.Dictionary%602> generic class also implements the <xref:System.Collections.Generic.IDictionary%602> generic interface.</span></span> <span data-ttu-id="fb3d2-105">因此，這些集合中的每個項目是索引鍵-值組。</span><span class="sxs-lookup"><span data-stu-id="fb3d2-105">Therefore, each element in these collections is a key-and-value pair.</span></span>  
  
 <span data-ttu-id="fb3d2-106"><xref:System.Collections.Hashtable> 物件是由包含集合項目的值區所組成。</span><span class="sxs-lookup"><span data-stu-id="fb3d2-106">A <xref:System.Collections.Hashtable> object consists of buckets that contain the elements of the collection.</span></span> <span data-ttu-id="fb3d2-107">值區是 <xref:System.Collections.Hashtable> 中項目的虛擬子群組，比大多數集合的搜尋和擷取更容易且更快速。</span><span class="sxs-lookup"><span data-stu-id="fb3d2-107">A bucket is a virtual subgroup of elements within the <xref:System.Collections.Hashtable>, which makes searching and retrieving easier and faster than in most collections.</span></span> <span data-ttu-id="fb3d2-108">每個值區會與一個雜湊碼相關聯，這個雜湊碼是使用雜湊函式並根據項目的索引鍵所產生。</span><span class="sxs-lookup"><span data-stu-id="fb3d2-108">Each bucket is associated with a hash code, which is generated using a hash function and is based on the key of the element.</span></span>  
  
 <span data-ttu-id="fb3d2-109">泛型 <xref:System.Collections.Generic.HashSet%601> 類別是包含唯一項目的未排序集合。</span><span class="sxs-lookup"><span data-stu-id="fb3d2-109">The generic <xref:System.Collections.Generic.HashSet%601> class is an unordered collection for containing unique elements.</span></span>  
  
 <span data-ttu-id="fb3d2-110">雜湊函式是根據索引鍵傳回數值雜湊碼的演算法。</span><span class="sxs-lookup"><span data-stu-id="fb3d2-110">A hash function is an algorithm that returns a numeric hash code based on a key.</span></span> <span data-ttu-id="fb3d2-111">索引鍵是所儲存之物件的特定屬性值。</span><span class="sxs-lookup"><span data-stu-id="fb3d2-111">The key is the value of some property of the object being stored.</span></span> <span data-ttu-id="fb3d2-112">雜湊函式一律必須針對同一個索引鍵傳回相同的雜湊碼。</span><span class="sxs-lookup"><span data-stu-id="fb3d2-112">A hash function must always return the same hash code for the same key.</span></span> <span data-ttu-id="fb3d2-113">雜湊函式可以為兩個不同的索引鍵產生相同的雜湊碼，但是當雜湊函式為每個唯一的索引鍵產生唯一的雜湊碼時，可以提升從雜湊資料表擷取項目的效能。</span><span class="sxs-lookup"><span data-stu-id="fb3d2-113">It is possible for a hash function to generate the same hash code for two different keys, but a hash function that generates a unique hash code for each unique key results in better performance when retrieving elements from the hash table.</span></span>  
  
 <span data-ttu-id="fb3d2-114">當做 <xref:System.Collections.Hashtable> 中項目使用的每個物件必須能夠使用 <xref:System.Object.GetHashCode%2A> 方法的實作，為自己產生雜湊碼。</span><span class="sxs-lookup"><span data-stu-id="fb3d2-114">Each object that is used as an element in a <xref:System.Collections.Hashtable> must be able to generate a hash code for itself by using an implementation of the <xref:System.Object.GetHashCode%2A> method.</span></span> <span data-ttu-id="fb3d2-115">不過，您也可以使用接受 <xref:System.Collections.IHashCodeProvider> 實作做為其中一個參數的 <xref:System.Collections.Hashtable> 建構函式，為 <xref:System.Collections.Hashtable> 中的所有項目指定雜湊函式。</span><span class="sxs-lookup"><span data-stu-id="fb3d2-115">However, you can also specify a hash function for all elements in a <xref:System.Collections.Hashtable> by using a <xref:System.Collections.Hashtable> constructor that accepts an <xref:System.Collections.IHashCodeProvider> implementation as one of its parameters.</span></span>  
  
 <span data-ttu-id="fb3d2-116">將物件加入 <xref:System.Collections.Hashtable> 之後，該物件會儲存在與符合物件雜湊碼的雜湊碼關聯的值區中。</span><span class="sxs-lookup"><span data-stu-id="fb3d2-116">When an object is added to a <xref:System.Collections.Hashtable>, it is stored in the bucket that is associated with the hash code that matches the object's hash code.</span></span> <span data-ttu-id="fb3d2-117">當搜尋 <xref:System.Collections.Hashtable> 中的值時，系統會針對該值產生雜湊碼，並搜尋與該雜湊碼關聯的值區。</span><span class="sxs-lookup"><span data-stu-id="fb3d2-117">When a value is being searched for in the <xref:System.Collections.Hashtable>, the hash code is generated for that value, and the bucket associated with that hash code is searched.</span></span>  
  
 <span data-ttu-id="fb3d2-118">例如，字串的雜湊函式可能會接受字串中每個字元的 ASCII 碼，並全部加入以產生雜湊碼。</span><span class="sxs-lookup"><span data-stu-id="fb3d2-118">For example, a hash function for a string might take the ASCII codes of each character in the string and add them together to generate a hash code.</span></span> <span data-ttu-id="fb3d2-119">字串 "picnic" 的雜湊碼與字串 "basket" 的雜湊碼不同；因此，字串 "picnic" 和 "basket" 會在不同的值區。</span><span class="sxs-lookup"><span data-stu-id="fb3d2-119">The string "picnic" would have a hash code that is different from the hash code for the string "basket"; therefore, the strings "picnic" and "basket" would be in different buckets.</span></span> <span data-ttu-id="fb3d2-120">相反地，"stressed" 和 "desserts" 有相同的雜湊碼，因此會在相同的值區。</span><span class="sxs-lookup"><span data-stu-id="fb3d2-120">In contrast, "stressed" and "desserts" would have the same hash code and would be in the same bucket.</span></span>  
  
 <span data-ttu-id="fb3d2-121"><xref:System.Collections.Generic.Dictionary%602> 和 <xref:System.Collections.Concurrent.ConcurrentDictionary%602> 類別的功能與 <xref:System.Collections.Hashtable> 類別相同。</span><span class="sxs-lookup"><span data-stu-id="fb3d2-121">The <xref:System.Collections.Generic.Dictionary%602> and <xref:System.Collections.Concurrent.ConcurrentDictionary%602> classes have the same functionality as the <xref:System.Collections.Hashtable> class.</span></span> <span data-ttu-id="fb3d2-122">特定類型 (<xref:System.Object> 以外的類型) 的 <xref:System.Collections.Generic.Dictionary%602> 提供比實值類型的 <xref:System.Collections.Hashtable> 更佳的效能。</span><span class="sxs-lookup"><span data-stu-id="fb3d2-122">A <xref:System.Collections.Generic.Dictionary%602> of a specific type (other than <xref:System.Object>) provides better performance than a <xref:System.Collections.Hashtable> for value types.</span></span> <span data-ttu-id="fb3d2-123">這是因為 <xref:System.Collections.Hashtable> 的項目屬於 <xref:System.Object> 類型；因此，當您儲存或擷取實值類型時，通常會發生 Boxing 和 Unboxing。</span><span class="sxs-lookup"><span data-stu-id="fb3d2-123">This is because the elements of <xref:System.Collections.Hashtable> are of type <xref:System.Object>; therefore, boxing and unboxing typically occur when you store or retrieve a value type.</span></span> <span data-ttu-id="fb3d2-124">當多個執行緒可能同時存取集合時，應該使用 <xref:System.Collections.Concurrent.ConcurrentDictionary%602> 類別。</span><span class="sxs-lookup"><span data-stu-id="fb3d2-124">The <xref:System.Collections.Concurrent.ConcurrentDictionary%602> class should be used when multiple threads might be accessing the collection simultaneously.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="fb3d2-125">另請參閱</span><span class="sxs-lookup"><span data-stu-id="fb3d2-125">See also</span></span>

- <xref:System.Collections.Hashtable>
- <xref:System.Collections.IDictionary>
- <xref:System.Collections.IHashCodeProvider>
- <xref:System.Collections.Generic.Dictionary%602>
- <xref:System.Collections.Generic.IDictionary%602?displayProperty=nameWithType>
- <xref:System.Collections.Concurrent.ConcurrentDictionary%602?displayProperty=nameWithType>
- [<span data-ttu-id="fb3d2-126">常用的集合類型</span><span class="sxs-lookup"><span data-stu-id="fb3d2-126">Commonly Used Collection Types</span></span>](commonly-used-collection-types.md)

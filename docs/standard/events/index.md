---
title: 處理和引發事件
description: 瞭解如何處理和引發以委派模型為基礎的 .NET 事件。 此模型可讓訂閱者註冊或接收來自提供者的通知。
ms.date: 03/30/2017
ms.technology: dotnet-standard
dev_langs:
- csharp
- vb
helpviewer_keywords:
- delegate model for events
- application development [.NET], events
- application development [.NET Framework], events
- application development [.NET Core], events
- events [.NET]
- events [.NET Core]
- events [.NET Framework]
ms.assetid: b6f65241-e0ad-4590-a99f-200ce741bb1f
ms.openlocfilehash: 47021873956f971709b49c1b224e43e4c7f482d0
ms.sourcegitcommit: 279fb6e8d515df51676528a7424a1df2f0917116
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/27/2020
ms.locfileid: "92687293"
---
# <a name="handle-and-raising-events"></a><span data-ttu-id="2f0bb-104">處理和引發事件</span><span class="sxs-lookup"><span data-stu-id="2f0bb-104">Handle and raising events</span></span>

<span data-ttu-id="2f0bb-105">.NET 中的事件是以委派模型為基礎。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-105">Events in .NET are based on the delegate model.</span></span> <span data-ttu-id="2f0bb-106">委派模型遵循觀察者 [設計模式](observer-design-pattern.md)，可讓訂閱者向提供者註冊和接收通知。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-106">The delegate model follows the [observer design pattern](observer-design-pattern.md), which enables a subscriber to register with and receive notifications from a provider.</span></span> <span data-ttu-id="2f0bb-107">事件發送者會推播事件已發生的通知，而事件接收器會收到該通告並定義對它的回應。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-107">An event sender pushes a notification that an event has happened, and an event receiver receives that notification and defines a response to it.</span></span> <span data-ttu-id="2f0bb-108">本文將描述委派模型的主要元件、如何在應用程式中使用事件，以及如何在程式碼中實作事件。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-108">This article describes the major components of the delegate model, how to consume events in applications, and how to implement events in your code.</span></span>
  
## <a name="events"></a><span data-ttu-id="2f0bb-109">事件</span><span class="sxs-lookup"><span data-stu-id="2f0bb-109">Events</span></span>

<span data-ttu-id="2f0bb-110">事件是由物件傳送的訊息，用以表示發生動作。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-110">An event is a message sent by an object to signal the occurrence of an action.</span></span> <span data-ttu-id="2f0bb-111">動作可能是使用者互動所造成，例如按一下按鈕，也可能是由其他程式邏輯所產生，例如變更屬性的值。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-111">The action can be caused by user interaction, such as a button click, or it can result from some other program logic, such as changing a property's value.</span></span> <span data-ttu-id="2f0bb-112">引發事件的物件稱為「事件發送者」  。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-112">The object that raises the event is called the *event sender* .</span></span> <span data-ttu-id="2f0bb-113">事件發送者並不清楚哪個物件或方法會接收 (處理) 它所引發的事件。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-113">The event sender doesn't know which object or method will receive (handle) the events it raises.</span></span> <span data-ttu-id="2f0bb-114">事件通常是事件發送者的成員，例如，<xref:System.Web.UI.WebControls.Button.Click> 事件是 <xref:System.Web.UI.WebControls.Button> 類別的成員，而 <xref:System.ComponentModel.INotifyPropertyChanged.PropertyChanged> 事件是實作 <xref:System.ComponentModel.INotifyPropertyChanged> 介面之類別的成員。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-114">The event is typically a member of the event sender; for example, the <xref:System.Web.UI.WebControls.Button.Click> event is a member of the <xref:System.Web.UI.WebControls.Button> class, and the <xref:System.ComponentModel.INotifyPropertyChanged.PropertyChanged> event is a member of the class that implements the <xref:System.ComponentModel.INotifyPropertyChanged> interface.</span></span>  
  
<span data-ttu-id="2f0bb-115">若要定義事件，您可以 [`event`](../../csharp/language-reference/keywords/event.md) 在事件類別的簽章中使用 c # 或 Visual Basic [`Event`](../../visual-basic/language-reference/statements/event-statement.md) 關鍵字，並指定事件的委派類型。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-115">To define an event, you use the C# [`event`](../../csharp/language-reference/keywords/event.md) or the Visual Basic [`Event`](../../visual-basic/language-reference/statements/event-statement.md) keyword in the signature of your event class, and specify the type of delegate for the event.</span></span> <span data-ttu-id="2f0bb-116">委派將在下一節中描述。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-116">Delegates are described in the next section.</span></span>  
  
<span data-ttu-id="2f0bb-117">一般而言，若要引發事件，您會加入標記為 `protected` 和 `virtual` (C#) 或 `Protected` 和 `Overridable` (Visual Basic) 的方法。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-117">Typically, to raise an event, you add a method that is marked as `protected` and `virtual` (in C#) or `Protected` and `Overridable` (in Visual Basic).</span></span> <span data-ttu-id="2f0bb-118">為這個 `On`*EventName* 方法命名，例如 `OnDataReceived`。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-118">Name this method `On`*EventName* ; for example, `OnDataReceived`.</span></span> <span data-ttu-id="2f0bb-119">這個方法應該接受一個指定事件資料物件 (<xref:System.EventArgs> 型別或衍生型別之物件) 的參數。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-119">The method should take one parameter that specifies an event data object, which is an object of type <xref:System.EventArgs> or a derived type.</span></span> <span data-ttu-id="2f0bb-120">您可以提供這個方法讓衍生類別覆寫引發事件的邏輯。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-120">You provide this method to enable derived classes to override the logic for raising the event.</span></span> <span data-ttu-id="2f0bb-121">衍生類別一定要呼叫基底類別的 `On`*EventName* 方法，以確保註冊的委派收到事件。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-121">A derived class should always call the `On`*EventName* method of the base class to ensure that registered delegates receive the event.</span></span>  

<span data-ttu-id="2f0bb-122">下列範例將示範如何宣告名為 `ThresholdReached` 的事件。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-122">The following example shows how to declare an event named `ThresholdReached`.</span></span> <span data-ttu-id="2f0bb-123">事件與 <xref:System.EventHandler> 委派有關，而且會在名為 `OnThresholdReached` 的方法中引發。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-123">The event is associated with the <xref:System.EventHandler> delegate and raised in a method named `OnThresholdReached`.</span></span>  
  
 [!code-csharp[EventsOverview#1](~/samples/snippets/csharp/VS_Snippets_CLR/eventsoverview/cs/programtruncated.cs#1)]
 [!code-vb[EventsOverview#1](~/samples/snippets/visualbasic/VS_Snippets_CLR/eventsoverview/vb/module1truncated.vb#1)]  
  
## <a name="delegates"></a><span data-ttu-id="2f0bb-124">委派</span><span class="sxs-lookup"><span data-stu-id="2f0bb-124">Delegates</span></span>

<span data-ttu-id="2f0bb-125">委派是保存方法之參考的類型。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-125">A delegate is a type that holds a reference to a method.</span></span> <span data-ttu-id="2f0bb-126">委派是透過特徵標記來宣告，該特徵標記會顯示所參考方法的傳回型別和參數，而且委派只能持有符合其特徵標記之方法的參考。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-126">A delegate is declared with a signature that shows the return type and parameters for the methods it references, and it can hold references only to methods that match its signature.</span></span> <span data-ttu-id="2f0bb-127">委派因此相當於 type-safe 函式指標或回呼。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-127">A delegate is thus equivalent to a type-safe function pointer or a callback.</span></span> <span data-ttu-id="2f0bb-128">委派宣告不足以定義委派類別。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-128">A delegate declaration is sufficient to define a delegate class.</span></span>  
  
<span data-ttu-id="2f0bb-129">委派在 .NET 中有多種用途。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-129">Delegates have many uses in .NET.</span></span> <span data-ttu-id="2f0bb-130">在事件中，委派是事件來源和處理事件的程式碼之間的媒介 (或類似指標的機制)。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-130">In the context of events, a delegate is an intermediary (or pointer-like mechanism) between the event source and the code that handles the event.</span></span> <span data-ttu-id="2f0bb-131">將委派類型加入事件宣告中就可以讓委派與事件產生關聯，如上一節的範例所示。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-131">You associate a delegate with an event by including the delegate type in the event declaration, as shown in the example in the previous section.</span></span> <span data-ttu-id="2f0bb-132">如需委派的詳細資訊，請參閱 <xref:System.Delegate> 類別。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-132">For more information about delegates, see the <xref:System.Delegate> class.</span></span>  
  
<span data-ttu-id="2f0bb-133">.NET 提供了 <xref:System.EventHandler> 和 <xref:System.EventHandler%601> 委派來支援大多數事件案例。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-133">.NET provides the <xref:System.EventHandler> and <xref:System.EventHandler%601> delegates to support most event scenarios.</span></span> <span data-ttu-id="2f0bb-134">請針對所有沒有事件資料的事件使用 <xref:System.EventHandler> 委派。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-134">Use the <xref:System.EventHandler> delegate for all events that do not include event data.</span></span> <span data-ttu-id="2f0bb-135">請針對有事件相關資料的事件使用 <xref:System.EventHandler%601> 委派。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-135">Use the <xref:System.EventHandler%601> delegate for events that include data about the event.</span></span> <span data-ttu-id="2f0bb-136">這些委派沒有傳回型別值，而且會接受兩個參數 (事件來源的物件和事件資料的物件)。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-136">These delegates have no return type value and take two parameters (an object for the source of the event, and an object for event data).</span></span>  
  
<span data-ttu-id="2f0bb-137">委派是 [多播](xref:System.MulticastDelegate)的，這表示它們可以保留多個事件處理方法的參考。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-137">Delegates are [multicast](xref:System.MulticastDelegate), which means that they can hold references to more than one event-handling method.</span></span> <span data-ttu-id="2f0bb-138">如需詳細資訊，請參閱 <xref:System.Delegate> 參考頁面。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-138">For details, see the <xref:System.Delegate> reference page.</span></span> <span data-ttu-id="2f0bb-139">委派可讓事件處理更彈性並進行精細的控制。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-139">Delegates provide flexibility and fine-grained control in event handling.</span></span> <span data-ttu-id="2f0bb-140">委派會維護事件的已註冊事件處理常式清單，進而做為引發事件之類別的事件分派者。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-140">A delegate acts as an event dispatcher for the class that raises the event by maintaining a list of registered event handlers for the event.</span></span>  
  
<span data-ttu-id="2f0bb-141">對於無法使用 <xref:System.EventHandler> 和 <xref:System.EventHandler%601> 委派的情況，您可以定義委派。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-141">For scenarios where the <xref:System.EventHandler> and <xref:System.EventHandler%601> delegates do not work, you can define a delegate.</span></span> <span data-ttu-id="2f0bb-142">需要定義委派的情況非常少見，例如，當您必須使用無法辨識泛型的程式碼時。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-142">Scenarios that require you to define a delegate are very rare, such as when you must work with code that does not recognize generics.</span></span> <span data-ttu-id="2f0bb-143">您可以在宣告中使用 c # [`delegate`](../../csharp/language-reference/builtin-types/reference-types.md#the-delegate-type) 和 Visual Basic 關鍵字標記委派 [`Delegate`](../../visual-basic/language-reference/statements/delegate-statement.md) 。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-143">You mark a delegate with the C# [`delegate`](../../csharp/language-reference/builtin-types/reference-types.md#the-delegate-type) and Visual Basic [`Delegate`](../../visual-basic/language-reference/statements/delegate-statement.md) keyword in the declaration.</span></span> <span data-ttu-id="2f0bb-144">下列範例將示範如何宣告名為 `ThresholdReachedEventHandler` 的委派。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-144">The following example shows how to declare a delegate named `ThresholdReachedEventHandler`.</span></span>  
  
[!code-csharp[EventsOverview#4](~/samples/snippets/csharp/VS_Snippets_CLR/eventsoverview/cs/programtruncated.cs#4)]
[!code-vb[EventsOverview#4](~/samples/snippets/visualbasic/VS_Snippets_CLR/eventsoverview/vb/module1truncated.vb#4)]  
  
## <a name="event-data"></a><span data-ttu-id="2f0bb-145">事件資料</span><span class="sxs-lookup"><span data-stu-id="2f0bb-145">Event data</span></span>

<span data-ttu-id="2f0bb-146">與事件相關聯的資料可以透過事件資料類別提供。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-146">Data that is associated with an event can be provided through an event data class.</span></span> <span data-ttu-id="2f0bb-147">.NET 提供了許多事件資料類別，可讓您在應用程式中使用。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-147">.NET provides many event data classes that you can use in your applications.</span></span> <span data-ttu-id="2f0bb-148">例如，<xref:System.IO.Ports.SerialDataReceivedEventArgs> 類別是 <xref:System.IO.Ports.SerialPort.DataReceived?displayProperty=nameWithType> 事件的事件資料類別。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-148">For example, the <xref:System.IO.Ports.SerialDataReceivedEventArgs> class is the event data class for the <xref:System.IO.Ports.SerialPort.DataReceived?displayProperty=nameWithType> event.</span></span> <span data-ttu-id="2f0bb-149">.NET 遵循的命名模式是以 `EventArgs` 作為所有事件資料類型的結尾。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-149">.NET follows a naming pattern of ending all event data classes with `EventArgs`.</span></span> <span data-ttu-id="2f0bb-150">您可以藉由查看事件的委派，判斷與事件相關聯的事件資料類別。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-150">You determine which event data class is associated with an event by looking at the delegate for the event.</span></span> <span data-ttu-id="2f0bb-151">例如，<xref:System.IO.Ports.SerialDataReceivedEventHandler> 委派會包含 <xref:System.IO.Ports.SerialDataReceivedEventArgs> 類別做為其中一個參數。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-151">For example, the <xref:System.IO.Ports.SerialDataReceivedEventHandler> delegate includes the <xref:System.IO.Ports.SerialDataReceivedEventArgs> class as one of its parameters.</span></span>  
  
<span data-ttu-id="2f0bb-152"><xref:System.EventArgs> 類別是所有事件資料類別的基底類型。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-152">The <xref:System.EventArgs> class is the base type for all event data classes.</span></span> <span data-ttu-id="2f0bb-153"><xref:System.EventArgs> 也是您在事件沒有任何相關資料時使用的類別。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-153"><xref:System.EventArgs> is also the class you use when an event does not have any data associated with it.</span></span> <span data-ttu-id="2f0bb-154">如果您建立的事件主要工作只是通知其他類別有事件發生，而不需要傳遞任何資料，請在委派中加入 <xref:System.EventArgs> 類別做為第二個參數。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-154">When you create an event that is only meant to notify other classes that something happened and does not need to pass any data, include the <xref:System.EventArgs> class as the second parameter in the delegate.</span></span> <span data-ttu-id="2f0bb-155">您可以在未提供資料時傳遞 <xref:System.EventArgs.Empty?displayProperty=nameWithType> 值。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-155">You can pass the <xref:System.EventArgs.Empty?displayProperty=nameWithType> value when no data is provided.</span></span> <span data-ttu-id="2f0bb-156"><xref:System.EventHandler> 委派會包含 <xref:System.EventArgs> 類別做為參數。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-156">The <xref:System.EventHandler> delegate includes the <xref:System.EventArgs> class as a parameter.</span></span>  
  
<span data-ttu-id="2f0bb-157">當您要建立自訂事件資料類別時，請建立衍生自 <xref:System.EventArgs> 的類別，然後提供傳遞事件相關資料所需的所有成員。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-157">When you want to create a customized event data class, create a class that derives from <xref:System.EventArgs>, and then provide any members needed to pass data that is related to the event.</span></span> <span data-ttu-id="2f0bb-158">一般而言，您應該使用與 .NET 相同的命名模式，並以 `EventArgs` 作為事件資料類別名稱的結尾。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-158">Typically, you should use the same naming pattern as .NET and end your event data class name with `EventArgs`.</span></span>  
  
<span data-ttu-id="2f0bb-159">下列範例將示範名為 `ThresholdReachedEventArgs` 的事件資料類別。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-159">The following example shows an event data class named `ThresholdReachedEventArgs`.</span></span> <span data-ttu-id="2f0bb-160">其中包含所引發事件專屬的屬性。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-160">It contains properties that are specific to the event being raised.</span></span>  
  
[!code-csharp[EventsOverview#3](~/samples/snippets/csharp/VS_Snippets_CLR/eventsoverview/cs/programtruncated.cs#3)]
[!code-vb[EventsOverview#3](~/samples/snippets/visualbasic/VS_Snippets_CLR/eventsoverview/vb/module1truncated.vb#3)]  
  
## <a name="event-handlers"></a><span data-ttu-id="2f0bb-161">事件處理常式</span><span class="sxs-lookup"><span data-stu-id="2f0bb-161">Event handlers</span></span>

<span data-ttu-id="2f0bb-162">若要回應事件，請在事件接收器中定義事件處理常式方法。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-162">To respond to an event, you define an event handler method in the event receiver.</span></span> <span data-ttu-id="2f0bb-163">這個方法必須符合您要處理之事件的委派簽章。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-163">This method must match the signature of the delegate for the event you are handling.</span></span> <span data-ttu-id="2f0bb-164">在事件處理常式中，您會在事件引發時執行必要的動作，例如，在使用者按一下按鈕後收集使用者輸入。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-164">In the event handler, you perform the actions that are required when the event is raised, such as collecting user input after the user clicks a button.</span></span> <span data-ttu-id="2f0bb-165">若要在事件發生時收到通告，則事件處理常式方法必須訂閱事件。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-165">To receive notifications when the event occurs, your event handler method must subscribe to the event.</span></span>  
  
<span data-ttu-id="2f0bb-166">下列範例將示範名為 `c_ThresholdReached` 的事件處理常式方法，該方法會比對 <xref:System.EventHandler> 委派的簽章。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-166">The following example shows an event handler method named `c_ThresholdReached` that matches the signature for the <xref:System.EventHandler> delegate.</span></span> <span data-ttu-id="2f0bb-167">方法會訂閱 `ThresholdReached` 事件。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-167">The method subscribes to the `ThresholdReached` event.</span></span>  
  
[!code-csharp[EventsOverview#2](~/samples/snippets/csharp/VS_Snippets_CLR/eventsoverview/cs/programtruncated.cs#2)]
[!code-vb[EventsOverview#2](~/samples/snippets/visualbasic/VS_Snippets_CLR/eventsoverview/vb/module1truncated.vb#2)]  
  
## <a name="static-and-dynamic-event-handlers"></a><span data-ttu-id="2f0bb-168">靜態和動態事件處理常式</span><span class="sxs-lookup"><span data-stu-id="2f0bb-168">Static and dynamic event handlers</span></span>  

<span data-ttu-id="2f0bb-169">.NET 可讓訂閱者以靜態或動態方式註冊事件通知。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-169">.NET allows subscribers to register for event notifications either statically or dynamically.</span></span> <span data-ttu-id="2f0bb-170">靜態事件處理常式在其處理事件之類別的整個生命週期內都有效。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-170">Static event handlers are in effect for the entire life of the class whose events they handle.</span></span> <span data-ttu-id="2f0bb-171">動態事件處理常式會在程式執行期間明確地啟動及停用，通常是為了回應某些條件式邏輯。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-171">Dynamic event handlers are explicitly activated and deactivated during program execution, usually in response to some conditional program logic.</span></span> <span data-ttu-id="2f0bb-172">比方說，如果只有在某些情況下才需要事件通知，或如果應用程式提供多個事件處理常式且執行階段條件會定義一個要使用的適當處理常式，即可使用動態事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-172">For example, they can be used if event notifications are needed only under certain conditions or if an application provides multiple event handlers and run-time conditions define the appropriate one to use.</span></span> <span data-ttu-id="2f0bb-173">上一節中的範例示範了如何以動態方式加入事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-173">The example in the previous section shows how to dynamically add an event handler.</span></span> <span data-ttu-id="2f0bb-174">如需詳細資訊，請參閱[事件](../../visual-basic/programming-guide/language-features/events/index.md) (in Visual Basic) 及[事件](../../csharp/programming-guide/events/index.md) (in C#)。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-174">For more information, see [Events](../../visual-basic/programming-guide/language-features/events/index.md) (in Visual Basic) and [Events](../../csharp/programming-guide/events/index.md) (in C#).</span></span>  
  
## <a name="raising-multiple-events"></a><span data-ttu-id="2f0bb-175">引發多個事件</span><span class="sxs-lookup"><span data-stu-id="2f0bb-175">Raising multiple events</span></span>

 <span data-ttu-id="2f0bb-176">如果您的類別會引發多個事件，編譯器將會為每個事件委派執行個體產生一個欄位。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-176">If your class raises multiple events, the compiler generates one field per event delegate instance.</span></span> <span data-ttu-id="2f0bb-177">如果事件數目很大，則可能無法接受每個委派一個欄位的儲存成本。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-177">If the number of events is large, the storage cost of one field per delegate may not be acceptable.</span></span> <span data-ttu-id="2f0bb-178">對於這些情況，.NET 提供了事件屬性，可以搭配您選擇的另一種資料結構來儲存事件委派。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-178">For those situations, .NET provides event properties that you can use with another data structure of your choice to store event delegates.</span></span>  
  
 <span data-ttu-id="2f0bb-179">事件屬性是由事件存取子伴隨的事件宣告所組成。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-179">Event properties consist of event declarations accompanied by event accessors.</span></span> <span data-ttu-id="2f0bb-180">事件存取子是您定義用來將事件委派執行個體加入儲存區資料結構或從其中移除的方法。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-180">Event accessors are methods that you define to add or remove event delegate instances from the storage data structure.</span></span> <span data-ttu-id="2f0bb-181">請注意，事件屬性會比事件欄位來得慢些，因為每個事件委派都必須先擷取，然後才能夠叫用。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-181">Note that event properties are slower than event fields, because each event delegate must be retrieved before it can be invoked.</span></span> <span data-ttu-id="2f0bb-182">記憶體和速度之間會有所折衷。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-182">The trade-off is between memory and speed.</span></span> <span data-ttu-id="2f0bb-183">如果您的類別定義許多不常引發的事件，您會想要實作事件屬性。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-183">If your class defines many events that are infrequently raised, you will want to implement event properties.</span></span> <span data-ttu-id="2f0bb-184">如需詳細資訊，請參閱[如何：使用事件屬性處理多個事件](how-to-handle-multiple-events-using-event-properties.md)。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-184">For more information, see [How to: Handle Multiple Events Using Event Properties](how-to-handle-multiple-events-using-event-properties.md).</span></span>  
  
## <a name="related-articles"></a><span data-ttu-id="2f0bb-185">相關文章</span><span class="sxs-lookup"><span data-stu-id="2f0bb-185">Related articles</span></span>
  
|<span data-ttu-id="2f0bb-186">標題</span><span class="sxs-lookup"><span data-stu-id="2f0bb-186">Title</span></span>|<span data-ttu-id="2f0bb-187">描述</span><span class="sxs-lookup"><span data-stu-id="2f0bb-187">Description</span></span>|  
|-----------|-----------------|  
|[<span data-ttu-id="2f0bb-188">如何：引發和使用事件</span><span class="sxs-lookup"><span data-stu-id="2f0bb-188">How to: Raise and Consume Events</span></span>](how-to-raise-and-consume-events.md)|<span data-ttu-id="2f0bb-189">包含引發和使用事件的範例。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-189">Contains examples of raising and consuming events.</span></span>|  
|[<span data-ttu-id="2f0bb-190">如何：使用事件屬性處理多個事件</span><span class="sxs-lookup"><span data-stu-id="2f0bb-190">How to: Handle Multiple Events Using Event Properties</span></span>](how-to-handle-multiple-events-using-event-properties.md)|<span data-ttu-id="2f0bb-191">示範如何使用事件屬性處理多個事件。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-191">Shows how to use event properties to handle multiple events.</span></span>|  
|[<span data-ttu-id="2f0bb-192">觀察者設計模式</span><span class="sxs-lookup"><span data-stu-id="2f0bb-192">Observer Design Pattern</span></span>](observer-design-pattern.md)|<span data-ttu-id="2f0bb-193">描述設計模式，可讓訂閱者向提供者註冊，並且接收通知。</span><span class="sxs-lookup"><span data-stu-id="2f0bb-193">Describes the design pattern that enables a subscriber to register with, and receive notifications from, a provider.</span></span>|
  
## <a name="see-also"></a><span data-ttu-id="2f0bb-194">請參閱</span><span class="sxs-lookup"><span data-stu-id="2f0bb-194">See also</span></span>

- <xref:System.EventHandler>
- <xref:System.EventHandler%601>
- <xref:System.EventArgs>
- <xref:System.Delegate>
- [<span data-ttu-id="2f0bb-195">事件 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="2f0bb-195">Events (Visual Basic)</span></span>](../../visual-basic/programming-guide/language-features/events/index.md)
- [<span data-ttu-id="2f0bb-196">事件 (C# 程式設計手冊)</span><span class="sxs-lookup"><span data-stu-id="2f0bb-196">Events (C# Programming Guide)</span></span>](../../csharp/programming-guide/events/index.md)
- [<span data-ttu-id="2f0bb-197">事件和路由事件概觀 (UWP 應用程式)</span><span class="sxs-lookup"><span data-stu-id="2f0bb-197">Events and routed events overview (UWP apps)</span></span>](/windows/uwp/xaml-platform/events-and-routed-events-overview)
- <span data-ttu-id="2f0bb-198">[Windows Store 8.x 應用程式中的事件](/previous-versions/windows/apps/hh758286(v=win.10))</span><span class="sxs-lookup"><span data-stu-id="2f0bb-198">[Events in Windows Store 8.x apps](/previous-versions/windows/apps/hh758286(v=win.10))</span></span>

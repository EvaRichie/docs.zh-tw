---
title: 使用日曆
ms.date: 04/01/2019
dev_langs:
- csharp
- vb
helpviewer_keywords:
- globalization [.NET], calendars
- calendars, global applications
- global applications, calendars
- world-ready applications, calendars
- international applications [.NET], calendars
- culture, calendars
ms.assetid: 0c1534e5-979b-4c8a-a588-1c24301aefb3
ms.openlocfilehash: c30af36b3426c4abbdf9c55f6c9062a5d8fc8c23
ms.sourcegitcommit: 965a5af7918acb0a3fd3baf342e15d511ef75188
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 11/18/2020
ms.locfileid: "94824248"
---
# <a name="work-with-calendars"></a><span data-ttu-id="7dd3b-102">使用行事曆</span><span class="sxs-lookup"><span data-stu-id="7dd3b-102">Work with calendars</span></span>

<span data-ttu-id="7dd3b-103">雖然日期和時間值代表一個時間點，但是其字串表示區分文化特性，而且同時取決於用於顯示特定文化特性之日期和時間值的慣例，以及該文化特性所使用的曆法。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-103">Although a date and time value represents a moment in time, its string representation is culture-sensitive and depends both on the conventions used for displaying date and time values by a specific culture and on the calendar used by that culture.</span></span> <span data-ttu-id="7dd3b-104">本主題將探討如何在 .NET 中使用行事曆，並討論在使用日期值時，行事曆類別的使用方式。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-104">This topic explores the support for calendars in .NET and discusses the use of the calendar classes when working with date values.</span></span>

## <a name="calendars-in-net"></a><span data-ttu-id="7dd3b-105">.NET 中的行事曆</span><span class="sxs-lookup"><span data-stu-id="7dd3b-105">Calendars in .NET</span></span>

<span data-ttu-id="7dd3b-106">.NET 中的所有行事曆都衍生自 <xref:System.Globalization.Calendar?displayProperty=nameWithType> 類別，該類別會提供基本行事曆執行。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-106">All calendars in .NET derive from the <xref:System.Globalization.Calendar?displayProperty=nameWithType> class, which provides the base calendar implementation.</span></span> <span data-ttu-id="7dd3b-107">其中一個衍生自 <xref:System.Globalization.Calendar> 類別的類別是 <xref:System.Globalization.EastAsianLunisolarCalendar> 類別，其為所有陰陽曆的基底類別。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-107">One of the classes that inherits from the <xref:System.Globalization.Calendar> class is the <xref:System.Globalization.EastAsianLunisolarCalendar> class, which is the base class for all lunisolar calendars.</span></span> <span data-ttu-id="7dd3b-108">.NET 包含下列行事曆執行：</span><span class="sxs-lookup"><span data-stu-id="7dd3b-108">.NET includes the following calendar implementations:</span></span>

- <span data-ttu-id="7dd3b-109"><xref:System.Globalization.ChineseLunisolarCalendar>，表示中文陰陽曆。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-109"><xref:System.Globalization.ChineseLunisolarCalendar>, which represents the Chinese lunisolar calendar.</span></span>

- <span data-ttu-id="7dd3b-110"><xref:System.Globalization.GregorianCalendar>，表示西曆。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-110"><xref:System.Globalization.GregorianCalendar>, which represents the Gregorian calendar.</span></span> <span data-ttu-id="7dd3b-111">這個曆法會進一步細分成子類型 (例如阿拉伯和中東法文)，這些子類別是由 <xref:System.Globalization.GregorianCalendarTypes?displayProperty=nameWithType> 列舉類型所定義。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-111">This calendar is further divided into subtypes (such as Arabic and Middle East French) that are defined by the <xref:System.Globalization.GregorianCalendarTypes?displayProperty=nameWithType> enumeration.</span></span> <span data-ttu-id="7dd3b-112"><xref:System.Globalization.GregorianCalendar.CalendarType%2A?displayProperty=nameWithType> 屬性會指定西曆的子類型。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-112">The <xref:System.Globalization.GregorianCalendar.CalendarType%2A?displayProperty=nameWithType> property specifies the subtype of the Gregorian calendar.</span></span>

- <span data-ttu-id="7dd3b-113"><xref:System.Globalization.HebrewCalendar>，表示希伯來曆法。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-113"><xref:System.Globalization.HebrewCalendar>, which represents the Hebrew calendar.</span></span>

- <span data-ttu-id="7dd3b-114"><xref:System.Globalization.HijriCalendar>，表示回曆。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-114"><xref:System.Globalization.HijriCalendar>, which represents the Hijri calendar.</span></span>

- <span data-ttu-id="7dd3b-115"><xref:System.Globalization.JapaneseCalendar>，表示日本曆法。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-115"><xref:System.Globalization.JapaneseCalendar>, which represents the Japanese calendar.</span></span>

- <span data-ttu-id="7dd3b-116"><xref:System.Globalization.JapaneseLunisolarCalendar>，表示日文陰陽曆。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-116"><xref:System.Globalization.JapaneseLunisolarCalendar>, which represents the Japanese lunisolar calendar.</span></span>

- <span data-ttu-id="7dd3b-117"><xref:System.Globalization.JulianCalendar>，表示凱撒曆法。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-117"><xref:System.Globalization.JulianCalendar>, which represents the Julian calendar.</span></span>

- <span data-ttu-id="7dd3b-118"><xref:System.Globalization.KoreanCalendar>，表示韓國曆法。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-118"><xref:System.Globalization.KoreanCalendar>, which represents the Korean calendar.</span></span>

- <span data-ttu-id="7dd3b-119"><xref:System.Globalization.KoreanLunisolarCalendar>，表示韓文陰陽曆。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-119"><xref:System.Globalization.KoreanLunisolarCalendar>, which represents the Korean lunisolar calendar.</span></span>

- <span data-ttu-id="7dd3b-120"><xref:System.Globalization.PersianCalendar>，表示波斯曆。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-120"><xref:System.Globalization.PersianCalendar>, which represents the Persian calendar.</span></span>

- <span data-ttu-id="7dd3b-121"><xref:System.Globalization.TaiwanCalendar>，表示台灣曆法。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-121"><xref:System.Globalization.TaiwanCalendar>, which represents the Taiwan calendar.</span></span>

- <span data-ttu-id="7dd3b-122"><xref:System.Globalization.TaiwanLunisolarCalendar>，表示台灣使用的陰陽曆。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-122"><xref:System.Globalization.TaiwanLunisolarCalendar>, which represents the Taiwan lunisolar calendar.</span></span>

- <span data-ttu-id="7dd3b-123"><xref:System.Globalization.ThaiBuddhistCalendar>，表示泰國佛教曆法。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-123"><xref:System.Globalization.ThaiBuddhistCalendar>, which represents the Thai Buddhist calendar.</span></span>

- <span data-ttu-id="7dd3b-124"><xref:System.Globalization.UmAlQuraCalendar>，表示 Um Al Qura 曆法。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-124"><xref:System.Globalization.UmAlQuraCalendar>, which represents the Um Al Qura calendar.</span></span>

<span data-ttu-id="7dd3b-125">曆法的使用方式有兩種：</span><span class="sxs-lookup"><span data-stu-id="7dd3b-125">A calendar can be used in one of two ways:</span></span>

- <span data-ttu-id="7dd3b-126">做為特定文化特性使用的曆法。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-126">As the calendar used by a specific culture.</span></span> <span data-ttu-id="7dd3b-127">每個 <xref:System.Globalization.CultureInfo> 物件都有現行的曆法，也就是物件目前使用的曆法。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-127">Each <xref:System.Globalization.CultureInfo> object has a current calendar, which is the calendar that the object is currently using.</span></span> <span data-ttu-id="7dd3b-128">所有日期和時間值的字串表示都會自動反映目前的文化特性及其現行曆法。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-128">The string representations of all date and time values automatically reflect the current culture and its current calendar.</span></span> <span data-ttu-id="7dd3b-129">通常現行曆法是文化特性的預設曆法。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-129">Typically, the current calendar is the culture's default calendar.</span></span> <span data-ttu-id="7dd3b-130"><xref:System.Globalization.CultureInfo> 物件也有選用的行事曆，包括文化特性可以使用的其他行事曆。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-130"><xref:System.Globalization.CultureInfo> objects also have optional calendars, which include additional calendars that the culture can use.</span></span>

- <span data-ttu-id="7dd3b-131">做為與特定文化特性無關的獨立曆法。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-131">As a standalone calendar independent of a specific culture.</span></span> <span data-ttu-id="7dd3b-132">這種情況下會使用 <xref:System.Globalization.Calendar> 方法以反映曆法的值表達日期。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-132">In this case, <xref:System.Globalization.Calendar> methods are used to express dates as values that reflect the calendar.</span></span>

<span data-ttu-id="7dd3b-133">請注意，這六種曆法類別 <xref:System.Globalization.ChineseLunisolarCalendar>、<xref:System.Globalization.JapaneseLunisolarCalendar>、<xref:System.Globalization.JulianCalendar>、<xref:System.Globalization.KoreanLunisolarCalendar>、<xref:System.Globalization.PersianCalendar> 和 <xref:System.Globalization.TaiwanLunisolarCalendar> 只能做為獨立曆法使用。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-133">Note that six calendar classes – <xref:System.Globalization.ChineseLunisolarCalendar>, <xref:System.Globalization.JapaneseLunisolarCalendar>, <xref:System.Globalization.JulianCalendar>, <xref:System.Globalization.KoreanLunisolarCalendar>, <xref:System.Globalization.PersianCalendar>, and <xref:System.Globalization.TaiwanLunisolarCalendar> – can be used only as standalone calendars.</span></span> <span data-ttu-id="7dd3b-134">這些類別不會由任何文化特性做為預設曆法或選擇性曆法使用。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-134">They are not used by any culture as either the default calendar or as an optional calendar.</span></span>

## <a name="calendars-and-cultures"></a><span data-ttu-id="7dd3b-135">行事曆和文化特性</span><span class="sxs-lookup"><span data-stu-id="7dd3b-135">Calendars and cultures</span></span>

<span data-ttu-id="7dd3b-136">每一種文化特性都有預設曆法，該曆法是由 <xref:System.Globalization.CultureInfo.Calendar%2A?displayProperty=nameWithType> 屬性所定義。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-136">Each culture has a default calendar, which is defined by the <xref:System.Globalization.CultureInfo.Calendar%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="7dd3b-137"><xref:System.Globalization.CultureInfo.OptionalCalendars%2A?displayProperty=nameWithType> 屬性會傳回 <xref:System.Globalization.Calendar> 物件的陣列，該陣列會指定特定文化特性支援的所有曆法，包括該文化特性的預設曆法。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-137">The <xref:System.Globalization.CultureInfo.OptionalCalendars%2A?displayProperty=nameWithType> property returns an array of <xref:System.Globalization.Calendar> objects that specifies all the calendars supported by a particular culture, including that culture's default calendar.</span></span>

<span data-ttu-id="7dd3b-138">下列範例說明 <xref:System.Globalization.CultureInfo.Calendar%2A?displayProperty=nameWithType> 和 <xref:System.Globalization.CultureInfo.OptionalCalendars%2A?displayProperty=nameWithType> 屬性。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-138">The following example illustrates the <xref:System.Globalization.CultureInfo.Calendar%2A?displayProperty=nameWithType> and <xref:System.Globalization.CultureInfo.OptionalCalendars%2A?displayProperty=nameWithType> properties.</span></span> <span data-ttu-id="7dd3b-139">範例中會為泰文 (泰國) 和日文 (日本) 文化特性建立 `CultureInfo` 物件，並且顯示其預設和選擇性曆法。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-139">It creates `CultureInfo` objects for the Thai (Thailand) and Japanese (Japan) cultures and displays their default and optional calendars.</span></span> <span data-ttu-id="7dd3b-140">請注意，在這兩種情況下，文化特性的預設曆法也會包含在 <xref:System.Globalization.CultureInfo.OptionalCalendars%2A?displayProperty=nameWithType> 集合中。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-140">Note that in both cases, the culture's default calendar is also included in the <xref:System.Globalization.CultureInfo.OptionalCalendars%2A?displayProperty=nameWithType> collection.</span></span>

[!code-csharp[Conceptual.Calendars#1](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.calendars/cs/calendarinfo1.cs#1)]
[!code-vb[Conceptual.Calendars#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.calendars/vb/calendarinfo1.vb#1)]

<span data-ttu-id="7dd3b-141">特定 <xref:System.Globalization.CultureInfo> 物件目前使用的曆法是由文化特性的 <xref:System.Globalization.DateTimeFormatInfo.Calendar%2A?displayProperty=nameWithType> 屬性定義。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-141">The calendar currently in use by a particular <xref:System.Globalization.CultureInfo> object is defined by the culture's <xref:System.Globalization.DateTimeFormatInfo.Calendar%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="7dd3b-142">文化特性的 <xref:System.Globalization.DateTimeFormatInfo> 物件是由 <xref:System.Globalization.CultureInfo.DateTimeFormat%2A?displayProperty=nameWithType> 屬性所傳回。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-142">A culture's <xref:System.Globalization.DateTimeFormatInfo> object is returned by the <xref:System.Globalization.CultureInfo.DateTimeFormat%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="7dd3b-143">建立文化特性時，其預設值與 <xref:System.Globalization.CultureInfo.Calendar%2A?displayProperty=nameWithType> 屬性的值相同。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-143">When a culture is created, its default value is the same as the value of the <xref:System.Globalization.CultureInfo.Calendar%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="7dd3b-144">不過，您可以將文化特性的現行曆法變更為 <xref:System.Globalization.CultureInfo.OptionalCalendars%2A?displayProperty=nameWithType> 屬性所傳回陣列中包含的任何曆法。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-144">However, you can change the culture's current calendar to any calendar contained in the array returned by the <xref:System.Globalization.CultureInfo.OptionalCalendars%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="7dd3b-145">如果您嘗試將現行曆法設定為不包括在 <xref:System.Globalization.CultureInfo.OptionalCalendars%2A?displayProperty=nameWithType> 屬性值中的曆法，則會顯示 <xref:System.ArgumentException>。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-145">If you try to set the current calendar to a calendar that is not included in the <xref:System.Globalization.CultureInfo.OptionalCalendars%2A?displayProperty=nameWithType> property value, an <xref:System.ArgumentException> is thrown.</span></span>

<span data-ttu-id="7dd3b-146">下列範例會變更阿拉伯文 (沙烏地阿拉伯) 文化特性使用的曆法。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-146">The following example changes the calendar used by the Arabic (Saudi Arabia) culture.</span></span> <span data-ttu-id="7dd3b-147">首先會具現化 <xref:System.DateTime> 值，並且使用現行文化特性 (此案例中是英文 (美國)) 和目前文化特性的曆法 (此案例中是西曆) 顯示該值。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-147">It first instantiates a <xref:System.DateTime> value and displays it using the current culture - which, in this case, is English (United States) - and the current culture's calendar (which, in this case, is the Gregorian calendar).</span></span> <span data-ttu-id="7dd3b-148">接著會將目前的文化特性變更為阿拉伯文 (沙烏地阿拉伯)，並且使用其預設的 Um Al-Qura 曆法顯示日期。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-148">Next, it changes the current culture to Arabic (Saudi Arabia) and displays the date using its default Um Al-Qura calendar.</span></span> <span data-ttu-id="7dd3b-149">最後呼叫 `CalendarExists` 方法，判斷阿拉伯文 (沙烏地阿拉伯) 文化特性是否支援回曆。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-149">It then calls the `CalendarExists` method to determine whether the Hijri calendar is supported by the Arabic (Saudi Arabia) culture.</span></span> <span data-ttu-id="7dd3b-150">由於支援此曆法，因此會將現行曆法變更為回曆，並且再次顯示日期。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-150">Because the calendar is supported, it changes the current calendar to Hijri and again displays the date.</span></span> <span data-ttu-id="7dd3b-151">請注意，在各案例中，日期會使用目前文化特性的現行曆法顯示。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-151">Note that in each case, the date is displayed using the current culture's current calendar.</span></span>

[!code-csharp[Conceptual.Calendars#2](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.calendars/cs/changecalendar2.cs#2)]
[!code-vb[Conceptual.Calendars#2](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.calendars/vb/changecalendar2.vb#2)]

## <a name="dates-and-calendars"></a><span data-ttu-id="7dd3b-152">日期和行事曆</span><span class="sxs-lookup"><span data-stu-id="7dd3b-152">Dates and calendars</span></span>

<span data-ttu-id="7dd3b-153">除了包括 <xref:System.Globalization.Calendar> 類型的參數且允許日期的項目 (也就是月、日和年) 以指定的曆法反映值的建構函式之外，<xref:System.DateTime> 和 <xref:System.DateTimeOffset> 這兩個值永遠以西曆為主。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-153">With the exception of the constructors that include a parameter of type <xref:System.Globalization.Calendar> and allow the elements of a date (that is, the month, the day, and the year) to reflect values in a designated calendar, both <xref:System.DateTime> and <xref:System.DateTimeOffset> values are always based on the Gregorian calendar.</span></span> <span data-ttu-id="7dd3b-154">例如，這表示 <xref:System.DateTime.Year%2A?displayProperty=nameWithType> 屬性會傳回西曆的年，而 <xref:System.DateTime.Day%2A?displayProperty=nameWithType> 屬性會傳回西曆的月份日期。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-154">This means, for example, that the <xref:System.DateTime.Year%2A?displayProperty=nameWithType> property returns the year in the Gregorian calendar, and the <xref:System.DateTime.Day%2A?displayProperty=nameWithType> property returns the day of the month in the Gregorian calendar.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="7dd3b-155">務必記得，日期值及其字串表示之間有一項差異。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-155">It is important to remember that there is a difference between a date value and its string representation.</span></span> <span data-ttu-id="7dd3b-156">前者是以西曆為主，後者是以特定文化特性的現行曆法為主。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-156">The former is based on the Gregorian calendar; the latter is based on the current calendar of a specific culture.</span></span>

<span data-ttu-id="7dd3b-157">下列範例會說明 <xref:System.DateTime> 屬性及其對應的 <xref:System.Globalization.Calendar> 方法之間的這項差異。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-157">The following example illustrates this difference between <xref:System.DateTime> properties and their corresponding <xref:System.Globalization.Calendar> methods.</span></span> <span data-ttu-id="7dd3b-158">在此範例中，目前文化特性為阿拉伯文 (埃及)，而現行曆法為 Um Al Qura。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-158">In the example, the current culture is Arabic (Egypt), and the current calendar is Um Al Qura.</span></span> <span data-ttu-id="7dd3b-159"><xref:System.DateTime> 值會設定為 2011 年第七個月的第 15 天。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-159">A <xref:System.DateTime> value is set to the fifteenth day of the seventh month of 2011.</span></span> <span data-ttu-id="7dd3b-160">很清楚這個日期是解譯為西曆日期，因為這些相同值是 <xref:System.DateTime.ToString%28System.String%2CSystem.IFormatProvider%29?displayProperty=nameWithType> 方法在使用不因文化特性而異的慣例時所傳回。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-160">It is clear that this is interpreted as a Gregorian date, because these same values are returned by the <xref:System.DateTime.ToString%28System.String%2CSystem.IFormatProvider%29?displayProperty=nameWithType> method when it uses the conventions of the invariant culture.</span></span> <span data-ttu-id="7dd3b-161">使用目前文化特性格式化之日期的字串表示為 14/08/32，其為 Um Al Qura 曆法的同等日期。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-161">The string representation of the date that is formatted using the conventions of the current culture is 14/08/32, which is the equivalent date in the Um Al Qura calendar.</span></span> <span data-ttu-id="7dd3b-162">其次，`DateTime` 和 `Calendar` 的成員會用來傳回 <xref:System.DateTime> 值的日、月和年。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-162">Next, members of `DateTime` and `Calendar` are used to return the day, the month, and the year of the <xref:System.DateTime> value.</span></span> <span data-ttu-id="7dd3b-163">在各案例中，<xref:System.DateTime> 成員傳回的值會反映西曆的值，而 <xref:System.Globalization.UmAlQuraCalendar> 成員傳回的值則會反映 Uum al-Qura 曆法的值。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-163">In each case, the values returned by <xref:System.DateTime> members reflect values in the Gregorian calendar, whereas values returned by <xref:System.Globalization.UmAlQuraCalendar> members reflect values in the Uum al-Qura calendar.</span></span>

[!code-csharp[Conceptual.Calendars#3](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.calendars/cs/datesandcalendars2.cs#3)]
[!code-vb[Conceptual.Calendars#3](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.calendars/vb/datesandcalendars2.vb#3)]

### <a name="instantiate-dates-based-on-a-calendar"></a><span data-ttu-id="7dd3b-164">以行事曆為基礎來具現化日期</span><span class="sxs-lookup"><span data-stu-id="7dd3b-164">Instantiate dates based on a calendar</span></span>

<span data-ttu-id="7dd3b-165">由於 <xref:System.DateTime> 和 <xref:System.DateTimeOffset> 值是以西曆為主，因此，如果您想要使用不同曆法的日、月或年值，則必須呼叫包含 <xref:System.Globalization.Calendar> 類型之參數的多載建構函式來具現化日期值。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-165">Because <xref:System.DateTime> and <xref:System.DateTimeOffset> values are based on the Gregorian calendar, you must call an overloaded constructor that includes a parameter of type <xref:System.Globalization.Calendar> to instantiate a date value if you want to use the day, month, or year values from a different calendar.</span></span> <span data-ttu-id="7dd3b-166">您也可以呼叫特定曆法之 <xref:System.Globalization.Calendar.ToDateTime%2A?displayProperty=nameWithType> 方法的其中一個多載，依據特殊曆法的值具現化 <xref:System.DateTime> 物件。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-166">You can also call one of the overloads of a specific calendar's <xref:System.Globalization.Calendar.ToDateTime%2A?displayProperty=nameWithType> method to instantiate a <xref:System.DateTime> object based on the values of a particular calendar.</span></span>

<span data-ttu-id="7dd3b-167">下列範例會藉由將 <xref:System.DateTime> 物件傳遞至 <xref:System.Globalization.HebrewCalendar> 建構函式具現化一個 <xref:System.DateTime> 值，並且藉由呼叫 <xref:System.DateTime> 方法具現化另一個 <xref:System.Globalization.HebrewCalendar.ToDateTime%28System.Int32%2CSystem.Int32%2CSystem.Int32%2CSystem.Int32%2CSystem.Int32%2CSystem.Int32%2CSystem.Int32%2CSystem.Int32%29?displayProperty=nameWithType> 值。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-167">The following example instantiates one <xref:System.DateTime> value by passing a <xref:System.Globalization.HebrewCalendar> object to a <xref:System.DateTime> constructor, and instantiates a second <xref:System.DateTime> value by calling the <xref:System.Globalization.HebrewCalendar.ToDateTime%28System.Int32%2CSystem.Int32%2CSystem.Int32%2CSystem.Int32%2CSystem.Int32%2CSystem.Int32%2CSystem.Int32%2CSystem.Int32%29?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="7dd3b-168">由於這兩個值是使用希伯來曆法的相同值所建立，因此呼叫 <xref:System.DateTime.Equals%2A?displayProperty=nameWithType> 方法會顯示這兩個 <xref:System.DateTime> 值相等。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-168">Because the two values are created with identical values from the Hebrew calendar, the call to the <xref:System.DateTime.Equals%2A?displayProperty=nameWithType> method shows that the two <xref:System.DateTime> values are equal.</span></span>

[!code-csharp[Conceptual.Calendars#4](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.calendars/cs/instantiatehcdate1.cs#4)]
[!code-vb[Conceptual.Calendars#4](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.calendars/vb/instantiatehcdate1.vb#4)]

### <a name="represent-dates-in-the-current-calendar"></a><span data-ttu-id="7dd3b-169">表示目前行事曆中的日期</span><span class="sxs-lookup"><span data-stu-id="7dd3b-169">Represent dates in the current calendar</span></span>

<span data-ttu-id="7dd3b-170">日期和時間格式化方法會固定使用現行曆法將日期轉換為字串。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-170">Date and time formatting methods always use the current calendar when converting dates to strings.</span></span> <span data-ttu-id="7dd3b-171">這表示年、月和月份日期的字串表示會反映現行曆法，而且不一定會反映西曆。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-171">This means that the string representation of the year, the month, and the day of the month reflect the current calendar, and do not necessarily reflect the Gregorian calendar.</span></span>

<span data-ttu-id="7dd3b-172">下列範例顯示現行曆法如何影響日期的字串表示。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-172">The following example shows how the current calendar affects the string representation of a date.</span></span> <span data-ttu-id="7dd3b-173">它會將目前文化特性變更為中文 (繁體，台灣)，並且具現化日期值。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-173">It changes the current culture to Chinese (Traditional, Taiwan), and instantiates a date value.</span></span> <span data-ttu-id="7dd3b-174">接著會顯示現行曆法和日期，將現行曆法變更為 <xref:System.Globalization.TaiwanCalendar>，然後再次顯示現行曆法和日期。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-174">It then displays the current calendar and the date, changes the current calendar to <xref:System.Globalization.TaiwanCalendar>, and displays the current calendar and date once again.</span></span> <span data-ttu-id="7dd3b-175">第一次顯示日期時，該日期會以西曆日期表示。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-175">The first time the date is displayed, it is represented as a date in the Gregorian calendar.</span></span> <span data-ttu-id="7dd3b-176">第二次顯示日期時，該日期會以台灣曆法的日期表示。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-176">The second time it is displayed, it is represented as a date in the Taiwan calendar.</span></span>

[!code-csharp[Conceptual.Calendars#5](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.calendars/cs/currentcalendar1.cs#5)]
[!code-vb[Conceptual.Calendars#5](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.calendars/vb/currentcalendar1.vb#5)]

### <a name="represent-dates-in-a-non-current-calendar"></a><span data-ttu-id="7dd3b-177">代表非目前行事曆中的日期</span><span class="sxs-lookup"><span data-stu-id="7dd3b-177">Represent dates in a non-current calendar</span></span>

<span data-ttu-id="7dd3b-178">若要使用不是特定文化特性的現行曆法來表示日期，您必須呼叫該 <xref:System.Globalization.Calendar> 物件的方法。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-178">To represent a date using a calendar that is not the current calendar of a particular culture, you must call methods of that <xref:System.Globalization.Calendar> object.</span></span> <span data-ttu-id="7dd3b-179">例如，<xref:System.Globalization.Calendar.GetYear%2A?displayProperty=nameWithType>、<xref:System.Globalization.Calendar.GetMonth%2A?displayProperty=nameWithType> 和 <xref:System.Globalization.Calendar.GetDayOfMonth%2A?displayProperty=nameWithType> 方法會將年、月和日轉換成反映特定曆法的值。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-179">For example, the <xref:System.Globalization.Calendar.GetYear%2A?displayProperty=nameWithType>, <xref:System.Globalization.Calendar.GetMonth%2A?displayProperty=nameWithType>, and <xref:System.Globalization.Calendar.GetDayOfMonth%2A?displayProperty=nameWithType> methods convert the year, month, and day to values that reflect a particular calendar.</span></span>

> [!WARNING]
> <span data-ttu-id="7dd3b-180">由於某些曆法並非任何文化特性的選擇性曆法，因此使用這些曆法表示日期一定要呼叫曆法方法。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-180">Because some calendars are not optional calendars of any culture, representing dates in these calendars always requires that you call calendar methods.</span></span> <span data-ttu-id="7dd3b-181">所有衍生自 <xref:System.Globalization.EastAsianLunisolarCalendar>、<xref:System.Globalization.JulianCalendar> 和 <xref:System.Globalization.PersianCalendar> 類別的曆法都要這樣做。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-181">This is true of all calendars that derive from the <xref:System.Globalization.EastAsianLunisolarCalendar>, <xref:System.Globalization.JulianCalendar>, and <xref:System.Globalization.PersianCalendar> classes.</span></span>

<span data-ttu-id="7dd3b-182">下列範例使用 <xref:System.Globalization.JulianCalendar> 物件具現化凱撒曆法的日期 1905 年 1 月 9 日。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-182">The following example uses a <xref:System.Globalization.JulianCalendar> object to instantiate a date, January 9, 1905, in the Julian calendar.</span></span> <span data-ttu-id="7dd3b-183">使用預設曆法 (西曆) 顯示這個日期時，該日期會表示為 1905 年 1 月 22 日。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-183">When this date is displayed using the default (Gregorian) calendar, it is represented as January 22, 1905.</span></span> <span data-ttu-id="7dd3b-184">呼叫個別 <xref:System.Globalization.JulianCalendar> 方法即可使用凱撒曆法表示日期。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-184">Calls to individual <xref:System.Globalization.JulianCalendar> methods enable the date to be represented in the Julian calendar.</span></span>

[!code-csharp[Conceptual.Calendars#6](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.calendars/cs/noncurrentcalendar1.cs#6)]
[!code-vb[Conceptual.Calendars#6](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.calendars/vb/noncurrentcalendar1.vb#6)]

### <a name="calendars-and-date-ranges"></a><span data-ttu-id="7dd3b-185">行事曆和日期範圍</span><span class="sxs-lookup"><span data-stu-id="7dd3b-185">Calendars and date ranges</span></span>

<span data-ttu-id="7dd3b-186">曆法所支援的最早日期是由該曆法的 <xref:System.Globalization.Calendar.MinSupportedDateTime%2A?displayProperty=nameWithType> 屬性所表示。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-186">The earliest date supported by a calendar is indicated by that calendar's <xref:System.Globalization.Calendar.MinSupportedDateTime%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="7dd3b-187">如果是 <xref:System.Globalization.GregorianCalendar> 類別，該日期是公元 0001 年 1 月 1 日。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-187">For the <xref:System.Globalization.GregorianCalendar> class, that date is January 1, 0001 C.E.</span></span> <span data-ttu-id="7dd3b-188">.NET 中大部分的其他行事曆都支援未來的日期。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-188">Most of the other calendars in .NET support a later date.</span></span> <span data-ttu-id="7dd3b-189">嘗試處理早於曆法所支援最早日期的日期和時間值，會擲回 <xref:System.ArgumentOutOfRangeException> 例外狀況。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-189">Trying to work with a date and time value that precedes a calendar's earliest supported date throws an <xref:System.ArgumentOutOfRangeException> exception.</span></span>

<span data-ttu-id="7dd3b-190">不過，有一個重要的例外狀況。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-190">However, there is one important exception.</span></span> <span data-ttu-id="7dd3b-191"><xref:System.DateTime> 物件和 <xref:System.DateTimeOffset> 物件的預設值 (未初始化的值) 相當於 <xref:System.Globalization.GregorianCalendar.MinSupportedDateTime%2A?displayProperty=nameWithType> 值。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-191">The default (uninitialized) value of a <xref:System.DateTime> object and a <xref:System.DateTimeOffset> object is equal to the <xref:System.Globalization.GregorianCalendar.MinSupportedDateTime%2A?displayProperty=nameWithType> value.</span></span> <span data-ttu-id="7dd3b-192">如果您嘗試在不支援西元0001年1月1日的行事曆中格式化此日期</span><span class="sxs-lookup"><span data-stu-id="7dd3b-192">If you try to format this date in a calendar that does not support January 1, 0001 C.E.</span></span> <span data-ttu-id="7dd3b-193">您未提供格式規範，格式方法會使用 "s" (可排序日期/時間模式) 格式規範，而不是 "G" (一般日期/時間模式) 格式規範。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-193">and you do not provide a format specifier, the formatting method uses the "s" (sortable date/time pattern) format specifier instead of the "G" (general date/time pattern) format specifier.</span></span> <span data-ttu-id="7dd3b-194">結果，格式化作業並不會擲回 <xref:System.ArgumentOutOfRangeException> 例外狀況，</span><span class="sxs-lookup"><span data-stu-id="7dd3b-194">As a result, the formatting operation does not throw an <xref:System.ArgumentOutOfRangeException> exception.</span></span> <span data-ttu-id="7dd3b-195">而是傳回不支援的日期。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-195">Instead, it returns the unsupported date.</span></span> <span data-ttu-id="7dd3b-196">下列範例將說明這種情況，當目前文化特性設為日文 (日本) 並採用日本曆法，以及設為阿拉伯文 (埃及) 並採用 Um Al Qura 曆法時，會顯示 <xref:System.DateTime.MinValue?displayProperty=nameWithType> 值。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-196">This is illustrated in the following example, which displays the value of <xref:System.DateTime.MinValue?displayProperty=nameWithType> when the current culture is set to Japanese (Japan) with the Japanese calendar, and to Arabic (Egypt) with the Um Al Qura calendar.</span></span> <span data-ttu-id="7dd3b-197">另外也會將目前文化特性設為英文 (美國)，並且對每一個 <xref:System.DateTime.ToString%28System.IFormatProvider%29?displayProperty=nameWithType> 物件呼叫 <xref:System.Globalization.CultureInfo> 方法。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-197">It also sets the current culture to English (United States) and calls the <xref:System.DateTime.ToString%28System.IFormatProvider%29?displayProperty=nameWithType> method with each of these <xref:System.Globalization.CultureInfo> objects.</span></span> <span data-ttu-id="7dd3b-198">在每個案例中，日期是使用可排序日期/時間模式顯示。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-198">In each case, the date is displayed by using the sortable date/time pattern.</span></span>

[!code-csharp[Conceptual.Calendars#11](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.calendars/cs/minsupporteddatetime1.cs#11)]
[!code-vb[Conceptual.Calendars#11](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.calendars/vb/minsupporteddatetime1.vb#11)]

## <a name="work-with-eras"></a><span data-ttu-id="7dd3b-199">使用紀元</span><span class="sxs-lookup"><span data-stu-id="7dd3b-199">Work with eras</span></span>

<span data-ttu-id="7dd3b-200">曆法通常會將日期細分成紀元。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-200">Calendars typically divide dates into eras.</span></span> <span data-ttu-id="7dd3b-201">不過， <xref:System.Globalization.Calendar> .net 中的類別不支援行事曆所定義的每個紀元，而大部分的 <xref:System.Globalization.Calendar> 類別只支援單一紀元。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-201">However, the <xref:System.Globalization.Calendar> classes in .NET do not support every era defined by a calendar, and most of the <xref:System.Globalization.Calendar> classes support only a single era.</span></span> <span data-ttu-id="7dd3b-202">只有 <xref:System.Globalization.JapaneseCalendar> 和 <xref:System.Globalization.JapaneseLunisolarCalendar> 類別支援多個紀元。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-202">Only the <xref:System.Globalization.JapaneseCalendar> and <xref:System.Globalization.JapaneseLunisolarCalendar> classes support multiple eras.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="7dd3b-203">Reiwa 紀元是和中的新時代 <xref:System.Globalization.JapaneseCalendar> <xref:System.Globalization.JapaneseLunisolarCalendar> ，從2019年5月1日開始。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-203">The Reiwa era, a new era in the <xref:System.Globalization.JapaneseCalendar> and <xref:System.Globalization.JapaneseLunisolarCalendar>, begins on May 1, 2019.</span></span> <span data-ttu-id="7dd3b-204">這項改變對所有使用這些日曆的應用程式都有影響。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-204">This change affects all applications that use these calendars.</span></span> <span data-ttu-id="7dd3b-205">如需詳細資訊，請參閱下列文章：</span><span class="sxs-lookup"><span data-stu-id="7dd3b-205">See the following articles for more information:</span></span>
>
> - <span data-ttu-id="7dd3b-206">在[.net 的日文日曆中處理新的時代](https://devblogs.microsoft.com/dotnet/handling-a-new-era-in-the-japanese-calendar-in-net/)，這會記載新增至 .net 的功能，以支援具有多個紀元的行事曆，並討論處理多個年代行事歷時使用的最佳做法。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-206">[Handling a new era in the Japanese calendar in .NET](https://devblogs.microsoft.com/dotnet/handling-a-new-era-in-the-japanese-calendar-in-net/), which documents features added to .NET to support calendars with multiple eras and discusses best practices to use when handling multi-era calendars.</span></span>
> - <span data-ttu-id="7dd3b-207">[為您的應用程式做好日文時代的變更](/windows/uwp/design/globalizing/japanese-era-change)，以提供在 Windows 上測試應用程式的相關資訊，以確保其在紀元方面的就緒程度變更。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-207">[Prepare your application for the Japanese era change](/windows/uwp/design/globalizing/japanese-era-change), which provides information on testing your applications on Windows to ensure their readiness for the era change.</span></span>
> - <span data-ttu-id="7dd3b-208">[.NET Framework 的新日文時代更新摘要](https://support.microsoft.com/help/4477957/new-japanese-era-updates-for-net-framework)，其中列出與新的日文日曆時代相關之個別 Windows 版本的 .NET Framework 更新、提供多個支援的新 .NET Framework 功能，以及在測試應用程式時要尋找的專案。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-208">[Summary of new Japanese Era updates for .NET Framework](https://support.microsoft.com/help/4477957/new-japanese-era-updates-for-net-framework), which lists .NET Framework updates for individual Windows versions that are related to the new Japanese calendar era, notes new .NET Framework features for multi-era support, and includes things to look for in testing your applications.</span></span>

<span data-ttu-id="7dd3b-209">大部分行事曆中的紀元表示非常長的時間週期。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-209">An era in most calendars denotes an extremely long time period.</span></span> <span data-ttu-id="7dd3b-210">例如，在西曆中，目前的紀元跨越兩個以上的千年來。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-210">In the Gregorian calendar, for example, the current era spans more than two millennia.</span></span> <span data-ttu-id="7dd3b-211">在 <xref:System.Globalization.JapaneseCalendar> 和 <xref:System.Globalization.JapaneseLunisolarCalendar> 中，支援多個紀元的兩個行事曆不是這種情況。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-211">For the <xref:System.Globalization.JapaneseCalendar> and the <xref:System.Globalization.JapaneseLunisolarCalendar>, the two calendars that support multiple eras, this is not the case.</span></span> <span data-ttu-id="7dd3b-212">紀元會對應到天皇的統治期間。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-212">An era corresponds to the period of an emperor's reign.</span></span> <span data-ttu-id="7dd3b-213">支援多個紀元，特別是當目前紀元的上限未知時，會帶來特殊的挑戰。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-213">Support for multiple eras, particularly when the upper limit of the current era is unknown, poses special challenges.</span></span>

### <a name="eras-and-era-names"></a><span data-ttu-id="7dd3b-214">紀元和紀元名稱</span><span class="sxs-lookup"><span data-stu-id="7dd3b-214">Eras and era names</span></span>

<span data-ttu-id="7dd3b-215">在 .NET 中，代表特定行事曆實所支援之紀元的整數會以反向順序儲存在 <xref:System.Globalization.Calendar.Eras%2A?displayProperty=nameWithType> 陣列中。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-215">In .NET, integers that represent the eras supported by a particular calendar implementation are stored in reverse order in the <xref:System.Globalization.Calendar.Eras%2A?displayProperty=nameWithType> array.</span></span> <span data-ttu-id="7dd3b-216">目前的紀元 (是具有最新時間範圍) 的紀元位於索引零，而針對 <xref:System.Globalization.Calendar> 支援多個紀元的類別，每個後續的索引都會反映先前的紀元。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-216">The current era (which is the era with the latest time range) is at index zero, and for <xref:System.Globalization.Calendar> classes that support multiple eras, each successive index reflects the previous era.</span></span> <span data-ttu-id="7dd3b-217">靜態 <xref:System.Globalization.Calendar.CurrentEra?displayProperty=nameWithType> 屬性會定義 <xref:System.Globalization.Calendar.Eras%2A?displayProperty=nameWithType> 陣列中目前紀元的索引，它是一個常數，且其值永遠為零。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-217">The static <xref:System.Globalization.Calendar.CurrentEra?displayProperty=nameWithType> property defines the index of the current era in the <xref:System.Globalization.Calendar.Eras%2A?displayProperty=nameWithType> array; it is a constant whose value is always zero.</span></span> <span data-ttu-id="7dd3b-218">個別 <xref:System.Globalization.Calendar> 類別也會包含傳回目前紀元值的靜態欄位。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-218">Individual <xref:System.Globalization.Calendar> classes also include static fields that return the value of the current era.</span></span> <span data-ttu-id="7dd3b-219">下表中列出這些欄位。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-219">They are listed in the following table.</span></span>

| <span data-ttu-id="7dd3b-220">曆法類別</span><span class="sxs-lookup"><span data-stu-id="7dd3b-220">Calendar class</span></span>                                        | <span data-ttu-id="7dd3b-221">目前紀元欄位</span><span class="sxs-lookup"><span data-stu-id="7dd3b-221">Current era field</span></span>                                                 |
| ----------------------------------------------------- | ----------------------------------------------------------------- |
| <xref:System.Globalization.ChineseLunisolarCalendar>  | <xref:System.Globalization.ChineseLunisolarCalendar.ChineseEra>   |
| <xref:System.Globalization.GregorianCalendar>         | <xref:System.Globalization.GregorianCalendar.ADEra>               |
| <xref:System.Globalization.HebrewCalendar>            | <xref:System.Globalization.HebrewCalendar.HebrewEra>              |
| <xref:System.Globalization.HijriCalendar>             | <xref:System.Globalization.HijriCalendar.HijriEra>                |
| <xref:System.Globalization.JapaneseLunisolarCalendar> | <xref:System.Globalization.JapaneseLunisolarCalendar.JapaneseEra> |
| <xref:System.Globalization.JulianCalendar>            | <xref:System.Globalization.JulianCalendar.JulianEra>              |
| <xref:System.Globalization.KoreanCalendar>            | <xref:System.Globalization.KoreanCalendar.KoreanEra>              |
| <xref:System.Globalization.KoreanLunisolarCalendar>   | <xref:System.Globalization.KoreanLunisolarCalendar.GregorianEra>  |
| <xref:System.Globalization.PersianCalendar>           | <xref:System.Globalization.PersianCalendar.PersianEra>            |
| <xref:System.Globalization.ThaiBuddhistCalendar>      | <xref:System.Globalization.ThaiBuddhistCalendar.ThaiBuddhistEra>  |
| <xref:System.Globalization.UmAlQuraCalendar>          | <xref:System.Globalization.UmAlQuraCalendar.UmAlQuraEra>          |

<span data-ttu-id="7dd3b-222">對應特定紀元數的名稱可藉由將紀元數傳遞至 <xref:System.Globalization.DateTimeFormatInfo.GetEraName%2A?displayProperty=nameWithType> 或 <xref:System.Globalization.DateTimeFormatInfo.GetAbbreviatedEraName%2A?displayProperty=nameWithType> 方法的方式擷取。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-222">The name that corresponds to a particular era number can be retrieved by passing the era number to the <xref:System.Globalization.DateTimeFormatInfo.GetEraName%2A?displayProperty=nameWithType> or <xref:System.Globalization.DateTimeFormatInfo.GetAbbreviatedEraName%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="7dd3b-223">下列範例會呼叫這些方法來擷取 <xref:System.Globalization.GregorianCalendar> 類別中紀元支援的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-223">The following example calls these methods to retrieve information about era support in the <xref:System.Globalization.GregorianCalendar> class.</span></span> <span data-ttu-id="7dd3b-224">它會顯示西曆日期，該日期與目前紀元的第二年1月1日相對應，以及對應至每個支援之日文日曆紀元第二年1月1日的西曆日期。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-224">It displays the Gregorian calendar date that corresponds to January 1 of the second year of the current era, as well as the Gregorian calendar date that corresponds to January 1 of the second year of each supported Japanese calendar era.</span></span>

[!code-csharp[Conceptual.Calendars#7](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.calendars/cs/instantiatewithera1.cs)]
[!code-vb[Conceptual.Calendars#7](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.calendars/vb/instantiatewithera1.vb)]

<span data-ttu-id="7dd3b-225">此外，"g" 自訂日期和時間格式字串包括曆法的紀元名稱，該名稱為日期和時間的字串表示。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-225">In addition, the "g" custom date and time format string includes a calendar's era name in the string representation of a date and time.</span></span> <span data-ttu-id="7dd3b-226">如需詳細資訊，請參閱 [自訂日期和時間格式字串](../base-types/custom-date-and-time-format-strings.md)。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-226">For more information, see [Custom date and time format strings](../base-types/custom-date-and-time-format-strings.md).</span></span>

### <a name="instantiatie-a-date-with-an-era"></a><span data-ttu-id="7dd3b-227">Instantiatie 具有紀元的日期</span><span class="sxs-lookup"><span data-stu-id="7dd3b-227">Instantiatie a date with an era</span></span>

<span data-ttu-id="7dd3b-228">針對 <xref:System.Globalization.Calendar> 支援多個紀元的兩個類別，包含特定年、月和日值的日期可能不明確。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-228">For the two <xref:System.Globalization.Calendar> classes that support multiple eras, a date that consists of a particular year, month, and day of the month value can be ambiguous.</span></span> <span data-ttu-id="7dd3b-229">例如，所支援的所有紀元 <xref:System.Globalization.JapaneseCalendar> 都有年份，其數目為1。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-229">For example, all eras supported by the <xref:System.Globalization.JapaneseCalendar> have years whose number is 1.</span></span> <span data-ttu-id="7dd3b-230">一般而言，如果未指定紀元，日期和時間及曆法方法都會假設這些值屬於目前紀元。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-230">Ordinarily, if an era is not specified, both date and time and calendar methods assume that values belong to the current era.</span></span> <span data-ttu-id="7dd3b-231">這適用于 <xref:System.DateTime.%23ctor%2A> 和 <xref:System.DateTimeOffset.%23ctor%2A> 包含型別參數的和函式 <xref:System.Globalization.Calendar> ，以及 [JapaneseCalendar. ToDateTime](xref:System.Globalization.Calendar.ToDateTime(System.Int32,System.Int32,System.Int32,System.Int32,System.Int32,System.Int32,System.Int32)) 和 [JapaneseLunisolarCalendar. ToDateTime](xref:System.Globalization.Calendar.ToDateTime(System.Int32,System.Int32,System.Int32,System.Int32,System.Int32,System.Int32,System.Int32)) 方法。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-231">This is true of the <xref:System.DateTime.%23ctor%2A> and <xref:System.DateTimeOffset.%23ctor%2A> constructors that include parameters of type <xref:System.Globalization.Calendar>, as well as the [JapaneseCalendar.ToDateTime](xref:System.Globalization.Calendar.ToDateTime(System.Int32,System.Int32,System.Int32,System.Int32,System.Int32,System.Int32,System.Int32)) and [JapaneseLunisolarCalendar.ToDateTime](xref:System.Globalization.Calendar.ToDateTime(System.Int32,System.Int32,System.Int32,System.Int32,System.Int32,System.Int32,System.Int32)) methods.</span></span> <span data-ttu-id="7dd3b-232">下列範例會具現化代表未指定紀元中第二年1月1日的日期。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-232">The following example instantiates a date that represents January 1 of the second year of an unspecified era.</span></span> <span data-ttu-id="7dd3b-233">如果您在 Reiwa 紀元是目前的紀元時執行範例，日期會被視為 Reiwa 紀元的第二年。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-233">If you execute the example when the Reiwa era is the current era, the date is interpreted as the second year of the Reiwa era.</span></span> <span data-ttu-id="7dd3b-234">紀元（令和）在方法所傳回之字串中的年份之前， <xref:System.DateTime.ToString(System.String,System.IFormatProvider)?displayProperty=nameWithType> 並對應至西曆中的2020年1月1日。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-234">The era, 令和, precedes the year in the string returned by the <xref:System.DateTime.ToString(System.String,System.IFormatProvider)?displayProperty=nameWithType> method and corresponds to January 1, 2020, in the Gregorian calendar.</span></span> <span data-ttu-id="7dd3b-235"> (Reiwa 紀元于西曆年2019年開始。 ) </span><span class="sxs-lookup"><span data-stu-id="7dd3b-235">(The Reiwa era begins in the year 2019 of the Gregorian calendar.)</span></span>

[!code-csharp[A date in the current era](~/samples/snippets/standard/datetime/calendars/current-era/cs/program.cs)]
[!code-vb[A date in the current era](~/samples/snippets/standard/datetime/calendars/current-era/vb/program.vb)]

<span data-ttu-id="7dd3b-236">但是，如果紀元變更，則此程式碼的意圖會變得不明確。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-236">However, if the era changes, the intent of this code becomes ambiguous.</span></span> <span data-ttu-id="7dd3b-237">這是要代表目前紀元的第二年的日期，還是要代表 Heisei 紀元的第二年？</span><span class="sxs-lookup"><span data-stu-id="7dd3b-237">Is the date intended to represent the second year of the current era, or is it intended to represent the second year of the Heisei era?</span></span> <span data-ttu-id="7dd3b-238">有兩種方式可避免這種混淆：</span><span class="sxs-lookup"><span data-stu-id="7dd3b-238">There are two ways to avoid this ambiguity:</span></span>

- <span data-ttu-id="7dd3b-239">使用預設類別來具現化日期和時間值 <xref:System.Globalization.GregorianCalendar> 。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-239">Instantiate the date and time value using the default <xref:System.Globalization.GregorianCalendar> class.</span></span> <span data-ttu-id="7dd3b-240">然後，您可以使用日文行事曆或日文陰陽曆來表示日期的字串表示，如下列範例所示。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-240">You can then use the Japanese calendar or the Japanese Lunisolar calendar for the string representation of dates, as the following example shows.</span></span>

  [!code-csharp[Insantiating a Gregorian date](~/samples/snippets/standard/datetime/calendars/gregorian/cs/program.cs)]
  [!code-vb[Instantiating a Gregorian date](~/samples/snippets/standard/datetime/calendars/gregorian/vb/program.vb)]

- <span data-ttu-id="7dd3b-241">呼叫明確指定紀元的日期和時間方法。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-241">Call a date and time method that explicitly specifies an era.</span></span> <span data-ttu-id="7dd3b-242">這包括下列方法︰</span><span class="sxs-lookup"><span data-stu-id="7dd3b-242">This includes the following methods:</span></span>

  - <span data-ttu-id="7dd3b-243"><xref:System.Globalization.Calendar.ToDateTime(System.Int32,System.Int32,System.Int32,System.Int32,System.Int32,System.Int32,System.Int32,System.Int32)>或類別的方法 <xref:System.Globalization.JapaneseCalendar> <xref:System.Globalization.JapaneseLunisolarCalendar> 。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-243">The <xref:System.Globalization.Calendar.ToDateTime(System.Int32,System.Int32,System.Int32,System.Int32,System.Int32,System.Int32,System.Int32,System.Int32)> method of the <xref:System.Globalization.JapaneseCalendar> or <xref:System.Globalization.JapaneseLunisolarCalendar> class.</span></span>

  - <span data-ttu-id="7dd3b-244"><xref:System.DateTime>或 <xref:System.DateTimeOffset> 剖析方法（例如 <xref:System.DateTime.Parse%2A> 、 <xref:System.DateTime.TryParse%2A> 、 <xref:System.DateTime.ParseExact%2A> 或）， <xref:System.DateTime.TryParseExact%2A> 其中包含要剖析的字串，以及選擇性的 <xref:System.Globalization.DateTimeStyles> 引數（如果目前的文化特性是 Japanese-Japan ( "ja-jp" ) 且文化特性的行事曆為） <xref:System.Globalization.JapaneseCalendar> 。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-244">A <xref:System.DateTime> or <xref:System.DateTimeOffset> parsing method, such as <xref:System.DateTime.Parse%2A>, <xref:System.DateTime.TryParse%2A>, <xref:System.DateTime.ParseExact%2A>, or <xref:System.DateTime.TryParseExact%2A>, that includes the string to be parsed and optionally a <xref:System.Globalization.DateTimeStyles> argument if the current culture is Japanese-Japan ("ja-JP") and that culture's calendar is the <xref:System.Globalization.JapaneseCalendar>.</span></span> <span data-ttu-id="7dd3b-245">要剖析的字串必須包含紀元。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-245">The string to be parsed must include the era.</span></span>

  - <span data-ttu-id="7dd3b-246"><xref:System.DateTime>或 <xref:System.DateTimeOffset> 剖析方法，其中包含 `provider` 類型的參數 <xref:System.IFormatProvider> 。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-246">A <xref:System.DateTime> or <xref:System.DateTimeOffset> parsing method that includes a `provider` parameter of type <xref:System.IFormatProvider>.</span></span> <span data-ttu-id="7dd3b-247">`provider` 必須是 <xref:System.Globalization.CultureInfo> 代表 Japanese-Japan ( "ja-jp" ) 文化特性的物件，其目前的行事曆是 <xref:System.Globalization.JapaneseCalendar> 或 <xref:System.Globalization.DateTimeFormatInfo> 其 <xref:System.Globalization.DateTimeFormatInfo.Calendar> 屬性為的物件 <xref:System.Globalization.JapaneseCalendar> 。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-247">`provider` must be either a <xref:System.Globalization.CultureInfo> object that represents the Japanese-Japan ("ja-JP") culture whose current calendar is <xref:System.Globalization.JapaneseCalendar> or a <xref:System.Globalization.DateTimeFormatInfo> object whose <xref:System.Globalization.DateTimeFormatInfo.Calendar> property is <xref:System.Globalization.JapaneseCalendar>.</span></span> <span data-ttu-id="7dd3b-248">要剖析的字串必須包含紀元。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-248">The string to be parsed must include the era.</span></span>

  <span data-ttu-id="7dd3b-249">下列範例會使用這三種方法來具現化 Meiji 紀元中的日期和時間（從1868年9月8日開始），並于1912年7月29日結束。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-249">The following example uses three of these methods to instantiate a date and time in the Meiji era, which began on September 8, 1868, and ended on July 29, 1912.</span></span>

  [!code-csharp[A date in a specified era](~/samples/snippets/standard/datetime/calendars/specify-era/cs/program.cs)]
  [!code-vb[A date in a specified era](~/samples/snippets/standard/datetime/calendars/specify-era/vb/program.vb)]

> [!TIP]
> <span data-ttu-id="7dd3b-250">使用支援多個紀元的行事歷時，請 *一律* 使用西曆日期來具現化日期，或在您根據該行事歷來具現化日期和時間時，指定紀元。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-250">When working with calendars that support multiple eras, *always* use the Gregorian date to instantiate a date, or specify the era when you instantiate a date and time based on that calendar.</span></span>

<span data-ttu-id="7dd3b-251">在指定紀元給 <xref:System.Globalization.Calendar.ToDateTime(System.Int32,System.Int32,System.Int32,System.Int32,System.Int32,System.Int32,System.Int32,System.Int32)> 方法時，您會在行事曆的屬性中提供紀元的索引 <xref:System.Globalization.Calendar.Eras> 。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-251">In specifying an era to the <xref:System.Globalization.Calendar.ToDateTime(System.Int32,System.Int32,System.Int32,System.Int32,System.Int32,System.Int32,System.Int32,System.Int32)> method, you provide the index of the era in the calendar's <xref:System.Globalization.Calendar.Eras> property.</span></span> <span data-ttu-id="7dd3b-252">不過，對於其紀元有可能變更的行事曆，這些索引不是常數值;目前的紀元位於索引0，而最舊的紀元位於索引處 `Eras.Length - 1` 。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-252">For calendars whose eras are subject to change, however, these indexes are not constant values; the current era is at index 0, and the oldest era is at index `Eras.Length - 1`.</span></span> <span data-ttu-id="7dd3b-253">當新的紀元新增至行事歷時，前一個紀元的索引會增加1。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-253">When a new era is added to a calendar, the indexes of the previous eras increase by one.</span></span> <span data-ttu-id="7dd3b-254">您可以提供適當的紀元索引，如下所示：</span><span class="sxs-lookup"><span data-stu-id="7dd3b-254">You can supply the appropriate era index as follows:</span></span>

- <span data-ttu-id="7dd3b-255">針對目前紀元中的日期，請一律使用行事曆的 <xref:System.Globalization.Calendar.CurrentEra> 屬性。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-255">For dates in the current era, always use the calendar's <xref:System.Globalization.Calendar.CurrentEra> property.</span></span>

- <span data-ttu-id="7dd3b-256">針對指定紀元中的日期，請使用 <xref:System.Globalization.DateTimeFormatInfo.GetEraName%2A?displayProperty=nameWithType> 方法來取出對應于指定之紀元名稱的索引。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-256">For dates in a specified era, use the <xref:System.Globalization.DateTimeFormatInfo.GetEraName%2A?displayProperty=nameWithType> method to retrieve the index that corresponds to a specified era name.</span></span> <span data-ttu-id="7dd3b-257">這需要 <xref:System.Globalization.JapaneseCalendar> 是 <xref:System.Globalization.CultureInfo> 代表 ja-jp 文化特性之物件的目前行事曆。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-257">This requires that the <xref:System.Globalization.JapaneseCalendar> be the current calendar of the <xref:System.Globalization.CultureInfo> object that represents the ja-JP culture.</span></span>  <span data-ttu-id="7dd3b-258"> (這項技術也適用于 <xref:System.Globalization.JapaneseLunisolarCalendar> ，因為它支援與相同的紀元 <xref:System.Globalization.JapaneseCalendar> 。 ) 上一個範例說明這種方法。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-258">(This technique works for the <xref:System.Globalization.JapaneseLunisolarCalendar> as well, since it supports the same eras as the <xref:System.Globalization.JapaneseCalendar>.) The previous example illustrates this approach.</span></span>

### <a name="calendars-eras-and-date-ranges-relaxed-range-checks"></a><span data-ttu-id="7dd3b-259">行事曆、紀元和日期範圍：寬鬆的範圍檢查</span><span class="sxs-lookup"><span data-stu-id="7dd3b-259">Calendars, eras, and date ranges: Relaxed range checks</span></span>

<span data-ttu-id="7dd3b-260">和個別行事曆都有支援的日期範圍，和類別中的紀元 <xref:System.Globalization.JapaneseCalendar> <xref:System.Globalization.JapaneseLunisolarCalendar> 也有支援的範圍。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-260">Very much like individual calendars have supported date ranges, eras in the <xref:System.Globalization.JapaneseCalendar> and <xref:System.Globalization.JapaneseLunisolarCalendar> classes also have supported ranges.</span></span> <span data-ttu-id="7dd3b-261">先前，.NET 使用嚴格的紀元範圍檢查，以確保紀元特定日期在該紀元的範圍內。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-261">Previously, .NET used strict era range checks to ensure that an era-specific date was within the range of that era.</span></span> <span data-ttu-id="7dd3b-262">也就是說，如果日期超出指定紀元的範圍，則方法會擲回 <xref:System.ArgumentOutOfRangeException> 。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-262">That is, if a date is outside of the range of the specified era, the method throws an <xref:System.ArgumentOutOfRangeException>.</span></span> <span data-ttu-id="7dd3b-263">目前，.NET 預設會使用寬鬆的範圍檢查。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-263">Currently, .NET uses relaxed ranged checking by default.</span></span> <span data-ttu-id="7dd3b-264">所有 .NET 版本的更新引進了寬鬆的紀元範圍檢查;嘗試將指定的紀元範圍以外的特定時間範圍，具現化為下列紀元，且不會擲回例外狀況。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-264">Updates to all versions of .NET introduced relaxed era range checks; the attempt to instantiate an era-specific date that is outside the range of the specified era "overflows" into the following era, and no exception is thrown.</span></span>

<span data-ttu-id="7dd3b-265">下列範例會嘗試在 Showa 紀元的65th 年中具現化日期，其開始時間為1926年12月25日，並于1989年1月7日結束。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-265">The following example attempts to instantiate a date in the 65th year of the Showa era, which began on December 25, 1926 and ended on January 7, 1989.</span></span> <span data-ttu-id="7dd3b-266">此日期對應于1990年1月9日，在中的 Showa 紀元範圍之外 <xref:System.Globalization.JapaneseCalendar> 。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-266">This date corresponds to January 9, 1990, which is outside the range of the Showa era in the <xref:System.Globalization.JapaneseCalendar>.</span></span> <span data-ttu-id="7dd3b-267">如範例的輸出所示，此範例顯示的日期為1990年1月9日（Heisei 紀元的第二年）。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-267">As the output from the example illustrates, the date displayed by the example is January 9, 1990, in the second year of the Heisei era.</span></span>

  [!code-csharp[Relaxed range checks](~/samples/snippets/standard/datetime/calendars/relaxed-range/cs/program.cs)]
  [!code-vb[Relaxed range checks](~/samples/snippets/standard/datetime/calendars/relaxed-range/vb/program.vb)]

<span data-ttu-id="7dd3b-268">如果不需要寬鬆的範圍檢查，您可以透過數種方式還原嚴格的範圍檢查，端視您的應用程式執行所在的 .NET 版本而定：</span><span class="sxs-lookup"><span data-stu-id="7dd3b-268">If relaxed range checks are undesirable, you can restore strict range checks in a number of ways, depending on the version of .NET on which your application is running:</span></span>

- <span data-ttu-id="7dd3b-269">**.Net Core：** 將下列內容新增至設定檔 *上的.netcore.runtime.js* ：</span><span class="sxs-lookup"><span data-stu-id="7dd3b-269">**.NET Core:** Add the following to the *.netcore.runtime.json* config file:</span></span>

  ```json
  "runtimeOptions": {
    "configProperties": {
        "Switch.System.Globalization.EnforceJapaneseEraYearRanges": true
    }
  }
  ```

- <span data-ttu-id="7dd3b-270">**.NET Framework 4.6 或更新版本：** 在 *app.config* 檔案中設定下列 AppCoNtext 參數：</span><span class="sxs-lookup"><span data-stu-id="7dd3b-270">**.NET Framework 4.6 or later:** Set the following AppContext switch in the *app.config* file:</span></span>

  ```xml
  <?xml version="1.0" encoding="utf-8"?>
  <configuration>
    <runtime>
      <AppContextSwitchOverrides value="Switch.System.Globalization.EnforceJapaneseEraYearRanges=true" />
    </runtime>
  </configuration>
  ```

- <span data-ttu-id="7dd3b-271">**.NET Framework 4.5.2 或更早版本：** 設定下列登錄值：</span><span class="sxs-lookup"><span data-stu-id="7dd3b-271">**.NET Framework 4.5.2 or earlier:** Set the following registry value:</span></span>

   |  |  |
   |--|--|
   | <span data-ttu-id="7dd3b-272">**Key**</span><span class="sxs-lookup"><span data-stu-id="7dd3b-272">**Key**</span></span> | <span data-ttu-id="7dd3b-273">**HKEY_LOCAL_MACHINE\Software\Microsoft\\ 。NETFramework\AppCoNtext**</span><span class="sxs-lookup"><span data-stu-id="7dd3b-273">**HKEY_LOCAL_MACHINE\Software\Microsoft\\.NETFramework\AppContext**</span></span> |
   | <span data-ttu-id="7dd3b-274">**Name**</span><span class="sxs-lookup"><span data-stu-id="7dd3b-274">**Name**</span></span> | <span data-ttu-id="7dd3b-275">Switch.System。全球化. EnforceJapaneseEraYearRanges</span><span class="sxs-lookup"><span data-stu-id="7dd3b-275">Switch.System.Globalization.EnforceJapaneseEraYearRanges</span></span> |
   | <span data-ttu-id="7dd3b-276">**型別**</span><span class="sxs-lookup"><span data-stu-id="7dd3b-276">**Type**</span></span> | <span data-ttu-id="7dd3b-277">REG_SZ</span><span class="sxs-lookup"><span data-stu-id="7dd3b-277">REG_SZ</span></span> |
   | <span data-ttu-id="7dd3b-278">**值**</span><span class="sxs-lookup"><span data-stu-id="7dd3b-278">**Value**</span></span> | <span data-ttu-id="7dd3b-279">true</span><span class="sxs-lookup"><span data-stu-id="7dd3b-279">true</span></span> |

<span data-ttu-id="7dd3b-280">啟用 strict 範圍檢查後，上述範例會擲回 <xref:System.ArgumentOutOfRangeException> ，並顯示下列輸出：</span><span class="sxs-lookup"><span data-stu-id="7dd3b-280">With strict range checks enabled, the previous example throws an <xref:System.ArgumentOutOfRangeException> and displays the following output:</span></span>

```console
Unhandled Exception: System.ArgumentOutOfRangeException: Valid values are between 1 and 64, inclusive.
Parameter name: year
   at System.Globalization.GregorianCalendarHelper.GetYearOffset(Int32 year, Int32 era, Boolean throwOnError)
   at System.Globalization.GregorianCalendarHelper.ToDateTime(Int32 year, Int32 month, Int32 day, Int32 hour, Int32 minute, Int32 second, Int32 millisecond, Int32 era)
   at Example.Main()
```

### <a name="represent-dates-in-calendars-with-multiple-eras"></a><span data-ttu-id="7dd3b-281">以多個紀元表示日曆中的日期</span><span class="sxs-lookup"><span data-stu-id="7dd3b-281">Represent dates in calendars with multiple eras</span></span>

<span data-ttu-id="7dd3b-282">如果 <xref:System.Globalization.Calendar> 物件支援紀元而且是 <xref:System.Globalization.CultureInfo> 物件的現行曆法，則紀元會包含在完整日期和時間模式、完整日期模式及簡短日期模式之日期和時間值的字串表示中。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-282">If a <xref:System.Globalization.Calendar> object supports eras and is the current calendar of a <xref:System.Globalization.CultureInfo> object, the era is included in the string representation of a date and time value for the full date and time, long date, and short date patterns.</span></span> <span data-ttu-id="7dd3b-283">下列範例顯示目前文化特性為日本 (日文) 且現行曆法為日本曆法時的這些日期模式。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-283">The following example displays these date patterns when the current culture is Japan (Japanese) and the current calendar is the Japanese calendar.</span></span>

[!code-csharp[Conceptual.Calendars#8](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.calendars/cs/formatstrings1.cs#8)]
[!code-vb[Conceptual.Calendars#8](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.calendars/vb/formatstrings1.vb#8)]

> [!WARNING]
> <span data-ttu-id="7dd3b-284"><xref:System.Globalization.JapaneseCalendar>類別是 .net 中唯一的行事曆類別，其支援多個紀元中的日期，而且可以是物件的目前行事曆 <xref:System.Globalization.CultureInfo> ，特別是 <xref:System.Globalization.CultureInfo> 代表日文 (日本) 文化特性的物件。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-284">The <xref:System.Globalization.JapaneseCalendar> class is the only calendar class in .NET that both supports dates in more than one era and that can be the current calendar of a <xref:System.Globalization.CultureInfo> object - specifically, of a <xref:System.Globalization.CultureInfo> object that represents the Japanese (Japan) culture.</span></span>

<span data-ttu-id="7dd3b-285">針對所有曆法，"g" 自訂格式規範會在結果字串中包含紀元。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-285">For all calendars, the "g" custom format specifier includes the era in the result string.</span></span> <span data-ttu-id="7dd3b-286">下列範例在現行曆法為西曆時，使用 "MM-dd-yyyy g" 自訂格式字串在結果字串中包含紀元。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-286">The following example uses the "MM-dd-yyyy g" custom format string to include the era in the result string when the current calendar is the Gregorian calendar.</span></span>

[!code-csharp[Conceptual.Calendars#9](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.calendars/cs/formatstrings2.cs#9)]
[!code-vb[Conceptual.Calendars#9](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.calendars/vb/formatstrings2.vb#9)]

<span data-ttu-id="7dd3b-287">在日期的字串表示不是以現行曆法表示的情況下，<xref:System.Globalization.Calendar> 類別會包含 <xref:System.Globalization.Calendar.GetEra%2A?displayProperty=nameWithType> 方法，該方法可搭配 <xref:System.Globalization.Calendar.GetYear%2A?displayProperty=nameWithType>、<xref:System.Globalization.Calendar.GetMonth%2A?displayProperty=nameWithType> 和 <xref:System.Globalization.Calendar.GetDayOfMonth%2A?displayProperty=nameWithType> 方法用來明確指出日期，以及該日期所屬的紀元。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-287">In cases where the string representation of a date is expressed in a calendar that is not the current calendar, the <xref:System.Globalization.Calendar> class includes a <xref:System.Globalization.Calendar.GetEra%2A?displayProperty=nameWithType> method that can be used along with the <xref:System.Globalization.Calendar.GetYear%2A?displayProperty=nameWithType>, <xref:System.Globalization.Calendar.GetMonth%2A?displayProperty=nameWithType>, and <xref:System.Globalization.Calendar.GetDayOfMonth%2A?displayProperty=nameWithType> methods to unambiguously indicate a date as well as the era to which it belongs.</span></span> <span data-ttu-id="7dd3b-288">下列範例使用 <xref:System.Globalization.JapaneseLunisolarCalendar> 類別提供圖例。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-288">The following example uses the <xref:System.Globalization.JapaneseLunisolarCalendar> class to provide an illustration.</span></span> <span data-ttu-id="7dd3b-289">不過請注意，若要在結果字串中包含代表紀元的有意義名稱或縮寫而非整數，必須將 <xref:System.Globalization.DateTimeFormatInfo> 物件具現化，並且讓 <xref:System.Globalization.JapaneseCalendar> 成為現行曆法 </span><span class="sxs-lookup"><span data-stu-id="7dd3b-289">However, note that including a meaningful name or abbreviation instead of an integer for the era in the result string requires that you instantiate a <xref:System.Globalization.DateTimeFormatInfo> object and make <xref:System.Globalization.JapaneseCalendar> its current calendar.</span></span> <span data-ttu-id="7dd3b-290">(<xref:System.Globalization.JapaneseLunisolarCalendar> 曆法不得為任何文化特性的現行曆法，但在這個案例中，兩個曆法共用相同的紀元)。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-290">(The <xref:System.Globalization.JapaneseLunisolarCalendar> calendar cannot be the current calendar of any culture, but in this case the two calendars share the same eras.)</span></span>

[!code-csharp[Conceptual.Calendars#10](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.calendars/cs/formatstrings3.cs#10)]
[!code-vb[Conceptual.Calendars#10](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.calendars/vb/formatstrings3.vb#10)]

<span data-ttu-id="7dd3b-291">在日文日曆中，紀元的第一年稱為 Gannen (元年) 。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-291">In the Japanese calendars, the first year of an era is called Gannen (元年).</span></span> <span data-ttu-id="7dd3b-292">例如，不是 Heisei 1，Heisei 紀元的第一年可以描述為 Heisei Gannen。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-292">For example, instead of Heisei 1, the first year of the Heisei era can be described as Heisei Gannen.</span></span> <span data-ttu-id="7dd3b-293">當使用下列標準或自訂日期和時間格式字串搭配 <xref:System.Globalization.CultureInfo> 代表 Japanese-Japan ( "ja-jp" ) 文化特性與類別的物件時，.net 會採用此慣例來格式化日期和時間格式的作業 <xref:System.Globalization.JapaneseCalendar> ：</span><span class="sxs-lookup"><span data-stu-id="7dd3b-293">.NET adopts this convention in formatting operations for dates and times formatted with the following standard or custom date and time format strings when they are used with a <xref:System.Globalization.CultureInfo> object that represents the Japanese-Japan ("ja-JP") culture with the <xref:System.Globalization.JapaneseCalendar> class:</span></span>

- <span data-ttu-id="7dd3b-294">[完整日期模式](../base-types/standard-date-and-time-format-strings.md#LongDate)，以 "D" 標準日期和時間格式字串表示。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-294">[The long date pattern](../base-types/standard-date-and-time-format-strings.md#LongDate), indicated by the "D" standard date and time format string.</span></span>
- <span data-ttu-id="7dd3b-295">[完整日期完整時間模式](../base-types/standard-date-and-time-format-strings.md#FullDateLongTime)，以 "F" 標準日期和時間格式字串表示。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-295">[The full date long time pattern](../base-types/standard-date-and-time-format-strings.md#FullDateLongTime), indicated by the "F" standard date and time format string.</span></span>
- <span data-ttu-id="7dd3b-296">[完整日期簡短時間模式](../base-types/standard-date-and-time-format-strings.md#FullDateShortTime)，以 "f" 標準日期和時間格式字串表示。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-296">[The full date short time pattern](../base-types/standard-date-and-time-format-strings.md#FullDateShortTime), indicated by the "f" standard date and time format string.</span></span>
- <span data-ttu-id="7dd3b-297">[Year/month 模式](../base-types/standard-date-and-time-format-strings.md#YearMonth)，以 Y "或" y "標準日期和時間格式字串表示。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-297">[The year/month pattern](../base-types/standard-date-and-time-format-strings.md#YearMonth), indicated by the Y" or "y" standard date and time format string.</span></span>
- <span data-ttu-id="7dd3b-298">[Ggy ' 年 ' "或" ggy年 " [自訂日期和時間格式字串](../base-types/custom-date-and-time-format-strings.md)。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-298">[The "ggy'年'" or "ggy年" [custom date and time format string](../base-types/custom-date-and-time-format-strings.md).</span></span>

<span data-ttu-id="7dd3b-299">例如，下列範例會在中顯示 Heisei 紀元的第一年中的日期 <xref:System.Globalization.JapaneseCalendar> 。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-299">For example, the following example displays a date in the first year of the Heisei era in the <xref:System.Globalization.JapaneseCalendar>.</span></span>

  [!code-csharp[gannen](~/samples/snippets/standard/datetime/calendars/gannen/cs/program.cs)]
  [!code-vb[gannen](~/samples/snippets/standard/datetime/calendars/gannen/vb/gannen-fmt.vb)]

<span data-ttu-id="7dd3b-300">如果在格式化作業中不需要這種行為，您可以藉由執行下列動作（視 .NET 的版本而定）來還原先前的行為，此行為一律會將紀元的第一年表示為 "1"，而不是 "Gannen"：</span><span class="sxs-lookup"><span data-stu-id="7dd3b-300">If this behavior is undesirable in formatting operations, you can restore the previous behavior, which always represents the first year of an era as "1" rather than "Gannen", by doing the following, depending on the version of .NET:</span></span>

- <span data-ttu-id="7dd3b-301">**.Net Core：** 將下列內容新增至設定檔 *上的.netcore.runtime.js* ：</span><span class="sxs-lookup"><span data-stu-id="7dd3b-301">**.NET Core:** Add the following to the *.netcore.runtime.json* config file:</span></span>

  ```json
  "runtimeOptions": {
    "configProperties": {
        "Switch.System.Globalization.FormatJapaneseFirstYearAsANumber": true
    }
  }
  ```

- <span data-ttu-id="7dd3b-302">**.NET Framework 4.6 或更新版本：** 在 *app.config* 檔案中設定下列 AppCoNtext 參數：</span><span class="sxs-lookup"><span data-stu-id="7dd3b-302">**.NET Framework 4.6 or later:** Set the following AppContext switch in the *app.config* file:</span></span>

  ```xml
  <?xml version="1.0" encoding="utf-8"?>
  <configuration>
    <runtime>
      <AppContextSwitchOverrides value="Switch.System.Globalization.FormatJapaneseFirstYearAsANumber=true" />
    </runtime>
  </configuration>
  ```

- <span data-ttu-id="7dd3b-303">**.NET Framework 4.5.2 或更早版本：** 設定下列登錄值：</span><span class="sxs-lookup"><span data-stu-id="7dd3b-303">**.NET Framework 4.5.2 or earlier:** Set the following registry value:</span></span>

   |  |  |
   |--|--|
   | <span data-ttu-id="7dd3b-304">**Key**</span><span class="sxs-lookup"><span data-stu-id="7dd3b-304">**Key**</span></span> | <span data-ttu-id="7dd3b-305">**HKEY_LOCAL_MACHINE\Software\Microsoft\\ 。NETFramework\AppCoNtext**</span><span class="sxs-lookup"><span data-stu-id="7dd3b-305">**HKEY_LOCAL_MACHINE\Software\Microsoft\\.NETFramework\AppContext**</span></span> |
   | <span data-ttu-id="7dd3b-306">**Name**</span><span class="sxs-lookup"><span data-stu-id="7dd3b-306">**Name**</span></span> | <span data-ttu-id="7dd3b-307">Switch.System。全球化. FormatJapaneseFirstYearAsANumber</span><span class="sxs-lookup"><span data-stu-id="7dd3b-307">Switch.System.Globalization.FormatJapaneseFirstYearAsANumber</span></span> |
   | <span data-ttu-id="7dd3b-308">**型別**</span><span class="sxs-lookup"><span data-stu-id="7dd3b-308">**Type**</span></span> | <span data-ttu-id="7dd3b-309">REG_SZ</span><span class="sxs-lookup"><span data-stu-id="7dd3b-309">REG_SZ</span></span> |
   | <span data-ttu-id="7dd3b-310">**值**</span><span class="sxs-lookup"><span data-stu-id="7dd3b-310">**Value**</span></span> | <span data-ttu-id="7dd3b-311">true</span><span class="sxs-lookup"><span data-stu-id="7dd3b-311">true</span></span> |

<span data-ttu-id="7dd3b-312">在停用格式化作業的 gannen 支援之後，上述範例會顯示下列輸出：</span><span class="sxs-lookup"><span data-stu-id="7dd3b-312">With gannen support in formatting operations disabled, the previous example displays the following output:</span></span>

```console
Japanese calendar date: 平成1年8月18日 (Gregorian: Friday, August 18, 1989)
```

<span data-ttu-id="7dd3b-313">.NET 也已更新，讓日期和時間剖析作業支援包含以 "1" 或 Gannen 表示之年份的字串。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-313">.NET has also been updated so that date and time parsing operations support strings that contain the year represented as either "1" or Gannen.</span></span> <span data-ttu-id="7dd3b-314">雖然您不應該這麼做，但您可以還原先前的行為，將「1」視為紀元的第一年。</span><span class="sxs-lookup"><span data-stu-id="7dd3b-314">Although you should not need to do this, you can restore the previous behavior to recognizes only "1" as the first year of an era.</span></span> <span data-ttu-id="7dd3b-315">您可以依照下列方式執行這項作業，視 .NET 的版本而定：</span><span class="sxs-lookup"><span data-stu-id="7dd3b-315">You can do this as follows, depending on the version of .NET:</span></span>

- <span data-ttu-id="7dd3b-316">**.Net Core：** 將下列內容新增至設定檔 *上的.netcore.runtime.js* ：</span><span class="sxs-lookup"><span data-stu-id="7dd3b-316">**.NET Core:** Add the following to the *.netcore.runtime.json* config file:</span></span>

  ```json
  "runtimeOptions": {
    "configProperties": {
        "Switch.System.Globalization.EnforceLegacyJapaneseDateParsing": true
    }
  }
  ```

- <span data-ttu-id="7dd3b-317">**.NET Framework 4.6 或更新版本：** 在 *app.config* 檔案中設定下列 AppCoNtext 參數：</span><span class="sxs-lookup"><span data-stu-id="7dd3b-317">**.NET Framework 4.6 or later:** Set the following AppContext switch in the *app.config* file:</span></span>

  ```xml
  <?xml version="1.0" encoding="utf-8"?>
  <configuration>
    <runtime>
      <AppContextSwitchOverrides value="Switch.System.Globalization.EnforceLegacyJapaneseDateParsing=true" />
    </runtime>
  </configuration>
  ```

- <span data-ttu-id="7dd3b-318">**.NET Framework 4.5.2 或更早版本：** 設定下列登錄值：</span><span class="sxs-lookup"><span data-stu-id="7dd3b-318">**.NET Framework 4.5.2 or earlier:** Set the following registry value:</span></span>

   |  |  |
   |--|--|
   | <span data-ttu-id="7dd3b-319">**Key**</span><span class="sxs-lookup"><span data-stu-id="7dd3b-319">**Key**</span></span> | <span data-ttu-id="7dd3b-320">**HKEY_LOCAL_MACHINE\Software\Microsoft\\ 。NETFramework\AppCoNtext**</span><span class="sxs-lookup"><span data-stu-id="7dd3b-320">**HKEY_LOCAL_MACHINE\Software\Microsoft\\.NETFramework\AppContext**</span></span> |
   | <span data-ttu-id="7dd3b-321">**Name**</span><span class="sxs-lookup"><span data-stu-id="7dd3b-321">**Name**</span></span> | <span data-ttu-id="7dd3b-322">Switch.System。全球化. EnforceLegacyJapaneseDateParsing</span><span class="sxs-lookup"><span data-stu-id="7dd3b-322">Switch.System.Globalization.EnforceLegacyJapaneseDateParsing</span></span> |
   | <span data-ttu-id="7dd3b-323">**型別**</span><span class="sxs-lookup"><span data-stu-id="7dd3b-323">**Type**</span></span> | <span data-ttu-id="7dd3b-324">REG_SZ</span><span class="sxs-lookup"><span data-stu-id="7dd3b-324">REG_SZ</span></span> |
   | <span data-ttu-id="7dd3b-325">**值**</span><span class="sxs-lookup"><span data-stu-id="7dd3b-325">**Value**</span></span> | <span data-ttu-id="7dd3b-326">true</span><span class="sxs-lookup"><span data-stu-id="7dd3b-326">true</span></span> |

## <a name="see-also"></a><span data-ttu-id="7dd3b-327">請參閱</span><span class="sxs-lookup"><span data-stu-id="7dd3b-327">See also</span></span>

- [<span data-ttu-id="7dd3b-328">如何：在非西曆中顯示日期</span><span class="sxs-lookup"><span data-stu-id="7dd3b-328">How to: Display dates in non-Gregorian calendars</span></span>](../base-types/how-to-display-dates-in-non-gregorian-calendars.md)
- [<span data-ttu-id="7dd3b-329">範例：行事曆周範圍公用程式</span><span class="sxs-lookup"><span data-stu-id="7dd3b-329">Sample: Calendar week range utility</span></span>](https://code.msdn.microsoft.com/NET-Framework-4-Calendar-3360a84a)
- [<span data-ttu-id="7dd3b-330">曆法類別</span><span class="sxs-lookup"><span data-stu-id="7dd3b-330">Calendar class</span></span>](xref:System.Globalization.Calendar)

---
title: 套用 Interop 屬性
description: 本文摘要說明 System.runtime.interopservices.outattribute 命名空間的 COM interop 屬性，包括設計階段和轉換工具屬性。
ms.date: 03/30/2017
helpviewer_keywords:
- design-time attributes
- .NET, exposing components to COM
- attributes [.NET], design-time functionality
- conversion-tool attributes
- attributes [.NET], interop-specific
- attributes [.NET], conversion-tool
- interoperation with unmanaged code, applying attributes
- interoperation with unmanaged code, exposing .NET components
- COM interop, exposing COM components
- COM interop, applying attributes
ms.assetid: b6014613-641c-4912-9e2f-83a99210a037
ms.openlocfilehash: 38632c5a1f462c3a7b537978fde81424916746da
ms.sourcegitcommit: d8020797a6657d0fbbdff362b80300815f682f94
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 11/24/2020
ms.locfileid: "95706290"
---
# <a name="applying-interop-attributes"></a><span data-ttu-id="9f02b-103">套用 Interop 屬性</span><span class="sxs-lookup"><span data-stu-id="9f02b-103">Applying Interop Attributes</span></span>

<span data-ttu-id="9f02b-104"><xref:System.Runtime.InteropServices> 命名空間提供了三種類別的 Interop 專屬屬性：一種是您在設計階段套用的屬性、一種是 COM Interop 工具和 API 在轉換過程中套用的屬性，還有一種是您或 COM Interop 套用的屬性。</span><span class="sxs-lookup"><span data-stu-id="9f02b-104">The <xref:System.Runtime.InteropServices> namespace provides three categories of interop-specific attributes: those applied by you at design time, those applied by COM interop tools and APIs during the conversion process, and those applied either by you or COM interop.</span></span>  
  
 <span data-ttu-id="9f02b-105">如果您不熟悉將屬性套用至 Managed 程式碼的工作，請參閱[使用屬性擴充中繼資料](../attributes/index.md)。</span><span class="sxs-lookup"><span data-stu-id="9f02b-105">If you are unfamiliar with the task of applying attributes to managed code, see [Extending Metadata Using Attributes](../attributes/index.md).</span></span> <span data-ttu-id="9f02b-106">就像其他自訂屬性一樣，您可以將 Interop 專屬屬性 (attribute) 套用至類型、方法、屬性 (property)、參數、欄位和其他成員。</span><span class="sxs-lookup"><span data-stu-id="9f02b-106">Like other custom attributes, you can apply interop-specific attributes to types, methods, properties, parameters, fields, and other members.</span></span>  
  
## <a name="design-time-attributes"></a><span data-ttu-id="9f02b-107">設計階段屬性</span><span class="sxs-lookup"><span data-stu-id="9f02b-107">Design-Time Attributes</span></span>  

 <span data-ttu-id="9f02b-108">您可以使用設計階段屬性來調整 COM Interop 工具和 API 所執行的轉換處理結果。</span><span class="sxs-lookup"><span data-stu-id="9f02b-108">You can adjust the outcome of the conversion process performed by COM interop tools and APIs by using design-time attributes.</span></span> <span data-ttu-id="9f02b-109">下表描述您可以套用到 Managed 原始程式碼的屬性。</span><span class="sxs-lookup"><span data-stu-id="9f02b-109">The following table describes the attributes that you can apply to your managed source code.</span></span> <span data-ttu-id="9f02b-110">COM Interop 工具偶爾也會套用下表所述的屬性。</span><span class="sxs-lookup"><span data-stu-id="9f02b-110">COM interop tools, on occasion, might also apply the attributes described in this table.</span></span>  
  
|<span data-ttu-id="9f02b-111">屬性</span><span class="sxs-lookup"><span data-stu-id="9f02b-111">Attribute</span></span>|<span data-ttu-id="9f02b-112">描述</span><span class="sxs-lookup"><span data-stu-id="9f02b-112">Description</span></span>|  
|---------------|-----------------|  
|<xref:System.Runtime.InteropServices.AutomationProxyAttribute>|<span data-ttu-id="9f02b-113">指定類型是否應使用 Automation 封送處理器或自訂的 Proxy 和 Stub 來進行封送處理。</span><span class="sxs-lookup"><span data-stu-id="9f02b-113">Specifies whether the type should be marshaled using the Automation marshaler or a custom proxy and stub.</span></span>|  
|<xref:System.Runtime.InteropServices.ClassInterfaceAttribute>|<span data-ttu-id="9f02b-114">控制對類別所產生之介面的類型。</span><span class="sxs-lookup"><span data-stu-id="9f02b-114">Controls the type of interface generated for a class.</span></span>|  
|<xref:System.Runtime.InteropServices.CoClassAttribute>|<span data-ttu-id="9f02b-115">識別從型別程式庫匯入之原始 Coclass 的 CLSID。</span><span class="sxs-lookup"><span data-stu-id="9f02b-115">Identifies the CLSID of the original coclass imported from a type library.</span></span><br /><br /> <span data-ttu-id="9f02b-116">COM Interop 工具通常都會套用這個屬性。</span><span class="sxs-lookup"><span data-stu-id="9f02b-116">COM interop tools typically apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.ComImportAttribute>|<span data-ttu-id="9f02b-117">表示已從 COM 類型程式庫匯入 Coclass 或介面定義。</span><span class="sxs-lookup"><span data-stu-id="9f02b-117">Indicates that a coclass or interface definition was imported from a COM type library.</span></span> <span data-ttu-id="9f02b-118">執行階段會使用這個旗標來了解如何啟動和封送處理該類型。</span><span class="sxs-lookup"><span data-stu-id="9f02b-118">The runtime uses this flag to know how to activate and marshal the type.</span></span> <span data-ttu-id="9f02b-119">這個屬性禁止將類型重新匯回型別程式庫中。</span><span class="sxs-lookup"><span data-stu-id="9f02b-119">This attribute prohibits the type from being exported back to a type library.</span></span><br /><br /> <span data-ttu-id="9f02b-120">COM Interop 工具通常都會套用這個屬性。</span><span class="sxs-lookup"><span data-stu-id="9f02b-120">COM interop tools typically apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.ComRegisterFunctionAttribute>|<span data-ttu-id="9f02b-121">表示當組件已註冊為從 COM 使用時應該呼叫某個方法，讓使用者撰寫的程式碼能夠在註冊處理期間執行。</span><span class="sxs-lookup"><span data-stu-id="9f02b-121">Indicates that a method should be called when the assembly is registered for use from COM, so that user-written code can be executed during the registration process.</span></span>|  
|<xref:System.Runtime.InteropServices.ComSourceInterfacesAttribute>|<span data-ttu-id="9f02b-122">識別此類別之事件來源的介面。</span><span class="sxs-lookup"><span data-stu-id="9f02b-122">Identifies interfaces that are sources of events for the class.</span></span><br /><br /> <span data-ttu-id="9f02b-123">COM Interop 工具可以套用這個屬性。</span><span class="sxs-lookup"><span data-stu-id="9f02b-123">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.ComUnregisterFunctionAttribute>|<span data-ttu-id="9f02b-124">表示當組件從 COM 取消註冊時應該呼叫某個方法，讓使用者撰寫的程式碼能夠在處理期間執行。</span><span class="sxs-lookup"><span data-stu-id="9f02b-124">Indicates that a method should be called when the assembly is unregistered from COM, so that user-written code can execute during the process.</span></span>|  
|<xref:System.Runtime.InteropServices.ComVisibleAttribute>|<span data-ttu-id="9f02b-125">當屬性值等於 **false** 時，將類型轉譯為讓 COM 看不見。</span><span class="sxs-lookup"><span data-stu-id="9f02b-125">Renders types invisible to COM when the attribute value equals **false**.</span></span> <span data-ttu-id="9f02b-126">這個屬性可以套用至個別類型或套用至整個組件以控制 COM 的可視性。</span><span class="sxs-lookup"><span data-stu-id="9f02b-126">This attribute can be applied to an individual type or to an entire assembly to control COM visibility.</span></span> <span data-ttu-id="9f02b-127">根據預設，所有 Managed 公用類型都是可見的；不需要這個屬性來讓它們變成可見。</span><span class="sxs-lookup"><span data-stu-id="9f02b-127">By default, all managed, public types are visible; the attribute is not needed to make them visible.</span></span>|  
|<xref:System.Runtime.InteropServices.DispIdAttribute>|<span data-ttu-id="9f02b-128">指定方法或欄位的 COM 分派識別碼 (DISPID)。</span><span class="sxs-lookup"><span data-stu-id="9f02b-128">Specifies the COM dispatch identifier (DISPID) of a method or field.</span></span> <span data-ttu-id="9f02b-129">這個屬性 (attribute) 含有它所描述之方法、欄位或屬性 (property) 的 DISPID。</span><span class="sxs-lookup"><span data-stu-id="9f02b-129">This attribute contains the DISPID for the method, field, or property it describes.</span></span><br /><br /> <span data-ttu-id="9f02b-130">COM Interop 工具可以套用這個屬性。</span><span class="sxs-lookup"><span data-stu-id="9f02b-130">COM interop tools can apply this attribute.</span></span>|
|<xref:System.Runtime.InteropServices.ComDefaultInterfaceAttribute>|<span data-ttu-id="9f02b-131">表示在 .NET 中實作為 COM 類別的預設介面。</span><span class="sxs-lookup"><span data-stu-id="9f02b-131">Indicates the default interface for a COM class implemented in .NET.</span></span><br /><br /> <span data-ttu-id="9f02b-132">COM Interop 工具可以套用這個屬性。</span><span class="sxs-lookup"><span data-stu-id="9f02b-132">COM interop tools can apply this attribute.</span></span>|
|<xref:System.Runtime.InteropServices.FieldOffsetAttribute>|<span data-ttu-id="9f02b-133">當搭配 **StructLayoutAttribute** 使用且 **LayoutKind** 設定為 Explicit 時，指出每一欄位在類別中的實際位置。</span><span class="sxs-lookup"><span data-stu-id="9f02b-133">Indicates the physical position of each field within a class when used with the **StructLayoutAttribute**, and the **LayoutKind** is set to Explicit.</span></span>|  
|<xref:System.Runtime.InteropServices.GuidAttribute>|<span data-ttu-id="9f02b-134">指定類別、介面或整個型別程式庫的全域唯一識別碼 (GUID)。</span><span class="sxs-lookup"><span data-stu-id="9f02b-134">Specifies the globally unique identifier (GUID) of a class, interface, or an entire type library.</span></span> <span data-ttu-id="9f02b-135">傳遞給屬性的字串必須是類型 **System.Guid** 可接受的建構函式引數的格式。</span><span class="sxs-lookup"><span data-stu-id="9f02b-135">The string passed to the attribute must be a format that is an acceptable constructor argument for the type **System.Guid**.</span></span><br /><br /> <span data-ttu-id="9f02b-136">COM Interop 工具可以套用這個屬性。</span><span class="sxs-lookup"><span data-stu-id="9f02b-136">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.IDispatchImplAttribute>|<span data-ttu-id="9f02b-137">表示在公開雙重介面 (Dual Interface) 和分配介面 (Dispinterface) 給 COM 時，通用語言執行平台所使用的 **IDispatch** 介面實作。</span><span class="sxs-lookup"><span data-stu-id="9f02b-137">Indicates which **IDispatch** interface implementation the common language runtime uses when exposing dual interfaces and dispinterfaces to COM.</span></span>|  
|<xref:System.Runtime.InteropServices.InAttribute>|<span data-ttu-id="9f02b-138">表示資料應封送處理至呼叫端。</span><span class="sxs-lookup"><span data-stu-id="9f02b-138">Indicates that data should be marshaled in to the caller.</span></span> <span data-ttu-id="9f02b-139">可用於屬性參數。</span><span class="sxs-lookup"><span data-stu-id="9f02b-139">Can be used to attribute parameters.</span></span>|  
|<xref:System.Runtime.InteropServices.InterfaceTypeAttribute>|<span data-ttu-id="9f02b-140">控制 Managed 介面如何公開給 COM 用戶端 (僅適用於 Dual、IUnknown-derived 或 IDispatch)。</span><span class="sxs-lookup"><span data-stu-id="9f02b-140">Controls how a managed interface is exposed to COM clients (Dual, IUnknown-derived, or IDispatch only).</span></span><br /><br /> <span data-ttu-id="9f02b-141">COM Interop 工具可以套用這個屬性。</span><span class="sxs-lookup"><span data-stu-id="9f02b-141">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.LCIDConversionAttribute>|<span data-ttu-id="9f02b-142">表示 Unmanaged 方法簽章預期有 LCID 參數。</span><span class="sxs-lookup"><span data-stu-id="9f02b-142">Indicates that an unmanaged method signature expects an LCID parameter.</span></span><br /><br /> <span data-ttu-id="9f02b-143">COM Interop 工具可以套用這個屬性。</span><span class="sxs-lookup"><span data-stu-id="9f02b-143">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.MarshalAsAttribute>|<span data-ttu-id="9f02b-144">表示欄位或參數中的資料在 Managed 和 Unmanaged 程式碼之間應如何封送處理。</span><span class="sxs-lookup"><span data-stu-id="9f02b-144">Indicates how the data in fields or parameters should be marshaled between managed and unmanaged code.</span></span> <span data-ttu-id="9f02b-145">這個屬性一律為選擇性屬性，因為每種資料類型都有預設的封送處理行為。</span><span class="sxs-lookup"><span data-stu-id="9f02b-145">The attribute is always optional because each data type has default marshaling behavior.</span></span><br /><br /> <span data-ttu-id="9f02b-146">COM Interop 工具可以套用這個屬性。</span><span class="sxs-lookup"><span data-stu-id="9f02b-146">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.OptionalAttribute>|<span data-ttu-id="9f02b-147">表示參數為選擇性。</span><span class="sxs-lookup"><span data-stu-id="9f02b-147">Indicates that a parameter is optional.</span></span><br /><br /> <span data-ttu-id="9f02b-148">COM Interop 工具可以套用這個屬性。</span><span class="sxs-lookup"><span data-stu-id="9f02b-148">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.OutAttribute>|<span data-ttu-id="9f02b-149">表示欄位或參數中的資料必須從呼叫的物件封送處理回其呼叫端。</span><span class="sxs-lookup"><span data-stu-id="9f02b-149">Indicates that the data in a field or parameter must be marshaled from a called object back to its caller.</span></span>|  
|<xref:System.Runtime.InteropServices.PreserveSigAttribute>|<span data-ttu-id="9f02b-150">抑制通常發生於互通呼叫期間的 HRESULT 或 Retval 簽章轉換。</span><span class="sxs-lookup"><span data-stu-id="9f02b-150">Suppresses the HRESULT or retval signature transformation that normally takes place during interoperation calls.</span></span> <span data-ttu-id="9f02b-151">這個屬性會影響封送處理以及型別程式庫匯出。</span><span class="sxs-lookup"><span data-stu-id="9f02b-151">The attribute affects marshaling as well as type library exporting.</span></span><br /><br /> <span data-ttu-id="9f02b-152">COM Interop 工具可以套用這個屬性。</span><span class="sxs-lookup"><span data-stu-id="9f02b-152">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.ProgIdAttribute>|<span data-ttu-id="9f02b-153">指定 .NET 類別的 ProgID。</span><span class="sxs-lookup"><span data-stu-id="9f02b-153">Specifies the ProgID of a .NET class.</span></span> <span data-ttu-id="9f02b-154">可用於屬性類別。</span><span class="sxs-lookup"><span data-stu-id="9f02b-154">Can be used to attribute classes.</span></span>|  
|<xref:System.Runtime.InteropServices.StructLayoutAttribute>|<span data-ttu-id="9f02b-155">控制類別欄位的實體配置。</span><span class="sxs-lookup"><span data-stu-id="9f02b-155">Controls the physical layout of the fields of a class.</span></span><br /><br /> <span data-ttu-id="9f02b-156">COM Interop 工具可以套用這個屬性。</span><span class="sxs-lookup"><span data-stu-id="9f02b-156">COM interop tools can apply this attribute.</span></span>|  
  
## <a name="conversion-tool-attributes"></a><span data-ttu-id="9f02b-157">轉換工具屬性</span><span class="sxs-lookup"><span data-stu-id="9f02b-157">Conversion-Tool Attributes</span></span>  

 <span data-ttu-id="9f02b-158">下表描述 COM Interop 工具在轉換處理期間套用的屬性。</span><span class="sxs-lookup"><span data-stu-id="9f02b-158">The following table describes attributes that COM interop tools apply during the conversion process.</span></span> <span data-ttu-id="9f02b-159">您不會在設計階段套用這些屬性。</span><span class="sxs-lookup"><span data-stu-id="9f02b-159">You do not apply these attributes at design time.</span></span>  
  
|<span data-ttu-id="9f02b-160">屬性</span><span class="sxs-lookup"><span data-stu-id="9f02b-160">Attribute</span></span>|<span data-ttu-id="9f02b-161">描述</span><span class="sxs-lookup"><span data-stu-id="9f02b-161">Description</span></span>|  
|---------------|-----------------|  
|<xref:System.Runtime.InteropServices.ComAliasNameAttribute>|<span data-ttu-id="9f02b-162">表示參數或欄位類型的 COM 別名。</span><span class="sxs-lookup"><span data-stu-id="9f02b-162">Indicates the COM alias for a parameter or field type.</span></span> <span data-ttu-id="9f02b-163">可用於屬性參數、欄位或傳回值。</span><span class="sxs-lookup"><span data-stu-id="9f02b-163">Can be used to attribute parameters, fields, or return values.</span></span>|  
|<xref:System.Runtime.InteropServices.ComConversionLossAttribute>|<span data-ttu-id="9f02b-164">表示類別或介面的相關資訊在從型別程式庫匯入組件時遺失。</span><span class="sxs-lookup"><span data-stu-id="9f02b-164">Indicates that information about a class or interface was lost when it was imported from a type library to an assembly.</span></span>|  
|<xref:System.Runtime.InteropServices.ComEventInterfaceAttribute>|<span data-ttu-id="9f02b-165">識別實作事件介面方法的來源介面和類別。</span><span class="sxs-lookup"><span data-stu-id="9f02b-165">Identifies the source interface and the class that implements the methods of the event interface.</span></span>|  
|<xref:System.Runtime.InteropServices.ImportedFromTypeLibAttribute>|<span data-ttu-id="9f02b-166">表示這個組件原來是從 COM 類型程式庫匯入的。</span><span class="sxs-lookup"><span data-stu-id="9f02b-166">Indicates that the assembly was originally imported from a COM type library.</span></span> <span data-ttu-id="9f02b-167">這個屬性含有原來型別程式庫的型別程式庫定義。</span><span class="sxs-lookup"><span data-stu-id="9f02b-167">This attribute contains the type library definition of the original type library.</span></span>|  
|<xref:System.Runtime.InteropServices.TypeLibFuncAttribute>|<span data-ttu-id="9f02b-168">含有原來針對這個函式從 COM 類型程式庫匯入的 **FUNCFLAGS**。</span><span class="sxs-lookup"><span data-stu-id="9f02b-168">Contains the **FUNCFLAGS** that were originally imported for this function from the COM type library.</span></span>|  
|<xref:System.Runtime.InteropServices.TypeLibTypeAttribute>|<span data-ttu-id="9f02b-169">含有原來針對這個類型從 COM 型別程式庫匯入的 **TYPEFLAGS**。</span><span class="sxs-lookup"><span data-stu-id="9f02b-169">Contains the **TYPEFLAGS** that were originally imported for this type from the COM type library.</span></span>|  
|<xref:System.Runtime.InteropServices.TypeLibVarAttribute>|<span data-ttu-id="9f02b-170">含有原來針對這個變數從 COM 類型程式庫匯入的 **VARFLAGS**。</span><span class="sxs-lookup"><span data-stu-id="9f02b-170">Contains the **VARFLAGS** that were originally imported for this variable from the COM type library.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="9f02b-171">另請參閱</span><span class="sxs-lookup"><span data-stu-id="9f02b-171">See also</span></span>

- <xref:System.Runtime.InteropServices>
- [<span data-ttu-id="9f02b-172">將 .NET Framework 元件公開給 COM</span><span class="sxs-lookup"><span data-stu-id="9f02b-172">Exposing .NET Framework Components to COM</span></span>](../../framework/interop/exposing-dotnet-components-to-com.md)
- [<span data-ttu-id="9f02b-173">屬性</span><span class="sxs-lookup"><span data-stu-id="9f02b-173">Attributes</span></span>](../attributes/index.md)
- [<span data-ttu-id="9f02b-174">限定交互操作的 .NET 類型</span><span class="sxs-lookup"><span data-stu-id="9f02b-174">Qualifying .NET Types for Interoperation</span></span>](qualify-net-types-for-interoperation.md)
- [<span data-ttu-id="9f02b-175">封裝 COM 的 .NET Framework 組件</span><span class="sxs-lookup"><span data-stu-id="9f02b-175">Packaging a .NET Framework Assembly for COM</span></span>](../../framework/interop/packaging-an-assembly-for-com.md)

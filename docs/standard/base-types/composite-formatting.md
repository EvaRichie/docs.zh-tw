---
title: 複合格式
description: 深入瞭解 .NET 複合格式，其採用物件清單和複合格式字串（包含具有索引預留位置的固定文字）作為輸入。
ms.date: 10/26/2018
ms.topic: conceptual
dev_langs:
- csharp
- vb
helpviewer_keywords:
- parameter specifiers
- strings [.NET], alignment
- format specifiers, composite formatting
- strings [.NET], composite
- composite formatting
- objects [.NET], formatting multiple objects
ms.assetid: 87b7d528-73f6-43c6-b71a-f23043039a49
ms.openlocfilehash: 3c5c1233ebdfc3ad624b2e4f2a8231969657eef1
ms.sourcegitcommit: 4313614f57690f9a5119a37314f0a1fd738ebda2
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/22/2021
ms.locfileid: "98693042"
---
# <a name="composite-formatting"></a><span data-ttu-id="5711e-103">複合格式</span><span class="sxs-lookup"><span data-stu-id="5711e-103">Composite formatting</span></span>

<span data-ttu-id="5711e-104">.NET 複合格式功能會採用物件清單和複合格式字串作為輸入。</span><span class="sxs-lookup"><span data-stu-id="5711e-104">The .NET composite formatting feature takes a list of objects and a composite format string as input.</span></span> <span data-ttu-id="5711e-105">複合格式字串是由混合索引替代符號 (Placeholder) 的固定文字所組成 (這些符號稱為對應至清單內物件的格式項目)。</span><span class="sxs-lookup"><span data-stu-id="5711e-105">A composite format string consists of fixed text intermixed with indexed placeholders, called format items, that correspond to the objects in the list.</span></span> <span data-ttu-id="5711e-106">格式作業產生的結果字串是由原始固定文字所組成，這些固定文字混合了清單中代表物件的字串。</span><span class="sxs-lookup"><span data-stu-id="5711e-106">The formatting operation yields a result string that consists of the original fixed text intermixed with the string representation of the objects in the list.</span></span>  
  
> [!IMPORTANT]
> <span data-ttu-id="5711e-107">如果您使用的語言和語言版本支援，您可以使用「內插字串」，而不使用複合格式字串。</span><span class="sxs-lookup"><span data-stu-id="5711e-107">Instead of using composite format strings, you can use *interpolated strings* if the language and language version that you're using support them.</span></span> <span data-ttu-id="5711e-108">內插字串是包含「插入運算式」的字串。</span><span class="sxs-lookup"><span data-stu-id="5711e-108">An interpolated string is a string that contains *interpolated expressions*.</span></span> <span data-ttu-id="5711e-109">每個插值的運算式會以運算式的值解析，且在字串指派時，包含在結果字串中。</span><span class="sxs-lookup"><span data-stu-id="5711e-109">Each interpolated expression is resolved with the expression's value and included in the result string when the string is assigned.</span></span> <span data-ttu-id="5711e-110">如需詳細資訊，請參閱[ (c # 參考中的字串插補) 和插入](../../csharp/language-reference/tokens/interpolated.md)[字串 (Visual Basic 參考) ](../../visual-basic/programming-guide/language-features/strings/interpolated-strings.md)。</span><span class="sxs-lookup"><span data-stu-id="5711e-110">For more information, see [String interpolation (C# Reference)](../../csharp/language-reference/tokens/interpolated.md) and [Interpolated strings (Visual Basic Reference)](../../visual-basic/programming-guide/language-features/strings/interpolated-strings.md).</span></span>

<span data-ttu-id="5711e-111">下列方法支援複合格式功能：</span><span class="sxs-lookup"><span data-stu-id="5711e-111">The composite formatting feature is supported by methods such as the following:</span></span>  
  
- <span data-ttu-id="5711e-112"><xref:System.String.Format%2A?displayProperty=nameWithType>，傳回格式化的結果字串。</span><span class="sxs-lookup"><span data-stu-id="5711e-112"><xref:System.String.Format%2A?displayProperty=nameWithType>, which returns a formatted result string.</span></span>  
  
- <span data-ttu-id="5711e-113"><xref:System.Text.StringBuilder.AppendFormat%2A?displayProperty=nameWithType>，將格式化的結果字串附加至 <xref:System.Text.StringBuilder> 物件。</span><span class="sxs-lookup"><span data-stu-id="5711e-113"><xref:System.Text.StringBuilder.AppendFormat%2A?displayProperty=nameWithType>, which appends a formatted result string to a <xref:System.Text.StringBuilder> object.</span></span>
- <span data-ttu-id="5711e-114"><xref:System.Console.WriteLine%2A?displayProperty=nameWithType> 方法的部分多載，對主控台顯示格式化的結果字串。</span><span class="sxs-lookup"><span data-stu-id="5711e-114">Some overloads of the <xref:System.Console.WriteLine%2A?displayProperty=nameWithType> method, which display a formatted result string to the console.</span></span>  
  
- <span data-ttu-id="5711e-115"><xref:System.IO.TextWriter.WriteLine%2A?displayProperty=nameWithType> 方法的部分多載，將格式化的結果字串寫入至資料流或檔案。</span><span class="sxs-lookup"><span data-stu-id="5711e-115">Some overloads of the <xref:System.IO.TextWriter.WriteLine%2A?displayProperty=nameWithType> method, which write the formatted result string to a stream or file.</span></span> <span data-ttu-id="5711e-116">衍生自 <xref:System.IO.TextWriter> 的類別，例如 <xref:System.IO.StreamWriter> 和 <xref:System.Web.UI.HtmlTextWriter>，也會共用這項功能。</span><span class="sxs-lookup"><span data-stu-id="5711e-116">The classes derived from <xref:System.IO.TextWriter>, such as <xref:System.IO.StreamWriter> and <xref:System.Web.UI.HtmlTextWriter>, also share this functionality.</span></span>  
  
- <span data-ttu-id="5711e-117"><xref:System.Diagnostics.Debug.WriteLine%28System.String%2CSystem.Object%5B%5D%29?displayProperty=nameWithType>，將格式化的訊息輸出至追蹤接聽項。</span><span class="sxs-lookup"><span data-stu-id="5711e-117"><xref:System.Diagnostics.Debug.WriteLine%28System.String%2CSystem.Object%5B%5D%29?displayProperty=nameWithType>, which outputs a formatted message to trace listeners.</span></span>  
  
- <span data-ttu-id="5711e-118"><xref:System.Diagnostics.Trace.TraceError%28System.String%2CSystem.Object%5B%5D%29?displayProperty=nameWithType>、<xref:System.Diagnostics.Trace.TraceInformation%28System.String%2CSystem.Object%5B%5D%29?displayProperty=nameWithType> 和 <xref:System.Diagnostics.Trace.TraceWarning%28System.String%2CSystem.Object%5B%5D%29?displayProperty=nameWithType> 方法，將格式化的訊息輸出至追蹤接聽項。</span><span class="sxs-lookup"><span data-stu-id="5711e-118">The <xref:System.Diagnostics.Trace.TraceError%28System.String%2CSystem.Object%5B%5D%29?displayProperty=nameWithType>, <xref:System.Diagnostics.Trace.TraceInformation%28System.String%2CSystem.Object%5B%5D%29?displayProperty=nameWithType>, and <xref:System.Diagnostics.Trace.TraceWarning%28System.String%2CSystem.Object%5B%5D%29?displayProperty=nameWithType> methods, which output formatted messages to trace listeners.</span></span>  
  
- <span data-ttu-id="5711e-119"><xref:System.Diagnostics.TraceSource.TraceInformation%28System.String%2CSystem.Object%5B%5D%29?displayProperty=nameWithType> 方法，將告知性方法寫入至追蹤接聽項。</span><span class="sxs-lookup"><span data-stu-id="5711e-119">The <xref:System.Diagnostics.TraceSource.TraceInformation%28System.String%2CSystem.Object%5B%5D%29?displayProperty=nameWithType> method, which writes an informational method to trace listeners.</span></span>  
  
## <a name="composite-format-string"></a><span data-ttu-id="5711e-120">複合格式字串</span><span class="sxs-lookup"><span data-stu-id="5711e-120">Composite Format String</span></span>  

 <span data-ttu-id="5711e-121">複合格式字串和物件清單會當做支援複合格式功能之方法的引數來使用。</span><span class="sxs-lookup"><span data-stu-id="5711e-121">A composite format string and object list are used as arguments of methods that support the composite formatting feature.</span></span> <span data-ttu-id="5711e-122">複合格式字串是由零個或更多段與一個或多個格式項目混合的固定文字所組成，</span><span class="sxs-lookup"><span data-stu-id="5711e-122">A composite format string consists of zero or more runs of fixed text intermixed with one or more format items.</span></span> <span data-ttu-id="5711e-123">固定文字是您選擇的任何文字，而每個格式項目都會對應到清單內的一個物件或 boxed 結構。</span><span class="sxs-lookup"><span data-stu-id="5711e-123">The fixed text is any string that you choose, and each format item corresponds to an object or boxed structure in the list.</span></span> <span data-ttu-id="5711e-124">複合格式功能將會傳回新的結果字串，其中每一個格式項目都會由清單內對應物件的字串表示來取代。</span><span class="sxs-lookup"><span data-stu-id="5711e-124">The composite formatting feature returns a new result string where each format item is replaced by the string representation of the corresponding object in the list.</span></span>  
  
 <span data-ttu-id="5711e-125">請考量下列 <xref:System.String.Format%2A> 程式碼片段。</span><span class="sxs-lookup"><span data-stu-id="5711e-125">Consider the following <xref:System.String.Format%2A> code fragment.</span></span>  
  
 [!code-csharp[Formatting.Composite#1](../../../samples/snippets/csharp/VS_Snippets_CLR/Formatting.Composite/cs/Composite1.cs#1)]
 [!code-vb[Formatting.Composite#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR/Formatting.Composite/vb/Composite1.vb#1)]  
  
 <span data-ttu-id="5711e-126">固定文字是 "`Name =`" 和 "`, hours =`"。</span><span class="sxs-lookup"><span data-stu-id="5711e-126">The fixed text is "`Name =` " and "`, hours =` ".</span></span> <span data-ttu-id="5711e-127">格式項目為 "`{0}`" (其索引為 0，且對應至物件 `name`) 及 "`{1:hh}`" (其索引為 1，且對應至物件 `DateTime.Now`)。</span><span class="sxs-lookup"><span data-stu-id="5711e-127">The format items are "`{0}`", whose index is 0, which corresponds to the object `name`, and "`{1:hh}`", whose index is 1, which corresponds to the object `DateTime.Now`.</span></span>  
  
## <a name="format-item-syntax"></a><span data-ttu-id="5711e-128">格式項目語法</span><span class="sxs-lookup"><span data-stu-id="5711e-128">Format Item Syntax</span></span>  

 <span data-ttu-id="5711e-129">每個格式項目都會使用下列格式，並由下列元件所組成：</span><span class="sxs-lookup"><span data-stu-id="5711e-129">Each format item takes the following form and consists of the following components:</span></span>  
  
 <span data-ttu-id="5711e-130">`{`*索引*[ `,` *對齊*] [ `:` *格式字串*]`}`</span><span class="sxs-lookup"><span data-stu-id="5711e-130">`{` *index*[`,`*alignment*][`:`*formatString*]`}`</span></span>  
  
 <span data-ttu-id="5711e-131">成對的大括號 ("{" 和 "}") 是必要的。</span><span class="sxs-lookup"><span data-stu-id="5711e-131">The matching braces ("{" and "}") are required.</span></span>  
  
### <a name="index-component"></a><span data-ttu-id="5711e-132">索引元件</span><span class="sxs-lookup"><span data-stu-id="5711e-132">Index Component</span></span>  

 <span data-ttu-id="5711e-133">強制的 *index* 元件 (也稱為參數規範) 是用以識別物件清單中對應項目的數字 (從 0 開始)。</span><span class="sxs-lookup"><span data-stu-id="5711e-133">The mandatory *index* component, also called a parameter specifier, is a number starting from 0 that identifies a corresponding item in the list of objects.</span></span> <span data-ttu-id="5711e-134">也就是說，參數規範為 0 的格式項目會格式化清單中的第一個物件，而參數規範為 1 的格式項目會格式化清單中的第二個物件，依此類推。</span><span class="sxs-lookup"><span data-stu-id="5711e-134">That is, the format item whose parameter specifier is 0 formats the first object in the list, the format item whose parameter specifier is 1 formats the second object in the list, and so on.</span></span> <span data-ttu-id="5711e-135">下列範例包含四個參數規範 (編號為 0 到 3)，以表示小於 10 的質數：</span><span class="sxs-lookup"><span data-stu-id="5711e-135">The following example includes four parameter specifiers, numbered zero through three,  to represent prime numbers less than ten:</span></span>  
  
 [!code-csharp[Formatting.Composite#7](../../../samples/snippets/csharp/VS_Snippets_CLR/Formatting.Composite/cs/index1.cs#7)]
 [!code-vb[Formatting.Composite#7](../../../samples/snippets/visualbasic/VS_Snippets_CLR/Formatting.Composite/vb/index1.vb#7)]  
  
 <span data-ttu-id="5711e-136">多個格式項目可以藉由指定相同參數規範來參考物件清單中的相同項目。</span><span class="sxs-lookup"><span data-stu-id="5711e-136">Multiple format items can refer to the same element in the list of objects by specifying the same parameter specifier.</span></span> <span data-ttu-id="5711e-137">例如，您可以指定複合格式字串（例如： "0x"）來格式化十六進位、科學和數位格式的相同數值 {0:X} {0:E} {0:N} ，如下列範例所示。</span><span class="sxs-lookup"><span data-stu-id="5711e-137">For example, you can format the same numeric value in hexadecimal, scientific, and number format by specifying a composite format string such as : "0x{0:X} {0:E} {0:N}", as the following example shows.</span></span>  
  
 [!code-csharp[Formatting.Composite#10](../../../samples/snippets/csharp/VS_Snippets_CLR/Formatting.Composite/cs/index1.cs#10)]
 [!code-vb[Formatting.Composite#10](../../../samples/snippets/visualbasic/VS_Snippets_CLR/Formatting.Composite/vb/index1.vb#10)]  
  
 <span data-ttu-id="5711e-138">每個格式項目皆可參考清單內的任何物件。</span><span class="sxs-lookup"><span data-stu-id="5711e-138">Each format item can refer to any object in the list.</span></span> <span data-ttu-id="5711e-139">例如，如果有三個物件，您可以指定複合格式字串（如下所示）來格式化第二個、第一個和第三個物件： " {1} {0} {2} "。</span><span class="sxs-lookup"><span data-stu-id="5711e-139">For example, if there are three objects, you can format the second, first, and third object by specifying a composite format string like this: "{1} {0} {2}".</span></span> <span data-ttu-id="5711e-140">不是格式項目所參考的物件會被忽略。</span><span class="sxs-lookup"><span data-stu-id="5711e-140">An object that is not referenced by a format item is ignored.</span></span> <span data-ttu-id="5711e-141"><xref:System.FormatException>如果參數規範指定超出物件清單範圍的專案，則會在執行時間擲回。</span><span class="sxs-lookup"><span data-stu-id="5711e-141">A <xref:System.FormatException> is thrown at run time if a parameter specifier designates an item outside the bounds of the list of objects.</span></span>  
  
### <a name="alignment-component"></a><span data-ttu-id="5711e-142">對齊元件</span><span class="sxs-lookup"><span data-stu-id="5711e-142">Alignment Component</span></span>  

 <span data-ttu-id="5711e-143">選擇性 *alignment* 元件為帶正負號的整數，表示慣用的格式化欄位寬度。</span><span class="sxs-lookup"><span data-stu-id="5711e-143">The optional *alignment* component is a signed integer indicating the preferred formatted field width.</span></span> <span data-ttu-id="5711e-144">如果 *alignment* 的值小於格式化字串的長度，則會忽略 *alignment* 並使用格式化字串的長度當做欄位寬度。</span><span class="sxs-lookup"><span data-stu-id="5711e-144">If the value of *alignment* is less than the length of the formatted string, *alignment* is ignored and the length of the formatted string is used as the field width.</span></span> <span data-ttu-id="5711e-145">如果 *alignment* 為正數，欄位中的格式化資料會靠右對齊；如果 *alignment* 為負數，則會靠左對齊。</span><span class="sxs-lookup"><span data-stu-id="5711e-145">The formatted data in the field is right-aligned if *alignment* is positive and left-aligned if *alignment* is negative.</span></span> <span data-ttu-id="5711e-146">如果填補有必要，則會使用泛空白字元 (White Space)。</span><span class="sxs-lookup"><span data-stu-id="5711e-146">If padding is necessary, white space is used.</span></span> <span data-ttu-id="5711e-147">如果指定了 *alignment*，則需要逗號。</span><span class="sxs-lookup"><span data-stu-id="5711e-147">The comma is required if *alignment*  is specified.</span></span>  
  
 <span data-ttu-id="5711e-148">下列範例會定義兩個陣列，一個包含員工的名稱，另一個包含他們在兩週內的工作時數。</span><span class="sxs-lookup"><span data-stu-id="5711e-148">The following example defines two arrays, one containing the names of employees and the other containing the hours they worked over a two-week period.</span></span> <span data-ttu-id="5711e-149">複合格式字串會在 20 個字元的欄位中，將名稱靠左對齊，並且在 5 個字元的欄位中，將其工作時數靠右對齊。</span><span class="sxs-lookup"><span data-stu-id="5711e-149">The composite format string left-aligns the names in a 20-character field, and right-aligns their hours in a 5-character field.</span></span> <span data-ttu-id="5711e-150">請注意，"N1" 標準格式字串也會用來格式化具有一個小數位數的時數。</span><span class="sxs-lookup"><span data-stu-id="5711e-150">Note that the "N1" standard format string is also used to format the hours with one fractional digit.</span></span>  
  
 [!code-csharp[Formatting.Composite#8](../../../samples/snippets/csharp/VS_Snippets_CLR/Formatting.Composite/cs/alignment1.cs#8)]
 [!code-vb[Formatting.Composite#8](../../../samples/snippets/visualbasic/VS_Snippets_CLR/Formatting.Composite/vb/alignment1.vb#8)]  
  
### <a name="format-string-component"></a><span data-ttu-id="5711e-151">格式字串元件</span><span class="sxs-lookup"><span data-stu-id="5711e-151">Format String Component</span></span>  

 <span data-ttu-id="5711e-152">選擇性 *formatString* 元件是一個格式字串，適用於將格式化的物件類型。</span><span class="sxs-lookup"><span data-stu-id="5711e-152">The optional *formatString* component is a format string that is appropriate for the type of object being formatted.</span></span> <span data-ttu-id="5711e-153">如果對應的物件為數值，指定標準或自訂的數值格式字串；如果對應的物件為 <xref:System.DateTime> 物件，指定標準或自訂的日期和時間格式字串；或者，如果對應的物件為列舉值，指定[列舉格式字串](enumeration-format-strings.md)。</span><span class="sxs-lookup"><span data-stu-id="5711e-153">Specify a standard or custom numeric format string if the corresponding object is a numeric value, a standard or custom date and time format string if the corresponding object is a <xref:System.DateTime> object, or an [enumeration format string](enumeration-format-strings.md) if the corresponding object is an enumeration value.</span></span> <span data-ttu-id="5711e-154">如果未指定 *formatString*，則會使用數值、日期和時間或列舉類型的一般 ("G") 格式規範。</span><span class="sxs-lookup"><span data-stu-id="5711e-154">If *formatString* is not specified, the general ("G") format specifier for a numeric, date and time, or enumeration type is used.</span></span> <span data-ttu-id="5711e-155">如果指定 *formatString*，則需要冒號。</span><span class="sxs-lookup"><span data-stu-id="5711e-155">The colon is required if *formatString* is specified.</span></span>  
  
 <span data-ttu-id="5711e-156">下表列出 .NET 類別庫中支援一組預先定義格式字串的類型或類別類型，並提供列出所支援格式字串之主題的連結。</span><span class="sxs-lookup"><span data-stu-id="5711e-156">The following table lists types or categories of types in the .NET class library that support a predefined set of format strings, and provides links to the topics that list the supported format strings.</span></span> <span data-ttu-id="5711e-157">請注意，字串格式是一種可延伸機制，可讓為所有現有類型定義新的格式字串，以及定義一組應用程式定義類型所支援的格式字串。</span><span class="sxs-lookup"><span data-stu-id="5711e-157">Note that string formatting is an extensible mechanism that makes it possible to define new format strings for all existing types as well as to define a set of format strings supported by an application-defined type.</span></span> <span data-ttu-id="5711e-158">如需詳細資訊，請參閱 <xref:System.IFormattable> 和 <xref:System.ICustomFormatter> 介面主題。</span><span class="sxs-lookup"><span data-stu-id="5711e-158">For more information, see the <xref:System.IFormattable> and <xref:System.ICustomFormatter> interface topics.</span></span>  
  
|<span data-ttu-id="5711e-159">類型或類型分類</span><span class="sxs-lookup"><span data-stu-id="5711e-159">Type or type category</span></span>|<span data-ttu-id="5711e-160">請參閱</span><span class="sxs-lookup"><span data-stu-id="5711e-160">See</span></span>|  
|---------------------------|---------|  
|<span data-ttu-id="5711e-161">日期和時間類型 (<xref:System.DateTime>、<xref:System.DateTimeOffset>)</span><span class="sxs-lookup"><span data-stu-id="5711e-161">Date and time types (<xref:System.DateTime>, <xref:System.DateTimeOffset>)</span></span>|[<span data-ttu-id="5711e-162">標準日期和時間格式字串</span><span class="sxs-lookup"><span data-stu-id="5711e-162">Standard Date and Time Format Strings</span></span>](standard-date-and-time-format-strings.md)<br /><br /> [<span data-ttu-id="5711e-163">自訂日期和時間格式字串</span><span class="sxs-lookup"><span data-stu-id="5711e-163">Custom Date and Time Format Strings</span></span>](custom-date-and-time-format-strings.md)|  
|<span data-ttu-id="5711e-164">列舉類型 (衍生自 <xref:System.Enum?displayProperty=nameWithType> 的所有類型)</span><span class="sxs-lookup"><span data-stu-id="5711e-164">Enumeration types (all types derived from <xref:System.Enum?displayProperty=nameWithType>)</span></span>|[<span data-ttu-id="5711e-165">列舉格式字串</span><span class="sxs-lookup"><span data-stu-id="5711e-165">Enumeration Format Strings</span></span>](enumeration-format-strings.md)|  
|<span data-ttu-id="5711e-166">數字類型 (<xref:System.Numerics.BigInteger>、<xref:System.Byte>、<xref:System.Decimal>、<xref:System.Double>、<xref:System.Int16>、<xref:System.Int32>、<xref:System.Int64>、<xref:System.SByte>、<xref:System.Single>、<xref:System.UInt16>、<xref:System.UInt32>、<xref:System.UInt64>)</span><span class="sxs-lookup"><span data-stu-id="5711e-166">Numeric types (<xref:System.Numerics.BigInteger>, <xref:System.Byte>, <xref:System.Decimal>, <xref:System.Double>, <xref:System.Int16>, <xref:System.Int32>, <xref:System.Int64>, <xref:System.SByte>, <xref:System.Single>, <xref:System.UInt16>, <xref:System.UInt32>, <xref:System.UInt64>)</span></span>|<span data-ttu-id="5711e-167">[標準數值格式字串](standard-numeric-format-strings.md) \(部分機器翻譯\)</span><span class="sxs-lookup"><span data-stu-id="5711e-167">[Standard Numeric Format Strings](standard-numeric-format-strings.md)</span></span><br /><br /> [<span data-ttu-id="5711e-168">自訂數值格式字串</span><span class="sxs-lookup"><span data-stu-id="5711e-168">Custom Numeric Format Strings</span></span>](custom-numeric-format-strings.md)|  
|<xref:System.Guid>|<xref:System.Guid.ToString%28System.String%29?displayProperty=nameWithType>|  
|<xref:System.TimeSpan>|[<span data-ttu-id="5711e-169">標準 TimeSpan 格式字串</span><span class="sxs-lookup"><span data-stu-id="5711e-169">Standard TimeSpan Format Strings</span></span>](standard-timespan-format-strings.md)<br /><br /> [<span data-ttu-id="5711e-170">自訂 TimeSpan 格式字串</span><span class="sxs-lookup"><span data-stu-id="5711e-170">Custom TimeSpan Format Strings</span></span>](custom-timespan-format-strings.md)|  
  
### <a name="escaping-braces"></a><span data-ttu-id="5711e-171">逸出大括號</span><span class="sxs-lookup"><span data-stu-id="5711e-171">Escaping Braces</span></span>  

 <span data-ttu-id="5711e-172">左右大括號會被解譯成格式項目的開頭與結尾。</span><span class="sxs-lookup"><span data-stu-id="5711e-172">Opening and closing braces are interpreted as starting and ending a format item.</span></span> <span data-ttu-id="5711e-173">因此，您必須使用逸出序列 (Escape Sequence)，才能顯示字面上的左右大括號。</span><span class="sxs-lookup"><span data-stu-id="5711e-173">Consequently, you must use an escape sequence to display a literal opening brace or closing brace.</span></span> <span data-ttu-id="5711e-174">請在固定文字中指定兩個左邊的大括號 ("{{")，以顯示一個左邊的大括號 ("{")，或者指定兩個右邊的大括號 ("}}") 來顯示一個右邊的大括號 ("}")。</span><span class="sxs-lookup"><span data-stu-id="5711e-174">Specify two opening braces ("{{") in the fixed text to display one opening brace ("{"), or two closing braces ("}}") to display one closing brace ("}").</span></span> <span data-ttu-id="5711e-175">格式項目中的括號會以它們出現的順序依序解譯，</span><span class="sxs-lookup"><span data-stu-id="5711e-175">Braces in a format item are interpreted sequentially in the order they are encountered.</span></span> <span data-ttu-id="5711e-176">但是不支援解譯巢狀大括號。</span><span class="sxs-lookup"><span data-stu-id="5711e-176">Interpreting nested braces is not supported.</span></span>  
  
 <span data-ttu-id="5711e-177">解譯逸出括號的方式，可能會造成無法預期的結果。</span><span class="sxs-lookup"><span data-stu-id="5711e-177">The way escaped braces are interpreted can lead to unexpected results.</span></span> <span data-ttu-id="5711e-178">例如，格式項目 "{{{0:D}}}" 原本是要顯示一個左邊大括號、一個格式化為十進位的數值和一個右邊大括號。</span><span class="sxs-lookup"><span data-stu-id="5711e-178">For example, consider the format item "{{{0:D}}}", which is intended to display an opening brace, a numeric value formatted as a decimal number, and a closing brace.</span></span> <span data-ttu-id="5711e-179">然而，格式項目實際會以下列方式來解譯：</span><span class="sxs-lookup"><span data-stu-id="5711e-179">However, the format item is actually interpreted in the following manner:</span></span>  
  
1. <span data-ttu-id="5711e-180">前面兩個左邊大括號 ("{{") 逸出，產生一個左邊大括號。</span><span class="sxs-lookup"><span data-stu-id="5711e-180">The first two opening braces ("{{") are escaped and yield one opening brace.</span></span>  
  
2. <span data-ttu-id="5711e-181">接下來的三個字元 ("{0:") 會解譯成格式項目的開頭。</span><span class="sxs-lookup"><span data-stu-id="5711e-181">The next three characters ("{0:") are interpreted as the start of a format item.</span></span>  
  
3. <span data-ttu-id="5711e-182">再下一個字元 ("D") 可能解譯成十進位 (Decimal) 標準數值格式規範，但後面兩個逸出的右邊大括號 ("}}") 會產生一個大括號。</span><span class="sxs-lookup"><span data-stu-id="5711e-182">The next character ("D") would be interpreted as the Decimal standard numeric format specifier, but the next two escaped braces ("}}") yield a single brace.</span></span> <span data-ttu-id="5711e-183">由於結果字串 ("D}") 並非標準的數值格式規範，因此，結果字串會被解譯成自訂格式字串，表示會顯示成常值字串 "D}"。</span><span class="sxs-lookup"><span data-stu-id="5711e-183">Because the resulting string ("D}") is not a standard numeric format specifier, the resulting string is interpreted as a custom format string that means display the literal string "D}".</span></span>  
  
4. <span data-ttu-id="5711e-184">最後的大括號 ("}") 會被解譯成格式項目的結尾。</span><span class="sxs-lookup"><span data-stu-id="5711e-184">The last brace ("}") is interpreted as the end of the format item.</span></span>  
  
5. <span data-ttu-id="5711e-185">最後顯示的結果會是常值字串 "{D}"，</span><span class="sxs-lookup"><span data-stu-id="5711e-185">The final result that is displayed is the literal string, "{D}".</span></span> <span data-ttu-id="5711e-186">而要進行格式化的數值則不會顯示出來。</span><span class="sxs-lookup"><span data-stu-id="5711e-186">The numeric value that was to be formatted is not displayed.</span></span>  
  
 <span data-ttu-id="5711e-187">撰寫程式碼時，能夠避免錯誤解譯逸出大括號和格式項目的方法，就是個別地格式化大括號和格式項目。</span><span class="sxs-lookup"><span data-stu-id="5711e-187">One way to write your code to avoid misinterpreting escaped braces and format items is to format the braces and format item separately.</span></span> <span data-ttu-id="5711e-188">也就是說，在第一個格式化作業中顯示常值的左邊大括號，在下一個作業中顯示格式項目的結果，接著在最終作業中顯示常值的右邊大括號。</span><span class="sxs-lookup"><span data-stu-id="5711e-188">That is, in the first format operation display a literal opening brace, in the next operation display the result of the format item, then in the final operation display a literal closing brace.</span></span> <span data-ttu-id="5711e-189">下列範例將示範這個方法。</span><span class="sxs-lookup"><span data-stu-id="5711e-189">The following example illustrates this approach.</span></span>  
  
 [!code-csharp[Formatting.Composite#2](../../../samples/snippets/csharp/VS_Snippets_CLR/Formatting.Composite/cs/Escaping1.cs#2)]
 [!code-vb[Formatting.Composite#2](../../../samples/snippets/visualbasic/VS_Snippets_CLR/Formatting.Composite/vb/Escaping1.vb#2)]  
  
### <a name="processing-order"></a><span data-ttu-id="5711e-190">處理順序</span><span class="sxs-lookup"><span data-stu-id="5711e-190">Processing Order</span></span>  

 <span data-ttu-id="5711e-191">如果對複合格式方法的呼叫包含的 <xref:System.IFormatProvider> 引數其值不是 `null`，則執行階段會呼叫其 <xref:System.IFormatProvider.GetFormat%2A?displayProperty=nameWithType> 方法要求 <xref:System.ICustomFormatter> 實作。</span><span class="sxs-lookup"><span data-stu-id="5711e-191">If the call to the composite formatting method includes an <xref:System.IFormatProvider> argument whose value is not `null`, the runtime calls its <xref:System.IFormatProvider.GetFormat%2A?displayProperty=nameWithType> method to request an <xref:System.ICustomFormatter> implementation.</span></span> <span data-ttu-id="5711e-192">如果該方法能夠傳回 <xref:System.ICustomFormatter> 實作，它會快取長達複合格式方法的呼叫持續時間。</span><span class="sxs-lookup"><span data-stu-id="5711e-192">If the method is able to return an <xref:System.ICustomFormatter> implementation, it's cached for the duration of the call of the composite formatting method.</span></span>
  
 <span data-ttu-id="5711e-193">參數清單中每個對應於格式項目的值都會轉換為字串，如下所示：</span><span class="sxs-lookup"><span data-stu-id="5711e-193">Each value in the parameter list that corresponds to a format item is converted to a string as follows:</span></span>  
  
1. <span data-ttu-id="5711e-194">如果要格式化的值是 `null`，則會傳回空字串 <xref:System.String.Empty?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="5711e-194">If the value to be formatted is `null`, an empty string <xref:System.String.Empty?displayProperty=nameWithType> is returned.</span></span>  
  
2. <span data-ttu-id="5711e-195">如果可以使用 <xref:System.ICustomFormatter> 實作，則執行階段會呼叫其 <xref:System.ICustomFormatter.Format%2A> 方法。</span><span class="sxs-lookup"><span data-stu-id="5711e-195">If an <xref:System.ICustomFormatter> implementation is available, the runtime calls its <xref:System.ICustomFormatter.Format%2A> method.</span></span> <span data-ttu-id="5711e-196">它會將格式項目的 *formatString* 值 (如果有的話) 傳遞給方法；如果沒有，則會將 `null` 連同 <xref:System.IFormatProvider> 實作一起傳遞。</span><span class="sxs-lookup"><span data-stu-id="5711e-196">It passes the method the format item's *formatString* value, if one is present, or `null` if it's not, along with the <xref:System.IFormatProvider> implementation.</span></span> <span data-ttu-id="5711e-197">如果 <xref:System.ICustomFormatter.Format%2A?displayProperty=nameWithType> 方法呼叫傳回 `null`，則會繼續執行到下一個步驟；否則，會傳回 <xref:System.ICustomFormatter.Format%2A?displayProperty=nameWithType> 呼叫的結果。</span><span class="sxs-lookup"><span data-stu-id="5711e-197">If the call to the <xref:System.ICustomFormatter.Format%2A?displayProperty=nameWithType> method returns `null`, execution proceeds to the next step; otherwise, the result of the <xref:System.ICustomFormatter.Format%2A?displayProperty=nameWithType> call is returned.</span></span>
  
3. <span data-ttu-id="5711e-198">如果值實作 <xref:System.IFormattable> 介面，則會呼叫介面的 <xref:System.IFormattable.ToString%28System.String%2CSystem.IFormatProvider%29> 方法。</span><span class="sxs-lookup"><span data-stu-id="5711e-198">If the value implements the <xref:System.IFormattable> interface, the interface's <xref:System.IFormattable.ToString%28System.String%2CSystem.IFormatProvider%29> method is called.</span></span> <span data-ttu-id="5711e-199">如果格式項目中有 *formatString* 值的話，就會將該值傳遞給方法；如果沒有的話，則會傳遞 `null`。</span><span class="sxs-lookup"><span data-stu-id="5711e-199">The method is passed the *formatString* value, if one is present in the format item, or `null` if it's not.</span></span> <span data-ttu-id="5711e-200"><xref:System.IFormatProvider> 引數的判斷如下：</span><span class="sxs-lookup"><span data-stu-id="5711e-200">The <xref:System.IFormatProvider> argument is determined as follows:</span></span>  
  
    - <span data-ttu-id="5711e-201">對於數值，如果呼叫具有非 null <xref:System.IFormatProvider> 引數的複合格式方法，則執行階段會從其 <xref:System.Globalization.NumberFormatInfo> 方法要求 <xref:System.IFormatProvider.GetFormat%2A?displayProperty=nameWithType> 物件。</span><span class="sxs-lookup"><span data-stu-id="5711e-201">For a numeric value, if a composite formatting method with a non-null <xref:System.IFormatProvider> argument is called, the runtime requests a <xref:System.Globalization.NumberFormatInfo> object from its <xref:System.IFormatProvider.GetFormat%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="5711e-202">如果無法提供、如果引數的值為 `null`，或者如果複合格式方法沒有 <xref:System.IFormatProvider> 參數，則會使用目前執行緒文化特性的 <xref:System.Globalization.NumberFormatInfo> 物件。</span><span class="sxs-lookup"><span data-stu-id="5711e-202">If it's unable to supply one, if the value of the argument is `null`, or if the composite formatting method doesn't have an <xref:System.IFormatProvider> parameter, the <xref:System.Globalization.NumberFormatInfo> object for the current thread culture is used.</span></span>  
  
    - <span data-ttu-id="5711e-203">對於日期和時間值，如果呼叫具有非 null <xref:System.IFormatProvider> 引數的複合格式方法，則執行階段會從其 <xref:System.Globalization.DateTimeFormatInfo> 方法要求 <xref:System.IFormatProvider.GetFormat%2A?displayProperty=nameWithType> 物件。</span><span class="sxs-lookup"><span data-stu-id="5711e-203">For a date and time value, if a composite formatting method with a non-null <xref:System.IFormatProvider> argument is called, the runtime requests a <xref:System.Globalization.DateTimeFormatInfo> object from its <xref:System.IFormatProvider.GetFormat%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="5711e-204">如果無法提供、如果引數的值為 `null`，或者如果複合格式方法沒有 <xref:System.IFormatProvider> 參數，則會使用目前執行緒文化特性的 <xref:System.Globalization.DateTimeFormatInfo> 物件。</span><span class="sxs-lookup"><span data-stu-id="5711e-204">If it's unable to supply one, if the value of the argument is `null`, or if the composite formatting method doesn't have an <xref:System.IFormatProvider> parameter, the <xref:System.Globalization.DateTimeFormatInfo> object for the current thread culture is used.</span></span>  
  
    - <span data-ttu-id="5711e-205">對於其他類型的物件，如果呼叫複合格式時包含 <xref:System.IFormatProvider> 引數，它的值會直接傳遞至 <xref:System.IFormattable.ToString%2A?displayProperty=nameWithType> 實作。</span><span class="sxs-lookup"><span data-stu-id="5711e-205">For objects of other types, if a composite formatting method is called with an <xref:System.IFormatProvider> argument, its value is passed directly to the <xref:System.IFormattable.ToString%2A?displayProperty=nameWithType> implementation.</span></span> <span data-ttu-id="5711e-206">否則會傳遞 `null` 至 <xref:System.IFormattable.ToString%2A?displayProperty=nameWithType> 實作。</span><span class="sxs-lookup"><span data-stu-id="5711e-206">Otherwise, `null` is passed to the <xref:System.IFormattable.ToString%2A?displayProperty=nameWithType> implementation.</span></span>  
  
4. <span data-ttu-id="5711e-207">呼叫類型的無參數 `ToString` 方法，該方法會覆寫 <xref:System.Object.ToString?displayProperty=nameWithType> 或繼承其基底類別的行為。</span><span class="sxs-lookup"><span data-stu-id="5711e-207">The type's parameterless `ToString` method, which either overrides <xref:System.Object.ToString?displayProperty=nameWithType> or inherits the behavior of its base class, is called.</span></span> <span data-ttu-id="5711e-208">在這種情況下，會忽略 *formatString* 元件在格式項目中指定的格式字串 (如果有的話)。</span><span class="sxs-lookup"><span data-stu-id="5711e-208">In this case, the format string specified by the *formatString* component in the format item, if it's present, is ignored.</span></span>  
  
 <span data-ttu-id="5711e-209">對齊會在已經執行前面的步驟之後套用。</span><span class="sxs-lookup"><span data-stu-id="5711e-209">Alignment is applied after the preceding steps have been performed.</span></span>  
  
## <a name="code-examples"></a><span data-ttu-id="5711e-210">程式碼範例</span><span class="sxs-lookup"><span data-stu-id="5711e-210">Code Examples</span></span>  

 <span data-ttu-id="5711e-211">下列範例顯示一個使用複合格式建立的字串，以及另一個使用物件的 `ToString` 方法建立的字串。</span><span class="sxs-lookup"><span data-stu-id="5711e-211">The following example shows one string created using composite formatting and another created using an object's `ToString` method.</span></span> <span data-ttu-id="5711e-212">這兩個類型的格式化產生相等結果。</span><span class="sxs-lookup"><span data-stu-id="5711e-212">Both types of formatting produce equivalent results.</span></span>  
  
 [!code-csharp[Formatting.Composite#3](../../../samples/snippets/csharp/VS_Snippets_CLR/Formatting.Composite/cs/Composite1.cs#3)]
 [!code-vb[Formatting.Composite#3](../../../samples/snippets/visualbasic/VS_Snippets_CLR/Formatting.Composite/vb/Composite1.vb#3)]  
  
 <span data-ttu-id="5711e-213">假設目前日期是五月的星期四，前面範例中兩個字串的值在美國英文文化特性中都是 `Thursday May`。</span><span class="sxs-lookup"><span data-stu-id="5711e-213">Assuming that the current day is a Thursday in May, the value of both strings in the preceding example is `Thursday May` in the U.S. English culture.</span></span>  
  
 <span data-ttu-id="5711e-214"><xref:System.Console.WriteLine%2A?displayProperty=nameWithType> 會公開與 <xref:System.String.Format%2A?displayProperty=nameWithType> 相同的功能。</span><span class="sxs-lookup"><span data-stu-id="5711e-214"><xref:System.Console.WriteLine%2A?displayProperty=nameWithType> exposes the same functionality as <xref:System.String.Format%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="5711e-215">這兩種方法唯一的差別在於，<xref:System.String.Format%2A?displayProperty=nameWithType> 會以字串形式傳回結果，而 <xref:System.Console.WriteLine%2A?displayProperty=nameWithType> 則會將結果寫入至與 <xref:System.Console> 物件關聯的輸出資料流。</span><span class="sxs-lookup"><span data-stu-id="5711e-215">The only difference between the two methods is that <xref:System.String.Format%2A?displayProperty=nameWithType> returns its result as a string, while <xref:System.Console.WriteLine%2A?displayProperty=nameWithType> writes the result to the output stream associated with the <xref:System.Console> object.</span></span> <span data-ttu-id="5711e-216">下列範例使用 <xref:System.Console.WriteLine%2A?displayProperty=nameWithType> 方法，將 `MyInt` 的值格式化為貨幣值。</span><span class="sxs-lookup"><span data-stu-id="5711e-216">The following example uses the <xref:System.Console.WriteLine%2A?displayProperty=nameWithType> method to format the value of `MyInt` to a currency value.</span></span>  
  
 [!code-csharp[Formatting.Composite#4](../../../samples/snippets/csharp/VS_Snippets_CLR/Formatting.Composite/cs/Composite1.cs#4)]
 [!code-vb[Formatting.Composite#4](../../../samples/snippets/visualbasic/VS_Snippets_CLR/Formatting.Composite/vb/Composite1.vb#4)]  
  
 <span data-ttu-id="5711e-217">下列範例示範多個物件的格式化，其中包括使用兩種不同方式來格式化一個物件。</span><span class="sxs-lookup"><span data-stu-id="5711e-217">The following example demonstrates formatting multiple objects, including formatting one object two different ways.</span></span>  
  
 [!code-csharp[Formatting.Composite#5](../../../samples/snippets/csharp/VS_Snippets_CLR/Formatting.Composite/cs/Composite1.cs#5)]
 [!code-vb[Formatting.Composite#5](../../../samples/snippets/visualbasic/VS_Snippets_CLR/Formatting.Composite/vb/Composite1.vb#5)]  
  
 <span data-ttu-id="5711e-218">下列範例示範格式設定中的對齊用法。</span><span class="sxs-lookup"><span data-stu-id="5711e-218">The following example demonstrates the use of alignment in formatting.</span></span> <span data-ttu-id="5711e-219">格式化的引數會放在兩個垂直線 (&#124;) 字元之間以強調所產生的對齊。</span><span class="sxs-lookup"><span data-stu-id="5711e-219">The arguments that are formatted are placed between vertical bar characters (&#124;) to highlight the resulting alignment.</span></span>  
  
 [!code-csharp[Formatting.Composite#6](../../../samples/snippets/csharp/VS_Snippets_CLR/Formatting.Composite/cs/Composite1.cs#6)]
 [!code-vb[Formatting.Composite#6](../../../samples/snippets/visualbasic/VS_Snippets_CLR/Formatting.Composite/vb/Composite1.vb#6)]  
  
## <a name="see-also"></a><span data-ttu-id="5711e-220">另請參閱</span><span class="sxs-lookup"><span data-stu-id="5711e-220">See also</span></span>

- <xref:System.Console.WriteLine%2A>
- <xref:System.String.Format%2A?displayProperty=nameWithType>
- [<span data-ttu-id="5711e-221">字串內插補點 (C#)</span><span class="sxs-lookup"><span data-stu-id="5711e-221">String interpolation (C#)</span></span>](../../csharp/language-reference/tokens/interpolated.md)
- [<span data-ttu-id="5711e-222">字串內插補點 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="5711e-222">String interpolation (Visual Basic)</span></span>](../../visual-basic/programming-guide/language-features/strings/interpolated-strings.md)
- [<span data-ttu-id="5711e-223">格式化類型</span><span class="sxs-lookup"><span data-stu-id="5711e-223">Formatting Types</span></span>](formatting-types.md)
- <span data-ttu-id="5711e-224">[標準數值格式字串](standard-numeric-format-strings.md) \(部分機器翻譯\)</span><span class="sxs-lookup"><span data-stu-id="5711e-224">[Standard Numeric Format Strings](standard-numeric-format-strings.md)</span></span>
- [<span data-ttu-id="5711e-225">自訂數值格式字串</span><span class="sxs-lookup"><span data-stu-id="5711e-225">Custom Numeric Format Strings</span></span>](custom-numeric-format-strings.md)
- [<span data-ttu-id="5711e-226">標準日期和時間格式字串</span><span class="sxs-lookup"><span data-stu-id="5711e-226">Standard Date and Time Format Strings</span></span>](standard-date-and-time-format-strings.md)
- [<span data-ttu-id="5711e-227">自訂日期和時間格式字串</span><span class="sxs-lookup"><span data-stu-id="5711e-227">Custom Date and Time Format Strings</span></span>](custom-date-and-time-format-strings.md)
- [<span data-ttu-id="5711e-228">標準 TimeSpan 格式字串</span><span class="sxs-lookup"><span data-stu-id="5711e-228">Standard TimeSpan Format Strings</span></span>](standard-timespan-format-strings.md)
- [<span data-ttu-id="5711e-229">自訂 TimeSpan 格式字串</span><span class="sxs-lookup"><span data-stu-id="5711e-229">Custom TimeSpan Format Strings</span></span>](custom-timespan-format-strings.md)
- [<span data-ttu-id="5711e-230">列舉格式字串</span><span class="sxs-lookup"><span data-stu-id="5711e-230">Enumeration Format Strings</span></span>](enumeration-format-strings.md)

---
title: '如何比較字串-c # 指南'
description: 了解如何比較和排序字串值，不論大小寫、不論文化特性特定的順序
ms.date: 10/03/2018
helpviewer_keywords:
- strings [C#], comparison
- comparing strings [C#]
ms.openlocfilehash: 725441f5399f72b6457af461d51419c35077f4c2
ms.sourcegitcommit: 7137e12f54c4e83a94ae43ec320f8cf59c1772ea
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 06/10/2020
ms.locfileid: "84662910"
---
# <a name="how-to-compare-strings-in-c"></a><span data-ttu-id="b8366-103">如何：在 C\# 比較字串</span><span class="sxs-lookup"><span data-stu-id="b8366-103">How to compare strings in C\#</span></span>

<span data-ttu-id="b8366-104">比較字串來回答兩個問題的其中一個：「這兩個字串相等嗎？」</span><span class="sxs-lookup"><span data-stu-id="b8366-104">You compare strings to answer one of two questions: "Are these two strings equal?"</span></span> <span data-ttu-id="b8366-105">或「這些字串在排序時應該以何種順序放置？」</span><span class="sxs-lookup"><span data-stu-id="b8366-105">or "In what order should these strings be placed when sorting them?"</span></span>

<span data-ttu-id="b8366-106">這兩個問題會因為影響字串比較的因素而變複雜：</span><span class="sxs-lookup"><span data-stu-id="b8366-106">Those two questions are complicated by factors that affect string comparisons:</span></span>

- <span data-ttu-id="b8366-107">您可以選擇序數或語言比較。</span><span class="sxs-lookup"><span data-stu-id="b8366-107">You can choose an ordinal or linguistic comparison.</span></span>
- <span data-ttu-id="b8366-108">您可以選擇大小寫是否重要。</span><span class="sxs-lookup"><span data-stu-id="b8366-108">You can choose if case matters.</span></span>
- <span data-ttu-id="b8366-109">您可以選擇文化特性 (Culture) 特定的比較。</span><span class="sxs-lookup"><span data-stu-id="b8366-109">You can choose culture-specific comparisons.</span></span>
- <span data-ttu-id="b8366-110">語言比較視文化特性 (Culture) 與平台而異。</span><span class="sxs-lookup"><span data-stu-id="b8366-110">Linguistic comparisons are culture and platform-dependent.</span></span>

[!INCLUDE[interactive-note](~/includes/csharp-interactive-note.md)]

<span data-ttu-id="b8366-111">當您比較字串時，您會定義它們之間的順序。</span><span class="sxs-lookup"><span data-stu-id="b8366-111">When you compare strings, you define an order among them.</span></span> <span data-ttu-id="b8366-112">比較用來排序字串的序列。</span><span class="sxs-lookup"><span data-stu-id="b8366-112">Comparisons are used to sort a sequence of strings.</span></span> <span data-ttu-id="b8366-113">一旦序列是已知的順序，軟體和人類都能比較容易搜尋。</span><span class="sxs-lookup"><span data-stu-id="b8366-113">Once the sequence is in a known order, it is easier to search, both for software and for humans.</span></span> <span data-ttu-id="b8366-114">其他的比較可能會檢查字串是否相同。</span><span class="sxs-lookup"><span data-stu-id="b8366-114">Other comparisons may check if strings are the same.</span></span> <span data-ttu-id="b8366-115">這些相同性檢查類似於相等，但可能會忽略部分差異，例如大小寫的差異。</span><span class="sxs-lookup"><span data-stu-id="b8366-115">These sameness checks are similar to equality, but some differences, such as case differences, may be ignored.</span></span>

## <a name="default-ordinal-comparisons"></a><span data-ttu-id="b8366-116">預設的序數比較</span><span class="sxs-lookup"><span data-stu-id="b8366-116">Default ordinal comparisons</span></span>

<span data-ttu-id="b8366-117">根據預設，最常見的作業如下：</span><span class="sxs-lookup"><span data-stu-id="b8366-117">By default, the most common operations:</span></span>

- <xref:System.String.CompareTo%2A?displayProperty=nameWithType>
- <xref:System.String.Equals%2A?displayProperty=nameWithType>
- <span data-ttu-id="b8366-118"><xref:System.String.op_Equality%2A?displayProperty=nameWithType>and <xref:System.String.op_Inequality%2A?displayProperty=nameWithType> ，也就是，分別是等[號比較運算子 `==` 和 `!=` ](../language-reference/operators/equality-operators.md#string-equality)</span><span class="sxs-lookup"><span data-stu-id="b8366-118"><xref:System.String.op_Equality%2A?displayProperty=nameWithType> and <xref:System.String.op_Inequality%2A?displayProperty=nameWithType>, that is, [equality operators `==` and `!=`](../language-reference/operators/equality-operators.md#string-equality), respectively</span></span>

<span data-ttu-id="b8366-119">執行區分大小寫的序數比較，並視需要使用目前的文化特性。</span><span class="sxs-lookup"><span data-stu-id="b8366-119">perform a case-sensitive ordinal comparison and, if necessary, use the current culture.</span></span> <span data-ttu-id="b8366-120">下列範例示範：</span><span class="sxs-lookup"><span data-stu-id="b8366-120">The following example demonstrates that:</span></span>

:::code language="csharp" interactive="try-dotnet-method" source="../../../samples/snippets/csharp/how-to/strings/CompareStrings.cs" id="Snippet1":::

<span data-ttu-id="b8366-121">比較字串時，預設序數比較並不會考慮語言規則。</span><span class="sxs-lookup"><span data-stu-id="b8366-121">The default ordinal comparison doesn't take linguistic rules into account when comparing strings.</span></span> <span data-ttu-id="b8366-122">其會在兩個字串中比較各 <xref:System.Char> 物件的二進位值。</span><span class="sxs-lookup"><span data-stu-id="b8366-122">It compares the binary value of each <xref:System.Char> object in two strings.</span></span> <span data-ttu-id="b8366-123">如此一來，預設序數比較也會區分大小寫。</span><span class="sxs-lookup"><span data-stu-id="b8366-123">As a result, the default ordinal comparison is also case-sensitive.</span></span>

<span data-ttu-id="b8366-124">請注意，與和運算子相等的測試，與 <xref:System.String.Equals%2A?displayProperty=nameWithType> `==` `!=` 使用和方法的字串比較 <xref:System.String.CompareTo%2A?displayProperty=nameWithType> 不同 <xref:System.String.Compare(System.String,System.String)?displayProperty=nameWithType)> 。</span><span class="sxs-lookup"><span data-stu-id="b8366-124">Note that the test for equality with <xref:System.String.Equals%2A?displayProperty=nameWithType> and the `==` and `!=` operators differs from string comparison using the <xref:System.String.CompareTo%2A?displayProperty=nameWithType> and <xref:System.String.Compare(System.String,System.String)?displayProperty=nameWithType)> methods.</span></span> <span data-ttu-id="b8366-125">雖然相等的測試會執行區分大小寫的序數比較，但比較方法會使用目前的文化特性執行區分大小寫、區分文化特性的比較。</span><span class="sxs-lookup"><span data-stu-id="b8366-125">While the tests for equality perform a case-sensitive ordinal comparison, the comparison methods perform a case-sensitive, culture-sensitive comparison using the current culture.</span></span> <span data-ttu-id="b8366-126">因為預設比較方法時常執行不同類型的比較，所以建議您皆透過呼叫明確指定要執行比較之類型的多載，以讓程式碼的意圖更加明確。</span><span class="sxs-lookup"><span data-stu-id="b8366-126">Because the default comparison methods often perform different types of comparisons, we recommend that you always make the intent of your code clear by calling an overload that explicitly specifies the type of comparison to perform.</span></span>

## <a name="case-insensitive-ordinal-comparisons"></a><span data-ttu-id="b8366-127">不區分大小寫的序數比較</span><span class="sxs-lookup"><span data-stu-id="b8366-127">Case-insensitive ordinal comparisons</span></span>

<span data-ttu-id="b8366-128"><xref:System.String.Equals(System.String,System.StringComparison)?displayProperty=nameWithType> 方法可讓您指定 <xref:System.StringComparison> 值 <xref:System.StringComparison.OrdinalIgnoreCase?displayProperty=nameWithType>，</span><span class="sxs-lookup"><span data-stu-id="b8366-128">The <xref:System.String.Equals(System.String,System.StringComparison)?displayProperty=nameWithType> method enables you to specify a <xref:System.StringComparison> value of <xref:System.StringComparison.OrdinalIgnoreCase?displayProperty=nameWithType></span></span>
<span data-ttu-id="b8366-129">對於不區分大小寫的序數比較。</span><span class="sxs-lookup"><span data-stu-id="b8366-129">for a case-insensitive ordinal comparison.</span></span> <span data-ttu-id="b8366-130">若為 <xref:System.StringComparison> 引數指定 <xref:System.StringComparison.OrdinalIgnoreCase?displayProperty=nameWithType> 的值，另外也有執行不區分大小寫序數比較的靜態 <xref:System.String.Compare(System.String,System.String,System.StringComparison)?displayProperty=nameWithType> 方法。</span><span class="sxs-lookup"><span data-stu-id="b8366-130">There is also a static <xref:System.String.Compare(System.String,System.String,System.StringComparison)?displayProperty=nameWithType> method that performs a case-insensitive ordinal comparison if you specify a value of <xref:System.StringComparison.OrdinalIgnoreCase?displayProperty=nameWithType> for the <xref:System.StringComparison> argument.</span></span> <span data-ttu-id="b8366-131">如下列程式碼所示：</span><span class="sxs-lookup"><span data-stu-id="b8366-131">These are shown in the following code:</span></span>

:::code language="csharp" interactive="try-dotnet-method" source="../../../samples/snippets/csharp/how-to/strings/CompareStrings.cs" id="Snippet2":::

<span data-ttu-id="b8366-132">當執行區分大小寫的序數比較時，這些方法會使用[不因文化特性而異](xref:System.Globalization.CultureInfo.InvariantCulture)的大小寫慣例。</span><span class="sxs-lookup"><span data-stu-id="b8366-132">When performing a case-insensitive ordinal comparison, these methods use the casing conventions of the [invariant culture](xref:System.Globalization.CultureInfo.InvariantCulture).</span></span>

## <a name="linguistic-comparisons"></a><span data-ttu-id="b8366-133">語言比較</span><span class="sxs-lookup"><span data-stu-id="b8366-133">Linguistic comparisons</span></span>

<span data-ttu-id="b8366-134">字串也可以使用目前文化特性的語言規則來排序。</span><span class="sxs-lookup"><span data-stu-id="b8366-134">Strings can also be ordered using linguistic rules for the current culture.</span></span>
<span data-ttu-id="b8366-135">這有時候稱為「字組排序次序」。</span><span class="sxs-lookup"><span data-stu-id="b8366-135">This is sometimes referred to as "word sort order."</span></span> <span data-ttu-id="b8366-136">當您執行語言比較時，部分非英數字元的 Unicode 字元可能會被指派特殊的權重。</span><span class="sxs-lookup"><span data-stu-id="b8366-136">When you perform a linguistic comparison, some nonalphanumeric Unicode characters might have special weights assigned.</span></span> <span data-ttu-id="b8366-137">例如，連字號 "-" 可能會被指派很小的權重，以便 "co-op" 和 "coop" 在排序次序中會出現在彼此旁邊。</span><span class="sxs-lookup"><span data-stu-id="b8366-137">For example, the hyphen "-" may have a very small weight assigned to it so that "co-op" and "coop" appear next to each other in sort order.</span></span> <span data-ttu-id="b8366-138">此外，某些 Unicode 字元可能會相等於 <xref:System.Char> 執行個體的順序。</span><span class="sxs-lookup"><span data-stu-id="b8366-138">In addition, some Unicode characters may be equivalent to a sequence of <xref:System.Char> instances.</span></span> <span data-ttu-id="b8366-139">下列範例使用該片語 "They dance in the street"。</span><span class="sxs-lookup"><span data-stu-id="b8366-139">The following example uses the phrase "They dance in the street."</span></span> <span data-ttu-id="b8366-140">以下使用德文「他們在街道上跳舞」為例，並在其中一個字串使用 "ss" (U+0073 U+0073)，而另一個則使用 'ß' (U+00DF)。</span><span class="sxs-lookup"><span data-stu-id="b8366-140">in German with the "ss" (U+0073 U+0073) in one string and 'ß' (U+00DF) in another.</span></span> <span data-ttu-id="b8366-141">在語言方面 (在 Windows 中)，"ss" 等於 "en-US" 和 "de-DE" 文化特性中的德文 Esszet: 'ß' 字元。</span><span class="sxs-lookup"><span data-stu-id="b8366-141">Linguistically (in Windows), "ss" is equal to the German Esszet: 'ß' character in both the "en-US" and "de-DE" cultures.</span></span>

:::code language="csharp" interactive="try-dotnet-method" source="../../../samples/snippets/csharp/how-to/strings/CompareStrings.cs" id="Snippet3":::

<span data-ttu-id="b8366-142">這個範例會示範語言比較之作業系統相依的本質。</span><span class="sxs-lookup"><span data-stu-id="b8366-142">This sample demonstrates the operating system-dependent nature of linguistic comparisons.</span></span> <span data-ttu-id="b8366-143">互動式視窗的主機是 Linux 主機。</span><span class="sxs-lookup"><span data-stu-id="b8366-143">The host for the interactive window is a Linux host.</span></span> <span data-ttu-id="b8366-144">語言和序數比較會產生相同的結果。</span><span class="sxs-lookup"><span data-stu-id="b8366-144">The linguistic and ordinal comparisons produce the same results.</span></span> <span data-ttu-id="b8366-145">如果您在 Windows 主機上執行相同的範例，您會看到下列輸出：</span><span class="sxs-lookup"><span data-stu-id="b8366-145">If you ran this same sample on a Windows host, you would see the following output:</span></span>

```console
<coop> is less than <co-op> using invariant culture
<coop> is greater than <co-op> using ordinal comparison
<coop> is less than <cop> using invariant culture
<coop> is less than <cop> using ordinal comparison
<co-op> is less than <cop> using invariant culture
<co-op> is less than <cop> using ordinal comparison
```

<span data-ttu-id="b8366-146">在 Windows 上，"cop"、"coop" 和 "co-op" 的排序次序會在您從語言比較變更為序數比較時改變。</span><span class="sxs-lookup"><span data-stu-id="b8366-146">On Windows, the sort order of "cop", "coop", and "co-op" change when you change from a linguistic comparison to an ordinal comparison.</span></span> <span data-ttu-id="b8366-147">兩個德文句子使用不同的比較型別時，比較起來也會不同。</span><span class="sxs-lookup"><span data-stu-id="b8366-147">The two German sentences also compare differently using the different comparison types.</span></span>

## <a name="comparisons-using-specific-cultures"></a><span data-ttu-id="b8366-148">使用特定文化特性的比較</span><span class="sxs-lookup"><span data-stu-id="b8366-148">Comparisons using specific cultures</span></span>

<span data-ttu-id="b8366-149">此範例會儲存 en-US 及 de-DE 文化特性 (Culture) 的 <xref:System.Globalization.CultureInfo> 物件。</span><span class="sxs-lookup"><span data-stu-id="b8366-149">This sample stores <xref:System.Globalization.CultureInfo> objects for the en-US and de-DE cultures.</span></span>
<span data-ttu-id="b8366-150">比較是使用 <xref:System.Globalization.CultureInfo> 物件執行，以確保文化特性 (Culture) 特定的比較。</span><span class="sxs-lookup"><span data-stu-id="b8366-150">The comparisons are performed using a <xref:System.Globalization.CultureInfo> object to ensure a culture-specific comparison.</span></span>

<span data-ttu-id="b8366-151">使用的文化特性會影響語言比較。</span><span class="sxs-lookup"><span data-stu-id="b8366-151">The culture used affects linguistic comparisons.</span></span> <span data-ttu-id="b8366-152">下列範例會顯示使用 "en-US" 文化特性和 "de-DE" 文化特性比較兩個德文句子的結果：</span><span class="sxs-lookup"><span data-stu-id="b8366-152">The following example shows the results of comparing the two German sentences using the "en-US" culture and the "de-DE" culture:</span></span>

:::code language="csharp" interactive="try-dotnet-method" source="../../../samples/snippets/csharp/how-to/strings/CompareStrings.cs" id="Snippet4":::

<span data-ttu-id="b8366-153">文化特性敏感的比較通常用來比較和排序使用者輸入的字串與使用者輸入的其他字串。</span><span class="sxs-lookup"><span data-stu-id="b8366-153">Culture-sensitive comparisons are typically used to compare and sort strings input by users with other strings input by users.</span></span> <span data-ttu-id="b8366-154">這些字串的字元和排序慣例可能會視使用者電腦的地區設定而變。</span><span class="sxs-lookup"><span data-stu-id="b8366-154">The characters and sorting conventions of these strings might vary depending on the locale of the user's computer.</span></span> <span data-ttu-id="b8366-155">即使包含完全相同字元的字串，也可能因目前執行緒的文化特性而改變排序。</span><span class="sxs-lookup"><span data-stu-id="b8366-155">Even strings that contain identical characters might sort differently depending on the culture of the current thread.</span></span> <span data-ttu-id="b8366-156">此外，在 Windows 電腦上本機嘗試此範例程式碼，會產生下列結果：</span><span class="sxs-lookup"><span data-stu-id="b8366-156">In addition, try this sample code locally on a Windows machine, and you will the following results:</span></span>

```console
<coop> is less than <co-op> using en-US culture
<coop> is greater than <co-op> using ordinal comparison
<coop> is less than <cop> using en-US culture
<coop> is less than <cop> using ordinal comparison
<co-op> is less than <cop> using en-US culture
<co-op> is less than <cop> using ordinal comparison
```

<span data-ttu-id="b8366-157">語言比較視目前的文化特性與 OS 而異。</span><span class="sxs-lookup"><span data-stu-id="b8366-157">Linguistic comparisons are dependent on the current culture, and are OS dependent.</span></span> <span data-ttu-id="b8366-158">當您使用字串比較時必須考量此點。</span><span class="sxs-lookup"><span data-stu-id="b8366-158">You must take that into account when you work with string comparisons.</span></span>

## <a name="linguistic-sorting-and-searching-strings-in-arrays"></a><span data-ttu-id="b8366-159">陣列中的語言排序和字串搜尋</span><span class="sxs-lookup"><span data-stu-id="b8366-159">Linguistic sorting and searching strings in arrays</span></span>

<span data-ttu-id="b8366-160">下列範例顯示如何使用相依於目前文化特性的語言比較，在陣列中排序和搜尋字串。</span><span class="sxs-lookup"><span data-stu-id="b8366-160">The following examples show how to sort and search for strings in an array using a linguistic comparison dependent on the current culture.</span></span> <span data-ttu-id="b8366-161">請使用接受 <xref:System.StringComparer?displayProperty=nameWithType> 參數的靜態 <xref:System.Array> 方法。</span><span class="sxs-lookup"><span data-stu-id="b8366-161">You use the static <xref:System.Array> methods that take a <xref:System.StringComparer?displayProperty=nameWithType> parameter.</span></span>

<span data-ttu-id="b8366-162">此範例顯示如何使用目前文化特性來排序字串陣列：</span><span class="sxs-lookup"><span data-stu-id="b8366-162">This example shows how to sort an array of strings using the current culture:</span></span>

:::code language="csharp" interactive="try-dotnet-method" source="../../../samples/snippets/csharp/how-to/strings/CompareStrings.cs" id="Snippet5":::

<span data-ttu-id="b8366-163">陣列排序之後，您可以使用二進位搜尋來搜尋項目。</span><span class="sxs-lookup"><span data-stu-id="b8366-163">Once the array is sorted, you can search for entries using a binary search.</span></span> <span data-ttu-id="b8366-164">二進位搜尋會從集合的中間開始，判斷集合的哪一半會包含搜尋的字串。</span><span class="sxs-lookup"><span data-stu-id="b8366-164">A binary search starts in the middle of the collection to determine which half of the collection would contain the sought string.</span></span> <span data-ttu-id="b8366-165">每次後續的比較都會將集合的剩餘部分再對分。</span><span class="sxs-lookup"><span data-stu-id="b8366-165">Each subsequent comparison subdivides the remaining part of the collection in half.</span></span>  <span data-ttu-id="b8366-166">陣列是使用 <xref:System.StringComparer.CurrentCulture?displayProperty=nameWithType> 排序。</span><span class="sxs-lookup"><span data-stu-id="b8366-166">The array is sorted using the <xref:System.StringComparer.CurrentCulture?displayProperty=nameWithType>.</span></span> <span data-ttu-id="b8366-167">區域函式 `ShowWhere` 會顯示找到字串處的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="b8366-167">The local function `ShowWhere` displays information about where the string was found.</span></span> <span data-ttu-id="b8366-168">如果找不到字串，則傳回的值會指出如果找到的話它會是在哪裡。</span><span class="sxs-lookup"><span data-stu-id="b8366-168">If the string was not found, the returned value indicates where it would be if it were found.</span></span>

:::code language="csharp" interactive="try-dotnet-method" source="../../../samples/snippets/csharp/how-to/strings/CompareStrings.cs" id="Snippet6":::

## <a name="ordinal-sorting-and-searching-in-collections"></a><span data-ttu-id="b8366-169">集合中的序數排序和搜尋</span><span class="sxs-lookup"><span data-stu-id="b8366-169">Ordinal sorting and searching in collections</span></span>

<span data-ttu-id="b8366-170">下列程式碼會使用 <xref:System.Collections.Generic.List%601?displayProperty=nameWithType> 集合類別來儲存字串。</span><span class="sxs-lookup"><span data-stu-id="b8366-170">The following code uses the <xref:System.Collections.Generic.List%601?displayProperty=nameWithType> collection class to store strings.</span></span> <span data-ttu-id="b8366-171">字串是使用 <xref:System.Collections.Generic.List%601.Sort%2A?displayProperty=nameWithType> 方法排序。</span><span class="sxs-lookup"><span data-stu-id="b8366-171">The strings are sorted using the <xref:System.Collections.Generic.List%601.Sort%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="b8366-172">這個方法需要可比較和排序兩個字串的委派。</span><span class="sxs-lookup"><span data-stu-id="b8366-172">This method needs a delegate that compares and orders two strings.</span></span> <span data-ttu-id="b8366-173"><xref:System.String.CompareTo%2A?displayProperty=nameWithType> 方法提供該比較函式。</span><span class="sxs-lookup"><span data-stu-id="b8366-173">The <xref:System.String.CompareTo%2A?displayProperty=nameWithType> method provides that comparison function.</span></span> <span data-ttu-id="b8366-174">執行範例，並觀察順序。</span><span class="sxs-lookup"><span data-stu-id="b8366-174">Run the sample and observe the order.</span></span> <span data-ttu-id="b8366-175">此排序作業會使用序數區分大小寫排序。</span><span class="sxs-lookup"><span data-stu-id="b8366-175">This sort operation uses an ordinal case sensitive sort.</span></span> <span data-ttu-id="b8366-176">您可以使用靜態 <xref:System.String.Compare%2A?displayProperty=nameWithType> 方法來指定不同的比較規則。</span><span class="sxs-lookup"><span data-stu-id="b8366-176">You would use the static <xref:System.String.Compare%2A?displayProperty=nameWithType> methods to specify different comparison rules.</span></span>

:::code language="csharp" interactive="try-dotnet-method" source="../../../samples/snippets/csharp/how-to/strings/CompareStrings.cs" id="Snippet7":::

<span data-ttu-id="b8366-177">排序之後，便可以使用二進位搜尋來搜尋字串清單。</span><span class="sxs-lookup"><span data-stu-id="b8366-177">Once sorted, the list of strings can be searched using a binary search.</span></span> <span data-ttu-id="b8366-178">下列範例會示範如何使用相同的比較函式搜尋已排序的清單。</span><span class="sxs-lookup"><span data-stu-id="b8366-178">The following sample shows how to search the sorted listed using the same comparison function.</span></span> <span data-ttu-id="b8366-179">區域函式 `ShowWhere` 顯示搜尋的文字在哪裡或是會在哪裡：</span><span class="sxs-lookup"><span data-stu-id="b8366-179">The local function `ShowWhere` shows where the sought text is or would be:</span></span>

:::code language="csharp" interactive="try-dotnet-method" source="../../../samples/snippets/csharp/how-to/strings/CompareStrings.cs" id="Snippet8":::

<span data-ttu-id="b8366-180">請務必使用相同型別的比較來排序和搜尋。</span><span class="sxs-lookup"><span data-stu-id="b8366-180">Always make sure to use the same type of comparison for sorting and searching.</span></span> <span data-ttu-id="b8366-181">使用不同的比較型別來排序和搜尋，會產生非預期的結果。</span><span class="sxs-lookup"><span data-stu-id="b8366-181">Using different comparison types for sorting and searching produces unexpected results.</span></span>

<span data-ttu-id="b8366-182">項目或索引鍵的類型為 `string` 時，<xref:System.Collections.Hashtable?displayProperty=nameWithType>、<xref:System.Collections.Generic.Dictionary%602?displayProperty=nameWithType> 和 <xref:System.Collections.Generic.List%601?displayProperty=nameWithType> 這類集合類別具有接受 <xref:System.StringComparer?displayProperty=nameWithType> 參數的建構函式。</span><span class="sxs-lookup"><span data-stu-id="b8366-182">Collection classes such as <xref:System.Collections.Hashtable?displayProperty=nameWithType>, <xref:System.Collections.Generic.Dictionary%602?displayProperty=nameWithType>, and <xref:System.Collections.Generic.List%601?displayProperty=nameWithType> have constructors that take a <xref:System.StringComparer?displayProperty=nameWithType> parameter when the type of the elements or keys is `string`.</span></span> <span data-ttu-id="b8366-183">通常應該盡可能使用這些建構函式，並指定 <xref:System.StringComparer.Ordinal?displayProperty=nameWithType> 或 <xref:System.StringComparer.OrdinalIgnoreCase?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="b8366-183">In general, you should use these constructors whenever possible, and specify either <xref:System.StringComparer.Ordinal?displayProperty=nameWithType> or <xref:System.StringComparer.OrdinalIgnoreCase?displayProperty=nameWithType>.</span></span>

## <a name="reference-equality-and-string-interning"></a><span data-ttu-id="b8366-184">參考相等與字串暫留</span><span class="sxs-lookup"><span data-stu-id="b8366-184">Reference equality and string interning</span></span>

<span data-ttu-id="b8366-185">沒有任何範例使用 <xref:System.Object.ReferenceEquals%2A>。</span><span class="sxs-lookup"><span data-stu-id="b8366-185">None of the samples have used <xref:System.Object.ReferenceEquals%2A>.</span></span> <span data-ttu-id="b8366-186">這個方法會判斷兩個字串是否相同的物件。</span><span class="sxs-lookup"><span data-stu-id="b8366-186">This method determines if two strings are the same object.</span></span> <span data-ttu-id="b8366-187">這可能會導致不一致的字串比較結果。</span><span class="sxs-lookup"><span data-stu-id="b8366-187">This can lead to inconsistent results in string comparisons.</span></span> <span data-ttu-id="b8366-188">下列範例示範 C# 的「字串暫留」\*\* 功能。</span><span class="sxs-lookup"><span data-stu-id="b8366-188">The following example demonstrates the *string interning* feature of C#.</span></span> <span data-ttu-id="b8366-189">當程式宣告兩個或多個相同的字串變數時，編譯器會將它們全部儲存在相同的位置。</span><span class="sxs-lookup"><span data-stu-id="b8366-189">When a program declares two or more identical string variables, the compiler stores them all in the same location.</span></span> <span data-ttu-id="b8366-190">藉由呼叫 <xref:System.Object.ReferenceEquals%2A> 方法，您會看到兩個字串實際上參考記憶體中的相同物件。</span><span class="sxs-lookup"><span data-stu-id="b8366-190">By calling the <xref:System.Object.ReferenceEquals%2A> method, you can see that the two strings actually refer to the same object in memory.</span></span> <span data-ttu-id="b8366-191">請使用 <xref:System.String.Copy%2A?displayProperty=nameWithType> 方法以避免暫留。</span><span class="sxs-lookup"><span data-stu-id="b8366-191">Use the <xref:System.String.Copy%2A?displayProperty=nameWithType> method to avoid interning.</span></span> <span data-ttu-id="b8366-192">複製完成後，兩個字串會有不同的儲存位置，即使它們有相同的值。</span><span class="sxs-lookup"><span data-stu-id="b8366-192">After the copy has been made, the two strings have different storage locations, even though they have the same value.</span></span> <span data-ttu-id="b8366-193">執行下列範例以顯示字串 `a` 和 `b` 已「暫留」\*\*，也就是說它們共用相同的存放裝置。</span><span class="sxs-lookup"><span data-stu-id="b8366-193">Run the following sample to show that strings `a` and `b` are *interned* meaning they share the same storage.</span></span> <span data-ttu-id="b8366-194">字串 `a` 和 `c` 則否。</span><span class="sxs-lookup"><span data-stu-id="b8366-194">The strings `a` and `c` are not.</span></span>

:::code language="csharp" interactive="try-dotnet-method" source="../../../samples/snippets/csharp/how-to/strings/CompareStrings.cs" id="Snippet9":::

> [!NOTE]
> <span data-ttu-id="b8366-195">當您測試字串是否相等時，您應該使用明確指定打算執行比較型別的方法。</span><span class="sxs-lookup"><span data-stu-id="b8366-195">When you test for equality of strings, you should use the methods that explicitly specify what kind of comparison you intend to perform.</span></span> <span data-ttu-id="b8366-196">您的程式碼會更容易維護及閱讀。</span><span class="sxs-lookup"><span data-stu-id="b8366-196">Your code is much more maintainable and readable.</span></span> <span data-ttu-id="b8366-197">請使用 <xref:System.String?displayProperty=nameWithType> 和 <xref:System.Array?displayProperty=nameWithType> 類別的方法多載，接受 <xref:System.StringComparison> 列舉參數。</span><span class="sxs-lookup"><span data-stu-id="b8366-197">Use the overloads of the methods of the <xref:System.String?displayProperty=nameWithType> and <xref:System.Array?displayProperty=nameWithType> classes that take a <xref:System.StringComparison> enumeration parameter.</span></span> <span data-ttu-id="b8366-198">您指定要執行的比較型別。</span><span class="sxs-lookup"><span data-stu-id="b8366-198">You specify which type of comparison to perform.</span></span> <span data-ttu-id="b8366-199">測試是否相等時，請避免使用 `==` 和 `!=` 運算子。</span><span class="sxs-lookup"><span data-stu-id="b8366-199">Avoid using the `==` and `!=` operators when you test for equality.</span></span> <span data-ttu-id="b8366-200"><xref:System.String.CompareTo%2A?displayProperty=nameWithType> 執行個體方法一律會執行區分大小寫的序數比較。</span><span class="sxs-lookup"><span data-stu-id="b8366-200">The <xref:System.String.CompareTo%2A?displayProperty=nameWithType> instance methods always perform an ordinal case-sensitive comparison.</span></span> <span data-ttu-id="b8366-201">它們主要適用於依字母順序排序字串。</span><span class="sxs-lookup"><span data-stu-id="b8366-201">They are primarily suited for ordering strings alphabetically.</span></span>

<span data-ttu-id="b8366-202">您可以透過呼叫 <xref:System.String.Intern%2A?displayProperty=nameWithType> 方法實習字串或擷取參考到現有的已實習字串。</span><span class="sxs-lookup"><span data-stu-id="b8366-202">You can intern a string or retrieve a reference to an existing interned string by calling the <xref:System.String.Intern%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="b8366-203">若要判斷字串是否已實習，請呼叫 <xref:System.String.IsInterned%2A?displayProperty=nameWithType> 方法。</span><span class="sxs-lookup"><span data-stu-id="b8366-203">To determine whether a string is interned, call the <xref:System.String.IsInterned%2A?displayProperty=nameWithType> method.</span></span>

## <a name="see-also"></a><span data-ttu-id="b8366-204">另請參閱</span><span class="sxs-lookup"><span data-stu-id="b8366-204">See also</span></span>

- <xref:System.Globalization.CultureInfo?displayProperty=nameWithType>
- <xref:System.StringComparer?displayProperty=nameWithType>
- [<span data-ttu-id="b8366-205">字串</span><span class="sxs-lookup"><span data-stu-id="b8366-205">Strings</span></span>](../programming-guide/strings/index.md)
- [<span data-ttu-id="b8366-206">比較字串</span><span class="sxs-lookup"><span data-stu-id="b8366-206">Comparing strings</span></span>](../../standard/base-types/comparing.md)
- [<span data-ttu-id="b8366-207">全球化和當地語系化應用程式</span><span class="sxs-lookup"><span data-stu-id="b8366-207">Globalizing and localizing applications</span></span>](/visualstudio/ide/globalizing-and-localizing-applications)
